import{aU as Qe}from"./SnackbarsStore-BWrzfOQC.js";var Ke={exports:{}};(function(We,Ze){(function(ge,_e){We.exports=_e()})(window,function(){return function(ge){var _e={};function x(V){if(_e[V])return _e[V].exports;var T=_e[V]={i:V,l:!1,exports:{}};return ge[V].call(T.exports,T,T.exports,x),T.l=!0,T.exports}return x.m=ge,x.c=_e,x.d=function(V,T,L){x.o(V,T)||Object.defineProperty(V,T,{enumerable:!0,get:L})},x.r=function(V){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(V,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(V,"__esModule",{value:!0})},x.t=function(V,T){if(1&T&&(V=x(V)),8&T||4&T&&typeof V=="object"&&V&&V.__esModule)return V;var L=Object.create(null);if(x.r(L),Object.defineProperty(L,"default",{enumerable:!0,value:V}),2&T&&typeof V!="string")for(var c in V)x.d(L,c,function(y){return V[y]}.bind(null,c));return L},x.n=function(V){var T=V&&V.__esModule?function(){return V.default}:function(){return V};return x.d(T,"a",T),T},x.o=function(V,T){return Object.prototype.hasOwnProperty.call(V,T)},x.p="",x(x.s=25)}([function(ge,_e,x){var V=x(10),T=x.n(V),L=function(){function c(){}return c.e=function(y,a){y&&!c.FORCE_GLOBAL_TAG||(y=c.GLOBAL_TAG);var h="[".concat(y,"] > ").concat(a);c.ENABLE_CALLBACK&&c.emitter.emit("log","error",h),c.ENABLE_ERROR&&(console.error?console.error(h):console.warn?console.warn(h):console.log(h))},c.i=function(y,a){y&&!c.FORCE_GLOBAL_TAG||(y=c.GLOBAL_TAG);var h="[".concat(y,"] > ").concat(a);c.ENABLE_CALLBACK&&c.emitter.emit("log","info",h),c.ENABLE_INFO&&(console.info?console.info(h):console.log(h))},c.w=function(y,a){y&&!c.FORCE_GLOBAL_TAG||(y=c.GLOBAL_TAG);var h="[".concat(y,"] > ").concat(a);c.ENABLE_CALLBACK&&c.emitter.emit("log","warn",h),c.ENABLE_WARN&&(console.warn?console.warn(h):console.log(h))},c.d=function(y,a){y&&!c.FORCE_GLOBAL_TAG||(y=c.GLOBAL_TAG);var h="[".concat(y,"] > ").concat(a);c.ENABLE_CALLBACK&&c.emitter.emit("log","debug",h),c.ENABLE_DEBUG&&(console.debug?console.debug(h):console.log(h))},c.v=function(y,a){y&&!c.FORCE_GLOBAL_TAG||(y=c.GLOBAL_TAG);var h="[".concat(y,"] > ").concat(a);c.ENABLE_CALLBACK&&c.emitter.emit("log","verbose",h),c.ENABLE_VERBOSE&&console.log(h)},c}();L.GLOBAL_TAG="mpegts.js",L.FORCE_GLOBAL_TAG=!1,L.ENABLE_ERROR=!0,L.ENABLE_INFO=!0,L.ENABLE_WARN=!0,L.ENABLE_DEBUG=!0,L.ENABLE_VERBOSE=!0,L.ENABLE_CALLBACK=!1,L.emitter=new T.a,_e.a=L},function(ge,_e,x){var V;(function(T){T.IO_ERROR="io_error",T.DEMUX_ERROR="demux_error",T.INIT_SEGMENT="init_segment",T.MEDIA_SEGMENT="media_segment",T.LOADING_COMPLETE="loading_complete",T.RECOVERED_EARLY_EOF="recovered_early_eof",T.MEDIA_INFO="media_info",T.METADATA_ARRIVED="metadata_arrived",T.SCRIPTDATA_ARRIVED="scriptdata_arrived",T.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",T.PGS_SUBTITLE_ARRIVED="pgs_subtitle_arrived",T.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",T.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",T.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",T.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",T.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",T.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",T.STATISTICS_INFO="statistics_info",T.RECOMMEND_SEEKPOINT="recommend_seekpoint"})(V||(V={})),_e.a=V},function(ge,_e,x){x.d(_e,"c",function(){return T}),x.d(_e,"b",function(){return L}),x.d(_e,"a",function(){return c});var V=x(3),T={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},L={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},c=function(){function y(a){this._type=a||"undefined",this._status=T.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return y.prototype.destroy=function(){this._status=T.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},y.prototype.isWorking=function(){return this._status===T.kConnecting||this._status===T.kBuffering},Object.defineProperty(y.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(a){this._onContentLengthKnown=a},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(a){this._onURLRedirect=a},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(a){this._onDataArrival=a},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onError",{get:function(){return this._onError},set:function(a){this._onError=a},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onComplete",{get:function(){return this._onComplete},set:function(a){this._onComplete=a},enumerable:!1,configurable:!0}),y.prototype.open=function(a,h){throw new V.c("Unimplemented abstract function!")},y.prototype.abort=function(){throw new V.c("Unimplemented abstract function!")},y}()},function(ge,_e,x){x.d(_e,"d",function(){return L}),x.d(_e,"a",function(){return c}),x.d(_e,"b",function(){return y}),x.d(_e,"c",function(){return a});var V,T=(V=function(h,f){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,E){A.__proto__=E}||function(A,E){for(var O in E)Object.prototype.hasOwnProperty.call(E,O)&&(A[O]=E[O])})(h,f)},function(h,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function A(){this.constructor=h}V(h,f),h.prototype=f===null?Object.create(f):(A.prototype=f.prototype,new A)}),L=function(){function h(f){this._message=f}return Object.defineProperty(h.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),h.prototype.toString=function(){return this.name+": "+this.message},h}(),c=function(h){function f(A){return h.call(this,A)||this}return T(f,h),Object.defineProperty(f.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),f}(L),y=function(h){function f(A){return h.call(this,A)||this}return T(f,h),Object.defineProperty(f.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),f}(L),a=function(h){function f(A){return h.call(this,A)||this}return T(f,h),Object.defineProperty(f.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),f}(L)},function(ge,_e,x){var V;(function(T){T.ERROR="error",T.LOADING_COMPLETE="loading_complete",T.RECOVERED_EARLY_EOF="recovered_early_eof",T.MEDIA_INFO="media_info",T.METADATA_ARRIVED="metadata_arrived",T.SCRIPTDATA_ARRIVED="scriptdata_arrived",T.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",T.PGS_SUBTITLE_ARRIVED="pgs_subtitle_arrived",T.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",T.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",T.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",T.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",T.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",T.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",T.STATISTICS_INFO="statistics_info",T.DESTROYING="destroying"})(V||(V={})),_e.a=V},function(ge,_e,x){var V={};(function(){var T=self.navigator.userAgent.toLowerCase(),L=/(edge)\/([\w.]+)/.exec(T)||/(opr)[\/]([\w.]+)/.exec(T)||/(chrome)[ \/]([\w.]+)/.exec(T)||/(iemobile)[\/]([\w.]+)/.exec(T)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(T)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(T)||/(webkit)[ \/]([\w.]+)/.exec(T)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(T)||/(msie) ([\w.]+)/.exec(T)||T.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(T)||T.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(T)||[],c=/(ipad)/.exec(T)||/(ipod)/.exec(T)||/(windows phone)/.exec(T)||/(iphone)/.exec(T)||/(kindle)/.exec(T)||/(android)/.exec(T)||/(windows)/.exec(T)||/(mac)/.exec(T)||/(linux)/.exec(T)||/(cros)/.exec(T)||[],y={browser:L[5]||L[3]||L[1]||"",version:L[2]||L[4]||"0",majorVersion:L[4]||L[2]||"0",platform:c[0]||""},a={};if(y.browser){a[y.browser]=!0;var h=y.majorVersion.split(".");a.version={major:parseInt(y.majorVersion,10),string:y.version},h.length>1&&(a.version.minor=parseInt(h[1],10)),h.length>2&&(a.version.build=parseInt(h[2],10))}y.platform&&(a[y.platform]=!0),(a.chrome||a.opr||a.safari)&&(a.webkit=!0),(a.rv||a.iemobile)&&(a.rv&&delete a.rv,y.browser="msie",a.msie=!0),a.edge&&(delete a.edge,y.browser="msedge",a.msedge=!0),a.opr&&(y.browser="opera",a.opera=!0),a.safari&&a.android&&(y.browser="android",a.android=!0);for(var f in a.name=y.browser,a.platform=y.platform,V)V.hasOwnProperty(f)&&delete V[f];Object.assign(V,a)})(),_e.a=V},function(ge,_e,x){_e.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(ge,_e,x){var V;(function(T){T.ERROR="error",T.SOURCE_OPEN="source_open",T.UPDATE_END="update_end",T.BUFFER_FULL="buffer_full",T.START_STREAMING="start_streaming",T.END_STREAMING="end_streaming"})(V||(V={})),_e.a=V},function(ge,_e,x){var V=x(3),T=function(){function L(c){this.TAG="ExpGolomb",this._buffer=c,this._buffer_index=0,this._total_bytes=c.byteLength,this._total_bits=8*c.byteLength,this._current_word=0,this._current_word_bits_left=0}return L.prototype.destroy=function(){this._buffer=null},L.prototype._fillCurrentWord=function(){var c=this._total_bytes-this._buffer_index;if(c<=0)throw new V.a("ExpGolomb: _fillCurrentWord() but no bytes available");var y=Math.min(4,c),a=new Uint8Array(4);a.set(this._buffer.subarray(this._buffer_index,this._buffer_index+y)),this._current_word=new DataView(a.buffer).getUint32(0,!1),this._buffer_index+=y,this._current_word_bits_left=8*y},L.prototype.readBits=function(c){if(c>32)throw new V.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(c<=this._current_word_bits_left){var y=this._current_word>>>32-c;return this._current_word<<=c,this._current_word_bits_left-=c,y}var a=this._current_word_bits_left?this._current_word:0;a>>>=32-this._current_word_bits_left;var h=c-this._current_word_bits_left;this._fillCurrentWord();var f=Math.min(h,this._current_word_bits_left),A=this._current_word>>>32-f;return this._current_word<<=f,this._current_word_bits_left-=f,a=a<<f|A},L.prototype.readBool=function(){return this.readBits(1)===1},L.prototype.readByte=function(){return this.readBits(8)},L.prototype._skipLeadingZero=function(){var c;for(c=0;c<this._current_word_bits_left;c++)if(this._current_word&2147483648>>>c)return this._current_word<<=c,this._current_word_bits_left-=c,c;return this._fillCurrentWord(),c+this._skipLeadingZero()},L.prototype.readUEG=function(){var c=this._skipLeadingZero();return this.readBits(c+1)-1},L.prototype.readSEG=function(){var c=this.readUEG();return 1&c?c+1>>>1:-1*(c>>>1)},L}();_e.a=T},function(ge,_e,x){var V=x(10),T=x.n(V),L=x(0),c=function(){function y(){}return Object.defineProperty(y,"forceGlobalTag",{get:function(){return L.a.FORCE_GLOBAL_TAG},set:function(a){L.a.FORCE_GLOBAL_TAG=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"globalTag",{get:function(){return L.a.GLOBAL_TAG},set:function(a){L.a.GLOBAL_TAG=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"enableAll",{get:function(){return L.a.ENABLE_VERBOSE&&L.a.ENABLE_DEBUG&&L.a.ENABLE_INFO&&L.a.ENABLE_WARN&&L.a.ENABLE_ERROR},set:function(a){L.a.ENABLE_VERBOSE=a,L.a.ENABLE_DEBUG=a,L.a.ENABLE_INFO=a,L.a.ENABLE_WARN=a,L.a.ENABLE_ERROR=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"enableDebug",{get:function(){return L.a.ENABLE_DEBUG},set:function(a){L.a.ENABLE_DEBUG=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"enableVerbose",{get:function(){return L.a.ENABLE_VERBOSE},set:function(a){L.a.ENABLE_VERBOSE=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"enableInfo",{get:function(){return L.a.ENABLE_INFO},set:function(a){L.a.ENABLE_INFO=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"enableWarn",{get:function(){return L.a.ENABLE_WARN},set:function(a){L.a.ENABLE_WARN=a,y._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"enableError",{get:function(){return L.a.ENABLE_ERROR},set:function(a){L.a.ENABLE_ERROR=a,y._notifyChange()},enumerable:!1,configurable:!0}),y.getConfig=function(){return{globalTag:L.a.GLOBAL_TAG,forceGlobalTag:L.a.FORCE_GLOBAL_TAG,enableVerbose:L.a.ENABLE_VERBOSE,enableDebug:L.a.ENABLE_DEBUG,enableInfo:L.a.ENABLE_INFO,enableWarn:L.a.ENABLE_WARN,enableError:L.a.ENABLE_ERROR,enableCallback:L.a.ENABLE_CALLBACK}},y.applyConfig=function(a){L.a.GLOBAL_TAG=a.globalTag,L.a.FORCE_GLOBAL_TAG=a.forceGlobalTag,L.a.ENABLE_VERBOSE=a.enableVerbose,L.a.ENABLE_DEBUG=a.enableDebug,L.a.ENABLE_INFO=a.enableInfo,L.a.ENABLE_WARN=a.enableWarn,L.a.ENABLE_ERROR=a.enableError,L.a.ENABLE_CALLBACK=a.enableCallback},y._notifyChange=function(){var a=y.emitter;if(a.listenerCount("change")>0){var h=y.getConfig();a.emit("change",h)}},y.registerListener=function(a){y.emitter.addListener("change",a)},y.removeListener=function(a){y.emitter.removeListener("change",a)},y.addLogListener=function(a){L.a.emitter.addListener("log",a),L.a.emitter.listenerCount("log")>0&&(L.a.ENABLE_CALLBACK=!0,y._notifyChange())},y.removeLogListener=function(a){L.a.emitter.removeListener("log",a),L.a.emitter.listenerCount("log")===0&&(L.a.ENABLE_CALLBACK=!1,y._notifyChange())},y}();c.emitter=new T.a,_e.a=c},function(ge,_e,x){var V,T=typeof Reflect=="object"?Reflect:null,L=T&&typeof T.apply=="function"?T.apply:function(C,J,ee){return Function.prototype.apply.call(C,J,ee)};V=T&&typeof T.ownKeys=="function"?T.ownKeys:Object.getOwnPropertySymbols?function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:function(C){return Object.getOwnPropertyNames(C)};var c=Number.isNaN||function(C){return C!=C};function y(){y.init.call(this)}ge.exports=y,ge.exports.once=function(C,J){return new Promise(function(ee,U){function u(l){C.removeListener(J,d),U(l)}function d(){typeof C.removeListener=="function"&&C.removeListener("error",u),ee([].slice.call(arguments))}q(C,J,d,{once:!0}),J!=="error"&&function(l,g,K){typeof l.on=="function"&&q(l,"error",g,K)}(C,u,{once:!0})})},y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var a=10;function h(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}function f(C){return C._maxListeners===void 0?y.defaultMaxListeners:C._maxListeners}function A(C,J,ee,U){var u,d,l,g;if(h(ee),(d=C._events)===void 0?(d=C._events=Object.create(null),C._eventsCount=0):(d.newListener!==void 0&&(C.emit("newListener",J,ee.listener?ee.listener:ee),d=C._events),l=d[J]),l===void 0)l=d[J]=ee,++C._eventsCount;else if(typeof l=="function"?l=d[J]=U?[ee,l]:[l,ee]:U?l.unshift(ee):l.push(ee),(u=f(C))>0&&l.length>u&&!l.warned){l.warned=!0;var K=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(J)+" listeners added. Use emitter.setMaxListeners() to increase limit");K.name="MaxListenersExceededWarning",K.emitter=C,K.type=J,K.count=l.length,g=K,console&&console.warn&&console.warn(g)}return C}function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function O(C,J,ee){var U={fired:!1,wrapFn:void 0,target:C,type:J,listener:ee},u=E.bind(U);return u.listener=ee,U.wrapFn=u,u}function G(C,J,ee){var U=C._events;if(U===void 0)return[];var u=U[J];return u===void 0?[]:typeof u=="function"?ee?[u.listener||u]:[u]:ee?function(d){for(var l=new Array(d.length),g=0;g<l.length;++g)l[g]=d[g].listener||d[g];return l}(u):z(u,u.length)}function I(C){var J=this._events;if(J!==void 0){var ee=J[C];if(typeof ee=="function")return 1;if(ee!==void 0)return ee.length}return 0}function z(C,J){for(var ee=new Array(J),U=0;U<J;++U)ee[U]=C[U];return ee}function q(C,J,ee,U){if(typeof C.on=="function")U.once?C.once(J,ee):C.on(J,ee);else{if(typeof C.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C);C.addEventListener(J,function u(d){U.once&&C.removeEventListener(J,u),ee(d)})}}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(C){if(typeof C!="number"||C<0||c(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");a=C}}),y.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||c(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this},y.prototype.getMaxListeners=function(){return f(this)},y.prototype.emit=function(C){for(var J=[],ee=1;ee<arguments.length;ee++)J.push(arguments[ee]);var U=C==="error",u=this._events;if(u!==void 0)U=U&&u.error===void 0;else if(!U)return!1;if(U){var d;if(J.length>0&&(d=J[0]),d instanceof Error)throw d;var l=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw l.context=d,l}var g=u[C];if(g===void 0)return!1;if(typeof g=="function")L(g,this,J);else{var K=g.length,$=z(g,K);for(ee=0;ee<K;++ee)L($[ee],this,J)}return!0},y.prototype.addListener=function(C,J){return A(this,C,J,!1)},y.prototype.on=y.prototype.addListener,y.prototype.prependListener=function(C,J){return A(this,C,J,!0)},y.prototype.once=function(C,J){return h(J),this.on(C,O(this,C,J)),this},y.prototype.prependOnceListener=function(C,J){return h(J),this.prependListener(C,O(this,C,J)),this},y.prototype.removeListener=function(C,J){var ee,U,u,d,l;if(h(J),(U=this._events)===void 0)return this;if((ee=U[C])===void 0)return this;if(ee===J||ee.listener===J)--this._eventsCount==0?this._events=Object.create(null):(delete U[C],U.removeListener&&this.emit("removeListener",C,ee.listener||J));else if(typeof ee!="function"){for(u=-1,d=ee.length-1;d>=0;d--)if(ee[d]===J||ee[d].listener===J){l=ee[d].listener,u=d;break}if(u<0)return this;u===0?ee.shift():function(g,K){for(;K+1<g.length;K++)g[K]=g[K+1];g.pop()}(ee,u),ee.length===1&&(U[C]=ee[0]),U.removeListener!==void 0&&this.emit("removeListener",C,l||J)}return this},y.prototype.off=y.prototype.removeListener,y.prototype.removeAllListeners=function(C){var J,ee,U;if((ee=this._events)===void 0)return this;if(ee.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ee[C]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete ee[C]),this;if(arguments.length===0){var u,d=Object.keys(ee);for(U=0;U<d.length;++U)(u=d[U])!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(J=ee[C])=="function")this.removeListener(C,J);else if(J!==void 0)for(U=J.length-1;U>=0;U--)this.removeListener(C,J[U]);return this},y.prototype.listeners=function(C){return G(this,C,!0)},y.prototype.rawListeners=function(C){return G(this,C,!1)},y.listenerCount=function(C,J){return typeof C.listenerCount=="function"?C.listenerCount(J):I.call(C,J)},y.prototype.listenerCount=I,y.prototype.eventNames=function(){return this._eventsCount>0?V(this._events):[]}},function(ge,_e,x){x.d(_e,"b",function(){return L}),x.d(_e,"a",function(){return c});var V=x(2),T=x(6),L={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},c={NETWORK_EXCEPTION:V.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:V.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:V.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:V.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:T.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:T.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:T.a.CODEC_UNSUPPORTED}},function(ge,_e,x){x.d(_e,"d",function(){return V}),x.d(_e,"b",function(){return T}),x.d(_e,"a",function(){return L}),x.d(_e,"c",function(){return c});var V=function(y,a,h,f,A){this.dts=y,this.pts=a,this.duration=h,this.originalDts=f,this.isSyncPoint=A,this.fileposition=null},T=function(){function y(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return y.prototype.appendSyncPoint=function(a){a.isSyncPoint=!0,this.syncPoints.push(a)},y}(),L=function(){function y(){this._list=[]}return y.prototype.clear=function(){this._list=[]},y.prototype.appendArray=function(a){var h=this._list;a.length!==0&&(h.length>0&&a[0].originalDts<h[h.length-1].originalDts&&this.clear(),Array.prototype.push.apply(h,a))},y.prototype.getLastSyncPointBeforeDts=function(a){if(this._list.length==0)return null;var h=this._list,f=0,A=h.length-1,E=0,O=0,G=A;for(a<h[0].dts&&(f=0,O=G+1);O<=G;){if((E=O+Math.floor((G-O)/2))===A||a>=h[E].dts&&a<h[E+1].dts){f=E;break}h[E].dts<a?O=E+1:G=E-1}return this._list[f]},y}(),c=function(){function y(a){this._type=a,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(y.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),y.prototype.isEmpty=function(){return this._list.length===0},y.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},y.prototype._searchNearestSegmentBefore=function(a){var h=this._list;if(h.length===0)return-2;var f=h.length-1,A=0,E=0,O=f,G=0;if(a<h[0].originalBeginDts)return G=-1;for(;E<=O;){if((A=E+Math.floor((O-E)/2))===f||a>h[A].lastSample.originalDts&&a<h[A+1].originalBeginDts){G=A;break}h[A].originalBeginDts<a?E=A+1:O=A-1}return G},y.prototype._searchNearestSegmentAfter=function(a){return this._searchNearestSegmentBefore(a)+1},y.prototype.append=function(a){var h=this._list,f=a,A=this._lastAppendLocation,E=0;A!==-1&&A<h.length&&f.originalBeginDts>=h[A].lastSample.originalDts&&(A===h.length-1||A<h.length-1&&f.originalBeginDts<h[A+1].originalBeginDts)?E=A+1:h.length>0&&(E=this._searchNearestSegmentBefore(f.originalBeginDts)+1),this._lastAppendLocation=E,this._list.splice(E,0,f)},y.prototype.getLastSegmentBefore=function(a){var h=this._searchNearestSegmentBefore(a);return h>=0?this._list[h]:null},y.prototype.getLastSampleBefore=function(a){var h=this.getLastSegmentBefore(a);return h!=null?h.lastSample:null},y.prototype.getLastSyncPointBefore=function(a){for(var h=this._searchNearestSegmentBefore(a),f=this._list[h].syncPoints;f.length===0&&h>0;)h--,f=this._list[h].syncPoints;return f.length>0?f[f.length-1]:null},y}()},function(ge,_e,x){var V=function(){function T(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return T.prototype.isComplete=function(){var L=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,c=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&L&&c},T.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},T.prototype.getNearestKeyframe=function(L){if(this.keyframesIndex==null)return null;var c=this.keyframesIndex,y=this._search(c.times,L);return{index:y,milliseconds:c.times[y],fileposition:c.filepositions[y]}},T.prototype._search=function(L,c){var y=0,a=L.length-1,h=0,f=0,A=a;for(c<L[0]&&(y=0,f=A+1);f<=A;){if((h=f+Math.floor((A-f)/2))===a||c>=L[h]&&c<L[h+1]){y=h;break}L[h]<c?f=h+1:A=h-1}return y},T}();_e.a=V},function(ge,_e,x){var V,T=x(0),L=x(13),c=x(3),y=function(){function _(){}return _.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onPGSSubtitleData=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},_}(),a=function(){this.program_pmt_pid={}};(function(_){_[_.kMPEG1Audio=3]="kMPEG1Audio",_[_.kMPEG2Audio=4]="kMPEG2Audio",_[_.kPESPrivateData=6]="kPESPrivateData",_[_.kADTSAAC=15]="kADTSAAC",_[_.kLOASAAC=17]="kLOASAAC",_[_.kAC3=129]="kAC3",_[_.kEAC3=135]="kEAC3",_[_.kMetadata=21]="kMetadata",_[_.kSCTE35=134]="kSCTE35",_[_.kPGS=144]="kPGS",_[_.kH264=27]="kH264",_[_.kH265=36]="kH265"})(V||(V={}));var h,f=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,av1:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.pgs_pids={},this.pgs_langs={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},A=function(){},E=function(){},O=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(_){_[_.kUnspecified=0]="kUnspecified",_[_.kSliceNonIDR=1]="kSliceNonIDR",_[_.kSliceDPA=2]="kSliceDPA",_[_.kSliceDPB=3]="kSliceDPB",_[_.kSliceDPC=4]="kSliceDPC",_[_.kSliceIDR=5]="kSliceIDR",_[_.kSliceSEI=6]="kSliceSEI",_[_.kSliceSPS=7]="kSliceSPS",_[_.kSlicePPS=8]="kSlicePPS",_[_.kSliceAUD=9]="kSliceAUD",_[_.kEndOfSequence=10]="kEndOfSequence",_[_.kEndOfStream=11]="kEndOfStream",_[_.kFiller=12]="kFiller",_[_.kSPSExt=13]="kSPSExt",_[_.kReserved0=14]="kReserved0"})(h||(h={}));var G,I,z=function(){},q=function(_){var p=_.data.byteLength;this.type=_.type,this.data=new Uint8Array(4+p),new DataView(this.data.buffer).setUint32(0,p),this.data.set(_.data,4)},C=function(){function _(p){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=p,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return _.prototype.findNextStartCodeOffset=function(p){for(var s=p,n=this.data_;;){if(s+3>=n.byteLength)return this.eof_flag_=!0,n.byteLength;var m=n[s+0]<<24|n[s+1]<<16|n[s+2]<<8|n[s+3],M=n[s+0]<<16|n[s+1]<<8|n[s+2];if(m===1||M===1)return s;s++}},_.prototype.readNextNaluPayload=function(){for(var p=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_startcode_offset_,m=31&p[n+=(p[n]<<24|p[n+1]<<16|p[n+2]<<8|p[n+3])===1?4:3],M=(128&p[n])>>>7,S=this.findNextStartCodeOffset(n);if(this.current_startcode_offset_=S,!(m>=h.kReserved0)&&M===0){var D=p.subarray(n,S);(s=new z).type=m,s.data=D}}return s},_}(),J=function(){function _(p,s,n){var m=8+p.byteLength+1+2+s.byteLength,M=!1;p[3]!==66&&p[3]!==77&&p[3]!==88&&(M=!0,m+=4);var S=this.data=new Uint8Array(m);S[0]=1,S[1]=p[1],S[2]=p[2],S[3]=p[3],S[4]=255,S[5]=225;var D=p.byteLength;S[6]=D>>>8,S[7]=255&D;var j=8;S.set(p,8),S[j+=D]=1;var B=s.byteLength;S[j+1]=B>>>8,S[j+2]=255&B,S.set(s,j+3),j+=3+B,M&&(S[j]=252|n.chroma_format_idc,S[j+1]=248|n.bit_depth_luma-8,S[j+2]=248|n.bit_depth_chroma-8,S[j+3]=0,j+=4)}return _.prototype.getData=function(){return this.data},_}(),ee=x(23),U=x(8);(function(_){_[_.kNull=0]="kNull",_[_.kAACMain=1]="kAACMain",_[_.kAAC_LC=2]="kAAC_LC",_[_.kAAC_SSR=3]="kAAC_SSR",_[_.kAAC_LTP=4]="kAAC_LTP",_[_.kAAC_SBR=5]="kAAC_SBR",_[_.kAAC_Scalable=6]="kAAC_Scalable",_[_.kLayer1=32]="kLayer1",_[_.kLayer2=33]="kLayer2",_[_.kLayer3=34]="kLayer3"})(G||(G={})),function(_){_[_.k96000Hz=0]="k96000Hz",_[_.k88200Hz=1]="k88200Hz",_[_.k64000Hz=2]="k64000Hz",_[_.k48000Hz=3]="k48000Hz",_[_.k44100Hz=4]="k44100Hz",_[_.k32000Hz=5]="k32000Hz",_[_.k24000Hz=6]="k24000Hz",_[_.k22050Hz=7]="k22050Hz",_[_.k16000Hz=8]="k16000Hz",_[_.k12000Hz=9]="k12000Hz",_[_.k11025Hz=10]="k11025Hz",_[_.k8000Hz=11]="k8000Hz",_[_.k7350Hz=12]="k7350Hz"}(I||(I={}));var u,d,l=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],g=(u=function(_,p){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var m in n)Object.prototype.hasOwnProperty.call(n,m)&&(s[m]=n[m])})(_,p)},function(_,p){if(typeof p!="function"&&p!==null)throw new TypeError("Class extends value "+String(p)+" is not a constructor or null");function s(){this.constructor=_}u(_,p),_.prototype=p===null?Object.create(p):(s.prototype=p.prototype,new s)}),K=function(){},$=function(_){function p(){return _!==null&&_.apply(this,arguments)||this}return g(p,_),p}(K),ae=function(){function _(p){this.TAG="AACADTSParser",this.data_=p,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return _.prototype.findNextSyncwordOffset=function(p){for(var s=p,n=this.data_;;){if(s+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<8|n[s+1])>>>4===4095)return s;s++}},_.prototype.readNextAACFrame=function(){for(var p=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_syncword_offset_,m=(8&p[n+1])>>>3,M=(6&p[n+1])>>>1,S=1&p[n+1],D=(192&p[n+2])>>>6,j=(60&p[n+2])>>>2,B=(1&p[n+2])<<2|(192&p[n+3])>>>6,Y=(3&p[n+3])<<11|p[n+4]<<3|(224&p[n+5])>>>5;if(p[n+6],n+Y>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var Q=S===1?7:9,X=Y-Q;n+=Q;var Z=this.findNextSyncwordOffset(n+X);if(this.current_syncword_offset_=Z,(m===0||m===1)&&M===0){var le=p.subarray(n,n+X);(s=new K).audio_object_type=D+1,s.sampling_freq_index=j,s.sampling_frequency=l[j],s.channel_config=B,s.data=le}}return s},_.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},_.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},_}(),de=function(){function _(p){this.TAG="AACLOASParser",this.data_=p,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return _.prototype.findNextSyncwordOffset=function(p){for(var s=p,n=this.data_;;){if(s+1>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<3|n[s+1]>>>5)===695)return s;s++}},_.prototype.getLATMValue=function(p){for(var s=p.readBits(2),n=0,m=0;m<=s;m++)n<<=8,n|=p.readByte();return n},_.prototype.readNextAACFrame=function(p){for(var s=this.data_,n=null;n==null&&!this.eof_flag_;){var m=this.current_syncword_offset_,M=(31&s[m+1])<<8|s[m+2];if(m+3+M>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var S=new U.a(s.subarray(m+3,m+3+M)),D=null;if(S.readBool()){if(p==null){T.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(m+3+M),S.destroy();continue}D=p}else{var j=S.readBool();if(j&&S.readBool()){T.a.e(this.TAG,"audioMuxVersionA is Not Supported"),S.destroy();break}if(j&&this.getLATMValue(S),!S.readBool()){T.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),S.destroy();break}if(S.readBits(6)!==0){T.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),S.destroy();break}if(S.readBits(4)!==0){T.a.e(this.TAG,"more than 2 numProgram Not Supported"),S.destroy();break}if(S.readBits(3)!==0){T.a.e(this.TAG,"more than 2 numLayer Not Supported"),S.destroy();break}var B=j?this.getLATMValue(S):0,Y=S.readBits(5);B-=5;var Q=S.readBits(4);B-=4;var X=S.readBits(4);B-=4,S.readBits(3),(B-=3)>0&&S.readBits(B);var Z=S.readBits(3);if(Z!==0){T.a.e(this.TAG,"frameLengthType = ".concat(Z,". Only frameLengthType = 0 Supported")),S.destroy();break}S.readByte();var le=S.readBool();if(le)if(j)this.getLATMValue(S);else{for(var he=0;;){he<<=8;var be=S.readBool();if(he+=S.readByte(),!be)break}console.log(he)}S.readBool()&&S.readByte(),(D=new $).audio_object_type=Y,D.sampling_freq_index=Q,D.sampling_frequency=l[D.sampling_freq_index],D.channel_config=X,D.other_data_present=le}for(var Te=0;;){var Ae=S.readByte();if(Te+=Ae,Ae!==255)break}for(var pe=new Uint8Array(Te),De=0;De<Te;De++)pe[De]=S.readByte();(n=new $).audio_object_type=D.audio_object_type,n.sampling_freq_index=D.sampling_freq_index,n.sampling_frequency=l[D.sampling_freq_index],n.channel_config=D.channel_config,n.other_data_present=D.other_data_present,n.data=pe,this.current_syncword_offset_=this.findNextSyncwordOffset(m+3+M)}return n},_.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},_.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},_}(),H=function(_){var p=null,s=_.audio_object_type,n=_.audio_object_type,m=_.sampling_freq_index,M=_.channel_config,S=0,D=navigator.userAgent.toLowerCase();D.indexOf("firefox")!==-1?m>=6?(n=5,p=new Array(4),S=m-3):(n=2,p=new Array(2),S=m):D.indexOf("android")!==-1?(n=2,p=new Array(2),S=m):(n=5,S=m,p=new Array(4),m>=6?S=m-3:M===1&&(n=2,p=new Array(2),S=m)),p[0]=n<<3,p[0]|=(15&m)>>>1,p[1]=(15&m)<<7,p[1]|=(15&M)<<3,n===5&&(p[1]|=(15&S)>>>1,p[2]=(1&S)<<7,p[2]|=8,p[3]=0),this.config=p,this.sampling_rate=l[m],this.channel_count=M,this.codec_mimetype="mp4a.40."+n,this.original_codec_mimetype="mp4a.40."+s},ne=function(){},re=function(){};(function(_){_[_.kSpliceNull=0]="kSpliceNull",_[_.kSpliceSchedule=4]="kSpliceSchedule",_[_.kSpliceInsert=5]="kSpliceInsert",_[_.kTimeSignal=6]="kTimeSignal",_[_.kBandwidthReservation=7]="kBandwidthReservation",_[_.kPrivateCommand=255]="kPrivateCommand"})(d||(d={}));var R,t=function(_){var p=_.readBool();return p?(_.readBits(6),{time_specified_flag:p,pts_time:4*_.readBits(31)+_.readBits(2)}):(_.readBits(7),{time_specified_flag:p})},e=function(_){var p=_.readBool();return _.readBits(6),{auto_return:p,duration:4*_.readBits(31)+_.readBits(2)}},i=function(_,p){var s=p.readBits(8);return _?{component_tag:s}:{component_tag:s,splice_time:t(p)}},o=function(_){return{component_tag:_.readBits(8),utc_splice_time:_.readBits(32)}},r=function(_){var p=_.readBits(32),s=_.readBool();_.readBits(7);var n={splice_event_id:p,splice_event_cancel_indicator:s};if(s)return n;if(n.out_of_network_indicator=_.readBool(),n.program_splice_flag=_.readBool(),n.duration_flag=_.readBool(),_.readBits(5),n.program_splice_flag)n.utc_splice_time=_.readBits(32);else{n.component_count=_.readBits(8),n.components=[];for(var m=0;m<n.component_count;m++)n.components.push(o(_))}return n.duration_flag&&(n.break_duration=e(_)),n.unique_program_id=_.readBits(16),n.avail_num=_.readBits(8),n.avails_expected=_.readBits(8),n},v=function(_,p,s,n){return{descriptor_tag:_,descriptor_length:p,identifier:s,provider_avail_id:n.readBits(32)}},k=function(_,p,s,n){var m=n.readBits(8),M=n.readBits(3);n.readBits(5);for(var S="",D=0;D<M;D++)S+=String.fromCharCode(n.readBits(8));return{descriptor_tag:_,descriptor_length:p,identifier:s,preroll:m,dtmf_count:M,DTMF_char:S}},b=function(_){var p=_.readBits(8);return _.readBits(7),{component_tag:p,pts_offset:4*_.readBits(31)+_.readBits(2)}},w=function(_,p,s,n){var m=n.readBits(32),M=n.readBool();n.readBits(7);var S={descriptor_tag:_,descriptor_length:p,identifier:s,segmentation_event_id:m,segmentation_event_cancel_indicator:M};if(M)return S;if(S.program_segmentation_flag=n.readBool(),S.segmentation_duration_flag=n.readBool(),S.delivery_not_restricted_flag=n.readBool(),S.delivery_not_restricted_flag?n.readBits(5):(S.web_delivery_allowed_flag=n.readBool(),S.no_regional_blackout_flag=n.readBool(),S.archive_allowed_flag=n.readBool(),S.device_restrictions=n.readBits(2)),!S.program_segmentation_flag){S.component_count=n.readBits(8),S.components=[];for(var D=0;D<S.component_count;D++)S.components.push(b(n))}S.segmentation_duration_flag&&(S.segmentation_duration=n.readBits(40)),S.segmentation_upid_type=n.readBits(8),S.segmentation_upid_length=n.readBits(8);var j=new Uint8Array(S.segmentation_upid_length);for(D=0;D<S.segmentation_upid_length;D++)j[D]=n.readBits(8);return S.segmentation_upid=j.buffer,S.segmentation_type_id=n.readBits(8),S.segment_num=n.readBits(8),S.segments_expected=n.readBits(8),S.segmentation_type_id!==52&&S.segmentation_type_id!==54&&S.segmentation_type_id!==56&&S.segmentation_type_id!==58||(S.sub_segment_num=n.readBits(8),S.sub_segments_expected=n.readBits(8)),S},N=function(_,p,s,n){return{descriptor_tag:_,descriptor_length:p,identifier:s,TAI_seconds:n.readBits(48),TAI_ns:n.readBits(32),UTC_offset:n.readBits(16)}},F=function(_){return{component_tag:_.readBits(8),ISO_code:String.fromCharCode(_.readBits(8),_.readBits(8),_.readBits(8)),Bit_Stream_Mode:_.readBits(3),Num_Channels:_.readBits(4),Full_Srvc_Audio:_.readBool()}},P=function(_,p,s,n){for(var m=n.readBits(4),M=[],S=0;S<m;S++)M.push(F(n));return{descriptor_tag:_,descriptor_length:p,identifier:s,audio_count:m,components:M}},W=function(_){var p=new U.a(_),s=p.readBits(8),n=p.readBool(),m=p.readBool();p.readBits(2);var M=p.readBits(12),S=p.readBits(8),D=p.readBool(),j=p.readBits(6),B=4*p.readBits(31)+p.readBits(2),Y=p.readBits(8),Q=p.readBits(12),X=p.readBits(12),Z=p.readBits(8),le=null;Z===d.kSpliceNull?le={}:Z===d.kSpliceSchedule?le=function(Le){for(var Ne=Le.readBits(8),Ge=[],Ee=0;Ee<Ne;Ee++)Ge.push(r(Le));return{splice_count:Ne,events:Ge}}(p):Z===d.kSpliceInsert?le=function(Le){var Ne=Le.readBits(32),Ge=Le.readBool();Le.readBits(7);var Ee={splice_event_id:Ne,splice_event_cancel_indicator:Ge};if(Ge)return Ee;if(Ee.out_of_network_indicator=Le.readBool(),Ee.program_splice_flag=Le.readBool(),Ee.duration_flag=Le.readBool(),Ee.splice_immediate_flag=Le.readBool(),Le.readBits(4),Ee.program_splice_flag&&!Ee.splice_immediate_flag&&(Ee.splice_time=t(Le)),!Ee.program_splice_flag){Ee.component_count=Le.readBits(8),Ee.components=[];for(var Fe=0;Fe<Ee.component_count;Fe++)Ee.components.push(i(Ee.splice_immediate_flag,Le))}return Ee.duration_flag&&(Ee.break_duration=e(Le)),Ee.unique_program_id=Le.readBits(16),Ee.avail_num=Le.readBits(8),Ee.avails_expected=Le.readBits(8),Ee}(p):Z===d.kTimeSignal?le=function(Le){return{splice_time:t(Le)}}(p):Z===d.kBandwidthReservation?le={}:Z===d.kPrivateCommand?le=function(Le,Ne){for(var Ge=String.fromCharCode(Ne.readBits(8),Ne.readBits(8),Ne.readBits(8),Ne.readBits(8)),Ee=new Uint8Array(Le-4),Fe=0;Fe<Le-4;Fe++)Ee[Fe]=Ne.readBits(8);return{identifier:Ge,private_data:Ee.buffer}}(X,p):p.readBits(8*X);for(var he=[],be=p.readBits(16),Te=0;Te<be;){var Ae=p.readBits(8),pe=p.readBits(8),De=String.fromCharCode(p.readBits(8),p.readBits(8),p.readBits(8),p.readBits(8));Ae===0?he.push(v(Ae,pe,De,p)):Ae===1?he.push(k(Ae,pe,De,p)):Ae===2?he.push(w(Ae,pe,De,p)):Ae===3?he.push(N(Ae,pe,De,p)):Ae===4?he.push(P(Ae,pe,De,p)):p.readBits(8*(pe-4)),Te+=2+pe}var xe={table_id:s,section_syntax_indicator:n,private_indicator:m,section_length:M,protocol_version:S,encrypted_packet:D,encryption_algorithm:j,pts_adjustment:B,cw_index:Y,tier:Q,splice_command_length:X,splice_command_type:Z,splice_command:le,descriptor_loop_length:be,splice_descriptors:he,E_CRC32:D?p.readBits(32):void 0,CRC32:p.readBits(32)};if(Z===d.kSpliceInsert){var Oe=le;if(Oe.splice_event_cancel_indicator)return{splice_command_type:Z,detail:xe,data:_};if(Oe.program_splice_flag&&!Oe.splice_immediate_flag){var Ie=Oe.duration_flag?Oe.break_duration.auto_return:void 0,ze=Oe.duration_flag?Oe.break_duration.duration/90:void 0;return Oe.splice_time.time_specified_flag?{splice_command_type:Z,pts:(B+Oe.splice_time.pts_time)%Math.pow(2,33),auto_return:Ie,duraiton:ze,detail:xe,data:_}:{splice_command_type:Z,auto_return:Ie,duraiton:ze,detail:xe,data:_}}return{splice_command_type:Z,auto_return:Ie=Oe.duration_flag?Oe.break_duration.auto_return:void 0,duraiton:ze=Oe.duration_flag?Oe.break_duration.duration/90:void 0,detail:xe,data:_}}if(Z===d.kTimeSignal){var He=le;return He.splice_time.time_specified_flag?{splice_command_type:Z,pts:(B+He.splice_time.pts_time)%Math.pow(2,33),detail:xe,data:_}:{splice_command_type:Z,detail:xe,data:_}}return{splice_command_type:Z,detail:xe,data:_}};(function(_){_[_.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",_[_.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",_[_.kSliceCRA_NUT=21]="kSliceCRA_NUT",_[_.kSliceVPS=32]="kSliceVPS",_[_.kSliceSPS=33]="kSliceSPS",_[_.kSlicePPS=34]="kSlicePPS",_[_.kSliceAUD=35]="kSliceAUD"})(R||(R={}));var te=function(){},ie=function(_){var p=_.data.byteLength;this.type=_.type,this.data=new Uint8Array(4+p),new DataView(this.data.buffer).setUint32(0,p),this.data.set(_.data,4)},ce=function(){function _(p){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=p,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return _.prototype.findNextStartCodeOffset=function(p){for(var s=p,n=this.data_;;){if(s+3>=n.byteLength)return this.eof_flag_=!0,n.byteLength;var m=n[s+0]<<24|n[s+1]<<16|n[s+2]<<8|n[s+3],M=n[s+0]<<16|n[s+1]<<8|n[s+2];if(m===1||M===1)return s;s++}},_.prototype.readNextNaluPayload=function(){for(var p=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_startcode_offset_,m=p[n+=(p[n]<<24|p[n+1]<<16|p[n+2]<<8|p[n+3])===1?4:3]>>1&63,M=(128&p[n])>>>7,S=this.findNextStartCodeOffset(n);if(this.current_startcode_offset_=S,M===0){var D=p.subarray(n,S);(s=new te).type=m,s.data=D}}return s},_}(),se=function(){function _(p,s,n,m){var M=23+(5+p.byteLength)+(5+s.byteLength)+(5+n.byteLength),S=this.data=new Uint8Array(M);S[0]=1,S[1]=(3&m.general_profile_space)<<6|(m.general_tier_flag?1:0)<<5|31&m.general_profile_idc,S[2]=m.general_profile_compatibility_flags_1,S[3]=m.general_profile_compatibility_flags_2,S[4]=m.general_profile_compatibility_flags_3,S[5]=m.general_profile_compatibility_flags_4,S[6]=m.general_constraint_indicator_flags_1,S[7]=m.general_constraint_indicator_flags_2,S[8]=m.general_constraint_indicator_flags_3,S[9]=m.general_constraint_indicator_flags_4,S[10]=m.general_constraint_indicator_flags_5,S[11]=m.general_constraint_indicator_flags_6,S[12]=m.general_level_idc,S[13]=240|(3840&m.min_spatial_segmentation_idc)>>8,S[14]=255&m.min_spatial_segmentation_idc,S[15]=252|3&m.parallelismType,S[16]=252|3&m.chroma_format_idc,S[17]=248|7&m.bit_depth_luma_minus8,S[18]=248|7&m.bit_depth_chroma_minus8,S[19]=0,S[20]=0,S[21]=(3&m.constant_frame_rate)<<6|(7&m.num_temporal_layers)<<3|(m.temporal_id_nested?1:0)<<2|3,S[22]=3,S[23]=128|R.kSliceVPS,S[24]=0,S[25]=1,S[26]=(65280&p.byteLength)>>8,S[27]=(255&p.byteLength)>>0,S.set(p,28),S[23+(5+p.byteLength)+0]=128|R.kSliceSPS,S[23+(5+p.byteLength)+1]=0,S[23+(5+p.byteLength)+2]=1,S[23+(5+p.byteLength)+3]=(65280&s.byteLength)>>8,S[23+(5+p.byteLength)+4]=(255&s.byteLength)>>0,S.set(s,23+(5+p.byteLength)+5),S[23+(5+p.byteLength+5+s.byteLength)+0]=128|R.kSlicePPS,S[23+(5+p.byteLength+5+s.byteLength)+1]=0,S[23+(5+p.byteLength+5+s.byteLength)+2]=1,S[23+(5+p.byteLength+5+s.byteLength)+3]=(65280&n.byteLength)>>8,S[23+(5+p.byteLength+5+s.byteLength)+4]=(255&n.byteLength)>>0,S.set(n,23+(5+p.byteLength+5+s.byteLength)+5)}return _.prototype.getData=function(){return this.data},_}(),me=x(15),oe=function(){},ue=function(){},ye=function(){},Re=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],fe=function(){function _(p){this.TAG="AC3Parser",this.data_=p,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return _.prototype.findNextSyncwordOffset=function(p){for(var s=p,n=this.data_;;){if(s+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<8|n[s+1]<<0)===2935)return s;s++}},_.prototype.readNextAC3Frame=function(){for(var p=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_syncword_offset_,m=p[n+4]>>6,M=[48e3,44200,33e3][m],S=63&p[n+4],D=2*Re[m][S];if(isNaN(D)||n+D>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var j=this.findNextSyncwordOffset(n+D);this.current_syncword_offset_=j;var B=p[n+5]>>3,Y=7&p[n+5],Q=p[n+6]>>5,X=0;1&Q&&Q!==1&&(X+=2),4&Q&&(X+=2),Q===2&&(X+=2);var Z=(p[n+6]<<8|p[n+7]<<0)>>12-X&1,le=[2,1,2,3,3,4,4,5][Q]+Z;(s=new ye).sampling_frequency=M,s.channel_count=le,s.channel_mode=Q,s.bit_stream_identification=B,s.low_frequency_effects_channel_on=Z,s.bit_stream_mode=Y,s.frame_size_code=S,s.data=p.subarray(n,n+D)}return s},_.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},_.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},_}(),ve=function(_){var p;p=[_.sampling_rate_code<<6|_.bit_stream_identification<<1|_.bit_stream_mode>>2,(3&_.bit_stream_mode)<<6|_.channel_mode<<3|_.low_frequency_effects_channel_on<<2|_.frame_size_code>>4,_.frame_size_code<<4&224],this.config=p,this.sampling_rate=_.sampling_frequency,this.bit_stream_identification=_.bit_stream_identification,this.bit_stream_mode=_.bit_stream_mode,this.low_frequency_effects_channel_on=_.low_frequency_effects_channel_on,this.channel_count=_.channel_count,this.channel_mode=_.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},Se=function(){},we=function(){function _(p){this.TAG="EAC3Parser",this.data_=p,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return _.prototype.findNextSyncwordOffset=function(p){for(var s=p,n=this.data_;;){if(s+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<8|n[s+1]<<0)===2935)return s;s++}},_.prototype.readNextEAC3Frame=function(){for(var p=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_syncword_offset_,m=new U.a(p.subarray(n+2)),M=(m.readBits(2),m.readBits(3),m.readBits(11)+1<<1),S=m.readBits(2),D=null,j=null;S===3?(D=[24e3,22060,16e3][S=m.readBits(2)],j=3):(D=[48e3,44100,32e3][S],j=m.readBits(2));var B=m.readBits(3),Y=m.readBits(1),Q=m.readBits(5);if(n+M>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var X=this.findNextSyncwordOffset(n+M);this.current_syncword_offset_=X;var Z=[2,1,2,3,3,4,4,5][B]+Y;m.destroy(),(s=new Se).sampling_frequency=D,s.channel_count=Z,s.channel_mode=B,s.bit_stream_identification=Q,s.low_frequency_effects_channel_on=Y,s.frame_size=M,s.num_blks=[1,2,3,6][j],s.data=p.subarray(n,n+M)}return s},_.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},_.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},_}(),Pe=function(_){var p,s=Math.floor(_.frame_size*_.sampling_frequency/(16*_.num_blks));p=[255&s,248&s,_.sampling_rate_code<<6|_.bit_stream_identification<<1|0,0|_.channel_mode<<1|_.low_frequency_effects_channel_on<<0,0],this.config=p,this.sampling_rate=_.sampling_frequency,this.bit_stream_identification=_.bit_stream_identification,this.num_blks=_.num_blks,this.low_frequency_effects_channel_on=_.low_frequency_effects_channel_on,this.channel_count=_.channel_count,this.channel_mode=_.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},Be=function(){},Ue=function(){function _(p){this.TAG="AV1OBUInMpegTsParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=p,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&T.a.e(this.TAG,"Could not find AV1 startcode until payload end!")}return _._ebsp2rbsp=function(p){for(var s=p,n=s.byteLength,m=new Uint8Array(n),M=0,S=0;S<n;S++)S>=2&&s[S]===3&&s[S-1]===0&&s[S-2]===0||(m[M]=s[S],M++);return new Uint8Array(m.buffer,0,M)},_.prototype.findNextStartCodeOffset=function(p){for(var s=p,n=this.data_;;){if(s+2>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<16|n[s+1]<<8|n[s+2])===1)return s;s++}},_.prototype.readNextOBUPayload=function(){for(var p=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_startcode_offset_+3,m=this.findNextStartCodeOffset(n);this.current_startcode_offset_=m,s=_._ebsp2rbsp(p.subarray(n,m))}return s},_}(),Ve=x(16),ke=function(){},Me=function(){var _=function(p,s){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,m){n.__proto__=m}||function(n,m){for(var M in m)Object.prototype.hasOwnProperty.call(m,M)&&(n[M]=m[M])})(p,s)};return function(p,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function n(){this.constructor=p}_(p,s),p.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}}(),Ce=function(){return(Ce=Object.assign||function(_){for(var p,s=1,n=arguments.length;s<n;s++)for(var m in p=arguments[s])Object.prototype.hasOwnProperty.call(p,m)&&(_[m]=p[m]);return _}).apply(this,arguments)},je=function(_){function p(s,n){var m=_.call(this)||this;return m.TAG="TSDemuxer",m.first_parse_=!0,m.media_info_=new L.a,m.timescale_=90,m.duration_=0,m.current_pmt_pid_=-1,m.program_pmt_map_={},m.pes_slice_queues_={},m.section_slice_queues_={},m.video_metadata_={vps:void 0,sps:void 0,pps:void 0,av1c:void 0,details:void 0},m.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},m.last_pcr_base_=NaN,m.timestamp_offset_=0,m.audio_last_sample_pts_=void 0,m.aac_last_incomplete_data_=null,m.has_video_=!1,m.has_audio_=!1,m.video_init_segment_dispatched_=!1,m.audio_init_segment_dispatched_=!1,m.video_metadata_changed_=!1,m.loas_previous_frame=null,m.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},m.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},m.preferred_secondary_audio=!1,m.ts_packet_size_=s.ts_packet_size,m.sync_offset_=s.sync_offset,m.config_=n,m}return Me(p,_),p.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,_.prototype.destroy.call(this)},p.probe=function(s){var n=new Uint8Array(s),m=-1,M=188;if(n.byteLength<=3*M)return{needMoreData:!0};for(;m===-1;){for(var S=Math.min(1e3,n.byteLength-3*M),D=0;D<S;){if(n[D]===71&&n[D+M]===71&&n[D+2*M]===71){m=D;break}D++}if(m===-1)if(M===188)M=192;else{if(M!==192)break;M=204}}return m===-1?{match:!1}:(M===192&&m>=4?(T.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),m-=4):M===204&&T.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:M,sync_offset:m})},p.prototype.bindDataSource=function(s){return s.onDataArrival=this.parseChunks.bind(this),this},p.prototype.resetMediaInfo=function(){this.media_info_=new L.a},p.prototype.parseChunks=function(s,n){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new c.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var m=0;for(this.first_parse_&&(this.first_parse_=!1,m=this.sync_offset_);m+this.ts_packet_size_<=s.byteLength;){var M=n+m;this.ts_packet_size_===192&&(m+=4);var S=new Uint8Array(s,m,188),D=S[0];if(D!==71){T.a.e(this.TAG,"sync_byte = ".concat(D,", not 0x47"));break}var j=(64&S[1])>>>6,B=(S[1],(31&S[1])<<8|S[2]),Y=(48&S[3])>>>4,Q=15&S[3],X=!(!this.pmt_||this.pmt_.pcr_pid!==B),Z={},le=4;if(Y==2||Y==3){var he=S[4];if(he>0&&(X||Y==3)&&(Z.discontinuity_indicator=(128&S[5])>>>7,Z.random_access_indicator=(64&S[5])>>>6,Z.elementary_stream_priority_indicator=(32&S[5])>>>5,(16&S[5])>>>4)){var be=300*this.getPcrBase(S)+((1&S[10])<<8|S[11]);this.last_pcr_=be}if(Y==2||5+he===188){m+=188,this.ts_packet_size_===204&&(m+=16);continue}le=5+he}if(Y==1||Y==3){if(B===0||B===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[B]===V.kSCTE35){var Te=188-le;this.handleSectionSlice(s,m+le,Te,{pid:B,file_position:M,payload_unit_start_indicator:j,continuity_conunter:Q,random_access_indicator:Z.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[B]!=null){Te=188-le;var Ae=this.pmt_.pid_stream_type[B];B!==this.pmt_.common_pids.h264&&B!==this.pmt_.common_pids.h265&&B!==this.pmt_.common_pids.av1&&B!==this.pmt_.common_pids.adts_aac&&B!==this.pmt_.common_pids.loas_aac&&B!==this.pmt_.common_pids.ac3&&B!==this.pmt_.common_pids.eac3&&B!==this.pmt_.common_pids.opus&&B!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[B]!==!0&&this.pmt_.timed_id3_pids[B]!==!0&&this.pmt_.pgs_pids[B]!==!0&&this.pmt_.synchronous_klv_pids[B]!==!0&&this.pmt_.asynchronous_klv_pids[B]!==!0||this.handlePESSlice(s,m+le,Te,{pid:B,stream_type:Ae,file_position:M,payload_unit_start_indicator:j,continuity_conunter:Q,random_access_indicator:Z.random_access_indicator})}}m+=188,this.ts_packet_size_===204&&(m+=16)}return this.dispatchAudioVideoMediaSegment(),m},p.prototype.handleSectionSlice=function(s,n,m,M){var S=new Uint8Array(s,n,m),D=this.section_slice_queues_[M.pid];if(M.payload_unit_start_indicator){var j=S[0];if(D!=null&&D.total_length!==0){var B=new Uint8Array(s,n+1,Math.min(m,j));D.slices.push(B),D.total_length+=B.byteLength,D.total_length===D.expected_length?this.emitSectionSlices(D,M):this.clearSlices(D,M)}for(var Y=1+j;Y<S.byteLength&&S[Y+0]!==255;){var Q=(15&S[Y+1])<<8|S[Y+2];this.section_slice_queues_[M.pid]=new O,(D=this.section_slice_queues_[M.pid]).expected_length=Q+3,D.file_position=M.file_position,D.random_access_indicator=M.random_access_indicator,B=new Uint8Array(s,n+Y,Math.min(m-Y,D.expected_length-D.total_length)),D.slices.push(B),D.total_length+=B.byteLength,D.total_length===D.expected_length?this.emitSectionSlices(D,M):D.total_length>=D.expected_length&&this.clearSlices(D,M),Y+=B.byteLength}}else D!=null&&D.total_length!==0&&(B=new Uint8Array(s,n,Math.min(m,D.expected_length-D.total_length)),D.slices.push(B),D.total_length+=B.byteLength,D.total_length===D.expected_length?this.emitSectionSlices(D,M):D.total_length>=D.expected_length&&this.clearSlices(D,M))},p.prototype.handlePESSlice=function(s,n,m,M){var S=new Uint8Array(s,n,m),D=S[0]<<16|S[1]<<8|S[2],j=(S[3],S[4]<<8|S[5]);if(M.payload_unit_start_indicator){if(D!==1)return void T.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(D));var B=this.pes_slice_queues_[M.pid];B&&(B.expected_length===0||B.expected_length===B.total_length?this.emitPESSlices(B,M):this.clearSlices(B,M)),this.pes_slice_queues_[M.pid]=new O,this.pes_slice_queues_[M.pid].file_position=M.file_position,this.pes_slice_queues_[M.pid].random_access_indicator=M.random_access_indicator}if(this.pes_slice_queues_[M.pid]!=null){var Y=this.pes_slice_queues_[M.pid];Y.slices.push(S),M.payload_unit_start_indicator&&(Y.expected_length=j===0?0:j+6),Y.total_length+=S.byteLength,Y.expected_length>0&&Y.expected_length===Y.total_length?this.emitPESSlices(Y,M):Y.expected_length>0&&Y.expected_length<Y.total_length&&this.clearSlices(Y,M)}},p.prototype.emitSectionSlices=function(s,n){for(var m=new Uint8Array(s.total_length),M=0,S=0;M<s.slices.length;M++){var D=s.slices[M];m.set(D,S),S+=D.byteLength}s.slices=[],s.expected_length=-1,s.total_length=0;var j=new E;j.pid=n.pid,j.data=m,j.file_position=s.file_position,j.random_access_indicator=s.random_access_indicator,this.parseSection(j)},p.prototype.emitPESSlices=function(s,n){for(var m=new Uint8Array(s.total_length),M=0,S=0;M<s.slices.length;M++){var D=s.slices[M];m.set(D,S),S+=D.byteLength}s.slices=[],s.expected_length=-1,s.total_length=0;var j=new A;j.pid=n.pid,j.data=m,j.stream_type=n.stream_type,j.file_position=s.file_position,j.random_access_indicator=s.random_access_indicator,this.parsePES(j)},p.prototype.clearSlices=function(s,n){s.slices=[],s.expected_length=-1,s.total_length=0},p.prototype.parseSection=function(s){var n=s.data,m=s.pid;m===0?this.parsePAT(n):m===this.current_pmt_pid_?this.parsePMT(n):this.pmt_!=null&&this.pmt_.scte_35_pids[m]&&this.parseSCTE35(n)},p.prototype.parsePES=function(s){var n=s.data,m=n[0]<<16|n[1]<<8|n[2],M=n[3],S=n[4]<<8|n[5];if(m===1)if(M!==188&&M!==190&&M!==191&&M!==240&&M!==241&&M!==255&&M!==242&&M!==248){n[6];var D=(192&n[7])>>>6,j=n[8],B=void 0,Y=void 0;D!==2&&D!==3||(B=this.getTimestamp(n,9),Y=D===3?this.getTimestamp(n,14):B);var Q=9+j,X=void 0;if(S!==0){if(S<3+j)return void T.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");X=S-3-j}else X=n.byteLength-Q;var Z=n.subarray(Q,Q+X);switch(s.stream_type){case V.kMPEG1Audio:case V.kMPEG2Audio:this.parseMP3Payload(Z,B);break;case V.kPESPrivateData:this.pmt_.common_pids.av1===s.pid?this.parseAV1Payload(Z,B,Y,s.file_position,s.random_access_indicator):this.pmt_.common_pids.opus===s.pid?this.parseOpusPayload(Z,B):this.pmt_.common_pids.ac3===s.pid?this.parseAC3Payload(Z,B):this.pmt_.common_pids.eac3===s.pid?this.parseEAC3Payload(Z,B):this.pmt_.asynchronous_klv_pids[s.pid]?this.parseAsynchronousKLVMetadataPayload(Z,s.pid,M):this.pmt_.smpte2038_pids[s.pid]?this.parseSMPTE2038MetadataPayload(Z,B,Y,s.pid,M):this.parsePESPrivateDataPayload(Z,B,Y,s.pid,M);break;case V.kADTSAAC:this.parseADTSAACPayload(Z,B);break;case V.kLOASAAC:this.parseLOASAACPayload(Z,B);break;case V.kAC3:this.parseAC3Payload(Z,B);break;case V.kEAC3:this.parseEAC3Payload(Z,B);break;case V.kMetadata:this.pmt_.timed_id3_pids[s.pid]?this.parseTimedID3MetadataPayload(Z,B,Y,s.pid,M):this.pmt_.synchronous_klv_pids[s.pid]&&this.parseSynchronousKLVMetadataPayload(Z,B,Y,s.pid,M);break;case V.kPGS:this.parsePGSPayload(Z,B,Y,s.pid,M,this.pmt_.pgs_langs[s.pid]);break;case V.kH264:this.parseH264Payload(Z,B,Y,s.file_position,s.random_access_indicator);break;case V.kH265:this.parseH265Payload(Z,B,Y,s.file_position,s.random_access_indicator)}}else(M===188||M===191||M===240||M===241||M===255||M===242||M===248)&&s.stream_type===V.kPESPrivateData&&(Q=6,X=void 0,X=S!==0?S:n.byteLength-Q,Z=n.subarray(Q,Q+X),this.parsePESPrivateDataPayload(Z,void 0,void 0,s.pid,M));else T.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(m))},p.prototype.parsePAT=function(s){var n=s[0];if(n===0){var m=(15&s[1])<<8|s[2],M=(s[3],s[4],(62&s[5])>>>1),S=1&s[5],D=s[6],j=(s[7],null);if(S===1&&D===0)(j=new a).version_number=M;else if((j=this.pat_)==null)return;for(var B=m-5-4,Y=-1,Q=-1,X=8;X<8+B;X+=4){var Z=s[X]<<8|s[X+1],le=(31&s[X+2])<<8|s[X+3];Z===0?j.network_pid=le:(j.program_pmt_pid[Z]=le,Y===-1&&(Y=Z),Q===-1&&(Q=le))}S===1&&D===0&&(this.pat_==null&&T.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(j))),this.pat_=j,this.current_program_=Y,this.current_pmt_pid_=Q)}else T.a.e(this.TAG,"parsePAT: table_id ".concat(n," is not corresponded to PAT!"))},p.prototype.parsePMT=function(s){var n=s[0];if(n===2){var m=(15&s[1])<<8|s[2],M=s[3]<<8|s[4],S=(62&s[5])>>>1,D=1&s[5],j=s[6],B=(s[7],null);if(D===1&&j===0)(B=new f).program_number=M,B.version_number=S,this.program_pmt_map_[M]=B;else if((B=this.program_pmt_map_[M])==null)return;B.pcr_pid=(31&s[8])<<8|s[9];for(var Y=(15&s[10])<<8|s[11],Q=12+Y,X=m-9-Y-4,Z=Q;Z<Q+X;){var le=s[Z],he=(31&s[Z+1])<<8|s[Z+2],be=(15&s[Z+3])<<8|s[Z+4];B.pid_stream_type[he]=le;var Te=B.common_pids.h264||B.common_pids.h265,Ae=B.common_pids.adts_aac||B.common_pids.loas_aac||B.common_pids.ac3||B.common_pids.eac3||B.common_pids.opus||B.common_pids.mp3;if(le!==V.kH264||Te)if(le!==V.kH265||Te)if(le!==V.kADTSAAC||Ae&&!this.preferred_secondary_audio)if(le!==V.kLOASAAC||Ae&&!this.preferred_secondary_audio)if(le!==V.kAC3||Ae&&!this.preferred_secondary_audio)if(le!==V.kEAC3||Ae&&!this.preferred_secondary_audio)if(le!==V.kMPEG1Audio&&le!==V.kMPEG2Audio||Ae&&!this.preferred_secondary_audio){if(le===V.kPESPrivateData){if(B.pes_private_data_pids[he]=!0,be>0){for(var pe=Z+5;pe<Z+5+be;){var De=s[pe+0],xe=s[pe+1];if(De===5){var Oe=String.fromCharCode.apply(String,Array.from(s.subarray(pe+2,pe+2+xe)));Oe==="VANC"?B.smpte2038_pids[he]=!0:Oe==="AV01"?B.common_pids.av1=he:Oe==="Opus"?B.common_pids.opus=he:Oe==="KLVA"&&(B.asynchronous_klv_pids[he]=!0)}else if(De===127){if(he===B.common_pids.opus){var Ie=null;if(s[pe+2]===128&&(Ie=s[pe+3]),Ie==null){T.a.e(this.TAG,"Not Supported Opus channel count.");continue}var ze={codec:"opus",channel_count:15&Ie?15&Ie:2,channel_config_code:Ie,sample_rate:48e3},He={codec:"opus",meta:ze};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(He))&&(this.audio_metadata_=ze,this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(He))}}else De===128&&he===B.common_pids.av1&&(this.video_metadata_.av1c=s.subarray(pe+2,pe+2+xe));pe+=2+xe}var Le=s.subarray(Z+5,Z+5+be);this.dispatchPESPrivateDataDescriptor(he,le,Le)}}else if(le===V.kMetadata){if(be>0)for(pe=Z+5;pe<Z+5+be;){De=s[pe+0];var Ne=s[pe+1];if(De===38){var Ge=s[pe+2]<<8|s[pe+3]<<0,Ee=null;Ge===65535&&(Ee=String.fromCharCode.apply(String,Array.from(s.subarray(pe+4,pe+4+4))));var Fe=null;if(s[pe+4+(Ge===65535?4:0)]===255){var qe=4+(Ge===65535?4:0)+1;Fe=String.fromCharCode.apply(String,Array.from(s.subarray(pe+qe,pe+qe+4)))}Ee==="ID3 "&&Fe==="ID3 "?B.timed_id3_pids[he]=!0:Fe==="KLVA"&&(B.synchronous_klv_pids[he]=!0)}pe+=2+Ne}}else if(le===V.kSCTE35)B.scte_35_pids[he]=!0;else if(le===V.kPGS){if(B.pgs_langs[he]="und",be>0)for(pe=Z+5;pe<Z+5+be;){De=s[pe+0];var Ye=s[pe+1];if(De===10){var Xe=String.fromCharCode.apply(String,Array.from(s.slice(pe+2,pe+5)));B.pgs_langs[he]=Xe}pe+=2+Ye}B.pgs_pids[he]=!0}}else B.common_pids.mp3=he;else B.common_pids.eac3=he;else B.common_pids.ac3=he;else B.common_pids.loas_aac=he;else B.common_pids.adts_aac=he;else B.common_pids.h265=he;else B.common_pids.h264=he;Z+=5+be}M===this.current_program_&&(this.pmt_==null&&T.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(B))),this.pmt_=B,(B.common_pids.h264||B.common_pids.h265||B.common_pids.av1)&&(this.has_video_=!0),(B.common_pids.adts_aac||B.common_pids.loas_aac||B.common_pids.ac3||B.common_pids.opus||B.common_pids.mp3)&&(this.has_audio_=!0))}else T.a.e(this.TAG,"parsePMT: table_id ".concat(n," is not corresponded to PMT!"))},p.prototype.parseSCTE35=function(s){var n=W(s);if(n.pts!=null){var m=Math.floor(n.pts/this.timescale_);n.pts=m}else n.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata(n)},p.prototype.parseAV1Payload=function(s,n,m,M,S){for(var D=new Ue(s),j=null,B=[],Y=0,Q=!1,X=null;(j=D.readNextOBUPayload())!=null;){if((X=Ve.a.parseOBUs(j,this.video_metadata_.details))&&X.keyframe===!0)if(this.video_init_segment_dispatched_){if(this.detectVideoMetadataChange(null,X)===!0){var Z;this.video_metadata_changed_=!0,this.dispatchVideoMediaSegment(!0),(Z=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+X.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),Z.set(X.sequence_header_data,this.video_metadata_.av1c.byteLength),X.av1c=Z,this.dispatchVideoInitSegment()}}else(Z=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+X.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),Z.set(X.sequence_header_data,this.video_metadata_.av1c.byteLength),X.av1c=Z,this.video_metadata_.details=X,this.dispatchVideoInitSegment();this.video_metadata_.details=X,Q||(Q=X.keyframe),B.push({data:j}),Y+=j.byteLength}var le=Math.floor(n/this.timescale_),he=Math.floor(m/this.timescale_);if(B.length){var be=this.video_track_,Te={units:B,length:Y,isKeyframe:Q,dts:he,pts:le,cts:le-he,file_position:M};be.samples.push(Te),be.length+=Y}},p.prototype.parseH264Payload=function(s,n,m,M,S){for(var D=new C(s),j=null,B=[],Y=0,Q=!1;(j=D.readNextNaluPayload())!=null;){var X=new q(j);if(X.type===h.kSliceSPS){var Z=ee.a.parseSPS(j.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(X,Z)===!0&&(T.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:X,pps:void 0,av1c:void 0,details:Z}):(this.video_metadata_.sps=X,this.video_metadata_.details=Z)}else X.type===h.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=X,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())):(X.type===h.kSliceIDR||X.type===h.kSliceNonIDR&&S===1)&&(Q=!0);this.video_init_segment_dispatched_&&(B.push(X),Y+=X.data.byteLength)}var le=Math.floor(n/this.timescale_),he=Math.floor(m/this.timescale_);if(B.length){var be=this.video_track_,Te={units:B,length:Y,isKeyframe:Q,dts:he,pts:le,cts:le-he,file_position:M};be.samples.push(Te),be.length+=Y}},p.prototype.parseH265Payload=function(s,n,m,M,S){for(var D=new ce(s),j=null,B=[],Y=0,Q=!1;(j=D.readNextNaluPayload())!=null;){var X=new ie(j);if(X.type===R.kSliceVPS){if(!this.video_init_segment_dispatched_){var Z=me.a.parseVPS(j.data);this.video_metadata_.vps=X,this.video_metadata_.details=Ce(Ce({},this.video_metadata_.details),Z)}}else X.type===R.kSliceSPS?(Z=me.a.parseSPS(j.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(X,Z)===!0&&(T.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:X,pps:void 0,av1c:void 0,details:Z}):(this.video_metadata_.sps=X,this.video_metadata_.details=Ce(Ce({},this.video_metadata_.details),Z))):X.type===R.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&(Z=me.a.parsePPS(j.data),this.video_metadata_.pps=X,this.video_metadata_.details=Ce(Ce({},this.video_metadata_.details),Z),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())):X.type!==R.kSliceIDR_W_RADL&&X.type!==R.kSliceIDR_N_LP&&X.type!==R.kSliceCRA_NUT||(Q=!0);this.video_init_segment_dispatched_&&(B.push(X),Y+=X.data.byteLength)}var le=Math.floor(n/this.timescale_),he=Math.floor(m/this.timescale_);if(B.length){var be=this.video_track_,Te={units:B,length:Y,isKeyframe:Q,dts:he,pts:le,cts:le-he,file_position:M};be.samples.push(Te),be.length+=Y}},p.prototype.detectVideoMetadataChange=function(s,n){if(n.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return T.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(n.codec_mimetype)),!0;if(n.codec_size.width!==this.video_metadata_.details.codec_size.width||n.codec_size.height!==this.video_metadata_.details.codec_size.height){var m=this.video_metadata_.details.codec_size,M=n.codec_size;return T.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(m.width,"x").concat(m.height," to ").concat(M.width,"x").concat(M.height)),!0}return n.present_size.width!==this.video_metadata_.details.present_size.width&&(T.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(n.present_size.width)),!0)},p.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},p.prototype.dispatchVideoInitSegment=function(){var s=this.video_metadata_.details,n={type:"video"};n.id=this.video_track_.id,n.timescale=1e3,n.duration=this.duration_,n.codecWidth=s.codec_size.width,n.codecHeight=s.codec_size.height,n.presentWidth=s.present_size.width,n.presentHeight=s.present_size.height,n.profile=s.profile_string,n.level=s.level_string,n.bitDepth=s.bit_depth,n.chromaFormat=s.chroma_format,n.sarRatio=s.sar_ratio,n.frameRate=s.frame_rate;var m=n.frameRate.fps_den,M=n.frameRate.fps_num;if(n.refSampleDuration=m/M*1e3,n.codec=s.codec_mimetype,this.video_metadata_.av1c)n.av1c=this.video_metadata_.av1c,this.video_init_segment_dispatched_==0&&T.a.v(this.TAG,"Generated first AV1 for mimeType: ".concat(n.codec));else if(this.video_metadata_.vps){var S=this.video_metadata_.vps.data.subarray(4),D=this.video_metadata_.sps.data.subarray(4),j=this.video_metadata_.pps.data.subarray(4),B=new se(S,D,j,s);n.hvcc=B.getData(),this.video_init_segment_dispatched_==0&&T.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(n.codec))}else{D=this.video_metadata_.sps.data.subarray(4),j=this.video_metadata_.pps.data.subarray(4);var Y=new J(D,j,s);n.avcc=Y.getData(),this.video_init_segment_dispatched_==0&&T.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat(n.codec))}this.onTrackMetadata("video",n),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var Q=this.media_info_;Q.hasVideo=!0,Q.width=n.codecWidth,Q.height=n.codecHeight,Q.fps=n.frameRate.fps,Q.profile=n.profile,Q.level=n.level,Q.refFrames=s.ref_frames,Q.chromaFormat=s.chroma_format_string,Q.sarNum=n.sarRatio.width,Q.sarDen=n.sarRatio.height,Q.videoCodec=n.codec,Q.hasAudio&&Q.audioCodec?Q.mimeType='video/mp2t; codecs="'.concat(Q.videoCodec,",").concat(Q.audioCodec,'"'):Q.mimeType='video/mp2t; codecs="'.concat(Q.videoCodec,'"'),Q.isComplete()&&this.onMediaInfo(Q)},p.prototype.dispatchVideoMediaSegment=function(s){s===void 0&&(s=!1),this.isInitSegmentDispatched()&&(this.video_track_.length||s)&&this.onDataAvailable(null,this.video_track_,s)},p.prototype.dispatchAudioMediaSegment=function(s){s===void 0&&(s=!1),this.isInitSegmentDispatched()&&(this.audio_track_.length||s)&&this.onDataAvailable(this.audio_track_,null,s)},p.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},p.prototype.parseADTSAACPayload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var m=new Uint8Array(s.byteLength+this.aac_last_incomplete_data_.byteLength);m.set(this.aac_last_incomplete_data_,0),m.set(s,this.aac_last_incomplete_data_.byteLength),s=m}var M,S;if(n!=null&&(S=n/this.timescale_),this.audio_metadata_.codec==="aac"){if(n==null&&this.audio_last_sample_pts_!=null)M=1024/this.audio_metadata_.sampling_frequency*1e3,S=this.audio_last_sample_pts_+M;else if(n==null)return void T.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){M=1024/this.audio_metadata_.sampling_frequency*1e3;var D=this.audio_last_sample_pts_+M;Math.abs(D-S)>1&&(T.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(D,"ms, PES pts: ").concat(S,"ms")),S=D)}}for(var j,B=new ae(s),Y=null,Q=S;(Y=B.readNextAACFrame())!=null;){M=1024/Y.sampling_frequency*1e3;var X={codec:"aac",data:Y};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(X))&&(this.audio_metadata_={codec:"aac",audio_object_type:Y.audio_object_type,sampling_freq_index:Y.sampling_freq_index,sampling_frequency:Y.sampling_frequency,channel_config:Y.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(X)),j=Q;var Z=Math.floor(Q),le={unit:Y.data,length:Y.data.byteLength,pts:Z,dts:Z};this.audio_track_.samples.push(le),this.audio_track_.length+=Y.data.byteLength,Q+=M}B.hasIncompleteData()&&(this.aac_last_incomplete_data_=B.getIncompleteData()),j&&(this.audio_last_sample_pts_=j)}},p.prototype.parseLOASAACPayload=function(s,n){var m;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var M=new Uint8Array(s.byteLength+this.aac_last_incomplete_data_.byteLength);M.set(this.aac_last_incomplete_data_,0),M.set(s,this.aac_last_incomplete_data_.byteLength),s=M}var S,D;if(n!=null&&(D=n/this.timescale_),this.audio_metadata_.codec==="aac"){if(n==null&&this.audio_last_sample_pts_!=null)S=1024/this.audio_metadata_.sampling_frequency*1e3,D=this.audio_last_sample_pts_+S;else if(n==null)return void T.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){S=1024/this.audio_metadata_.sampling_frequency*1e3;var j=this.audio_last_sample_pts_+S;Math.abs(j-D)>1&&(T.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(j,"ms, PES pts: ").concat(D,"ms")),D=j)}}for(var B,Y=new de(s),Q=null,X=D;(Q=Y.readNextAACFrame((m=this.loas_previous_frame)!==null&&m!==void 0?m:void 0))!=null;){this.loas_previous_frame=Q,S=1024/Q.sampling_frequency*1e3;var Z={codec:"aac",data:Q};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(Z))&&(this.audio_metadata_={codec:"aac",audio_object_type:Q.audio_object_type,sampling_freq_index:Q.sampling_freq_index,sampling_frequency:Q.sampling_frequency,channel_config:Q.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(Z)),B=X;var le=Math.floor(X),he={unit:Q.data,length:Q.data.byteLength,pts:le,dts:le};this.audio_track_.samples.push(he),this.audio_track_.length+=Q.data.byteLength,X+=S}Y.hasIncompleteData()&&(this.aac_last_incomplete_data_=Y.getIncompleteData()),B&&(this.audio_last_sample_pts_=B)}},p.prototype.parseAC3Payload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var m,M;if(n!=null&&(M=n/this.timescale_),this.audio_metadata_.codec==="ac-3"){if(n==null&&this.audio_last_sample_pts_!=null)m=1536/this.audio_metadata_.sampling_frequency*1e3,M=this.audio_last_sample_pts_+m;else if(n==null)return void T.a.w(this.TAG,"AC3: Unknown pts")}for(var S,D=new fe(s),j=null,B=M;(j=D.readNextAC3Frame())!=null;){m=1536/j.sampling_frequency*1e3;var Y={codec:"ac-3",data:j};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(Y))&&(this.audio_metadata_={codec:"ac-3",sampling_frequency:j.sampling_frequency,bit_stream_identification:j.bit_stream_identification,bit_stream_mode:j.bit_stream_mode,low_frequency_effects_channel_on:j.low_frequency_effects_channel_on,channel_mode:j.channel_mode},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(Y)),S=B;var Q=Math.floor(B),X={unit:j.data,length:j.data.byteLength,pts:Q,dts:Q};this.audio_track_.samples.push(X),this.audio_track_.length+=j.data.byteLength,B+=m}S&&(this.audio_last_sample_pts_=S)}},p.prototype.parseEAC3Payload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var m,M;if(n!=null&&(M=n/this.timescale_),this.audio_metadata_.codec==="ec-3"){if(n==null&&this.audio_last_sample_pts_!=null)m=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,M=this.audio_last_sample_pts_+m;else if(n==null)return void T.a.w(this.TAG,"EAC3: Unknown pts")}for(var S,D=new we(s),j=null,B=M;(j=D.readNextEAC3Frame())!=null;){m=1536/j.sampling_frequency*1e3;var Y={codec:"ec-3",data:j};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(Y))&&(this.audio_metadata_={codec:"ec-3",sampling_frequency:j.sampling_frequency,bit_stream_identification:j.bit_stream_identification,low_frequency_effects_channel_on:j.low_frequency_effects_channel_on,num_blks:j.num_blks,channel_mode:j.channel_mode},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(Y)),S=B;var Q=Math.floor(B),X={unit:j.data,length:j.data.byteLength,pts:Q,dts:Q};this.audio_track_.samples.push(X),this.audio_track_.length+=j.data.byteLength,B+=m}S&&(this.audio_last_sample_pts_=S)}},p.prototype.parseOpusPayload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var m,M;if(n!=null&&(M=n/this.timescale_),this.audio_metadata_.codec==="opus"){if(n==null&&this.audio_last_sample_pts_!=null)m=20,M=this.audio_last_sample_pts_+m;else if(n==null)return void T.a.w(this.TAG,"Opus: Unknown pts")}for(var S,D=M,j=0;j<s.length;){m=20;for(var B=(16&s[j+1])!=0,Y=(8&s[j+1])!=0,Q=j+2,X=0;s[Q]===255;)X+=255,Q+=1;X+=s[Q],Q+=1,Q+=B?2:0,Q+=Y?2:0,S=D;var Z=Math.floor(D),le=s.slice(Q,Q+X),he={unit:le,length:le.byteLength,pts:Z,dts:Z};this.audio_track_.samples.push(he),this.audio_track_.length+=le.byteLength,D+=m,j=Q+X}S&&(this.audio_last_sample_pts_=S)}},p.prototype.parseMP3Payload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var m=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],M=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],S=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],D=s[1]>>>3&3,j=(6&s[1])>>1,B=(240&s[2])>>>4,Y=(12&s[2])>>>2,Q=(s[3]>>>6&3)!==3?2:1,X=0,Z=34;switch(D){case 0:X=[11025,12e3,8e3,0][Y];break;case 2:X=[22050,24e3,16e3,0][Y];break;case 3:X=[44100,48e3,32e3,0][Y]}switch(j){case 1:Z=34,B<S.length&&S[B];break;case 2:Z=33,B<M.length&&M[B];break;case 3:Z=32,B<m.length&&m[B]}var le=new ue;le.object_type=Z,le.sample_rate=X,le.channel_count=Q,le.data=s;var he={codec:"mp3",data:le};this.audio_init_segment_dispatched_==0&&(this.audio_metadata_={codec:"mp3",object_type:Z,sample_rate:X,channel_count:Q},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(he));var be={unit:s,length:s.byteLength,pts:n/this.timescale_,dts:n/this.timescale_};this.audio_track_.samples.push(be),this.audio_track_.length+=s.byteLength}},p.prototype.detectAudioMetadataChange=function(s){if(s.codec!==this.audio_metadata_.codec)return T.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(s.codec)),!0;if(s.codec==="aac"&&this.audio_metadata_.codec==="aac"){if((n=s.data).audio_object_type!==this.audio_metadata_.audio_object_type)return T.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(n.audio_object_type)),!0;if(n.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return T.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(n.sampling_freq_index)),!0;if(n.channel_config!==this.audio_metadata_.channel_config)return T.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(n.channel_config)),!0}else if(s.codec==="ac-3"&&this.audio_metadata_.codec==="ac-3"){var n;if((n=s.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return T.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat(n.sampling_frequency)),!0;if(n.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return T.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat(n.bit_stream_identification)),!0;if(n.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return T.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat(n.bit_stream_mode)),!0;if(n.channel_mode!==this.audio_metadata_.channel_mode)return T.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat(n.channel_mode)),!0;if(n.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return T.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat(n.low_frequency_effects_channel_on)),!0}else if(s.codec==="opus"&&this.audio_metadata_.codec==="opus"){if((m=s.meta).sample_rate!==this.audio_metadata_.sample_rate)return T.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(m.sample_rate)),!0;if(m.channel_count!==this.audio_metadata_.channel_count)return T.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(m.channel_count)),!0}else if(s.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var m;if((m=s.data).object_type!==this.audio_metadata_.object_type)return T.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(m.object_type)),!0;if(m.sample_rate!==this.audio_metadata_.sample_rate)return T.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(m.sample_rate)),!0;if(m.channel_count!==this.audio_metadata_.channel_count)return T.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(m.channel_count)),!0}return!1},p.prototype.dispatchAudioInitSegment=function(s){var n={type:"audio"};if(n.id=this.audio_track_.id,n.timescale=1e3,n.duration=this.duration_,this.audio_metadata_.codec==="aac"){var m=s.codec==="aac"?s.data:null,M=new H(m);n.audioSampleRate=M.sampling_rate,n.channelCount=M.channel_count,n.codec=M.codec_mimetype,n.originalCodec=M.original_codec_mimetype,n.config=M.config,n.refSampleDuration=1024/n.audioSampleRate*n.timescale}else if(this.audio_metadata_.codec==="ac-3"){var S=s.codec==="ac-3"?s.data:null,D=new ve(S);n.audioSampleRate=D.sampling_rate,n.channelCount=D.channel_count,n.codec=D.codec_mimetype,n.originalCodec=D.original_codec_mimetype,n.config=D.config,n.refSampleDuration=1536/n.audioSampleRate*n.timescale}else if(this.audio_metadata_.codec==="ec-3"){var j=s.codec==="ec-3"?s.data:null,B=new Pe(j);n.audioSampleRate=B.sampling_rate,n.channelCount=B.channel_count,n.codec=B.codec_mimetype,n.originalCodec=B.original_codec_mimetype,n.config=B.config,n.refSampleDuration=256*B.num_blks/n.audioSampleRate*n.timescale}else this.audio_metadata_.codec==="opus"?(n.audioSampleRate=this.audio_metadata_.sample_rate,n.channelCount=this.audio_metadata_.channel_count,n.channelConfigCode=this.audio_metadata_.channel_config_code,n.codec="opus",n.originalCodec="opus",n.config=void 0,n.refSampleDuration=20):this.audio_metadata_.codec==="mp3"&&(n.audioSampleRate=this.audio_metadata_.sample_rate,n.channelCount=this.audio_metadata_.channel_count,n.codec="mp3",n.originalCodec="mp3",n.config=void 0);this.audio_init_segment_dispatched_==0&&T.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(n.codec)),this.onTrackMetadata("audio",n),this.audio_init_segment_dispatched_=!0;var Y=this.media_info_;Y.hasAudio=!0,Y.audioCodec=n.originalCodec,Y.audioSampleRate=n.audioSampleRate,Y.audioChannelCount=n.channelCount,Y.hasVideo&&Y.videoCodec?Y.mimeType='video/mp2t; codecs="'.concat(Y.videoCodec,",").concat(Y.audioCodec,'"'):Y.mimeType='video/mp2t; codecs="'.concat(Y.audioCodec,'"'),Y.isComplete()&&this.onMediaInfo(Y)},p.prototype.dispatchPESPrivateDataDescriptor=function(s,n,m){var M=new re;M.pid=s,M.stream_type=n,M.descriptor=m,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(M)},p.prototype.parsePESPrivateDataPayload=function(s,n,m,M,S){var D=new ne;if(D.pid=M,D.stream_id=S,D.len=s.byteLength,D.data=s,n!=null){var j=Math.floor(n/this.timescale_);D.pts=j}else D.nearest_pts=this.getNearestTimestampMilliseconds();if(m!=null){var B=Math.floor(m/this.timescale_);D.dts=B}this.onPESPrivateData&&this.onPESPrivateData(D)},p.prototype.parseTimedID3MetadataPayload=function(s,n,m,M,S){var D=new ne;if(D.pid=M,D.stream_id=S,D.len=s.byteLength,D.data=s,n!=null){var j=Math.floor(n/this.timescale_);D.pts=j}if(m!=null){var B=Math.floor(m/this.timescale_);D.dts=B}this.onTimedID3Metadata&&this.onTimedID3Metadata(D)},p.prototype.parsePGSPayload=function(s,n,m,M,S,D){var j=new ke;if(j.pid=M,j.lang=D,j.stream_id=S,j.len=s.byteLength,j.data=s,n!=null){var B=Math.floor(n/this.timescale_);j.pts=B}if(m!=null){var Y=Math.floor(m/this.timescale_);j.dts=Y}this.onPGSSubtitleData&&this.onPGSSubtitleData(j)},p.prototype.parseSynchronousKLVMetadataPayload=function(s,n,m,M,S){var D=new Be;if(D.pid=M,D.stream_id=S,D.len=s.byteLength,D.data=s,n!=null){var j=Math.floor(n/this.timescale_);D.pts=j}if(m!=null){var B=Math.floor(m/this.timescale_);D.dts=B}D.access_units=function(Y){for(var Q=[],X=0;X+5<Y.byteLength;){var Z=Y[X+0],le=Y[X+1],he=Y[X+2],be=Y[X+3]<<8|Y[X+4]<<0,Te=Y.slice(X+5,X+5+be);Q.push({service_id:Z,sequence_number:le,flags:he,data:Te}),X+=5+be}return Q}(s),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(D)},p.prototype.parseAsynchronousKLVMetadataPayload=function(s,n,m){var M=new ne;M.pid=n,M.stream_id=m,M.len=s.byteLength,M.data=s,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(M)},p.prototype.parseSMPTE2038MetadataPayload=function(s,n,m,M,S){var D=new oe;if(D.pid=M,D.stream_id=S,D.len=s.byteLength,D.data=s,n!=null){var j=Math.floor(n/this.timescale_);D.pts=j}if(D.nearest_pts=this.getNearestTimestampMilliseconds(),m!=null){var B=Math.floor(m/this.timescale_);D.dts=B}D.ancillaries=function(Y){for(var Q=new U.a(Y),X=0,Z=[];X+=6,Q.readBits(6)===0;){var le=Q.readBool();X+=1;var he=Q.readBits(11);X+=11;var be=Q.readBits(12);X+=12;var Te=255&Q.readBits(10);X+=10;var Ae=255&Q.readBits(10);X+=10;var pe=255&Q.readBits(10);X+=10;for(var De=new Uint8Array(pe),xe=0;xe<pe;xe++){var Oe=255&Q.readBits(10);X+=10,De[xe]=Oe}Q.readBits(10),X+=10;var Ie="User Defined";Te===65?Ae===7&&(Ie="SCTE-104"):Te===95?Ae===220?Ie="ARIB STD-B37 (1SEG)":Ae===221?Ie="ARIB STD-B37 (ANALOG)":Ae===222?Ie="ARIB STD-B37 (SD)":Ae===223&&(Ie="ARIB STD-B37 (HD)"):Te===97&&(Ae===1?Ie="EIA-708":Ae===2&&(Ie="EIA-608")),Z.push({yc_indicator:le,line_number:he,horizontal_offset:be,did:Te,sdid:Ae,user_data:De,description:Ie,information:{}}),Q.readBits(8-(X-Math.floor(X/8))%8),X+=(8-(X-Math.floor(X/8)))%8}return Q.destroy(),Q=null,Z}(s),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(D)},p.prototype.getNearestTimestampMilliseconds=function(){return this.audio_last_sample_pts_!=null?Math.floor(this.audio_last_sample_pts_):this.last_pcr_!=null?Math.floor(this.last_pcr_/300/this.timescale_):void 0},p.prototype.getPcrBase=function(s){var n=33554432*s[6]+131072*s[7]+512*s[8]+2*s[9]+(128&s[10])/128+this.timestamp_offset_;return n+4294967296<this.last_pcr_base_&&(n+=8589934592,this.timestamp_offset_+=8589934592),this.last_pcr_base_=n,n},p.prototype.getTimestamp=function(s,n){var m=536870912*(14&s[n])+4194304*(255&s[n+1])+16384*(254&s[n+2])+128*(255&s[n+3])+(254&s[n+4])/2+this.timestamp_offset_;return m+4294967296<this.last_pcr_base_&&(m+=8589934592),m},p}(y);_e.a=je},function(ge,_e,x){var V=x(8),T=function(){function L(){}return L._ebsp2rbsp=function(c){for(var y=c,a=y.byteLength,h=new Uint8Array(a),f=0,A=0;A<a;A++)A>=2&&y[A]===3&&y[A-1]===0&&y[A-2]===0||(h[f]=y[A],f++);return new Uint8Array(h.buffer,0,f)},L.parseVPS=function(c){var y=L._ebsp2rbsp(c),a=new V.a(y);return a.readByte(),a.readByte(),a.readBits(4),a.readBits(2),a.readBits(6),{num_temporal_layers:a.readBits(3)+1,temporal_id_nested:a.readBool()}},L.parseSPS=function(c){var y=L._ebsp2rbsp(c),a=new V.a(y);a.readByte(),a.readByte();for(var h=0,f=0,A=0,E=0,O=(a.readBits(4),a.readBits(3)),G=(a.readBool(),a.readBits(2)),I=a.readBool(),z=a.readBits(5),q=a.readByte(),C=a.readByte(),J=a.readByte(),ee=a.readByte(),U=a.readByte(),u=a.readByte(),d=a.readByte(),l=a.readByte(),g=a.readByte(),K=a.readByte(),$=a.readByte(),ae=[],de=[],H=0;H<O;H++)ae.push(a.readBool()),de.push(a.readBool());if(O>0)for(H=O;H<8;H++)a.readBits(2);for(H=0;H<O;H++)ae[H]&&(a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte()),de[H]&&a.readByte();a.readUEG();var ne=a.readUEG();ne==3&&a.readBits(1);var re=a.readUEG(),R=a.readUEG();a.readBool()&&(h+=a.readUEG(),f+=a.readUEG(),A+=a.readUEG(),E+=a.readUEG());var t=a.readUEG(),e=a.readUEG(),i=a.readUEG();for(H=a.readBool()?0:O;H<=O;H++)a.readUEG(),a.readUEG(),a.readUEG();if(a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG(),a.readBool()&&a.readBool())for(var o=0;o<4;o++)for(var r=0;r<(o===3?2:6);r++)if(a.readBool()){var v=Math.min(64,1<<4+(o<<1));for(o>1&&a.readSEG(),H=0;H<v;H++)a.readSEG()}else a.readUEG();a.readBool(),a.readBool(),a.readBool()&&(a.readByte(),a.readUEG(),a.readUEG(),a.readBool());var k=a.readUEG(),b=0;for(H=0;H<k;H++){var w=!1;if(H!==0&&(w=a.readBool()),w){H===k&&a.readUEG(),a.readBool(),a.readUEG();for(var N=0,F=0;F<=b;F++){var P=a.readBool(),W=!1;P||(W=a.readBool()),(P||W)&&N++}b=N}else{var te=a.readUEG(),ie=a.readUEG();for(b=te+ie,F=0;F<te;F++)a.readUEG(),a.readBool();for(F=0;F<ie;F++)a.readUEG(),a.readBool()}}if(a.readBool()){var ce=a.readUEG();for(H=0;H<ce;H++){for(F=0;F<i+4;F++)a.readBits(1);a.readBits(1)}}var se=0,me=1,oe=1,ue=!1,ye=1,Re=1,fe=(a.readBool(),a.readBool(),2),ve=2,Se=2;if(a.readBool()){if(a.readBool()){var we=a.readByte();we>0&&we<=16?(me=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][we-1],oe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][we-1]):we===255&&(me=a.readBits(16),oe=a.readBits(16))}if(a.readBool()&&a.readBool(),a.readBool()&&(a.readBits(3),a.readBool(),a.readBool()&&(fe=a.readByte(),ve=a.readByte(),Se=a.readByte())),a.readBool()&&(a.readUEG(),a.readUEG()),a.readBool(),a.readBool(),a.readBool(),a.readBool()&&(a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG()),a.readBool()&&(ye=a.readBits(32),Re=a.readBits(32),a.readBool()&&a.readUEG(),a.readBool())){var Pe=!1,Be=!1,Ue=!1;for(Pe=a.readBool(),Be=a.readBool(),(Pe||Be)&&((Ue=a.readBool())&&(a.readByte(),a.readBits(5),a.readBool(),a.readBits(5)),a.readBits(4),a.readBits(4),Ue&&a.readBits(4),a.readBits(5),a.readBits(5),a.readBits(5)),H=0;H<=O;H++){var Ve=a.readBool();ue=Ve;var ke=!0,Me=1;Ve||(ke=a.readBool());var Ce=!1;if(ke?a.readUEG():Ce=a.readBool(),Ce||(Me=a.readUEG()+1),Pe){for(F=0;F<Me;F++)a.readUEG(),a.readUEG(),Ue&&(a.readUEG(),a.readUEG());a.readBool()}if(Be){for(F=0;F<Me;F++)a.readUEG(),a.readUEG(),Ue&&(a.readUEG(),a.readUEG());a.readBool()}}}a.readBool()&&(a.readBool(),a.readBool(),a.readBool(),se=a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG())}a.readBool();var je="hvc1.".concat(z,".1.L").concat($,".B0"),_=re-(h+f)*(ne===1||ne===2?2:1),p=R-(A+E)*(ne===1?2:1),s=1;return me!==1&&oe!==1&&(s=me/oe),a.destroy(),a=null,{codec_mimetype:je,profile_string:L.getProfileString(z),level_string:L.getLevelString($),profile_idc:z,bit_depth:t+8,ref_frames:1,chroma_format:ne,chroma_format_string:L.getChromaFormatString(ne),general_level_idc:$,general_profile_space:G,general_tier_flag:I,general_profile_idc:z,general_profile_compatibility_flags_1:q,general_profile_compatibility_flags_2:C,general_profile_compatibility_flags_3:J,general_profile_compatibility_flags_4:ee,general_constraint_indicator_flags_1:U,general_constraint_indicator_flags_2:u,general_constraint_indicator_flags_3:d,general_constraint_indicator_flags_4:l,general_constraint_indicator_flags_5:g,general_constraint_indicator_flags_6:K,min_spatial_segmentation_idc:se,constant_frame_rate:0,chroma_format_idc:ne,bit_depth_luma_minus8:t,bit_depth_chroma_minus8:e,colour_primaries:fe,transfer_characteristics:ve,matrix_coeffs:Se,frame_rate:{fixed:ue,fps:Re/ye,fps_den:ye,fps_num:Re},sar_ratio:{width:me,height:oe},codec_size:{width:_,height:p},present_size:{width:_*s,height:p}}},L.parsePPS=function(c){var y=L._ebsp2rbsp(c),a=new V.a(y);a.readByte(),a.readByte(),a.readUEG(),a.readUEG(),a.readBool(),a.readBool(),a.readBits(3),a.readBool(),a.readBool(),a.readUEG(),a.readUEG(),a.readSEG(),a.readBool(),a.readBool(),a.readBool()&&a.readUEG(),a.readSEG(),a.readSEG(),a.readBool(),a.readBool(),a.readBool(),a.readBool();var h=a.readBool(),f=a.readBool(),A=1;return f&&h?A=0:f?A=3:h&&(A=2),{parallelismType:A}},L.getChromaFormatString=function(c){switch(c){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},L.getProfileString=function(c){switch(c){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},L.getLevelString=function(c){return(c/30).toFixed(1)},L}();_e.a=T},function(ge,_e,x){var V=x(8),T=function(){return(T=Object.assign||function(c){for(var y,a=1,h=arguments.length;a<h;a++)for(var f in y=arguments[a])Object.prototype.hasOwnProperty.call(y,f)&&(c[f]=y[f]);return c}).apply(this,arguments)},L=function(){function c(){}return c.parseOBUs=function(y,a){for(var h=0;h<y.byteLength;){var f=h,A=(y[h],(120&y[h])>>3),E=(4&y[h])!=0,O=(2&y[h])!=0;y[h],h+=1,E&&(h+=1);var G=Number.POSITIVE_INFINITY;if(O){G=0;for(var I=0;;I++){var z=y[h++];if(G|=(127&z)<<7*I,(128&z)==0)break}}console.log(A),A===1?a=T(T({},c.parseSeuqneceHeader(y.subarray(h,h+G))),{sequence_header_data:y.subarray(f,h+G)}):(A==3&&a||A==6&&a)&&(a=c.parseOBUFrameHeader(y.subarray(h,h+G),0,0,a)),h+=G}return a},c.parseSeuqneceHeader=function(y){var a=new V.a(y),h=a.readBits(3),f=(a.readBool(),a.readBool()),A=!0,E=0,O=1,G=void 0,I=[];if(f)I.push({operating_point_idc:0,level:a.readBits(5),tier:0});else{if(a.readBool()){var z=a.readBits(32),q=a.readBits(32),C=a.readBool();if(C){for(var J=0;a.readBits(1)===0;)J+=1;J>=32||(1<<J)-1+a.readBits(J)}(E=q)/(O=z),A=C,a.readBool()&&(a.readBits(5),a.readBits(32),G=a.readBits(5),a.readBits(5))}for(var ee=a.readBool(),U=a.readBits(5),u=0;u<=U;u++){var d=a.readBits(12),l=a.readBits(5),g=l>7?a.readBits(1):0;I.push({operating_point_idc:d,level:l,tier:g}),ee&&a.readBool()&&a.readBits(4)}}var K=I[0],$=K.level,ae=K.tier,de=a.readBits(4),H=a.readBits(4),ne=a.readBits(de+1)+1,re=a.readBits(H+1)+1,R=!1;f||(R=a.readBool()),R&&(a.readBits(4),a.readBits(4)),a.readBool(),a.readBool(),a.readBool();var t=!1,e=2,i=2,o=0;f||(a.readBool(),a.readBool(),a.readBool(),a.readBool(),(t=a.readBool())&&(a.readBool(),a.readBool()),(e=a.readBool()?2:a.readBits(1))?i=a.readBool()?2:a.readBits(1):i=2,t?o=a.readBits(3)+1:o=0);var r=a.readBool(),v=(a.readBool(),a.readBool(),a.readBool()),k=8;h===2&&v?k=a.readBool()?12:10:k=v?10:8;var b=!1;h!==1&&(b=a.readBool()),a.readBool()&&(a.readBits(8),a.readBits(8),a.readBits(8));var w=1,N=1;return b?(a.readBits(1),w=1,N=1):(a.readBits(1),h==0?(w=1,N=1):h==1?(w=0,N=0):k==12?a.readBits(1)&&a.readBits(1):(w=1,N=0),w&&N&&a.readBits(2),a.readBits(1)),a.readBool(),a.destroy(),a=null,{codec_mimetype:"av01.".concat(h,".").concat(c.getLevelString($,ae),".").concat(k.toString(10).padStart(2,"0")),level:$,tier:ae,level_string:c.getLevelString($,ae),profile_idc:h,profile_string:"".concat(h),bit_depth:k,ref_frames:1,chroma_format:c.getChromaFormat(b,w,N),chroma_format_string:c.getChromaFormatString(b,w,N),sequence_header:{frame_id_numbers_present_flag:R,additional_frame_id_length_minus_1:void 0,delta_frame_id_length_minus_2:void 0,reduced_still_picture_header:f,decoder_model_info_present_flag:!1,operating_points:I,buffer_removal_time_length_minus_1:G,equal_picture_interval:A,seq_force_screen_content_tools:e,seq_force_integer_mv:i,enable_order_hint:t,order_hint_bits:o,enable_superres:r,frame_width_bit:de+1,frame_height_bit:H+1,max_frame_width:ne,max_frame_height:re},keyframe:void 0,frame_rate:{fixed:A,fps:E/O,fps_den:O,fps_num:E}}},c.parseOBUFrameHeader=function(y,a,h,f){var A=f.sequence_header,E=new V.a(y),O=(A.max_frame_width,A.max_frame_height,0);A.frame_id_numbers_present_flag&&(O=A.additional_frame_id_length_minus_1+A.delta_frame_id_length_minus_2+3);var G=0,I=!0,z=!0,q=!1;if(!A.reduced_still_picture_header){if(E.readBool())return f;I=(G=E.readBits(2))===2||G===0,(z=E.readBool())&&A.decoder_model_info_present_flag&&A.equal_picture_interval,z&&E.readBool(),q=!!(G===3||G===0&&z)||E.readBool()}f.keyframe=I,E.readBool();var C=A.seq_force_screen_content_tools;A.seq_force_screen_content_tools===2&&(C=E.readBits(1)),C&&(A.seq_force_integer_mv,A.seq_force_integer_mv==2&&E.readBits(1)),A.frame_id_numbers_present_flag&&E.readBits(O);var J=!1;if(J=G==3||!A.reduced_still_picture_header&&E.readBool(),E.readBits(A.order_hint_bits),I||q||E.readBits(3),A.decoder_model_info_present_flag&&E.readBool()){for(var ee=0;ee<=A.operating_points_cnt_minus_1;ee++)if(A.operating_points[ee].decoder_model_present_for_this_op[ee]){var U=A.operating_points[ee].operating_point_idc;(U===0||U>>a&1&&U>>h+8&1)&&E.readBits(A.buffer_removal_time_length_minus_1+1)}}var u=255;if(G===3||G==0&&z||(u=E.readBits(8)),(I||u!==255)&&q&&A.enable_order_hint)for(var d=0;d<8;d++)E.readBits(A.order_hint_bits);if(I){var l=c.frameSizeAndRenderSize(E,J,A);f.codec_size={width:l.FrameWidth,height:l.FrameHeight},f.present_size={width:l.RenderWidth,height:l.RenderHeight},f.sar_ratio={width:l.RenderWidth/l.FrameWidth,height:l.RenderHeight/l.FrameHeight}}return E.destroy(),E=null,f},c.frameSizeAndRenderSize=function(y,a,h){var f=h.max_frame_width,A=h.max_frame_height;a&&(f=y.readBits(h.frame_width_bit)+1,A=y.readBits(h.frame_height_bit)+1);var E=!1;h.enable_superres&&(E=y.readBool());var O=8;E&&(O=y.readBits(3)+9);var G=f;f=Math.floor((8*G+O/2)/O);var I=G,z=A;if(y.readBool()){var q=y.readBits(16)+1,C=y.readBits(16)+1;I=y.readBits(q)+1,z=y.readBits(C)+1}return{UpscaledWidth:G,FrameWidth:f,FrameHeight:A,RenderWidth:I,RenderHeight:z}},c.getLevelString=function(y,a){return"".concat(y.toString(10).padStart(2,"0")).concat(a===0?"M":"H")},c.getChromaFormat=function(y,a,h){return y?0:a===0&&h===0?3:a===1&&h===0?2:a===1&&h===1?1:Number.NaN},c.getChromaFormatString=function(y,a,h){return y?"4:0:0":a===0&&h===0?"4:4:4":a===1&&h===0?"4:2:2":a===1&&h===1?"4:2:0":"Unknown"},c}();_e.a=L},function(ge,_e,x){var V,T=x(0),L=function(){function U(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return U.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},U.prototype.addBytes=function(u){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=u,this._totalBytes+=u):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=u,this._totalBytes+=u):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=u,this._totalBytes+=u,this._lastCheckpoint=this._now())},Object.defineProperty(U.prototype,"currentKBps",{get:function(){this.addBytes(0);var u=(this._now()-this._lastCheckpoint)/1e3;return u==0&&(u=1),this._intervalBytes/u/1024},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"averageKBps",{get:function(){var u=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/u/1024},enumerable:!1,configurable:!0}),U}(),c=x(2),y=x(5),a=x(3),h=(V=function(U,u){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,l){d.__proto__=l}||function(d,l){for(var g in l)Object.prototype.hasOwnProperty.call(l,g)&&(d[g]=l[g])})(U,u)},function(U,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function d(){this.constructor=U}V(U,u),U.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)}),f=function(U){function u(d,l){var g=U.call(this,"fetch-stream-loader")||this;return g.TAG="FetchStreamLoader",g._seekHandler=d,g._config=l,g._needStash=!0,g._requestAbort=!1,g._abortController=null,g._contentLength=null,g._receivedLength=0,g}return h(u,U),u.isSupported=function(){try{var d=y.a.msedge&&y.a.version.minor>=15048,l=!y.a.msedge||d;return self.fetch&&self.ReadableStream&&l}catch{return!1}},u.prototype.destroy=function(){this.isWorking()&&this.abort(),U.prototype.destroy.call(this)},u.prototype.open=function(d,l){var g=this;this._dataSource=d,this._range=l;var K=d.url;this._config.reuseRedirectedURL&&d.redirectedURL!=null&&(K=d.redirectedURL);var $=this._seekHandler.getConfig(K,l),ae=new self.Headers;if(typeof $.headers=="object"){var de=$.headers;for(var H in de)de.hasOwnProperty(H)&&ae.append(H,de[H])}var ne={method:"GET",headers:ae,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var H in this._config.headers)ae.append(H,this._config.headers[H]);d.cors===!1&&(ne.mode="same-origin"),d.withCredentials&&(ne.credentials="include"),d.referrerPolicy&&(ne.referrerPolicy=d.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,ne.signal=this._abortController.signal),this._status=c.c.kConnecting,self.fetch($.url,ne).then(function(re){if(g._requestAbort)return g._status=c.c.kIdle,void re.body.cancel();if(re.ok&&re.status>=200&&re.status<=299){if(re.url!==$.url&&g._onURLRedirect){var R=g._seekHandler.removeURLParameters(re.url);g._onURLRedirect(R)}var t=re.headers.get("Content-Length");return t!=null&&(g._contentLength=parseInt(t),g._contentLength!==0&&g._onContentLengthKnown&&g._onContentLengthKnown(g._contentLength)),g._pump.call(g,re.body.getReader())}if(g._status=c.c.kError,!g._onError)throw new a.d("FetchStreamLoader: Http code invalid, "+re.status+" "+re.statusText);g._onError(c.b.HTTP_STATUS_CODE_INVALID,{code:re.status,msg:re.statusText})}).catch(function(re){if(!g._abortController||!g._abortController.signal.aborted){if(g._status=c.c.kError,!g._onError)throw re;g._onError(c.b.EXCEPTION,{code:-1,msg:re.message})}})},u.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==c.c.kBuffering||!y.a.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},u.prototype._pump=function(d){var l=this;return d.read().then(function(g){if(g.done)if(l._contentLength!==null&&l._receivedLength<l._contentLength){l._status=c.c.kError;var K=c.b.EARLY_EOF,$={code:-1,msg:"Fetch stream meet Early-EOF"};if(!l._onError)throw new a.d($.msg);l._onError(K,$)}else l._status=c.c.kComplete,l._onComplete&&l._onComplete(l._range.from,l._range.from+l._receivedLength-1);else{if(l._abortController&&l._abortController.signal.aborted)return void(l._status=c.c.kComplete);if(l._requestAbort===!0)return l._status=c.c.kComplete,d.cancel();l._status=c.c.kBuffering;var ae=g.value.buffer,de=l._range.from+l._receivedLength;l._receivedLength+=ae.byteLength,l._onDataArrival&&l._onDataArrival(ae,de,l._receivedLength),l._pump(d)}}).catch(function(g){if(l._abortController&&l._abortController.signal.aborted)l._status=c.c.kComplete;else if(g.code!==11||!y.a.msedge){l._status=c.c.kError;var K=0,$=null;if(g.code!==19&&g.message!=="network error"||!(l._contentLength===null||l._contentLength!==null&&l._receivedLength<l._contentLength)?(K=c.b.EXCEPTION,$={code:g.code,msg:g.message}):(K=c.b.EARLY_EOF,$={code:g.code,msg:"Fetch stream meet Early-EOF"}),!l._onError)throw new a.d($.msg);l._onError(K,$)}})},u}(c.a),A=function(){var U=function(u,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,g){l.__proto__=g}||function(l,g){for(var K in g)Object.prototype.hasOwnProperty.call(g,K)&&(l[K]=g[K])})(u,d)};return function(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function l(){this.constructor=u}U(u,d),u.prototype=d===null?Object.create(d):(l.prototype=d.prototype,new l)}}(),E=function(U){function u(d,l){var g=U.call(this,"xhr-moz-chunked-loader")||this;return g.TAG="MozChunkedLoader",g._seekHandler=d,g._config=l,g._needStash=!0,g._xhr=null,g._requestAbort=!1,g._contentLength=null,g._receivedLength=0,g}return A(u,U),u.isSupported=function(){try{var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="moz-chunked-arraybuffer",d.responseType==="moz-chunked-arraybuffer"}catch(l){return T.a.w("MozChunkedLoader",l.message),!1}},u.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),U.prototype.destroy.call(this)},u.prototype.open=function(d,l){this._dataSource=d,this._range=l;var g=d.url;this._config.reuseRedirectedURL&&d.redirectedURL!=null&&(g=d.redirectedURL);var K=this._seekHandler.getConfig(g,l);this._requestURL=K.url;var $=this._xhr=new XMLHttpRequest;if($.open("GET",K.url,!0),$.responseType="moz-chunked-arraybuffer",$.onreadystatechange=this._onReadyStateChange.bind(this),$.onprogress=this._onProgress.bind(this),$.onloadend=this._onLoadEnd.bind(this),$.onerror=this._onXhrError.bind(this),d.withCredentials&&($.withCredentials=!0),typeof K.headers=="object"){var ae=K.headers;for(var de in ae)ae.hasOwnProperty(de)&&$.setRequestHeader(de,ae[de])}if(typeof this._config.headers=="object"){ae=this._config.headers;for(var de in ae)ae.hasOwnProperty(de)&&$.setRequestHeader(de,ae[de])}this._status=c.c.kConnecting,$.send()},u.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=c.c.kComplete},u.prototype._onReadyStateChange=function(d){var l=d.target;if(l.readyState===2){if(l.responseURL!=null&&l.responseURL!==this._requestURL&&this._onURLRedirect){var g=this._seekHandler.removeURLParameters(l.responseURL);this._onURLRedirect(g)}if(l.status!==0&&(l.status<200||l.status>299)){if(this._status=c.c.kError,!this._onError)throw new a.d("MozChunkedLoader: Http code invalid, "+l.status+" "+l.statusText);this._onError(c.b.HTTP_STATUS_CODE_INVALID,{code:l.status,msg:l.statusText})}else this._status=c.c.kBuffering}},u.prototype._onProgress=function(d){if(this._status!==c.c.kError){this._contentLength===null&&d.total!==null&&d.total!==0&&(this._contentLength=d.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var l=d.target.response,g=this._range.from+this._receivedLength;this._receivedLength+=l.byteLength,this._onDataArrival&&this._onDataArrival(l,g,this._receivedLength)}},u.prototype._onLoadEnd=function(d){this._requestAbort!==!0?this._status!==c.c.kError&&(this._status=c.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},u.prototype._onXhrError=function(d){this._status=c.c.kError;var l=0,g=null;if(this._contentLength&&d.loaded<this._contentLength?(l=c.b.EARLY_EOF,g={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(l=c.b.EXCEPTION,g={code:-1,msg:d.constructor.name+" "+d.type}),!this._onError)throw new a.d(g.msg);this._onError(l,g)},u}(c.a),O=function(){var U=function(u,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,g){l.__proto__=g}||function(l,g){for(var K in g)Object.prototype.hasOwnProperty.call(g,K)&&(l[K]=g[K])})(u,d)};return function(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function l(){this.constructor=u}U(u,d),u.prototype=d===null?Object.create(d):(l.prototype=d.prototype,new l)}}(),G=(function(U){function u(d,l){var g=U.call(this,"xhr-msstream-loader")||this;return g.TAG="MSStreamLoader",g._seekHandler=d,g._config=l,g._needStash=!0,g._xhr=null,g._reader=null,g._totalRange=null,g._currentRange=null,g._currentRequestURL=null,g._currentRedirectedURL=null,g._contentLength=null,g._receivedLength=0,g._bufferLimit=16777216,g._lastTimeBufferSize=0,g._isReconnecting=!1,g}O(u,U),u.isSupported=function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="ms-stream",d.responseType==="ms-stream"}catch(l){return T.a.w("MSStreamLoader",l.message),!1}},u.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),U.prototype.destroy.call(this)},u.prototype.open=function(d,l){this._internalOpen(d,l,!1)},u.prototype._internalOpen=function(d,l,g){this._dataSource=d,g?this._currentRange=l:this._totalRange=l;var K=d.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?K=this._currentRedirectedURL:d.redirectedURL!=null&&(K=d.redirectedURL));var $=this._seekHandler.getConfig(K,l);this._currentRequestURL=$.url;var ae=this._reader=new self.MSStreamReader;ae.onprogress=this._msrOnProgress.bind(this),ae.onload=this._msrOnLoad.bind(this),ae.onerror=this._msrOnError.bind(this);var de=this._xhr=new XMLHttpRequest;if(de.open("GET",$.url,!0),de.responseType="ms-stream",de.onreadystatechange=this._xhrOnReadyStateChange.bind(this),de.onerror=this._xhrOnError.bind(this),d.withCredentials&&(de.withCredentials=!0),typeof $.headers=="object"){var H=$.headers;for(var ne in H)H.hasOwnProperty(ne)&&de.setRequestHeader(ne,H[ne])}if(typeof this._config.headers=="object"){H=this._config.headers;for(var ne in H)H.hasOwnProperty(ne)&&de.setRequestHeader(ne,H[ne])}this._isReconnecting?this._isReconnecting=!1:this._status=c.c.kConnecting,de.send()},u.prototype.abort=function(){this._internalAbort(),this._status=c.c.kComplete},u.prototype._internalAbort=function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},u.prototype._xhrOnReadyStateChange=function(d){var l=d.target;if(l.readyState===2)if(l.status>=200&&l.status<=299){if(this._status=c.c.kBuffering,l.responseURL!=null){var g=this._seekHandler.removeURLParameters(l.responseURL);l.responseURL!==this._currentRequestURL&&g!==this._currentRedirectedURL&&(this._currentRedirectedURL=g,this._onURLRedirect&&this._onURLRedirect(g))}var K=l.getResponseHeader("Content-Length");if(K!=null&&this._contentLength==null){var $=parseInt(K);$>0&&(this._contentLength=$,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=c.c.kError,!this._onError)throw new a.d("MSStreamLoader: Http code invalid, "+l.status+" "+l.statusText);this._onError(c.b.HTTP_STATUS_CODE_INVALID,{code:l.status,msg:l.statusText})}else if(l.readyState===3&&l.status>=200&&l.status<=299){this._status=c.c.kBuffering;var ae=l.response;this._reader.readAsArrayBuffer(ae)}},u.prototype._xhrOnError=function(d){this._status=c.c.kError;var l=c.b.EXCEPTION,g={code:-1,msg:d.constructor.name+" "+d.type};if(!this._onError)throw new a.d(g.msg);this._onError(l,g)},u.prototype._msrOnProgress=function(d){var l=d.target.result;if(l!=null){var g=l.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=l.byteLength;var K=this._totalRange.from+this._receivedLength;this._receivedLength+=g.byteLength,this._onDataArrival&&this._onDataArrival(g,K,this._receivedLength),l.byteLength>=this._bufferLimit&&(T.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(K+g.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},u.prototype._doReconnectIfNeeded=function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var d={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,d,!0)}},u.prototype._msrOnLoad=function(d){this._status=c.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},u.prototype._msrOnError=function(d){this._status=c.c.kError;var l=0,g=null;if(this._contentLength&&this._receivedLength<this._contentLength?(l=c.b.EARLY_EOF,g={code:-1,msg:"MSStream meet Early-Eof"}):(l=c.b.EARLY_EOF,g={code:-1,msg:d.constructor.name+" "+d.type}),!this._onError)throw new a.d(g.msg);this._onError(l,g)}}(c.a),function(){var U=function(u,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,g){l.__proto__=g}||function(l,g){for(var K in g)Object.prototype.hasOwnProperty.call(g,K)&&(l[K]=g[K])})(u,d)};return function(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function l(){this.constructor=u}U(u,d),u.prototype=d===null?Object.create(d):(l.prototype=d.prototype,new l)}}()),I=function(U){function u(d,l){var g=U.call(this,"xhr-range-loader")||this;return g.TAG="RangeLoader",g._seekHandler=d,g._config=l,g._needStash=!1,g._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],g._currentChunkSizeKB=384,g._currentSpeedNormalized=0,g._zeroSpeedChunkCount=0,g._xhr=null,g._speedSampler=new L,g._requestAbort=!1,g._waitForTotalLength=!1,g._totalLengthReceived=!1,g._currentRequestURL=null,g._currentRedirectedURL=null,g._currentRequestRange=null,g._totalLength=null,g._contentLength=null,g._receivedLength=0,g._lastTimeLoaded=0,g}return G(u,U),u.isSupported=function(){try{var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="arraybuffer",d.responseType==="arraybuffer"}catch(l){return T.a.w("RangeLoader",l.message),!1}},u.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),U.prototype.destroy.call(this)},Object.defineProperty(u.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),u.prototype.open=function(d,l){this._dataSource=d,this._range=l,this._status=c.c.kConnecting;var g=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(g=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||g?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},u.prototype._openSubRange=function(){var d=1024*this._currentChunkSizeKB,l=this._range.from+this._receivedLength,g=l+d;this._contentLength!=null&&g-this._range.from>=this._contentLength&&(g=this._range.from+this._contentLength-1),this._currentRequestRange={from:l,to:g},this._internalOpen(this._dataSource,this._currentRequestRange)},u.prototype._internalOpen=function(d,l){this._lastTimeLoaded=0;var g=d.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?g=this._currentRedirectedURL:d.redirectedURL!=null&&(g=d.redirectedURL));var K=this._seekHandler.getConfig(g,l);this._currentRequestURL=K.url;var $=this._xhr=new XMLHttpRequest;if($.open("GET",K.url,!0),$.responseType="arraybuffer",$.onreadystatechange=this._onReadyStateChange.bind(this),$.onprogress=this._onProgress.bind(this),$.onload=this._onLoad.bind(this),$.onerror=this._onXhrError.bind(this),d.withCredentials&&($.withCredentials=!0),typeof K.headers=="object"){var ae=K.headers;for(var de in ae)ae.hasOwnProperty(de)&&$.setRequestHeader(de,ae[de])}if(typeof this._config.headers=="object"){ae=this._config.headers;for(var de in ae)ae.hasOwnProperty(de)&&$.setRequestHeader(de,ae[de])}$.send()},u.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=c.c.kComplete},u.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},u.prototype._onReadyStateChange=function(d){var l=d.target;if(l.readyState===2){if(l.responseURL!=null){var g=this._seekHandler.removeURLParameters(l.responseURL);l.responseURL!==this._currentRequestURL&&g!==this._currentRedirectedURL&&(this._currentRedirectedURL=g,this._onURLRedirect&&this._onURLRedirect(g))}if(l.status>=200&&l.status<=299){if(this._waitForTotalLength)return;this._status=c.c.kBuffering}else{if(this._status=c.c.kError,!this._onError)throw new a.d("RangeLoader: Http code invalid, "+l.status+" "+l.statusText);this._onError(c.b.HTTP_STATUS_CODE_INVALID,{code:l.status,msg:l.statusText})}}},u.prototype._onProgress=function(d){if(this._status!==c.c.kError){if(this._contentLength===null){var l=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,l=!0;var g=d.total;this._internalAbort(),g!=null&g!==0&&(this._totalLength=g)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,l)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var K=d.loaded-this._lastTimeLoaded;this._lastTimeLoaded=d.loaded,this._speedSampler.addBytes(K)}},u.prototype._normalizeSpeed=function(d){var l=this._chunkSizeKBList,g=l.length-1,K=0,$=0,ae=g;if(d<l[0])return l[0];for(;$<=ae;){if((K=$+Math.floor((ae-$)/2))===g||d>=l[K]&&d<l[K+1])return l[K];l[K]<d?$=K+1:ae=K-1}},u.prototype._onLoad=function(d){if(this._status!==c.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var l=this._speedSampler.lastSecondKBps;if(l===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(l=this._speedSampler.currentKBps)),l!==0){var g=this._normalizeSpeed(l);this._currentSpeedNormalized!==g&&(this._currentSpeedNormalized=g,this._currentChunkSizeKB=g)}var K=d.target.response,$=this._range.from+this._receivedLength;this._receivedLength+=K.byteLength;var ae=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():ae=!0,this._onDataArrival&&this._onDataArrival(K,$,this._receivedLength),ae&&(this._status=c.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},u.prototype._onXhrError=function(d){this._status=c.c.kError;var l=0,g=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(l=c.b.EARLY_EOF,g={code:-1,msg:"RangeLoader meet Early-Eof"}):(l=c.b.EXCEPTION,g={code:-1,msg:d.constructor.name+" "+d.type}),!this._onError)throw new a.d(g.msg);this._onError(l,g)},u}(c.a),z=function(){var U=function(u,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,g){l.__proto__=g}||function(l,g){for(var K in g)Object.prototype.hasOwnProperty.call(g,K)&&(l[K]=g[K])})(u,d)};return function(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function l(){this.constructor=u}U(u,d),u.prototype=d===null?Object.create(d):(l.prototype=d.prototype,new l)}}(),q=function(U){function u(){var d=U.call(this,"websocket-loader")||this;return d.TAG="WebSocketLoader",d._needStash=!0,d._ws=null,d._requestAbort=!1,d._receivedLength=0,d}return z(u,U),u.isSupported=function(){try{return self.WebSocket!==void 0}catch{return!1}},u.prototype.destroy=function(){this._ws&&this.abort(),U.prototype.destroy.call(this)},u.prototype.open=function(d){try{var l=this._ws=new self.WebSocket(d.url);l.binaryType="arraybuffer",l.onopen=this._onWebSocketOpen.bind(this),l.onclose=this._onWebSocketClose.bind(this),l.onmessage=this._onWebSocketMessage.bind(this),l.onerror=this._onWebSocketError.bind(this),this._status=c.c.kConnecting}catch(K){this._status=c.c.kError;var g={code:K.code,msg:K.message};if(!this._onError)throw new a.d(g.msg);this._onError(c.b.EXCEPTION,g)}},u.prototype.abort=function(){var d=this._ws;!d||d.readyState!==0&&d.readyState!==1||(this._requestAbort=!0,d.close()),this._ws=null,this._status=c.c.kComplete},u.prototype._onWebSocketOpen=function(d){this._status=c.c.kBuffering},u.prototype._onWebSocketClose=function(d){this._requestAbort!==!0?(this._status=c.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},u.prototype._onWebSocketMessage=function(d){var l=this;if(d.data instanceof ArrayBuffer)this._dispatchArrayBuffer(d.data);else if(d.data instanceof Blob){var g=new FileReader;g.onload=function(){l._dispatchArrayBuffer(g.result)},g.readAsArrayBuffer(d.data)}else{this._status=c.c.kError;var K={code:-1,msg:"Unsupported WebSocket message type: "+d.data.constructor.name};if(!this._onError)throw new a.d(K.msg);this._onError(c.b.EXCEPTION,K)}},u.prototype._dispatchArrayBuffer=function(d){var l=d,g=this._receivedLength;this._receivedLength+=l.byteLength,this._onDataArrival&&this._onDataArrival(l,g,this._receivedLength)},u.prototype._onWebSocketError=function(d){this._status=c.c.kError;var l={code:d.code,msg:d.message};if(!this._onError)throw new a.d(l.msg);this._onError(c.b.EXCEPTION,l)},u}(c.a),C=function(){function U(u){this._zeroStart=u||!1}return U.prototype.getConfig=function(u,d){var l={};if(d.from!==0||d.to!==-1){var g=void 0;g=d.to!==-1?"bytes=".concat(d.from.toString(),"-").concat(d.to.toString()):"bytes=".concat(d.from.toString(),"-"),l.Range=g}else this._zeroStart&&(l.Range="bytes=0-");return{url:u,headers:l}},U.prototype.removeURLParameters=function(u){return u},U}(),J=function(){function U(u,d){this._startName=u,this._endName=d}return U.prototype.getConfig=function(u,d){var l=u;if(d.from!==0||d.to!==-1){var g=!0;l.indexOf("?")===-1&&(l+="?",g=!1),g&&(l+="&"),l+="".concat(this._startName,"=").concat(d.from.toString()),d.to!==-1&&(l+="&".concat(this._endName,"=").concat(d.to.toString()))}return{url:l,headers:{}}},U.prototype.removeURLParameters=function(u){var d=u.split("?")[0],l=void 0,g=u.indexOf("?");g!==-1&&(l=u.substring(g+1));var K="";if(l!=null&&l.length>0)for(var $=l.split("&"),ae=0;ae<$.length;ae++){var de=$[ae].split("="),H=ae>0;de[0]!==this._startName&&de[0]!==this._endName&&(H&&(K+="&"),K+=$[ae])}return K.length===0?d:d+"?"+K},U}(),ee=function(){function U(u,d,l){this.TAG="IOController",this._config=d,this._extraData=l,this._stashInitialSize=65536,d.stashInitialSize!=null&&d.stashInitialSize>0&&(this._stashInitialSize=d.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,d.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=u,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(u.url),this._refTotalLength=u.filesize?u.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new L,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return U.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},U.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},U.prototype.isPaused=function(){return this._paused},Object.defineProperty(U.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"extraData",{get:function(){return this._extraData},set:function(u){this._extraData=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(u){this._onDataArrival=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(u){this._onSeeked=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onError",{get:function(){return this._onError},set:function(u){this._onError=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onComplete",{get:function(){return this._onComplete},set:function(u){this._onComplete=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(u){this._onRedirect=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(u){this._onRecoveredEarlyEof=u},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"currentSpeed",{get:function(){return this._loaderClass===I?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),U.prototype._selectSeekHandler=function(){var u=this._config;if(u.seekType==="range")this._seekHandler=new C(this._config.rangeLoadZeroStart);else if(u.seekType==="param"){var d=u.seekParamStart||"bstart",l=u.seekParamEnd||"bend";this._seekHandler=new J(d,l)}else{if(u.seekType!=="custom")throw new a.b("Invalid seekType in config: ".concat(u.seekType));if(typeof u.customSeekHandler!="function")throw new a.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new u.customSeekHandler}},U.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=q;else if(f.isSupported())this._loaderClass=f;else if(E.isSupported())this._loaderClass=E;else{if(!I.isSupported())throw new a.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=I}},U.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},U.prototype.open=function(u){this._currentRange={from:0,to:-1},u&&(this._currentRange.from=u),this._speedSampler.reset(),u||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},U.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},U.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},U.prototype.resume=function(){if(this._paused){this._paused=!1;var u=this._resumeFrom;this._resumeFrom=0,this._internalSeek(u,!0)}},U.prototype.seek=function(u){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(u,!0)},U.prototype._internalSeek=function(u,d){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(d),this._loader.destroy(),this._loader=null;var l={from:u,to:-1};this._currentRange={from:l.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,l),this._onSeeked&&this._onSeeked()},U.prototype.updateUrl=function(u){if(!u||typeof u!="string"||u.length===0)throw new a.b("Url must be a non-empty string!");this._dataSource.url=u},U.prototype._expandBuffer=function(u){for(var d=this._stashSize;d+1048576<u;)d*=2;if((d+=1048576)!==this._bufferSize){var l=new ArrayBuffer(d);if(this._stashUsed>0){var g=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(l,0,d).set(g,0)}this._stashBuffer=l,this._bufferSize=d}},U.prototype._normalizeSpeed=function(u){var d=this._speedNormalizeList,l=d.length-1,g=0,K=0,$=l;if(u<d[0])return d[0];for(;K<=$;){if((g=K+Math.floor(($-K)/2))===l||u>=d[g]&&u<d[g+1])return d[g];d[g]<u?K=g+1:$=g-1}},U.prototype._adjustStashSize=function(u){var d=0;(d=this._config.isLive?u/8:u<512?u:u>=512&&u<=1024?Math.floor(1.5*u):2*u)>8192&&(d=8192);var l=1024*d+1048576;this._bufferSize<l&&this._expandBuffer(l),this._stashSize=1024*d},U.prototype._dispatchChunks=function(u,d){return this._currentRange.to=d+u.byteLength-1,this._onDataArrival(u,d)},U.prototype._onURLRedirect=function(u){this._redirectedURL=u,this._onRedirect&&this._onRedirect(u)},U.prototype._onContentLengthKnown=function(u){u&&this._fullRequestFlag&&(this._totalLength=u,this._fullRequestFlag=!1)},U.prototype._onLoaderChunkArrival=function(u,d,l){if(!this._onDataArrival)throw new a.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(u.byteLength);var g=this._speedSampler.lastSecondKBps;if(g!==0){var K=this._normalizeSpeed(g);this._speedNormalized!==K&&(this._speedNormalized=K,this._adjustStashSize(K))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=d),this._stashUsed+u.byteLength<=this._stashSize)(de=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(u),this._stashUsed),this._stashUsed+=u.byteLength;else if(de=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var $=this._stashBuffer.slice(0,this._stashUsed);(H=this._dispatchChunks($,this._stashByteStart))<$.byteLength?H>0&&(ne=new Uint8Array($,H),de.set(ne,0),this._stashUsed=ne.byteLength,this._stashByteStart+=H):(this._stashUsed=0,this._stashByteStart+=H),this._stashUsed+u.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+u.byteLength),de=new Uint8Array(this._stashBuffer,0,this._bufferSize)),de.set(new Uint8Array(u),this._stashUsed),this._stashUsed+=u.byteLength}else(H=this._dispatchChunks(u,d))<u.byteLength&&((ae=u.byteLength-H)>this._bufferSize&&(this._expandBuffer(ae),de=new Uint8Array(this._stashBuffer,0,this._bufferSize)),de.set(new Uint8Array(u,H),0),this._stashUsed+=ae,this._stashByteStart=d+H);else if(this._stashUsed===0){var ae;(H=this._dispatchChunks(u,d))<u.byteLength&&((ae=u.byteLength-H)>this._bufferSize&&this._expandBuffer(ae),(de=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(u,H),0),this._stashUsed+=ae,this._stashByteStart=d+H)}else{var de,H;if(this._stashUsed+u.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+u.byteLength),(de=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(u),this._stashUsed),this._stashUsed+=u.byteLength,(H=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&H>0){var ne=new Uint8Array(this._stashBuffer,H);de.set(ne,0)}this._stashUsed-=H,this._stashByteStart+=H}}},U.prototype._flushStashBuffer=function(u){if(this._stashUsed>0){var d=this._stashBuffer.slice(0,this._stashUsed),l=this._dispatchChunks(d,this._stashByteStart),g=d.byteLength-l;if(l<d.byteLength){if(!u){if(l>0){var K=new Uint8Array(this._stashBuffer,0,this._bufferSize),$=new Uint8Array(d,l);K.set($,0),this._stashUsed=$.byteLength,this._stashByteStart+=l}return 0}T.a.w(this.TAG,"".concat(g," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,g}return 0},U.prototype._onLoaderComplete=function(u,d){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},U.prototype._onLoaderError=function(u,d){switch(T.a.e(this.TAG,"Loader error, code = ".concat(d.code,", msg = ").concat(d.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,u=c.b.UNRECOVERABLE_EARLY_EOF),u){case c.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var l=this._currentRange.to+1;return void(l<this._totalLength&&(T.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(l,!1)))}u=c.b.UNRECOVERABLE_EARLY_EOF;break;case c.b.UNRECOVERABLE_EARLY_EOF:case c.b.CONNECTING_TIMEOUT:case c.b.HTTP_STATUS_CODE_INVALID:case c.b.EXCEPTION:}if(!this._onError)throw new a.d("IOException: "+d.msg);this._onError(u,d)},U}();_e.a=ee},function(ge,_e,x){var V=x(10),T=x.n(V),L=x(0),c=x(5),y=x(13);function a(t,e,i){var o=t;if(e+i<o.length){for(;i--;)if((192&o[++e])!=128)return!1;return!0}return!1}var h,f=function(t){for(var e=[],i=t,o=0,r=t.length;o<r;)if(i[o]<128)e.push(String.fromCharCode(i[o])),++o;else{if(!(i[o]<192)){if(i[o]<224){if(a(i,o,1)&&(v=(31&i[o])<<6|63&i[o+1])>=128){e.push(String.fromCharCode(65535&v)),o+=2;continue}}else if(i[o]<240){if(a(i,o,2)&&(v=(15&i[o])<<12|(63&i[o+1])<<6|63&i[o+2])>=2048&&(63488&v)!=55296){e.push(String.fromCharCode(65535&v)),o+=3;continue}}else if(i[o]<248){var v;if(a(i,o,3)&&(v=(7&i[o])<<18|(63&i[o+1])<<12|(63&i[o+2])<<6|63&i[o+3])>65536&&v<1114112){v-=65536,e.push(String.fromCharCode(v>>>10|55296)),e.push(String.fromCharCode(1023&v|56320)),o+=4;continue}}}e.push(""),++o}return e.join("")},A=x(3),E=(h=new ArrayBuffer(2),new DataView(h).setInt16(0,256,!0),new Int16Array(h)[0]===256),O=function(){function t(){}return t.parseScriptData=function(e,i,o){var r={};try{var v=t.parseValue(e,i,o),k=t.parseValue(e,i+v.size,o-v.size);r[v.data]=k.data}catch(b){L.a.e("AMF",b.toString())}return r},t.parseObject=function(e,i,o){if(o<3)throw new A.a("Data not enough when parse ScriptDataObject");var r=t.parseString(e,i,o),v=t.parseValue(e,i+r.size,o-r.size),k=v.objectEnd;return{data:{name:r.data,value:v.data},size:r.size+v.size,objectEnd:k}},t.parseVariable=function(e,i,o){return t.parseObject(e,i,o)},t.parseString=function(e,i,o){if(o<2)throw new A.a("Data not enough when parse String");var r=new DataView(e,i,o).getUint16(0,!E);return{data:r>0?f(new Uint8Array(e,i+2,r)):"",size:2+r}},t.parseLongString=function(e,i,o){if(o<4)throw new A.a("Data not enough when parse LongString");var r=new DataView(e,i,o).getUint32(0,!E);return{data:r>0?f(new Uint8Array(e,i+4,r)):"",size:4+r}},t.parseDate=function(e,i,o){if(o<10)throw new A.a("Data size invalid when parse Date");var r=new DataView(e,i,o),v=r.getFloat64(0,!E),k=r.getInt16(8,!E);return{data:new Date(v+=60*k*1e3),size:10}},t.parseValue=function(e,i,o){if(o<1)throw new A.a("Data not enough when parse Value");var r,v=new DataView(e,i,o),k=1,b=v.getUint8(0),w=!1;try{switch(b){case 0:r=v.getFloat64(1,!E),k+=8;break;case 1:r=!!v.getUint8(1),k+=1;break;case 2:var N=t.parseString(e,i+1,o-1);r=N.data,k+=N.size;break;case 3:r={};var F=0;for((16777215&v.getUint32(o-4,!E))==9&&(F=3);k<o-4;){var P=t.parseObject(e,i+k,o-k-F);if(P.objectEnd)break;r[P.data.name]=P.data.value,k+=P.size}k<=o-3&&(16777215&v.getUint32(k-1,!E))===9&&(k+=3);break;case 8:for(r={},k+=4,F=0,(16777215&v.getUint32(o-4,!E))==9&&(F=3);k<o-8;){var W=t.parseVariable(e,i+k,o-k-F);if(W.objectEnd)break;r[W.data.name]=W.data.value,k+=W.size}k<=o-3&&(16777215&v.getUint32(k-1,!E))===9&&(k+=3);break;case 9:r=void 0,k=1,w=!0;break;case 10:r=[];var te=v.getUint32(1,!E);k+=4;for(var ie=0;ie<te;ie++){var ce=t.parseValue(e,i+k,o-k);r.push(ce.data),k+=ce.size}break;case 11:var se=t.parseDate(e,i+1,o-1);r=se.data,k+=se.size;break;case 12:var me=t.parseString(e,i+1,o-1);r=me.data,k+=me.size;break;default:k=o,L.a.w("AMF","Unsupported AMF value type "+b)}}catch(oe){L.a.e("AMF",oe.toString())}return{data:r,size:k,objectEnd:w}},t}(),G=x(23),I=x(6),z=x(15);function q(t){return t.byteOffset%2==0&&t.byteLength%2==0}function C(t){return t.byteOffset%4==0&&t.byteLength%4==0}function J(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var ee=function(t,e){return t.byteLength===e.byteLength&&(C(t)&&C(e)?function(i,o){return J(new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4),new Uint32Array(o.buffer,o.byteOffset,o.byteLength/4))}(t,e):q(t)&&q(e)?function(i,o){return J(new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),new Uint16Array(o.buffer,o.byteOffset,o.byteLength/2))}(t,e):function(i,o){return J(i,o)}(t,e))},U=x(16),u=x(8),d=function(){function t(e,i){this.TAG="FLVDemuxer",this._config=i,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new y.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var o=new ArrayBuffer(2);return new DataView(o).setInt16(0,256,!0),new Int16Array(o)[0]===256}()}return t.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},t.probe=function(e){var i=new Uint8Array(e);if(i.byteLength<9)return{needMoreData:!0};var o={match:!1};if(i[0]!==70||i[1]!==76||i[2]!==86||i[3]!==1)return o;var r,v,k=(4&i[4])>>>2!=0,b=(1&i[4])!=0,w=(r=i)[v=5]<<24|r[v+1]<<16|r[v+2]<<8|r[v+3];return w<9?o:{match:!0,consumed:w,dataOffset:w,hasAudioTrack:k,hasVideoTrack:b}},t.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(t.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(e){this._timestampBase=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"overridedDuration",{get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"overridedHasAudio",{set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"overridedHasVideo",{set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e},enumerable:!1,configurable:!0}),t.prototype.resetMediaInfo=function(){this._mediaInfo=new y.a},t.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},t.prototype.parseChunks=function(e,i){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new A.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var o=0,r=this._littleEndian;if(i===0){if(!(e.byteLength>13))return 0;o=t.probe(e).dataOffset}for(this._firstParse&&(this._firstParse=!1,i+o!==this._dataOffset&&L.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(v=new DataView(e,o)).getUint32(0,!r)!==0&&L.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),o+=4);o<e.byteLength;){this._dispatch=!0;var v=new DataView(e,o);if(o+11+4>e.byteLength)break;var k=v.getUint8(0),b=16777215&v.getUint32(0,!r);if(o+11+b+4>e.byteLength)break;if(k===8||k===9||k===18){var w=v.getUint8(4),N=v.getUint8(5),F=v.getUint8(6)|N<<8|w<<16|v.getUint8(7)<<24;16777215&v.getUint32(7,!r)&&L.a.w(this.TAG,"Meet tag which has StreamID != 0!");var P=o+11;switch(k){case 8:this._parseAudioData(e,P,b,F);break;case 9:this._parseVideoData(e,P,b,F,i+o);break;case 18:this._parseScriptData(e,P,b)}var W=v.getUint32(11+b,!r);W!==11+b&&L.a.w(this.TAG,"Invalid PrevTagSize ".concat(W)),o+=11+b+4}else L.a.w(this.TAG,"Unsupported tag type ".concat(k,", skipped")),o+=11+b+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),o},t.prototype._parseScriptData=function(e,i,o){var r=O.parseScriptData(e,i,o);if(r.hasOwnProperty("onMetaData")){if(r.onMetaData==null||typeof r.onMetaData!="object")return void L.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&L.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=r;var v=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},v)),typeof v.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=v.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof v.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=v.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof v.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=v.audiodatarate),typeof v.videodatarate=="number"&&(this._mediaInfo.videoDataRate=v.videodatarate),typeof v.width=="number"&&(this._mediaInfo.width=v.width),typeof v.height=="number"&&(this._mediaInfo.height=v.height),typeof v.duration=="number"){if(!this._durationOverrided){var k=Math.floor(v.duration*this._timescale);this._duration=k,this._mediaInfo.duration=k}}else this._mediaInfo.duration=0;if(typeof v.framerate=="number"){var b=Math.floor(1e3*v.framerate);if(b>0){var w=b/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=w,this._referenceFrameRate.fps_num=b,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=w}}if(typeof v.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var N=v.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(N),v.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=v,L.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(r).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},r))},t.prototype._parseKeyframesIndex=function(e){for(var i=[],o=[],r=1;r<e.times.length;r++){var v=this._timestampBase+Math.floor(1e3*e.times[r]);i.push(v),o.push(e.filepositions[r])}return{times:i,filepositions:o}},t.prototype._parseAudioData=function(e,i,o,r){if(o<=1)L.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var v=new DataView(e,i,o).getUint8(0),k=v>>>4;if(k!==9)if(k===2||k===3||k===10){var b=0,w=(12&v)>>>2;if(w>=0&&w<=4){b=this._flvSoundRateTable[w];var N=(2&v)>>>1,F=1&v,P=this._audioMetadata,W=this._audioTrack;if(P||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(P=this._audioMetadata={}).type="audio",P.id=W.id,P.timescale=this._timescale,P.duration=this._duration,P.audioSampleRate=b,P.channelCount=F===0?1:2),k===10){var te=this._parseAACAudioData(e,i+1,o-1);if(te==null)return;if(te.packetType===0){if(P.config){if(ee(te.data.config,P.config))return;L.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var ie=te.data;P.audioSampleRate=ie.samplingRate,P.channelCount=ie.channelCount,P.codec=ie.codec,P.originalCodec=ie.originalCodec,P.config=ie.config,P.refSampleDuration=1024/P.audioSampleRate*P.timescale,L.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",P),(oe=this._mediaInfo).audioCodec=P.originalCodec,oe.audioSampleRate=P.audioSampleRate,oe.audioChannelCount=P.channelCount,oe.hasVideo?oe.videoCodec!=null&&(oe.mimeType='video/x-flv; codecs="'+oe.videoCodec+","+oe.audioCodec+'"'):oe.mimeType='video/x-flv; codecs="'+oe.audioCodec+'"',oe.isComplete()&&this._onMediaInfo(oe)}else if(te.packetType===1){var ce=this._timestampBase+r,se={unit:te.data,length:te.data.byteLength,dts:ce,pts:ce};W.samples.push(se),W.length+=te.data.length}else L.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(te.packetType))}else if(k===2){if(!P.codec){if((ie=this._parseMP3AudioData(e,i+1,o-1,!0))==null)return;P.audioSampleRate=ie.samplingRate,P.channelCount=ie.channelCount,P.codec=ie.codec,P.originalCodec=ie.originalCodec,P.refSampleDuration=1152/P.audioSampleRate*P.timescale,L.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",P),(oe=this._mediaInfo).audioCodec=P.codec,oe.audioSampleRate=P.audioSampleRate,oe.audioChannelCount=P.channelCount,oe.audioDataRate=ie.bitRate,oe.hasVideo?oe.videoCodec!=null&&(oe.mimeType='video/x-flv; codecs="'+oe.videoCodec+","+oe.audioCodec+'"'):oe.mimeType='video/x-flv; codecs="'+oe.audioCodec+'"',oe.isComplete()&&this._onMediaInfo(oe)}if((ue=this._parseMP3AudioData(e,i+1,o-1,!1))==null)return;ce=this._timestampBase+r;var me={unit:ue,length:ue.byteLength,dts:ce,pts:ce};W.samples.push(me),W.length+=ue.length}else if(k===3){var oe;P.codec||(P.audioSampleRate=b,P.sampleSize=8*(N+1),P.littleEndian=!0,P.codec="ipcm",P.originalCodec="ipcm",this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",P),(oe=this._mediaInfo).audioCodec=P.codec,oe.audioSampleRate=P.audioSampleRate,oe.audioChannelCount=P.channelCount,oe.audioDataRate=P.sampleSize*P.audioSampleRate,oe.hasVideo?oe.videoCodec!=null&&(oe.mimeType='video/x-flv; codecs="'+oe.videoCodec+","+oe.audioCodec+'"'):oe.mimeType='video/x-flv; codecs="'+oe.audioCodec+'"',oe.isComplete()&&this._onMediaInfo(oe));var ue=new Uint8Array(e,i+1,o-1),ye=(ce=this._timestampBase+r,{unit:ue,length:ue.byteLength,dts:ce,pts:ce});W.samples.push(ye),W.length+=ue.length}}else this._onError(I.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+w)}else this._onError(I.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+k);else{if(o<=5)return void L.a.w(this.TAG,"Flv: Invalid audio packet, missing AudioFourCC in Ehnanced FLV payload!");var Re=15&v,fe=String.fromCharCode.apply(String,new Uint8Array(e,i,o).slice(1,5));switch(fe){case"Opus":this._parseOpusAudioPacket(e,i+5,o-5,r,Re);break;case"fLaC":this._parseFlacAudioPacket(e,i+5,o-5,r,Re);break;default:this._onError(I.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec: "+fe)}}}},t.prototype._parseAACAudioData=function(e,i,o){if(!(o<=1)){var r={},v=new Uint8Array(e,i,o);return r.packetType=v[0],v[0]===0?r.data=this._parseAACAudioSpecificConfig(e,i+1,o-1):r.data=v.subarray(1),r}L.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},t.prototype._parseAACAudioSpecificConfig=function(e,i,o){var r,v,k=new Uint8Array(e,i,o),b=null,w=0,N=null;if(w=r=k[0]>>>3,(v=(7&k[0])<<1|k[1]>>>7)<0||v>=this._mpegSamplingRates.length)this._onError(I.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var F=this._mpegSamplingRates[v],P=(120&k[1])>>>3;if(!(P<0||P>=8)){w===5&&(N=(7&k[1])<<1|k[2]>>>7,(124&k[2])>>>2);var W=self.navigator.userAgent.toLowerCase();return W.indexOf("firefox")!==-1?v>=6?(w=5,b=new Array(4),N=v-3):(w=2,b=new Array(2),N=v):W.indexOf("android")!==-1?(w=2,b=new Array(2),N=v):(w=5,N=v,b=new Array(4),v>=6?N=v-3:P===1&&(w=2,b=new Array(2),N=v)),b[0]=w<<3,b[0]|=(15&v)>>>1,b[1]=(15&v)<<7,b[1]|=(15&P)<<3,w===5&&(b[1]|=(15&N)>>>1,b[2]=(1&N)<<7,b[2]|=8,b[3]=0),{config:b,samplingRate:F,channelCount:P,codec:"mp4a.40."+w,originalCodec:"mp4a.40."+r}}this._onError(I.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},t.prototype._parseMP3AudioData=function(e,i,o,r){if(!(o<4)){this._littleEndian;var v=new Uint8Array(e,i,o),k=null;if(r){if(v[0]!==255)return;var b=v[1]>>>3&3,w=(6&v[1])>>1,N=(240&v[2])>>>4,F=(12&v[2])>>>2,P=(v[3]>>>6&3)!==3?2:1,W=0,te=0;switch(b){case 0:W=this._mpegAudioV25SampleRateTable[F];break;case 2:W=this._mpegAudioV20SampleRateTable[F];break;case 3:W=this._mpegAudioV10SampleRateTable[F]}switch(w){case 1:N<this._mpegAudioL3BitRateTable.length&&(te=this._mpegAudioL3BitRateTable[N]);break;case 2:N<this._mpegAudioL2BitRateTable.length&&(te=this._mpegAudioL2BitRateTable[N]);break;case 3:N<this._mpegAudioL1BitRateTable.length&&(te=this._mpegAudioL1BitRateTable[N])}k={bitRate:te,samplingRate:W,channelCount:P,codec:"mp3",originalCodec:"mp3"}}else k=v;return k}L.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},t.prototype._parseOpusAudioPacket=function(e,i,o,r,v){if(v===0)this._parseOpusSequenceHeader(e,i,o);else if(v===1)this._parseOpusAudioData(e,i,o,r);else if(v!==2)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(v))},t.prototype._parseOpusSequenceHeader=function(e,i,o){if(o<=16)L.a.w(this.TAG,"Flv: Invalid OpusSequenceHeader, lack of data!");else{var r=this._audioMetadata,v=this._audioTrack;r||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(r=this._audioMetadata={}).type="audio",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration);var k=new DataView(e,i,o);k.setUint8(8,0);var b=k.getUint8(9);k.setUint16(10,k.getUint16(10,!0),!1);var w=k.getUint32(12,!0);k.setUint32(12,k.getUint32(12,!0),!1);var N={config:new Uint8Array(e,i+8,o-8),channelCount:b,samplingFrequence:w,codec:"opus",originalCodec:"opus"};if(r.config){if(ee(N.config,r.config))return;L.a.w(this.TAG,"OpusSequenceHeader has been changed, re-generate initialization segment")}r.audioSampleRate=N.samplingFrequence,r.channelCount=N.channelCount,r.codec=N.codec,r.originalCodec=N.originalCodec,r.config=N.config,r.refSampleDuration=20,L.a.v(this.TAG,"Parsed OpusSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",r);var F=this._mediaInfo;F.audioCodec=r.originalCodec,F.audioSampleRate=r.audioSampleRate,F.audioChannelCount=r.channelCount,F.hasVideo?F.videoCodec!=null&&(F.mimeType='video/x-flv; codecs="'+F.videoCodec+","+F.audioCodec+'"'):F.mimeType='video/x-flv; codecs="'+F.audioCodec+'"',F.isComplete()&&this._onMediaInfo(F)}},t.prototype._parseOpusAudioData=function(e,i,o,r){var v=this._audioTrack,k=new Uint8Array(e,i,o),b=this._timestampBase+r,w={unit:k,length:k.byteLength,dts:b,pts:b};v.samples.push(w),v.length+=k.length},t.prototype._parseFlacAudioPacket=function(e,i,o,r,v){if(v===0)this._parseFlacSequenceHeader(e,i,o);else if(v===1)this._parseFlacAudioData(e,i,o,r);else if(v!==2)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid Flac audio packet type ".concat(v))},t.prototype._parseFlacSequenceHeader=function(e,i,o){var r=this._audioMetadata,v=this._audioTrack;r||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(r=this._audioMetadata={}).type="audio",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration);var k=new Uint8Array(e,i+4,o-4),b=new u.a(k),w=b.readBits(16),N=b.readBits(16),F=N===w?N:null;b.readBits(24),b.readBits(24);var P=b.readBits(20),W=b.readBits(3)+1,te=b.readBits(5)+1;b.destroy();var ie=new Uint8Array(k.byteLength+4);ie.set(k,4),ie[0]=128,ie[1]=k.byteLength>>>16&255,ie[2]=k.byteLength>>>8&255,ie[3]=k.byteLength>>>0&255;var ce={config:ie,channelCount:W,samplingFrequence:P,sampleSize:te,codec:"flac",originalCodec:"flac"};if(r.config){if(ee(ce.config,r.config))return;L.a.w(this.TAG,"FlacSequenceHeader has been changed, re-generate initialization segment")}r.audioSampleRate=ce.samplingFrequence,r.channelCount=ce.channelCount,r.sampleSize=ce.sampleSize,r.codec=ce.codec,r.originalCodec=ce.originalCodec,r.config=ce.config,r.refSampleDuration=F!=null?1e3*F/ce.samplingFrequence:null,L.a.v(this.TAG,"Parsed FlacSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",r);var se=this._mediaInfo;se.audioCodec=r.originalCodec,se.audioSampleRate=r.audioSampleRate,se.audioChannelCount=r.channelCount,se.hasVideo?se.videoCodec!=null&&(se.mimeType='video/x-flv; codecs="'+se.videoCodec+","+se.audioCodec+'"'):se.mimeType='video/x-flv; codecs="'+se.audioCodec+'"',se.isComplete()&&this._onMediaInfo(se)},t.prototype._parseFlacAudioData=function(e,i,o,r){var v=this._audioTrack,k=new Uint8Array(e,i,o),b=this._timestampBase+r,w={unit:k,length:k.byteLength,dts:b,pts:b};v.samples.push(w),v.length+=k.length},t.prototype._parseVideoData=function(e,i,o,r,v){if(o<=1)L.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var k=new Uint8Array(e,i,o)[0],b=(112&k)>>>4;if(128&k){var w=15&k,N=String.fromCharCode.apply(String,new Uint8Array(e,i,o).slice(1,5));if(N==="hvc1")this._parseEnhancedHEVCVideoPacket(e,i+5,o-5,r,v,b,w);else{if(N!=="av01")return void this._onError(I.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(N));this._parseEnhancedAV1VideoPacket(e,i+5,o-5,r,v,b,w)}}else{var F=15&k;if(F===7)this._parseAVCVideoPacket(e,i+1,o-1,r,v,b);else{if(F!==12)return void this._onError(I.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(F));this._parseHEVCVideoPacket(e,i+1,o-1,r,v,b)}}}},t.prototype._parseAVCVideoPacket=function(e,i,o,r,v,k){if(o<4)L.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var b=this._littleEndian,w=new DataView(e,i,o),N=w.getUint8(0),F=(16777215&w.getUint32(0,!b))<<8>>8;if(N===0)this._parseAVCDecoderConfigurationRecord(e,i+4,o-4);else if(N===1)this._parseAVCVideoData(e,i+4,o-4,r,v,k,F);else if(N!==2)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(N))}},t.prototype._parseHEVCVideoPacket=function(e,i,o,r,v,k){if(o<4)L.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var b=this._littleEndian,w=new DataView(e,i,o),N=w.getUint8(0),F=(16777215&w.getUint32(0,!b))<<8>>8;if(N===0)this._parseHEVCDecoderConfigurationRecord(e,i+4,o-4);else if(N===1)this._parseHEVCVideoData(e,i+4,o-4,r,v,k,F);else if(N!==2)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(N))}},t.prototype._parseEnhancedHEVCVideoPacket=function(e,i,o,r,v,k,b){var w=this._littleEndian,N=new DataView(e,i,o);if(b===0)this._parseHEVCDecoderConfigurationRecord(e,i,o);else if(b===1){var F=(4294967040&N.getUint32(0,!w))>>8;this._parseHEVCVideoData(e,i+3,o-3,r,v,k,F)}else if(b===3)this._parseHEVCVideoData(e,i,o,r,v,k,0);else if(b!==2)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(b))},t.prototype._parseEnhancedAV1VideoPacket=function(e,i,o,r,v,k,b){if(this._littleEndian,b===0)this._parseAV1CodecConfigurationRecord(e,i,o);else if(b===1)this._parseAV1VideoData(e,i,o,r,v,k,0);else{if(b===5)return void this._onError(I.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(b));if(b!==2)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(b))}},t.prototype._parseAVCDecoderConfigurationRecord=function(e,i,o){if(o<7)L.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var r=this._videoMetadata,v=this._videoTrack,k=this._littleEndian,b=new DataView(e,i,o);if(r){if(r.avcc!==void 0){var w=new Uint8Array(e,i,o);if(ee(w,r.avcc))return;L.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(r=this._videoMetadata={}).type="video",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration;var N=b.getUint8(0),F=b.getUint8(1);if(b.getUint8(2),b.getUint8(3),N===1&&F!==0)if(this._naluLengthSize=1+(3&b.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var P=31&b.getUint8(5);if(P!==0){P>1&&L.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(P));for(var W=6,te=0;te<P;te++){var ie=b.getUint16(W,!k);if(W+=2,ie!==0){var ce=new Uint8Array(e,i+W,ie);W+=ie;var se=G.a.parseSPS(ce);if(te===0){r.codecWidth=se.codec_size.width,r.codecHeight=se.codec_size.height,r.presentWidth=se.present_size.width,r.presentHeight=se.present_size.height,r.profile=se.profile_string,r.level=se.level_string,r.bitDepth=se.bit_depth,r.chromaFormat=se.chroma_format,r.sarRatio=se.sar_ratio,r.frameRate=se.frame_rate,se.frame_rate.fixed!==!1&&se.frame_rate.fps_num!==0&&se.frame_rate.fps_den!==0||(r.frameRate=this._referenceFrameRate);var me=r.frameRate.fps_den,oe=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(me/oe);for(var ue=ce.subarray(1,4),ye="avc1.",Re=0;Re<3;Re++){var fe=ue[Re].toString(16);fe.length<2&&(fe="0"+fe),ye+=fe}r.codec=ye;var ve=this._mediaInfo;ve.width=r.codecWidth,ve.height=r.codecHeight,ve.fps=r.frameRate.fps,ve.profile=r.profile,ve.level=r.level,ve.refFrames=se.ref_frames,ve.chromaFormat=se.chroma_format_string,ve.sarNum=r.sarRatio.width,ve.sarDen=r.sarRatio.height,ve.videoCodec=ye,ve.hasAudio?ve.audioCodec!=null&&(ve.mimeType='video/x-flv; codecs="'+ve.videoCodec+","+ve.audioCodec+'"'):ve.mimeType='video/x-flv; codecs="'+ve.videoCodec+'"',ve.isComplete()&&this._onMediaInfo(ve)}}}var Se=b.getUint8(W);if(Se!==0){for(Se>1&&L.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(Se)),W++,te=0;te<Se;te++)ie=b.getUint16(W,!k),W+=2,ie!==0&&(W+=ie);r.avcc=new Uint8Array(o),r.avcc.set(new Uint8Array(e,i,o),0),L.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",r)}else this._onError(I.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(I.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(I.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(I.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},t.prototype._parseHEVCDecoderConfigurationRecord=function(e,i,o){if(o<22)L.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var r=this._videoMetadata,v=this._videoTrack,k=this._littleEndian,b=new DataView(e,i,o);if(r){if(r.hvcc!==void 0){var w=new Uint8Array(e,i,o);if(ee(w,r.hvcc))return;L.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(r=this._videoMetadata={}).type="video",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration;var N=b.getUint8(0),F=31&b.getUint8(1);if(N!==0&&N!==1||F===0)this._onError(I.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord");else if(this._naluLengthSize=1+(3&b.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var P=b.getUint8(22),W=0,te=23;W<P;W++){var ie=63&b.getUint8(te+0),ce=b.getUint16(te+1,!k);te+=3;for(var se=0;se<ce;se++){var me=b.getUint16(te+0,!k);if(se===0)if(ie===33){te+=2;var oe=new Uint8Array(e,i+te,me),ue=z.a.parseSPS(oe);r.codecWidth=ue.codec_size.width,r.codecHeight=ue.codec_size.height,r.presentWidth=ue.present_size.width,r.presentHeight=ue.present_size.height,r.profile=ue.profile_string,r.level=ue.level_string,r.bitDepth=ue.bit_depth,r.chromaFormat=ue.chroma_format,r.sarRatio=ue.sar_ratio,r.frameRate=ue.frame_rate,ue.frame_rate.fixed!==!1&&ue.frame_rate.fps_num!==0&&ue.frame_rate.fps_den!==0||(r.frameRate=this._referenceFrameRate);var ye=r.frameRate.fps_den,Re=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(ye/Re),r.codec=ue.codec_mimetype;var fe=this._mediaInfo;fe.width=r.codecWidth,fe.height=r.codecHeight,fe.fps=r.frameRate.fps,fe.profile=r.profile,fe.level=r.level,fe.refFrames=ue.ref_frames,fe.chromaFormat=ue.chroma_format_string,fe.sarNum=r.sarRatio.width,fe.sarDen=r.sarRatio.height,fe.videoCodec=ue.codec_mimetype,fe.hasAudio?fe.audioCodec!=null&&(fe.mimeType='video/x-flv; codecs="'+fe.videoCodec+","+fe.audioCodec+'"'):fe.mimeType='video/x-flv; codecs="'+fe.videoCodec+'"',fe.isComplete()&&this._onMediaInfo(fe),te+=me}else te+=2+me;else te+=2+me}}r.hvcc=new Uint8Array(o),r.hvcc.set(new Uint8Array(e,i,o),0),L.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",r)}else this._onError(I.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1))}},t.prototype._parseAV1CodecConfigurationRecord=function(e,i,o){if(o<4)L.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var r=this._videoMetadata,v=this._videoTrack,k=(this._littleEndian,new DataView(e,i,o));r?r.av1c!==void 0&&L.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(r=this._videoMetadata={}).type="video",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration);var b=127&k.getUint8(0);if(k.getUint8(1),k.getUint8(1),k.getUint8(2),b===1){var w=U.a.parseOBUs(new Uint8Array(e,i+4,o-4));if(w!=null){r.profile=w.profile_string,r.level=w.level_string,r.bitDepth=w.bit_depth,r.chromaFormat=w.chroma_format,r.frameRate=w.frame_rate,w.frame_rate.fixed!==!1&&w.frame_rate.fps_num!==0&&w.frame_rate.fps_den!==0||(r.frameRate=this._referenceFrameRate);var N=r.frameRate.fps_den,F=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(N/F),r.codec=w.codec_mimetype,r.extra=w;var P=this._mediaInfo;P.fps=r.frameRate.fps,P.profile=r.profile,P.level=r.level,P.refFrames=w.ref_frames,P.chromaFormat=w.chroma_format_string,P.videoCodec=w.codec_mimetype,P.hasAudio?P.audioCodec!=null&&(P.mimeType='video/x-flv; codecs="'+P.videoCodec+","+P.audioCodec+'"'):P.mimeType='video/x-flv; codecs="'+P.videoCodec+'"',P.isComplete()&&this._onMediaInfo(P),r.av1c=new Uint8Array(o),r.av1c.set(new Uint8Array(e,i,o),0),L.a.v(this.TAG,"Preparing AV1CodecConfigurationRecord")}else this._onError(I.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(I.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},t.prototype._parseAVCVideoData=function(e,i,o,r,v,k,b){for(var w=this._littleEndian,N=new DataView(e,i,o),F=[],P=0,W=0,te=this._naluLengthSize,ie=this._timestampBase+r,ce=k===1;W<o;){if(W+4>=o){L.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(ie,", offset = ").concat(W,", dataSize = ").concat(o));break}var se=N.getUint32(W,!w);if(te===3&&(se>>>=8),se>o-te)return void L.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(ie,", NaluSize > DataSize!"));var me=31&N.getUint8(W+te);me===5&&(ce=!0);var oe=new Uint8Array(e,i+W,te+se),ue={type:me,data:oe};F.push(ue),P+=oe.byteLength,W+=te+se}if(F.length){var ye=this._videoTrack,Re={units:F,length:P,isKeyframe:ce,dts:ie,cts:b,pts:ie+b};ce&&(Re.fileposition=v),ye.samples.push(Re),ye.length+=P}},t.prototype._parseHEVCVideoData=function(e,i,o,r,v,k,b){for(var w=this._littleEndian,N=new DataView(e,i,o),F=[],P=0,W=0,te=this._naluLengthSize,ie=this._timestampBase+r,ce=k===1;W<o;){if(W+4>=o){L.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(ie,", offset = ").concat(W,", dataSize = ").concat(o));break}var se=N.getUint32(W,!w);if(te===3&&(se>>>=8),se>o-te)return void L.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(ie,", NaluSize > DataSize!"));var me=N.getUint8(W+te)>>1&63;me!==19&&me!==20&&me!==21||(ce=!0);var oe=new Uint8Array(e,i+W,te+se),ue={type:me,data:oe};F.push(ue),P+=oe.byteLength,W+=te+se}if(F.length){var ye=this._videoTrack,Re={units:F,length:P,isKeyframe:ce,dts:ie,cts:b,pts:ie+b};ce&&(Re.fileposition=v),ye.samples.push(Re),ye.length+=P}},t.prototype._parseAV1VideoData=function(e,i,o,r,v,k,b){this._littleEndian;var w,N=[],F=this._timestampBase+r,P=k===1;if(P){var W=this._videoMetadata,te=U.a.parseOBUs(new Uint8Array(e,i,o),W.extra);if(te==null)return void this._onError(I.a.FORMAT_ERROR,"Flv: Invalid AV1 VideoData");console.log(te),W.codecWidth=te.codec_size.width,W.codecHeight=te.codec_size.height,W.presentWidth=te.present_size.width,W.presentHeight=te.present_size.height,W.sarRatio=te.sar_ratio;var ie=this._mediaInfo;ie.width=W.codecWidth,ie.height=W.codecHeight,ie.sarNum=W.sarRatio.width,ie.sarDen=W.sarRatio.height,L.a.v(this.TAG,"Parsed AV1DecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",W)}if(w=o,N.push({unitType:0,data:new Uint8Array(e,i+0,o)}),N.length){var ce=this._videoTrack,se={units:N,length:w,isKeyframe:P,dts:F,cts:b,pts:F+b};P&&(se.fileposition=v),ce.samples.push(se),ce.length+=w}},t}(),l=x(14),g=function(t,e,i){for(var o,r=0,v=e.length;r<v;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},K=function(){function t(){}return t.init=function(){for(var e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],chnl:[],".mp3":[],Opus:[],dOps:[],fLaC:[],dfLa:[],ipcm:[],pcmC:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[]},t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var i=t.constants={};i.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),i.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),i.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),i.STSC=i.STCO=i.STTS,i.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),i.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),i.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),i.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},t.box=function(e){for(var i=8,o=null,r=Array.prototype.slice.call(arguments,1),v=r.length,k=0;k<v;k++)i+=r[k].byteLength;(o=new Uint8Array(i))[0]=i>>>24&255,o[1]=i>>>16&255,o[2]=i>>>8&255,o[3]=255&i,o.set(e,4);var b=8;for(k=0;k<v;k++)o.set(r[k],b),b+=r[k].byteLength;return o},t.generateInitSegment=function(e){var i=t.box(t.types.ftyp,t.constants.FTYP),o=t.moov(e),r=new Uint8Array(i.byteLength+o.byteLength);return r.set(i,0),r.set(o,i.byteLength),r},t.moov=function(e){var i=t.mvhd(e.timescale,e.duration),o=t.trak(e),r=t.mvex(e);return t.box(t.types.moov,i,o,r)},t.mvhd=function(e,i){return t.box(t.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},t.trak=function(e){return t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.tkhd=function(e){var i=e.id,o=e.duration,r=e.presentWidth,v=e.presentHeight;return t.box(t.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>>8&255,255&r,0,0,v>>>8&255,255&v,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e),t.hdlr(e),t.minf(e))},t.mdhd=function(e){var i=e.timescale,o=e.duration;return t.box(t.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,85,196,0,0]))},t.hdlr=function(e){var i=null;return i=e.type==="audio"?t.constants.HDLR_AUDIO:t.constants.HDLR_VIDEO,t.box(t.types.hdlr,i)},t.minf=function(e){var i=null;return i=e.type==="audio"?t.box(t.types.smhd,t.constants.SMHD):t.box(t.types.vmhd,t.constants.VMHD),t.box(t.types.minf,i,t.dinf(),t.stbl(e))},t.dinf=function(){return t.box(t.types.dinf,t.box(t.types.dref,t.constants.DREF))},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.constants.STTS),t.box(t.types.stsc,t.constants.STSC),t.box(t.types.stsz,t.constants.STSZ),t.box(t.types.stco,t.constants.STCO))},t.stsd=function(e){return e.type==="audio"?e.codec==="mp3"?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.mp3(e)):e.codec==="ac-3"?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.ac3(e)):e.codec==="ec-3"?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.ec3(e)):e.codec==="opus"?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.Opus(e)):e.codec=="flac"?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.fLaC(e)):e.codec=="ipcm"?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.ipcm(e)):t.box(t.types.stsd,t.constants.STSD_PREFIX,t.mp4a(e)):e.type==="video"&&e.codec.startsWith("hvc1")?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.hvc1(e)):e.type==="video"&&e.codec.startsWith("av01")?t.box(t.types.stsd,t.constants.STSD_PREFIX,t.av01(e)):t.box(t.types.stsd,t.constants.STSD_PREFIX,t.avc1(e))},t.mp3=function(e){var i=e.channelCount,o=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return t.box(t.types[".mp3"],r)},t.mp4a=function(e){var i=e.channelCount,o=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return t.box(t.types.mp4a,r,t.esds(e))},t.ac3=function(e){var i=e.channelCount,o=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return t.box(t.types["ac-3"],r,t.box(t.types.dac3,new Uint8Array(e.config)))},t.ec3=function(e){var i=e.channelCount,o=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return t.box(t.types["ec-3"],r,t.box(t.types.dec3,new Uint8Array(e.config)))},t.esds=function(e){var i=e.config||[],o=i.length,r=new Uint8Array([0,0,0,0,3,23+o,0,1,0,4,15+o,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([o]).concat(i).concat([6,1,2]));return t.box(t.types.esds,r)},t.Opus=function(e){var i=e.channelCount,o=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return t.box(t.types.Opus,r,t.dOps(e))},t.dOps=function(e){var i=e.channelCount,o=e.channelConfigCode,r=e.audioSampleRate;if(e.config)return t.box(t.types.dOps,e.config);var v=[];switch(o){case 1:case 2:v=[0];break;case 0:v=[255,1,1,0,1];break;case 128:v=[255,2,0,0,1];break;case 3:v=[1,2,1,0,2,1];break;case 4:v=[1,2,2,0,1,2,3];break;case 5:v=[1,3,2,0,4,1,2,3];break;case 6:v=[1,4,2,0,4,1,2,3,5];break;case 7:v=[1,4,2,0,4,1,2,3,5,6];break;case 8:v=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:v=[1,1,2,0,1];break;case 131:v=[1,1,3,0,1,2];break;case 132:v=[1,1,4,0,1,2,3];break;case 133:v=[1,1,5,0,1,2,3,4];break;case 134:v=[1,1,6,0,1,2,3,4,5];break;case 135:v=[1,1,7,0,1,2,3,4,5,6];break;case 136:v=[1,1,8,0,1,2,3,4,5,6,7]}var k=new Uint8Array(g([0,i,0,0,r>>>24&255,r>>>17&255,r>>>8&255,r>>>0&255,0,0],v));return t.box(t.types.dOps,k)},t.fLaC=function(e){var i=e.channelCount,o=Math.min(e.audioSampleRate,65535),r=e.sampleSize,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,r,0,0,0,0,o>>>8&255,255&o,0,0]);return t.box(t.types.fLaC,v,t.dfLa(e))},t.dfLa=function(e){var i=new Uint8Array(g([0,0,0,0],e.config));return t.box(t.types.dfLa,i)},t.ipcm=function(e){var i=e.channelCount,o=Math.min(e.audioSampleRate,65535),r=e.sampleSize,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,r,0,0,0,0,o>>>8&255,255&o,0,0]);return e.channelCount===1?t.box(t.types.ipcm,v,t.pcmC(e)):t.box(t.types.ipcm,v,t.chnl(e),t.pcmC(e))},t.chnl=function(e){var i=new Uint8Array([0,0,0,0,1,e.channelCount,0,0,0,0,0,0,0,0]);return t.box(t.types.chnl,i)},t.pcmC=function(e){var i=e.littleEndian?1:0,o=e.sampleSize,r=new Uint8Array([0,0,0,0,i,o]);return t.box(t.types.pcmC,r)},t.avc1=function(e){var i=e.avcc,o=e.codecWidth,r=e.codecHeight,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return t.box(t.types.avc1,v,t.box(t.types.avcC,i))},t.hvc1=function(e){var i=e.hvcc,o=e.codecWidth,r=e.codecHeight,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return t.box(t.types.hvc1,v,t.box(t.types.hvcC,i))},t.av01=function(e){var i=e.av1c,o=e.codecWidth||192,r=e.codecHeight||108,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return t.box(t.types.av01,v,t.box(t.types.av1C,i))},t.mvex=function(e){return t.box(t.types.mvex,t.trex(e))},t.trex=function(e){var i=e.id,o=new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return t.box(t.types.trex,o)},t.moof=function(e,i){return t.box(t.types.moof,t.mfhd(e.sequenceNumber),t.traf(e,i))},t.mfhd=function(e){var i=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]);return t.box(t.types.mfhd,i)},t.traf=function(e,i){var o=e.id,r=t.box(t.types.tfhd,new Uint8Array([0,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),v=t.box(t.types.tfdt,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),k=t.sdtp(e),b=t.trun(e,k.byteLength+16+16+8+16+8+8);return t.box(t.types.traf,r,v,b,k)},t.sdtp=function(e){for(var i=e.samples||[],o=i.length,r=new Uint8Array(4+o),v=0;v<o;v++){var k=i[v].flags;r[v+4]=k.isLeading<<6|k.dependsOn<<4|k.isDependedOn<<2|k.hasRedundancy}return t.box(t.types.sdtp,r)},t.trun=function(e,i){var o=e.samples||[],r=o.length,v=12+16*r,k=new Uint8Array(v);i+=8+v,k.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0);for(var b=0;b<r;b++){var w=o[b].duration,N=o[b].size,F=o[b].flags,P=o[b].cts;k.set([w>>>24&255,w>>>16&255,w>>>8&255,255&w,N>>>24&255,N>>>16&255,N>>>8&255,255&N,F.isLeading<<2|F.dependsOn,F.isDependedOn<<6|F.hasRedundancy<<4|F.isNonSync,0,0,P>>>24&255,P>>>16&255,P>>>8&255,255&P],12+16*b)}return t.box(t.types.trun,k)},t.mdat=function(e){return t.box(t.types.mdat,e)},t}();K.init();var $=K,ae=function(){function t(){}return t.getSilentFrame=function(e,i){if(e==="mp4a.40.2"){if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),de=x(12),H=function(){function t(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=e.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new de.c("audio"),this._videoSegmentInfoList=new de.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!c.a.chrome||!(c.a.version.major<50||c.a.version.major===50&&c.a.version.build<2661)),this._fillSilentAfterSeek=c.a.msedge||c.a.msie,this._mp3UseMpegAudio=!c.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return t.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},t.prototype.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(t.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e},enumerable:!1,configurable:!0}),t.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},t.prototype.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},t.prototype.remux=function(e,i,o){if(o===void 0&&(o=!1),!this._onMediaSegment)throw new A.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,i),i&&this._remuxVideo(i,o),e&&this._remuxAudio(e,o)},t.prototype._onTrackMetadataReceived=function(e,i){var o=null,r="mp4",v=i.codec;if(e==="audio")this._audioMeta=i,i.codec==="mp3"&&this._mp3UseMpegAudio?(r="mpeg",v="",o=new Uint8Array):o=$.generateInitSegment(i);else{if(e!=="video")return;this._videoMeta=i,o=$.generateInitSegment(i)}if(!this._onInitSegment)throw new A.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:o.buffer,codec:v,container:"".concat(e,"/").concat(r),mediaDuration:i.duration})},t.prototype._calculateDtsBase=function(e,i){this._dtsBaseInited||(e&&e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),i&&i.samples&&i.samples.length&&(this._videoDtsBase=i.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},t.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},t.prototype.flushStashedSamples=function(){var e=this._videoStashedLastSample,i=this._audioStashedLastSample,o={type:"video",id:1,sequenceNumber:0,samples:[],length:0};e!=null&&(o.samples.push(e),o.length=e.length);var r={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};i!=null&&(r.samples.push(i),r.length=i.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(o,!0),this._remuxAudio(r,!0)},t.prototype._remuxAudio=function(e,i){if(this._audioMeta!=null){var o,r=e,v=r.samples,k=void 0,b=-1,w=this._audioMeta.refSampleDuration,N=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,F=this._dtsBaseInited&&this._audioNextDts===void 0,P=!1;if((v&&v.length!==0||i&&this._audioStashedLastSample!=null)&&(v.length!==1||i)){var W=0,te=null,ie=0;N?(W=0,ie=r.length):(W=8,ie=8+r.length);var ce=null;if(v.length>1&&!i&&(ie-=(ce=v.pop()).length),this._audioStashedLastSample!=null){var se=this._audioStashedLastSample;this._audioStashedLastSample=null,v.unshift(se),ie+=se.length}ce!=null&&(this._audioStashedLastSample=ce);var me=v[0].dts-this._dtsBase;if(this._audioNextDts)k=me-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())k=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(P=!0);else{var oe=this._audioSegmentInfoList.getLastSampleBefore(me);if(oe!=null){var ue=me-(oe.originalDts+oe.duration);ue<=3&&(ue=0),k=me-(oe.dts+oe.duration+ue)}else k=0}if(P){var ye=me-k,Re=this._videoSegmentInfoList.getLastSegmentBefore(me);if(Re!=null&&Re.beginDts<ye){if(Ce=ae.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var fe=Re.beginDts,ve=ye-Re.beginDts;L.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(fe,", duration: ").concat(ve)),v.unshift({unit:Ce,dts:fe,pts:fe}),ie+=Ce.byteLength}}else P=!1}for(var Se=[],we=0;we<v.length;we++){var Pe=(se=v[we]).unit,Be=se.dts-this._dtsBase,Ue=(fe=Be,!1),Ve=null,ke=0;if(!(Be<-.001)){if(this._audioMeta.codec!=="mp3"&&w!=null){var Me=Be;if(this._audioNextDts&&(Me=this._audioNextDts),(k=Be-Me)<=-3*w){L.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(Be," ms ,curRefDts: ").concat(Me," ms)  due to dtsCorrection: ").concat(k," ms overlap."));continue}if(k>=3*w&&this._fillAudioTimestampGap&&!c.a.safari){Ue=!0;var Ce,je=Math.floor(k/w);L.a.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+"originalDts: ".concat(Be," ms, curRefDts: ").concat(Me," ms, ")+"dtsCorrection: ".concat(Math.round(k)," ms, generate: ").concat(je," frames")),fe=Math.floor(Me),ke=Math.floor(Me+w)-fe,(Ce=ae.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(L.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),Ce=Pe),Ve=[];for(var _=0;_<je;_++){Me+=w;var p=Math.floor(Me),s=Math.floor(Me+w)-p,n={dts:p,pts:p,cts:0,unit:Ce,size:Ce.byteLength,duration:s,originalDts:Be,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Ve.push(n),ie+=n.size}this._audioNextDts=Me+w}else fe=Math.floor(Me),ke=Math.floor(Me+w)-fe,this._audioNextDts=Me+w}else fe=Be-k,we!==v.length-1?ke=v[we+1].dts-this._dtsBase-k-fe:ce!=null?ke=ce.dts-this._dtsBase-k-fe:ke=Se.length>=1?Se[Se.length-1].duration:Math.floor(w),this._audioNextDts=fe+ke;b===-1&&(b=fe),Se.push({dts:fe,pts:fe,cts:0,unit:se.unit,size:se.unit.byteLength,duration:ke,originalDts:Be,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Ue&&Se.push.apply(Se,Ve)}}if(Se.length===0)return r.samples=[],void(r.length=0);for(N?te=new Uint8Array(ie):((te=new Uint8Array(ie))[0]=ie>>>24&255,te[1]=ie>>>16&255,te[2]=ie>>>8&255,te[3]=255&ie,te.set($.types.mdat,4)),we=0;we<Se.length;we++)Pe=Se[we].unit,te.set(Pe,W),W+=Pe.byteLength;var m=Se[Se.length-1];o=m.dts+m.duration;var M=new de.b;M.beginDts=b,M.endDts=o,M.beginPts=b,M.endPts=o,M.originalBeginDts=Se[0].originalDts,M.originalEndDts=m.originalDts+m.duration,M.firstSample=new de.d(Se[0].dts,Se[0].pts,Se[0].duration,Se[0].originalDts,!1),M.lastSample=new de.d(m.dts,m.pts,m.duration,m.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(M),r.samples=Se,r.sequenceNumber++;var S=null;S=N?new Uint8Array:$.moof(r,b),r.samples=[],r.length=0;var D={type:"audio",data:this._mergeBoxes(S,te).buffer,sampleCount:Se.length,info:M};N&&F&&(D.timestampOffset=b),this._onMediaSegment("audio",D)}}},t.prototype._remuxVideo=function(e,i){if(this._videoMeta!=null){var o,r,v=e,k=v.samples,b=void 0,w=-1,N=-1;if(k&&k.length!==0){if(k.length!==1||i){var F=8,P=null,W=8+e.length,te=null;if(k.length>1&&!i&&(W-=(te=k.pop()).length),this._videoStashedLastSample!=null){var ie=this._videoStashedLastSample;this._videoStashedLastSample=null,k.unshift(ie),W+=ie.length}te!=null&&(this._videoStashedLastSample=te);var ce=k[0].dts-this._dtsBase;if(this._videoNextDts)b=ce-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())b=0;else{var se=this._videoSegmentInfoList.getLastSampleBefore(ce);if(se!=null){var me=ce-(se.originalDts+se.duration);me<=3&&(me=0),b=ce-(se.dts+se.duration+me)}else b=0}for(var oe=new de.b,ue=[],ye=0;ye<k.length;ye++){var Re=(ie=k[ye]).dts-this._dtsBase,fe=ie.isKeyframe,ve=Re-b,Se=ie.cts,we=ve+Se;w===-1&&(w=ve,N=we);var Pe=0;if(ye!==k.length-1?Pe=k[ye+1].dts-this._dtsBase-b-ve:te!=null?Pe=te.dts-this._dtsBase-b-ve:Pe=ue.length>=1?ue[ue.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),fe){var Be=new de.d(ve,we,Pe,ie.dts,!0);Be.fileposition=ie.fileposition,oe.appendSyncPoint(Be)}ue.push({dts:ve,pts:we,cts:Se,units:ie.units,size:ie.length,isKeyframe:fe,duration:Pe,originalDts:Re,flags:{isLeading:0,dependsOn:fe?2:1,isDependedOn:fe?1:0,hasRedundancy:0,isNonSync:fe?0:1}})}for((P=new Uint8Array(W))[0]=W>>>24&255,P[1]=W>>>16&255,P[2]=W>>>8&255,P[3]=255&W,P.set($.types.mdat,4),ye=0;ye<ue.length;ye++)for(var Ue=ue[ye].units;Ue.length;){var Ve=Ue.shift().data;P.set(Ve,F),F+=Ve.byteLength}var ke=ue[ue.length-1];if(o=ke.dts+ke.duration,r=ke.pts+ke.duration,this._videoNextDts=o,oe.beginDts=w,oe.endDts=o,oe.beginPts=N,oe.endPts=r,oe.originalBeginDts=ue[0].originalDts,oe.originalEndDts=ke.originalDts+ke.duration,oe.firstSample=new de.d(ue[0].dts,ue[0].pts,ue[0].duration,ue[0].originalDts,ue[0].isKeyframe),oe.lastSample=new de.d(ke.dts,ke.pts,ke.duration,ke.originalDts,ke.isKeyframe),this._isLive||this._videoSegmentInfoList.append(oe),v.samples=ue,v.sequenceNumber++,this._forceFirstIDR){var Me=ue[0].flags;Me.dependsOn=2,Me.isNonSync=0}var Ce=$.moof(v,w);v.samples=[],v.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Ce,P).buffer,sampleCount:ue.length,info:oe})}}else!i||this._videoStashedLastSample}},t.prototype._mergeBoxes=function(e,i){var o=new Uint8Array(e.byteLength+i.byteLength);return o.set(e,0),o.set(i,e.byteLength),o},t}(),ne=x(17),re=x(1),R=(x(2),function(){function t(e,i){this.TAG="TransmuxingController",this._emitter=new T.a,this._config=i,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),typeof e.cors!="boolean"&&(e.cors=!0),typeof e.withCredentials!="boolean"&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var o=0;this._mediaDataSource.segments.forEach(function(r){r.timestampBase=o,o+=r.duration,r.cors=e.cors,r.withCredentials=e.withCredentials,i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy)}),isNaN(o)||this._mediaDataSource.duration===o||(this._mediaDataSource.duration=o),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return t.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},t.prototype.on=function(e,i){this._emitter.addListener(e,i)},t.prototype.off=function(e,i){this._emitter.removeListener(e,i)},t.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},t.prototype._loadSegment=function(e,i){this._currentSegmentIndex=e;var o=this._mediaDataSource.segments[e],r=this._ioctl=new ne.a(o,this._config,e);r.onError=this._onIOException.bind(this),r.onSeeked=this._onIOSeeked.bind(this),r.onComplete=this._onIOComplete.bind(this),r.onRedirect=this._onIORedirect.bind(this),r.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),i?this._demuxer.bindDataSource(this._ioctl):r.onDataArrival=this._onInitChunkArrival.bind(this),r.open(i)},t.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},t.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},t.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},t.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},t.prototype.seek=function(e){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var i=this._searchSegmentIndexContains(e);if(i===this._currentSegmentIndex){var o=this._mediaInfo.segments[i];if(o==null)this._pendingSeekTime=e;else{var r=o.getNearestKeyframe(e);this._remuxer.seek(r.milliseconds),this._ioctl.seek(r.fileposition),this._pendingResolveSeekPoint=r.milliseconds}}else{var v=this._mediaInfo.segments[i];v==null?(this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(i)):(r=v.getNearestKeyframe(e),this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[i].timestampBase,this._loadSegment(i,r.fileposition),this._pendingResolveSeekPoint=r.milliseconds,this._reportSegmentMediaInfo(i))}this._enableStatisticsReporter()}},t.prototype._searchSegmentIndexContains=function(e){for(var i=this._mediaDataSource.segments,o=i.length-1,r=0;r<i.length;r++)if(e<i[r].timestampBase){o=r-1;break}return o},t.prototype._onInitChunkArrival=function(e,i){var o=this,r=0;if(i>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,r=this._demuxer.parseChunks(e,i);else{var v=null;(v=d.probe(e)).match&&(this._setupFLVDemuxerRemuxer(v),r=this._demuxer.parseChunks(e,i)),v.match||v.needMoreData||(v=l.a.probe(e)).match&&(this._setupTSDemuxerRemuxer(v),r=this._demuxer.parseChunks(e,i)),v.match||v.needMoreData||(v=null,L.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(function(){o._internalAbort()}),this._emitter.emit(re.a.DEMUX_ERROR,I.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return r},t.prototype._setupFLVDemuxerRemuxer=function(e){this._demuxer=new d(e,this._config),this._remuxer||(this._remuxer=new H(this._config));var i=this._mediaDataSource;i.duration==null||isNaN(i.duration)||(this._demuxer.overridedDuration=i.duration),typeof i.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=i.hasAudio),typeof i.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=i.hasVideo),this._demuxer.timestampBase=i.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},t.prototype._setupTSDemuxerRemuxer=function(e){var i=this._demuxer=new l.a(e,this._config);this._remuxer||(this._remuxer=new H(this._config)),i.onError=this._onDemuxException.bind(this),i.onMediaInfo=this._onMediaInfo.bind(this),i.onMetaDataArrived=this._onMetaDataArrived.bind(this),i.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),i.onPGSSubtitleData=this._onPGSSubtitle.bind(this),i.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),i.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),i.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),i.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),i.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),i.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},t.prototype._onMediaInfo=function(e){var i=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,y.a.prototype));var o=Object.assign({},e);Object.setPrototypeOf(o,y.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=o,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var r=i._pendingSeekTime;i._pendingSeekTime=null,i.seek(r)})},t.prototype._onMetaDataArrived=function(e){this._emitter.emit(re.a.METADATA_ARRIVED,e)},t.prototype._onScriptDataArrived=function(e){this._emitter.emit(re.a.SCRIPTDATA_ARRIVED,e)},t.prototype._onTimedID3Metadata=function(e){var i=this._remuxer.getTimestampBase();i!=null&&(e.pts!=null&&(e.pts-=i),e.dts!=null&&(e.dts-=i),this._emitter.emit(re.a.TIMED_ID3_METADATA_ARRIVED,e))},t.prototype._onPGSSubtitle=function(e){var i=this._remuxer.getTimestampBase();i!=null&&(e.pts!=null&&(e.pts-=i),e.dts!=null&&(e.dts-=i),this._emitter.emit(re.a.PGS_SUBTITLE_ARRIVED,e))},t.prototype._onSynchronousKLVMetadata=function(e){var i=this._remuxer.getTimestampBase();i!=null&&(e.pts!=null&&(e.pts-=i),e.dts!=null&&(e.dts-=i),this._emitter.emit(re.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e))},t.prototype._onAsynchronousKLVMetadata=function(e){this._emitter.emit(re.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)},t.prototype._onSMPTE2038Metadata=function(e){var i=this._remuxer.getTimestampBase();i!=null&&(e.pts!=null&&(e.pts-=i),e.dts!=null&&(e.dts-=i),e.nearest_pts!=null&&(e.nearest_pts-=i),this._emitter.emit(re.a.SMPTE2038_METADATA_ARRIVED,e))},t.prototype._onSCTE35Metadata=function(e){var i=this._remuxer.getTimestampBase();i!=null&&(e.pts!=null&&(e.pts-=i),e.nearest_pts!=null&&(e.nearest_pts-=i),this._emitter.emit(re.a.SCTE35_METADATA_ARRIVED,e))},t.prototype._onPESPrivateDataDescriptor=function(e){this._emitter.emit(re.a.PES_PRIVATE_DATA_DESCRIPTOR,e)},t.prototype._onPESPrivateData=function(e){var i=this._remuxer.getTimestampBase();i!=null&&(e.pts!=null&&(e.pts-=i),e.nearest_pts!=null&&(e.nearest_pts-=i),e.dts!=null&&(e.dts-=i),this._emitter.emit(re.a.PES_PRIVATE_DATA_ARRIVED,e))},t.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},t.prototype._onIOComplete=function(e){var i=e+1;i<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(i)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(re.a.LOADING_COMPLETE),this._disableStatisticsReporter())},t.prototype._onIORedirect=function(e){var i=this._ioctl.extraData;this._mediaDataSource.segments[i].redirectedURL=e},t.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(re.a.RECOVERED_EARLY_EOF)},t.prototype._onIOException=function(e,i){L.a.e(this.TAG,"IOException: type = ".concat(e,", code = ").concat(i.code,", msg = ").concat(i.msg)),this._emitter.emit(re.a.IO_ERROR,e,i),this._disableStatisticsReporter()},t.prototype._onDemuxException=function(e,i){L.a.e(this.TAG,"DemuxException: type = ".concat(e,", info = ").concat(i)),this._emitter.emit(re.a.DEMUX_ERROR,e,i)},t.prototype._onRemuxerInitSegmentArrival=function(e,i){this._emitter.emit(re.a.INIT_SEGMENT,e,i)},t.prototype._onRemuxerMediaSegmentArrival=function(e,i){if(this._pendingSeekTime==null&&(this._emitter.emit(re.a.MEDIA_SEGMENT,e,i),this._pendingResolveSeekPoint!=null&&e==="video")){var o=i.info.syncPoints,r=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,c.a.safari&&o.length>0&&o[0].originalDts===r&&(r=o[0].pts),this._emitter.emit(re.a.RECOMMEND_SEEKPOINT,r)}},t.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},t.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},t.prototype._reportSegmentMediaInfo=function(e){var i=this._mediaInfo.segments[e],o=Object.assign({},i);o.duration=this._mediaInfo.duration,o.segmentCount=this._mediaInfo.segmentCount,delete o.segments,delete o.keyframesIndex,this._emitter.emit(re.a.MEDIA_INFO,o)},t.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(re.a.STATISTICS_INFO,e)},t}());_e.a=R},function(ge,_e,x){var V=function(){function T(){}return T.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(L,c){return L.__proto__=c,L},Object.assign=Object.assign||function(L){if(L==null)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(L),y=1;y<arguments.length;y++){var a=arguments[y];if(a!=null)for(var h in a)a.hasOwnProperty(h)&&(c[h]=a[h])}return c},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(L,c){var y=c>0?0|c:0;return this.substring(y,y+L.length)===L}}),typeof self.Promise!="function"&&x(26).polyfill()},T}();V.install(),_e.a=V},function(ge,_e,x){function V(y){var a={};function h(A){if(a[A])return a[A].exports;var E=a[A]={i:A,l:!1,exports:{}};return y[A].call(E.exports,E,E.exports,h),E.l=!0,E.exports}h.m=y,h.c=a,h.i=function(A){return A},h.d=function(A,E,O){h.o(A,E)||Object.defineProperty(A,E,{configurable:!1,enumerable:!0,get:O})},h.r=function(A){Object.defineProperty(A,"__esModule",{value:!0})},h.n=function(A){var E=A&&A.__esModule?function(){return A.default}:function(){return A};return h.d(E,"a",E),E},h.o=function(A,E){return Object.prototype.hasOwnProperty.call(A,E)},h.p="/",h.oe=function(A){throw console.error(A),A};var f=h(h.s=ENTRY_MODULE);return f.default||f}function T(y){return(y+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function L(y,a,h){var f={};f[h]=[];var A=a.toString(),E=A.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!E)return f;for(var O,G=E[1],I=new RegExp("(\\\\n|\\W)"+T(G)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");O=I.exec(A);)O[3]!=="dll-reference"&&f[h].push(O[3]);for(I=new RegExp("\\("+T(G)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");O=I.exec(A);)y[O[2]]||(f[h].push(O[1]),y[O[2]]=x(O[1]).m),f[O[2]]=f[O[2]]||[],f[O[2]].push(O[4]);for(var z,q=Object.keys(f),C=0;C<q.length;C++)for(var J=0;J<f[q[C]].length;J++)z=f[q[C]][J],isNaN(1*z)||(f[q[C]][J]=1*f[q[C]][J]);return f}function c(y){return Object.keys(y).reduce(function(a,h){return a||y[h].length>0},!1)}ge.exports=function(y,a){a=a||{};var h={main:x.m},f=a.all?{main:Object.keys(h.main)}:function(I,z){for(var q={main:[z]},C={main:[]},J={main:{}};c(q);)for(var ee=Object.keys(q),U=0;U<ee.length;U++){var u=ee[U],d=q[u].pop();if(J[u]=J[u]||{},!J[u][d]&&I[u][d]){J[u][d]=!0,C[u]=C[u]||[],C[u].push(d);for(var l=L(I,I[u][d],u),g=Object.keys(l),K=0;K<g.length;K++)q[g[K]]=q[g[K]]||[],q[g[K]]=q[g[K]].concat(l[g[K]])}}return C}(h,y),A="";Object.keys(f).filter(function(I){return I!=="main"}).forEach(function(I){for(var z=0;f[I][z];)z++;f[I].push(z),h[I][z]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",A=A+"var "+I+" = ("+V.toString().replace("ENTRY_MODULE",JSON.stringify(z))+")({"+f[I].map(function(q){return JSON.stringify(q)+": "+h[I][q].toString()}).join(",")+`});
`}),A=A+"new (("+V.toString().replace("ENTRY_MODULE",JSON.stringify(y))+")({"+f.main.map(function(I){return JSON.stringify(I)+": "+h.main[I].toString()}).join(",")+"}))(self);";var E=new self.Blob([A],{type:"text/javascript"});if(a.bare)return E;var O=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(E),G=new self.Worker(O);return G.objectURL=O,G}},function(ge,_e,x){var V=x(10),T=x.n(V),L=x(0),c=x(5),y=x(7),a=x(3),h=function(){function f(A){this.TAG="MSEController",this._config=A,this._emitter=new T.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return f.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},f.prototype.on=function(A,E){this._emitter.addListener(A,E)},f.prototype.off=function(A,E){this._emitter.removeListener(A,E)},f.prototype.initialize=function(A){if(this._mediaSource)throw new a.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&L.a.v(this.TAG,"Using ManagedMediaSource");var E=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;E.addEventListener("sourceopen",this.e.onSourceOpen),E.addEventListener("sourceended",this.e.onSourceEnded),E.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(E.addEventListener("startstreaming",this.e.onStartStreaming),E.addEventListener("endstreaming",this.e.onEndStreaming),E.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=A},f.prototype.shutdown=function(){if(this._mediaSource){var A=this._mediaSource;for(var E in this._sourceBuffers){var O=this._pendingSegments[E];O.splice(0,O.length),this._pendingSegments[E]=null,this._pendingRemoveRanges[E]=null,this._lastInitSegments[E]=null;var G=this._sourceBuffers[E];if(G){if(A.readyState!=="closed"){try{A.removeSourceBuffer(G)}catch(I){L.a.e(this.TAG,I.message)}G.removeEventListener("error",this.e.onSourceBufferError),G.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[E]=null,this._sourceBuffers[E]=null}}if(A.readyState==="open")try{A.endOfStream()}catch(I){L.a.e(this.TAG,I.message)}this._mediaElementProxy=null,A.removeEventListener("sourceopen",this.e.onSourceOpen),A.removeEventListener("sourceended",this.e.onSourceEnded),A.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(A.removeEventListener("startstreaming",this.e.onStartStreaming),A.removeEventListener("endstreaming",this.e.onEndStreaming),A.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},f.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},f.prototype.getObject=function(){if(!this._mediaSource)throw new a.a("MediaSource has not been initialized yet!");return this._mediaSource},f.prototype.getHandle=function(){if(!this._mediaSource)throw new a.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},f.prototype.getObjectURL=function(){if(!this._mediaSource)throw new a.a("MediaSource has not been initialized yet!");return this._mediaSourceObjectURL==null&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},f.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},f.prototype.appendInitSegment=function(A,E){if(E===void 0&&(E=void 0),!this._mediaSource||this._mediaSource.readyState!=="open"||this._mediaSource.streaming===!1)return this._pendingSourceBufferInit.push(A),void this._pendingSegments[A.type].push(A);var O=A,G="".concat(O.container);O.codec&&O.codec.length>0&&(O.codec==="opus"&&c.a.safari&&(O.codec="Opus"),G+=";codecs=".concat(O.codec));var I=!1;if(L.a.v(this.TAG,"Received Initialization Segment, mimeType: "+G),this._lastInitSegments[O.type]=O,G!==this._mimeTypes[O.type]){if(this._mimeTypes[O.type])L.a.v(this.TAG,"Notice: ".concat(O.type," mimeType changed, origin: ").concat(this._mimeTypes[O.type],", target: ").concat(G));else{I=!0;try{var z=this._sourceBuffers[O.type]=this._mediaSource.addSourceBuffer(G);z.addEventListener("error",this.e.onSourceBufferError),z.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(q){return L.a.e(this.TAG,q.message),void this._emitter.emit(y.a.ERROR,{code:q.code,msg:q.message})}}this._mimeTypes[O.type]=G}E||this._pendingSegments[O.type].push(O),I||this._sourceBuffers[O.type]&&!this._sourceBuffers[O.type].updating&&this._doAppendSegments(),c.a.safari&&O.container==="audio/mpeg"&&O.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=O.mediaDuration/1e3,this._updateMediaSourceDuration())},f.prototype.appendMediaSegment=function(A){var E=A;this._pendingSegments[E.type].push(E),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var O=this._sourceBuffers[E.type];!O||O.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},f.prototype.flush=function(){for(var A in this._sourceBuffers)if(this._sourceBuffers[A]){var E=this._sourceBuffers[A];if(this._mediaSource.readyState==="open")try{E.abort()}catch(C){L.a.e(this.TAG,C.message)}var O=this._pendingSegments[A];if(O.splice(0,O.length),this._mediaSource.readyState!=="closed"){for(var G=0;G<E.buffered.length;G++){var I=E.buffered.start(G),z=E.buffered.end(G);this._pendingRemoveRanges[A].push({start:I,end:z})}if(E.updating||this._doRemoveRanges(),c.a.safari){var q=this._lastInitSegments[A];q&&(this._pendingSegments[A].push(q),E.updating||this._doAppendSegments())}}}},f.prototype.endOfStream=function(){var A=this._mediaSource,E=this._sourceBuffers;A&&A.readyState==="open"?E.video&&E.video.updating||E.audio&&E.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,A.endOfStream()):A&&A.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},f.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var A=this._mediaElementProxy.getCurrentTime();for(var E in this._sourceBuffers){var O=this._sourceBuffers[E];if(O){var G=O.buffered;if(G.length>=1&&A-G.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},f.prototype._doCleanupSourceBuffer=function(){var A=this._mediaElementProxy.getCurrentTime();for(var E in this._sourceBuffers){var O=this._sourceBuffers[E];if(O){for(var G=O.buffered,I=!1,z=0;z<G.length;z++){var q=G.start(z),C=G.end(z);if(q<=A&&A<C+3){if(A-q>=this._config.autoCleanupMaxBackwardDuration){I=!0;var J=A-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[E].push({start:q,end:J})}}else C<A&&(I=!0,this._pendingRemoveRanges[E].push({start:q,end:C}))}I&&!O.updating&&this._doRemoveRanges()}}},f.prototype._updateMediaSourceDuration=function(){var A=this._sourceBuffers;if(this._mediaElementProxy.getReadyState()!==0&&this._mediaSource.readyState==="open"&&!(A.video&&A.video.updating||A.audio&&A.audio.updating)){var E=this._mediaSource.duration,O=this._pendingMediaDuration;O>0&&(isNaN(E)||O>E)&&(L.a.v(this.TAG,"Update MediaSource duration from ".concat(E," to ").concat(O)),this._mediaSource.duration=O),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},f.prototype._doRemoveRanges=function(){for(var A in this._pendingRemoveRanges)if(this._sourceBuffers[A]&&!this._sourceBuffers[A].updating)for(var E=this._sourceBuffers[A],O=this._pendingRemoveRanges[A];O.length&&!E.updating;){var G=O.shift();E.remove(G.start,G.end)}},f.prototype._doAppendSegments=function(){var A=this._pendingSegments;for(var E in A)if(this._sourceBuffers[E]&&!this._sourceBuffers[E].updating&&this._mediaSource.streaming!==!1&&A[E].length>0){var O=A[E].shift();if(typeof O.timestampOffset=="number"&&isFinite(O.timestampOffset)){var G=this._sourceBuffers[E].timestampOffset,I=O.timestampOffset/1e3;Math.abs(G-I)>.1&&(L.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(G," to ").concat(I)),this._sourceBuffers[E].timestampOffset=I),delete O.timestampOffset}if(!O.data||O.data.byteLength===0)continue;try{this._sourceBuffers[E].appendBuffer(O.data),this._isBufferFull=!1}catch(z){this._pendingSegments[E].unshift(O),z.code===22?(this._isBufferFull||this._emitter.emit(y.a.BUFFER_FULL),this._isBufferFull=!0):(L.a.e(this.TAG,z.message),this._emitter.emit(y.a.ERROR,{code:z.code,msg:z.message}))}}},f.prototype._onSourceOpen=function(){if(L.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var A=this._pendingSourceBufferInit;A.length;){var E=A.shift();this.appendInitSegment(E,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(y.a.SOURCE_OPEN)},f.prototype._onStartStreaming=function(){L.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(y.a.START_STREAMING)},f.prototype._onEndStreaming=function(){L.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(y.a.END_STREAMING)},f.prototype._onQualityChange=function(){L.a.v(this.TAG,"ManagedMediaSource onQualityChange")},f.prototype._onSourceEnded=function(){L.a.v(this.TAG,"MediaSource onSourceEnded")},f.prototype._onSourceClose=function(){L.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstreaming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},f.prototype._hasPendingSegments=function(){var A=this._pendingSegments;return A.video.length>0||A.audio.length>0},f.prototype._hasPendingRemoveRanges=function(){var A=this._pendingRemoveRanges;return A.video.length>0||A.audio.length>0},f.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(y.a.UPDATE_END)},f.prototype._onSourceBufferError=function(A){L.a.e(this.TAG,"SourceBuffer Error: ".concat(A))},f}();_e.a=h},function(ge,_e,x){var V=x(10),T=x.n(V),L=x(20),c=x.n(L),y=x(0),a=x(9),h=x(18),f=x(1),A=(x(24),x(13)),E=x(14),O=function(){function G(I,z){if(this.TAG="Transmuxer",this._emitter=new T.a,z.enableWorker&&typeof Worker<"u")try{this._worker=c()(24),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[I,z]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},a.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:a.a.getConfig()})}catch{y.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new h.a(I,z)}else this._controller=new h.a(I,z);if(this._controller){var q=this._controller;q.on(f.a.IO_ERROR,this._onIOError.bind(this)),q.on(f.a.DEMUX_ERROR,this._onDemuxError.bind(this)),q.on(f.a.INIT_SEGMENT,this._onInitSegment.bind(this)),q.on(f.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),q.on(f.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),q.on(f.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),q.on(f.a.MEDIA_INFO,this._onMediaInfo.bind(this)),q.on(f.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),q.on(f.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),q.on(f.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),q.on(f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),q.on(f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),q.on(f.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),q.on(f.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),q.on(f.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),q.on(f.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),q.on(f.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),q.on(f.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return G.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),a.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},G.prototype.on=function(I,z){this._emitter.addListener(I,z)},G.prototype.off=function(I,z){this._emitter.removeListener(I,z)},G.prototype.hasWorker=function(){return this._worker!=null},G.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},G.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},G.prototype.seek=function(I){this._worker?this._worker.postMessage({cmd:"seek",param:I}):this._controller.seek(I)},G.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},G.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},G.prototype.switchPrimaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"primary"}):this._controller._demuxer instanceof E.a&&(this._controller._demuxer.preferred_secondary_audio=!1)},G.prototype.switchSecondaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"secondary"}):this._controller._demuxer instanceof E.a&&(this._controller._demuxer.preferred_secondary_audio=!0)},G.prototype._onInitSegment=function(I,z){var q=this;Promise.resolve().then(function(){q._emitter.emit(f.a.INIT_SEGMENT,I,z)})},G.prototype._onMediaSegment=function(I,z){var q=this;Promise.resolve().then(function(){q._emitter.emit(f.a.MEDIA_SEGMENT,I,z)})},G.prototype._onLoadingComplete=function(){var I=this;Promise.resolve().then(function(){I._emitter.emit(f.a.LOADING_COMPLETE)})},G.prototype._onRecoveredEarlyEof=function(){var I=this;Promise.resolve().then(function(){I._emitter.emit(f.a.RECOVERED_EARLY_EOF)})},G.prototype._onMediaInfo=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.MEDIA_INFO,I)})},G.prototype._onMetaDataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.METADATA_ARRIVED,I)})},G.prototype._onScriptDataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.SCRIPTDATA_ARRIVED,I)})},G.prototype._onTimedID3MetadataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.TIMED_ID3_METADATA_ARRIVED,I)})},G.prototype._onPGSSubtitleArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.PGS_SUBTITLE_ARRIVED,I)})},G.prototype._onSynchronousKLVMetadataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,I)})},G.prototype._onAsynchronousKLVMetadataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,I)})},G.prototype._onSMPTE2038MetadataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.SMPTE2038_METADATA_ARRIVED,I)})},G.prototype._onSCTE35MetadataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.SCTE35_METADATA_ARRIVED,I)})},G.prototype._onPESPrivateDataDescriptor=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.PES_PRIVATE_DATA_DESCRIPTOR,I)})},G.prototype._onPESPrivateDataArrived=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.PES_PRIVATE_DATA_ARRIVED,I)})},G.prototype._onStatisticsInfo=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.STATISTICS_INFO,I)})},G.prototype._onIOError=function(I,z){var q=this;Promise.resolve().then(function(){q._emitter.emit(f.a.IO_ERROR,I,z)})},G.prototype._onDemuxError=function(I,z){var q=this;Promise.resolve().then(function(){q._emitter.emit(f.a.DEMUX_ERROR,I,z)})},G.prototype._onRecommendSeekpoint=function(I){var z=this;Promise.resolve().then(function(){z._emitter.emit(f.a.RECOMMEND_SEEKPOINT,I)})},G.prototype._onLoggingConfigChanged=function(I){this._worker&&this._worker.postMessage({cmd:"logging_config",param:I})},G.prototype._onWorkerMessage=function(I){var z=I.data,q=z.data;if(z.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(z.msg){case f.a.INIT_SEGMENT:case f.a.MEDIA_SEGMENT:this._emitter.emit(z.msg,q.type,q.data);break;case f.a.LOADING_COMPLETE:case f.a.RECOVERED_EARLY_EOF:this._emitter.emit(z.msg);break;case f.a.MEDIA_INFO:Object.setPrototypeOf(q,A.a.prototype),this._emitter.emit(z.msg,q);break;case f.a.METADATA_ARRIVED:case f.a.SCRIPTDATA_ARRIVED:case f.a.TIMED_ID3_METADATA_ARRIVED:case f.a.PGS_SUBTITLE_ARRIVED:case f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case f.a.SMPTE2038_METADATA_ARRIVED:case f.a.SCTE35_METADATA_ARRIVED:case f.a.PES_PRIVATE_DATA_DESCRIPTOR:case f.a.PES_PRIVATE_DATA_ARRIVED:case f.a.STATISTICS_INFO:this._emitter.emit(z.msg,q);break;case f.a.IO_ERROR:case f.a.DEMUX_ERROR:this._emitter.emit(z.msg,q.type,q.info);break;case f.a.RECOMMEND_SEEKPOINT:this._emitter.emit(z.msg,q);break;case"logcat_callback":y.a.emitter.emit("log",q.type,q.logcat)}},G}();_e.a=O},function(ge,_e,x){var V=x(8),T=function(){function L(){}return L._ebsp2rbsp=function(c){for(var y=c,a=y.byteLength,h=new Uint8Array(a),f=0,A=0;A<a;A++)A>=2&&y[A]===3&&y[A-1]===0&&y[A-2]===0||(h[f]=y[A],f++);return new Uint8Array(h.buffer,0,f)},L.parseSPS=function(c){for(var y=c.subarray(1,4),a="avc1.",h=0;h<3;h++){var f=y[h].toString(16);f.length<2&&(f="0"+f),a+=f}var A=L._ebsp2rbsp(c),E=new V.a(A);E.readByte();var O=E.readByte();E.readByte();var G=E.readByte();E.readUEG();var I=L.getProfileString(O),z=L.getLevelString(G),q=1,C=420,J=8,ee=8;if((O===100||O===110||O===122||O===244||O===44||O===83||O===86||O===118||O===128||O===138||O===144)&&((q=E.readUEG())===3&&E.readBits(1),q<=3&&(C=[0,420,422,444][q]),J=E.readUEG()+8,ee=E.readUEG()+8,E.readBits(1),E.readBool()))for(var U=q!==3?8:12,u=0;u<U;u++)E.readBool()&&(u<6?L._skipScalingList(E,16):L._skipScalingList(E,64));E.readUEG();var d=E.readUEG();if(d===0)E.readUEG();else if(d===1){E.readBits(1),E.readSEG(),E.readSEG();var l=E.readUEG();for(u=0;u<l;u++)E.readSEG()}var g=E.readUEG();E.readBits(1);var K=E.readUEG(),$=E.readUEG(),ae=E.readBits(1);ae===0&&E.readBits(1),E.readBits(1);var de=0,H=0,ne=0,re=0;E.readBool()&&(de=E.readUEG(),H=E.readUEG(),ne=E.readUEG(),re=E.readUEG());var R=1,t=1,e=0,i=!0,o=0,r=0;if(E.readBool()){if(E.readBool()){var v=E.readByte();v>0&&v<16?(R=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][v-1],t=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][v-1]):v===255&&(R=E.readByte()<<8|E.readByte(),t=E.readByte()<<8|E.readByte())}if(E.readBool()&&E.readBool(),E.readBool()&&(E.readBits(4),E.readBool()&&E.readBits(24)),E.readBool()&&(E.readUEG(),E.readUEG()),E.readBool()){var k=E.readBits(32),b=E.readBits(32);i=E.readBool(),e=(o=b)/(r=2*k)}}var w=1;R===1&&t===1||(w=R/t);var N=0,F=0;q===0?(N=1,F=2-ae):(N=q===3?1:2,F=(q===1?2:1)*(2-ae));var P=16*(K+1),W=16*($+1)*(2-ae);P-=(de+H)*N,W-=(ne+re)*F;var te=Math.ceil(P*w);return E.destroy(),E=null,{codec_mimetype:a,profile_idc:O,level_idc:G,profile_string:I,level_string:z,chroma_format_idc:q,bit_depth:J,bit_depth_luma:J,bit_depth_chroma:ee,ref_frames:g,chroma_format:C,chroma_format_string:L.getChromaFormatString(C),frame_rate:{fixed:i,fps:e,fps_den:r,fps_num:o},sar_ratio:{width:R,height:t},codec_size:{width:P,height:W},present_size:{width:te,height:W}}},L._skipScalingList=function(c,y){for(var a=8,h=8,f=0;f<y;f++)h!==0&&(h=(a+c.readSEG()+256)%256),a=h===0?a:h},L.getProfileString=function(c){switch(c){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},L.getLevelString=function(c){return(c/10).toFixed(1)},L.getChromaFormatString=function(c){switch(c){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},L}();_e.a=T},function(ge,_e,x){x.r(_e),x(0);var V=x(9),T=x(19),L=x(18),c=x(1),y=x(14);_e.default=function(a){var h=null,f=function(H,ne){a.postMessage({msg:"logcat_callback",data:{type:H,logcat:ne}})}.bind(this);function A(H,ne){var re={msg:c.a.INIT_SEGMENT,data:{type:H,data:ne}};a.postMessage(re,[ne.data])}function E(H,ne){var re={msg:c.a.MEDIA_SEGMENT,data:{type:H,data:ne}};a.postMessage(re,[ne.data])}function O(){var H={msg:c.a.LOADING_COMPLETE};a.postMessage(H)}function G(){var H={msg:c.a.RECOVERED_EARLY_EOF};a.postMessage(H)}function I(H){var ne={msg:c.a.MEDIA_INFO,data:H};a.postMessage(ne)}function z(H){var ne={msg:c.a.METADATA_ARRIVED,data:H};a.postMessage(ne)}function q(H){var ne={msg:c.a.SCRIPTDATA_ARRIVED,data:H};a.postMessage(ne)}function C(H){var ne={msg:c.a.TIMED_ID3_METADATA_ARRIVED,data:H};a.postMessage(ne)}function J(H){var ne={msg:c.a.PGS_SUBTITLE_ARRIVED,data:H};a.postMessage(ne)}function ee(H){var ne={msg:c.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:H};a.postMessage(ne)}function U(H){var ne={msg:c.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:H};a.postMessage(ne)}function u(H){var ne={msg:c.a.SMPTE2038_METADATA_ARRIVED,data:H};a.postMessage(ne)}function d(H){var ne={msg:c.a.SCTE35_METADATA_ARRIVED,data:H};a.postMessage(ne)}function l(H){var ne={msg:c.a.PES_PRIVATE_DATA_DESCRIPTOR,data:H};a.postMessage(ne)}function g(H){var ne={msg:c.a.PES_PRIVATE_DATA_ARRIVED,data:H};a.postMessage(ne)}function K(H){var ne={msg:c.a.STATISTICS_INFO,data:H};a.postMessage(ne)}function $(H,ne){a.postMessage({msg:c.a.IO_ERROR,data:{type:H,info:ne}})}function ae(H,ne){a.postMessage({msg:c.a.DEMUX_ERROR,data:{type:H,info:ne}})}function de(H){a.postMessage({msg:c.a.RECOMMEND_SEEKPOINT,data:H})}T.a.install(),a.addEventListener("message",function(H){switch(H.data.cmd){case"init":(h=new L.a(H.data.param[0],H.data.param[1])).on(c.a.IO_ERROR,$.bind(this)),h.on(c.a.DEMUX_ERROR,ae.bind(this)),h.on(c.a.INIT_SEGMENT,A.bind(this)),h.on(c.a.MEDIA_SEGMENT,E.bind(this)),h.on(c.a.LOADING_COMPLETE,O.bind(this)),h.on(c.a.RECOVERED_EARLY_EOF,G.bind(this)),h.on(c.a.MEDIA_INFO,I.bind(this)),h.on(c.a.METADATA_ARRIVED,z.bind(this)),h.on(c.a.SCRIPTDATA_ARRIVED,q.bind(this)),h.on(c.a.TIMED_ID3_METADATA_ARRIVED,C.bind(this)),h.on(c.a.PGS_SUBTITLE_ARRIVED,J.bind(this)),h.on(c.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,ee.bind(this)),h.on(c.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,U.bind(this)),h.on(c.a.SMPTE2038_METADATA_ARRIVED,u.bind(this)),h.on(c.a.SCTE35_METADATA_ARRIVED,d.bind(this)),h.on(c.a.PES_PRIVATE_DATA_DESCRIPTOR,l.bind(this)),h.on(c.a.PES_PRIVATE_DATA_ARRIVED,g.bind(this)),h.on(c.a.STATISTICS_INFO,K.bind(this)),h.on(c.a.RECOMMEND_SEEKPOINT,de.bind(this));break;case"destroy":h&&(h.destroy(),h=null),a.postMessage({msg:"destroyed"});break;case"start":h.start();break;case"stop":h.stop();break;case"seek":h.seek(H.data.param);break;case"pause":h.pause();break;case"resume":h.resume();break;case"logging_config":var ne=H.data.param;V.a.applyConfig(ne),ne.enableCallback===!0?V.a.addLogListener(f):V.a.removeLogListener(f);break;case"switch_audio":h._demuxer instanceof y.a&&(H.data.param==="primary"?h._demuxer.preferred_secondary_audio=!1:H.data.param==="secondary"&&(h._demuxer.preferred_secondary_audio=!0))}})}},function(ge,_e,x){ge.exports=x(30).default},function(ge,_e,x){(function(V,T){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var L;L=function(){function c(b){return typeof b=="function"}var y=Array.isArray?Array.isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"},a=0,h=void 0,f=void 0,A=function(b,w){C[a]=b,C[a+1]=w,(a+=2)===2&&(f?f(J):l())},E=typeof window<"u"?window:void 0,O=E||{},G=O.MutationObserver||O.WebKitMutationObserver,I=typeof self>"u"&&V!==void 0&&{}.toString.call(V)==="[object process]",z=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function q(){var b=setTimeout;return function(){return b(J,1)}}var C=new Array(1e3);function J(){for(var b=0;b<a;b+=2)(0,C[b])(C[b+1]),C[b]=void 0,C[b+1]=void 0;a=0}var ee,U,u,d,l=void 0;function g(b,w){var N=this,F=new this.constructor(ae);F[$]===void 0&&r(F);var P=N._state;if(P){var W=arguments[P-1];A(function(){return i(P,F,W,N._result)})}else t(N,F,b,w);return F}function K(b){if(b&&typeof b=="object"&&b.constructor===this)return b;var w=new this(ae);return H(w,b),w}I?l=function(){return V.nextTick(J)}:G?(U=0,u=new G(J),d=document.createTextNode(""),u.observe(d,{characterData:!0}),l=function(){d.data=U=++U%2}):z?((ee=new MessageChannel).port1.onmessage=J,l=function(){return ee.port2.postMessage(0)}):l=E===void 0?function(){try{var b=Function("return this")().require("vertx");return(h=b.runOnLoop||b.runOnContext)!==void 0?function(){h(J)}:q()}catch{return q()}}():q();var $=Math.random().toString(36).substring(2);function ae(){}function de(b,w,N){w.constructor===b.constructor&&N===g&&w.constructor.resolve===K?function(F,P){P._state===1?re(F,P._result):P._state===2?R(F,P._result):t(P,void 0,function(W){return H(F,W)},function(W){return R(F,W)})}(b,w):N===void 0?re(b,w):c(N)?function(F,P,W){A(function(te){var ie=!1,ce=function(se,me,oe,ue){try{se.call(me,oe,ue)}catch(ye){return ye}}(W,P,function(se){ie||(ie=!0,P!==se?H(te,se):re(te,se))},function(se){ie||(ie=!0,R(te,se))},te._label);!ie&&ce&&(ie=!0,R(te,ce))},F)}(b,w,N):re(b,w)}function H(b,w){if(b===w)R(b,new TypeError("You cannot resolve a promise with itself"));else if(P=typeof(F=w),F===null||P!=="object"&&P!=="function")re(b,w);else{var N=void 0;try{N=w.then}catch(W){return void R(b,W)}de(b,w,N)}var F,P}function ne(b){b._onerror&&b._onerror(b._result),e(b)}function re(b,w){b._state===void 0&&(b._result=w,b._state=1,b._subscribers.length!==0&&A(e,b))}function R(b,w){b._state===void 0&&(b._state=2,b._result=w,A(ne,b))}function t(b,w,N,F){var P=b._subscribers,W=P.length;b._onerror=null,P[W]=w,P[W+1]=N,P[W+2]=F,W===0&&b._state&&A(e,b)}function e(b){var w=b._subscribers,N=b._state;if(w.length!==0){for(var F=void 0,P=void 0,W=b._result,te=0;te<w.length;te+=3)F=w[te],P=w[te+N],F?i(N,F,P,W):P(W);b._subscribers.length=0}}function i(b,w,N,F){var P=c(N),W=void 0,te=void 0,ie=!0;if(P){try{W=N(F)}catch(ce){ie=!1,te=ce}if(w===W)return void R(w,new TypeError("A promises callback cannot return that same promise."))}else W=F;w._state!==void 0||(P&&ie?H(w,W):ie===!1?R(w,te):b===1?re(w,W):b===2&&R(w,W))}var o=0;function r(b){b[$]=o++,b._state=void 0,b._result=void 0,b._subscribers=[]}var v=function(){function b(w,N){this._instanceConstructor=w,this.promise=new w(ae),this.promise[$]||r(this.promise),y(N)?(this.length=N.length,this._remaining=N.length,this._result=new Array(this.length),this.length===0?re(this.promise,this._result):(this.length=this.length||0,this._enumerate(N),this._remaining===0&&re(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}return b.prototype._enumerate=function(w){for(var N=0;this._state===void 0&&N<w.length;N++)this._eachEntry(w[N],N)},b.prototype._eachEntry=function(w,N){var F=this._instanceConstructor,P=F.resolve;if(P===K){var W=void 0,te=void 0,ie=!1;try{W=w.then}catch(se){ie=!0,te=se}if(W===g&&w._state!==void 0)this._settledAt(w._state,N,w._result);else if(typeof W!="function")this._remaining--,this._result[N]=w;else if(F===k){var ce=new F(ae);ie?R(ce,te):de(ce,w,W),this._willSettleAt(ce,N)}else this._willSettleAt(new F(function(se){return se(w)}),N)}else this._willSettleAt(P(w),N)},b.prototype._settledAt=function(w,N,F){var P=this.promise;P._state===void 0&&(this._remaining--,w===2?R(P,F):this._result[N]=F),this._remaining===0&&re(P,this._result)},b.prototype._willSettleAt=function(w,N){var F=this;t(w,void 0,function(P){return F._settledAt(1,N,P)},function(P){return F._settledAt(2,N,P)})},b}(),k=function(){function b(w){this[$]=o++,this._result=this._state=void 0,this._subscribers=[],ae!==w&&(typeof w!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof b?function(N,F){try{F(function(P){H(N,P)},function(P){R(N,P)})}catch(P){R(N,P)}}(this,w):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return b.prototype.catch=function(w){return this.then(null,w)},b.prototype.finally=function(w){var N=this.constructor;return c(w)?this.then(function(F){return N.resolve(w()).then(function(){return F})},function(F){return N.resolve(w()).then(function(){throw F})}):this.then(w,w)},b}();return k.prototype.then=g,k.all=function(b){return new v(this,b).promise},k.race=function(b){var w=this;return y(b)?new w(function(N,F){for(var P=b.length,W=0;W<P;W++)w.resolve(b[W]).then(N,F)}):new w(function(N,F){return F(new TypeError("You must pass an array to race."))})},k.resolve=K,k.reject=function(b){var w=new this(ae);return R(w,b),w},k._setScheduler=function(b){f=b},k._setAsap=function(b){A=b},k._asap=A,k.polyfill=function(){var b=void 0;if(T!==void 0)b=T;else if(typeof self<"u")b=self;else try{b=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var w=b.Promise;if(w){var N=null;try{N=Object.prototype.toString.call(w.resolve())}catch{}if(N==="[object Promise]"&&!w.cast)return}b.Promise=k},k.Promise=k,k},ge.exports=L()}).call(this,x(27),x(28))},function(ge,_e){var x,V,T=ge.exports={};function L(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function y(z){if(x===setTimeout)return setTimeout(z,0);if((x===L||!x)&&setTimeout)return x=setTimeout,setTimeout(z,0);try{return x(z,0)}catch{try{return x.call(null,z,0)}catch{return x.call(this,z,0)}}}(function(){try{x=typeof setTimeout=="function"?setTimeout:L}catch{x=L}try{V=typeof clearTimeout=="function"?clearTimeout:c}catch{V=c}})();var a,h=[],f=!1,A=-1;function E(){f&&a&&(f=!1,a.length?h=a.concat(h):A=-1,h.length&&O())}function O(){if(!f){var z=y(E);f=!0;for(var q=h.length;q;){for(a=h,h=[];++A<q;)a&&a[A].run();A=-1,q=h.length}a=null,f=!1,function(C){if(V===clearTimeout)return clearTimeout(C);if((V===c||!V)&&clearTimeout)return V=clearTimeout,clearTimeout(C);try{V(C)}catch{try{return V.call(null,C)}catch{return V.call(this,C)}}}(z)}}function G(z,q){this.fun=z,this.array=q}function I(){}T.nextTick=function(z){var q=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)q[C-1]=arguments[C];h.push(new G(z,q)),h.length!==1||f||y(O)},G.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=I,T.addListener=I,T.once=I,T.off=I,T.removeListener=I,T.removeAllListeners=I,T.emit=I,T.prependListener=I,T.prependOnceListener=I,T.listeners=function(z){return[]},T.binding=function(z){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(z){throw new Error("process.chdir is not supported")},T.umask=function(){return 0}},function(ge,_e){var x;x=function(){return this}();try{x=x||new Function("return this")()}catch{typeof window=="object"&&(x=window)}ge.exports=x},function(ge,_e,x){x.r(_e);var V=x(0),T=x(9),L=x(3),c=x(7),y=x(21),a=x(22),h=x(1),f=x(4),A=x(11);_e.default=function(E){var O="PlayerEngineWorker",G=function(R,t){E.postMessage({msg:"logcat_callback",type:R,logcat:t})}.bind(void 0),I=null,z=null,q=null,C=null,J=!1,ee=!1,U=0,u=0,d=!1;function l(){q&&(q.shutdown(),q.destroy(),q=null)}function g(){if(I==null||z==null)throw new L.a("Worker not initialized");if(C)throw new L.a("Transmuxer has been initialized");ee||(!z.deferLoadAfterSourceOpen||J?((C=new a.a(I,z)).on(h.a.INIT_SEGMENT,function(R,t){q.appendInitSegment(t)}),C.on(h.a.MEDIA_SEGMENT,function(R,t){q.appendMediaSegment(t),E.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:t.info.endDts})}),C.on(h.a.LOADING_COMPLETE,function(){q.endOfStream(),E.postMessage({msg:"player_event",event:f.a.LOADING_COMPLETE})}),C.on(h.a.RECOVERED_EARLY_EOF,function(){E.postMessage({msg:"player_event",event:f.a.RECOVERED_EARLY_EOF})}),C.on(h.a.IO_ERROR,function(R,t){E.postMessage({msg:"player_event",event:f.a.ERROR,error_type:A.b.NETWORK_ERROR,error_detail:R,info:t})}),C.on(h.a.DEMUX_ERROR,function(R,t){E.postMessage({msg:"player_event",event:f.a.ERROR,error_type:A.b.MEDIA_ERROR,error_detail:R,info:t})}),C.on(h.a.MEDIA_INFO,function(R){ne(h.a.MEDIA_INFO,R)}),C.on(h.a.STATISTICS_INFO,function(R){ne(h.a.STATISTICS_INFO,R)}),C.on(h.a.RECOMMEND_SEEKPOINT,function(R){(function(t){E.postMessage({msg:"transmuxing_event",event:h.a.RECOMMEND_SEEKPOINT,milliseconds:t})})(R)}),C.on(h.a.METADATA_ARRIVED,function(R){re(f.a.METADATA_ARRIVED,R)}),C.on(h.a.SCRIPTDATA_ARRIVED,function(R){re(f.a.SCRIPTDATA_ARRIVED,R)}),C.on(h.a.TIMED_ID3_METADATA_ARRIVED,function(R){re(f.a.TIMED_ID3_METADATA_ARRIVED,R)}),C.on(h.a.PGS_SUBTITLE_ARRIVED,function(R){re(f.a.PGS_SUBTITLE_ARRIVED,R)}),C.on(h.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(R){re(f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,R)}),C.on(h.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(R){re(f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,R)}),C.on(h.a.SMPTE2038_METADATA_ARRIVED,function(R){re(f.a.SMPTE2038_METADATA_ARRIVED,R)}),C.on(h.a.SCTE35_METADATA_ARRIVED,function(R){re(f.a.SCTE35_METADATA_ARRIVED,R)}),C.on(h.a.PES_PRIVATE_DATA_DESCRIPTOR,function(R){re(f.a.PES_PRIVATE_DATA_DESCRIPTOR,R)}),C.on(h.a.PES_PRIVATE_DATA_ARRIVED,function(R){re(f.a.PES_PRIVATE_DATA_ARRIVED,R)}),C.open()):ee=!0)}function K(){q&&q.flush(),C&&(C.close(),C.destroy(),C=null)}function $(){J=!0,ee&&(ee=!1,g())}function ae(){E.postMessage({msg:"mse_event",event:c.a.UPDATE_END})}function de(){V.a.v(O,"MSE SourceBuffer is full, report to main thread"),E.postMessage({msg:"mse_event",event:c.a.BUFFER_FULL})}function H(R){E.postMessage({msg:"player_event",event:f.a.ERROR,error_type:A.b.MEDIA_ERROR,error_detail:A.b.MEDIA_MSE_ERROR,info:R})}function ne(R,t){E.postMessage({msg:"transmuxing_event",event:R,info:t})}function re(R,t){E.postMessage({msg:"player_event",event:R,extraData:t})}E.addEventListener("message",function(R){if(!d){var t=R.data;switch(t.cmd){case"logging_config":var e=t;T.a.applyConfig(e.logging_config),e.logging_config.enableCallback===!0?T.a.addLogListener(G):T.a.removeLogListener(G);break;case"init":I=(e=t).media_data_source,z=e.config;break;case"destroy":(function(){C&&K(),q&&l(),d=!0,E.postMessage({msg:"destroyed"})})();break;case"initialize_mse":(function(){V.a.v(O,"Initializing MediaSource in DedicatedWorker"),(q=new y.a(z)).on(c.a.SOURCE_OPEN,$.bind(this)),q.on(c.a.UPDATE_END,ae.bind(this)),q.on(c.a.BUFFER_FULL,de.bind(this)),q.on(c.a.ERROR,H.bind(this)),q.initialize({getCurrentTime:function(){return U},getReadyState:function(){return u}});var i=q.getHandle();E.postMessage({msg:"mse_init",handle:i},[i])})();break;case"shutdown_mse":l();break;case"load":g();break;case"unload":K();break;case"unbuffered_seek":e=t,q.flush(),C.seek(e.milliseconds);break;case"timeupdate":U=(e=t).current_time;break;case"readystatechange":u=(e=t).ready_state;break;case"pause_transmuxer":C.pause();break;case"resume_transmuxer":C.resume();break;case"switch_audio":(e=t).audio_track==="primary"?C.switchPrimaryAudio():e.audio_track==="secondary"&&C.switchSecondaryAudio()}}})}},function(ge,_e,x){x.r(_e);var V=x(19),T=x(17),L={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,liveSyncMinLatency:void 0,liveSyncMinPlaybackRate:.95,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function c(){return Object.assign({},L)}var y=x(10),a=x.n(y),h=x(20),f=x(0),A=x(9),E=x(7),O=x(4),G=x(1),I=x(5),z=x(12),q=function(){function R(t,e,i){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new z.a,this.e=null,this._config=t,this._media_element=e,this._on_unbuffered_seek=i,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var o=I.a.chrome&&(I.a.version.major<50||I.a.version.major===50&&I.a.version.build<2661);this._always_seek_keyframe=!!(o||I.a.msedge||I.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return R.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},R.prototype.seek=function(t){var e=this._isPositionBuffered(t),i=!1;if(t<1&&this._media_element.buffered.length>0){var o=this._media_element.buffered.start(0);(o<1&&t<o||I.a.safari)&&(i=!0,t=I.a.safari?.1:o)}if(i)this.directSeek(t);else if(e)if(this._always_seek_keyframe){var r=this._getNearestKeyframe(Math.floor(1e3*t));r!=null&&(t=r.dts/1e3),this.directSeek(t)}else this.directSeek(t);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*t)),this._config.accurateSeek&&this.directSeek(t)},R.prototype.directSeek=function(t){this._request_set_current_time=!0,this._media_element.currentTime=t},R.prototype.appendSyncPoints=function(t){this._idr_sample_list.appendArray(t)},R.prototype._onMediaSeeking=function(t){if(this._request_set_current_time)this._request_set_current_time=!1;else{var e=this._media_element.currentTime,i=this._media_element.buffered;if(e<1&&i.length>0){var o=i.start(0);if(o<1&&e<o||I.a.safari){var r=I.a.safari?.1:o;return void this.directSeek(r)}}if(this._isPositionBuffered(e)){if(this._always_seek_keyframe){var v=this._getNearestKeyframe(Math.floor(1e3*e));v!=null&&(e=v.dts/1e3,this.directSeek(e))}}else this._seek_request_record_clocktime=R._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},R.prototype._pollAndApplyUnbufferedSeek=function(){if(this._seek_request_record_clocktime!=null)if(this._seek_request_record_clocktime<=R._getClockTime()-100){var t=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(t)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*t)),this._config.accurateSeek&&this.directSeek(t))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},R.prototype._isPositionBuffered=function(t){for(var e=this._media_element.buffered,i=0;i<e.length;i++){var o=e.start(i),r=e.end(i);if(t>=o&&t<r)return!0}return!1},R.prototype._getNearestKeyframe=function(t){return this._idr_sample_list.getLastSyncPointBeforeDts(t)},R._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},R}(),C=function(){function R(t,e,i,o){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=t,this._media_element=e,this._on_pause_transmuxer=i,this._on_resume_transmuxer=o,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return R.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},R.prototype.notifyBufferedPositionChanged=function(t){!this._config.isLive&&this._config.lazyLoad&&(t==null?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(t))},R.prototype._onMediaTimeUpdate=function(t){this._paused&&this._resumeTransmuxerIfNeeded()},R.prototype._suspendTransmuxerIfNeeded=function(){for(var t=this._media_element.buffered,e=this._media_element.currentTime,i=0,o=0;o<t.length;o++){var r=t.start(o),v=t.end(o);if(r<=e&&e<v){i=v;break}}i>0&&this._suspendTransmuxerIfBufferedPositionExceeded(i)},R.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(t){t>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(f.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},R.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},R.prototype._resumeTransmuxerIfNeeded=function(){for(var t=this._media_element.buffered,e=this._media_element.currentTime,i=this._config.lazyLoadRecoverDuration,o=!1,r=0;r<t.length;r++){var v=t.start(r),k=t.end(r);if(e>=v&&e<k){e>=k-i&&(o=!0);break}}o&&(f.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},R.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},R}(),J=function(){function R(t,e){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=t,this._on_direct_seek=e,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return R.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},R.prototype._onMediaCanPlay=function(t){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},R.prototype._onMediaStalled=function(t){this._detectAndFixStuckPlayback(!0)},R.prototype._onMediaProgress=function(t){this._detectAndFixStuckPlayback()},R.prototype._detectAndFixStuckPlayback=function(t){var e=this._media_element,i=e.buffered;t||!this._canplay_received||e.readyState<2?i.length>0&&e.currentTime<i.start(0)&&(f.a.w(this.TAG,"Playback seems stuck at ".concat(e.currentTime,", seek to ").concat(i.start(0))),this._on_direct_seek(i.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},R}(),ee=function(){function R(t,e,i){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=t,this._media_element=e,this._on_direct_seek=i}return R.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},R.prototype.notifyBufferedRangeUpdate=function(){this._chaseLiveLatency()},R.prototype._chaseLiveLatency=function(){var t=this._media_element.buffered,e=this._media_element.currentTime,i=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&t.length!=0&&(this._config.liveBufferLatencyChasingOnPaused||!i)){var o=t.end(t.length-1);if(o>this._config.liveBufferLatencyMaxLatency&&o-e>this._config.liveBufferLatencyMaxLatency){var r=o-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(r)}}},R}(),U=function(){function R(t,e){this.TAG="LiveLatencySynchronizer",this._config=null,this._media_element=null,this.e=null,this._config=t,this._media_element=e,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return R.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},R.prototype._onMediaTimeUpdate=function(t){if(this._config.isLive&&this._config.liveSync){var e=this._getCurrentLatency();if(e>this._config.liveSyncMaxLatency){var i=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate!==i&&(f.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => ").concat(i)),this._media_element.playbackRate=i)}else e>this._config.liveSyncTargetLatency||(this._config.liveSyncMinLatency!=null&&e<this._config.liveSyncMinLatency?(i=Math.min(1,Math.max(.5,this._config.liveSyncMinPlaybackRate)),this._media_element.playbackRate!==i&&(f.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => ").concat(i)),this._media_element.playbackRate=i)):this._media_element.playbackRate!==1&&this._media_element.playbackRate!==0&&(f.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => 1")),this._media_element.playbackRate=1))}},R.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var t=this._media_element.buffered,e=this._media_element.currentTime;return t.length==0?0:t.end(t.length-1)-e},R}(),u=function(){function R(t,e){this.TAG="PlayerEngineDedicatedThread",this._emitter=new y,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._prev_ready_state=0,this._media_data_source=t,this._config=c(),typeof e=="object"&&Object.assign(this._config,e),t.isLive===!0&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},A.a.registerListener(this.e.onLoggingConfigChanged),this._worker=h(29,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:A.a.getConfig()})}return R.isSupported=function(){return!!self.Worker&&(!(!self.MediaSource||!("canConstructInDedicatedWorker"in self.MediaSource)||self.MediaSource.canConstructInDedicatedWorker!==!0)||!(!self.ManagedMediaSource||!("canConstructInDedicatedWorker"in self.ManagedMediaSource)||self.ManagedMediaSource.canConstructInDedicatedWorker!==!0))},R.prototype.destroy=function(){this._emitter.emit(O.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),A.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(t,e){var i=this;this._emitter.addListener(t,e),t===O.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return i._emitter.emit(O.a.MEDIA_INFO,i.mediaInfo)}):t==O.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return i._emitter.emit(O.a.STATISTICS_INFO,i.statisticsInfo)})},R.prototype.off=function(t,e){this._emitter.removeListener(t,e)},R.prototype.attachMediaElement=function(t){this._media_element=t,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("emptied",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("ended",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("waiting",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("canplay",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("canplaythrough",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadstart",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadeddata",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadedmetadata",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("progress",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("stalled",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},R.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("emptied",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("ended",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("waiting",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("canplay",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("canplaythrough",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadstart",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadeddata",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("progress",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("stalled",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},R.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new q(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new C(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new J(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new ee(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new U(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},R.prototype.unload=function(){var t,e,i,o,r,v;(t=this._media_element)===null||t===void 0||t.pause(),this._worker.postMessage({cmd:"unload"}),(e=this._live_latency_synchronizer)===null||e===void 0||e.destroy(),this._live_latency_synchronizer=null,(i=this._live_latency_chaser)===null||i===void 0||i.destroy(),this._live_latency_chaser=null,(o=this._startup_stall_jumper)===null||o===void 0||o.destroy(),this._startup_stall_jumper=null,(r=this._loading_controller)===null||r===void 0||r.destroy(),this._loading_controller=null,(v=this._seeking_handler)===null||v===void 0||v.destroy(),this._seeking_handler=null},R.prototype.play=function(){return this._media_element.play()},R.prototype.pause=function(){this._media_element.pause()},R.prototype.seek=function(t){this._media_element&&this._seeking_handler?this._seeking_handler.seek(t):this._pending_seek_time=t},R.prototype.switchPrimaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"primary"})},R.prototype.switchSecondaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"secondary"})},Object.defineProperty(R.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),R.prototype._onLoggingConfigChanged=function(t){var e;(e=this._worker)===null||e===void 0||e.postMessage({cmd:"logging_config",logging_config:t})},R.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},R.prototype._onMSEBufferFull=function(){f.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},R.prototype._onMediaLoadedMetadata=function(t){this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},R.prototype._onRequestDirectSeek=function(t){this._seeking_handler.directSeek(t)},R.prototype._onRequiredUnbufferedSeek=function(t){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:t})},R.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},R.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},R.prototype._onMediaTimeUpdate=function(t){this._worker.postMessage({cmd:"timeupdate",current_time:t.target.currentTime})},R.prototype._onMediaReadyStateChange=function(){var t;this._media_element!=null&&this._prev_ready_state!==((t=this._media_element)===null||t===void 0?void 0:t.readyState)&&(this._prev_ready_state=this._media_element.readyState,this._worker.postMessage({cmd:"readystatechange",ready_state:this._media_element.readyState}))},R.prototype._onWorkerMessage=function(t){var e,i=t.data,o=i.msg;if(o=="destroyed"||this._worker_destroying)return this._worker_destroying=!1,(e=this._worker)===null||e===void 0||e.terminate(),void(this._worker=null);switch(o){case"mse_init":var r=i;"ManagedMediaSource"in self&&!("MediaSource"in self)&&(this._media_element.disableRemotePlayback=!0),this._media_element.srcObject=r.handle;break;case"mse_event":(r=i).event==E.a.UPDATE_END?this._onMSEUpdateEnd():r.event==E.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((r=i).event==G.a.MEDIA_INFO){var v=i;this._media_info=v.info,this._emitter.emit(O.a.MEDIA_INFO,Object.assign({},v.info))}else if(r.event==G.a.STATISTICS_INFO){var k=i;this._statistics_info=this._fillStatisticsInfo(k.info),this._emitter.emit(O.a.STATISTICS_INFO,Object.assign({},k.info))}else if(r.event==G.a.RECOMMEND_SEEKPOINT){var b=i;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(b.milliseconds/1e3)}break;case"player_event":if((r=i).event==O.a.ERROR){var w=i;this._emitter.emit(O.a.ERROR,w.error_type,w.error_detail,w.info)}else if("extraData"in r){var N=i;this._emitter.emit(N.event,N.extraData)}break;case"logcat_callback":r=i,f.a.emitter.emit("log",r.type,r.logcat);break;case"buffered_position_changed":r=i,this._loading_controller.notifyBufferedPositionChanged(r.buffered_position_milliseconds/1e3)}},R.prototype._fillStatisticsInfo=function(t){if(t.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return t;var e=!0,i=0,o=0;if(this._media_element.getVideoPlaybackQuality){var r=this._media_element.getVideoPlaybackQuality();i=r.totalVideoFrames,o=r.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(i=this._media_element.webkitDecodedFrameCount,o=this._media_element.webkitDroppedFrameCount):e=!1;return e&&(t.decodedFrames=i,t.droppedFrames=o),t},R}(),d=function(){function R(){}return R.supportMSEH264Playback=function(){var t=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),e=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return t===!0||e===!0},R.supportMSEH265Playback=function(){var t=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),e=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return t===!0||e===!0},R.supportWorkerForMSEH265Playback=function(){return new Promise(function(t){if(u.isSupported()){var e=URL.createObjectURL(new Blob([`
                const hevc_mime_type = 'video/mp4; codecs="hvc1.1.6.L93.B0"';
                const support_w3c_mse = self.MediaSource && self.MediaSource.isTypeSupported(hevc_mime_type);
                const support_apple_mme = self.ManagedMediaSource && self.ManagedMediaSource.isTypeSupported(hevc_mime_type);
                self.postMessage(support_w3c_mse === true || support_apple_mme === true);
            `],{type:"application/javascript"}));new Worker(e).addEventListener("message",function(i){return t(i.data)}),URL.revokeObjectURL(e)}else t(!1)})},R.supportNetworkStreamIO=function(){var t=new T.a({},c()),e=t.loaderType;return t.destroy(),e=="fetch-stream-loader"||e=="xhr-moz-chunked-loader"},R.getNetworkLoaderTypeName=function(){var t=new T.a({},c()),e=t.loaderType;return t.destroy(),e},R.supportNativeMediaPlayback=function(t){R.videoElement==null&&(R.videoElement=window.document.createElement("video"));var e=R.videoElement.canPlayType(t);return e==="probably"||e=="maybe"},R.getFeatureList=function(){var t={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.msePlayback=R.supportMSEH264Playback(),t.networkStreamIO=R.supportNetworkStreamIO(),t.networkLoaderName=R.getNetworkLoaderTypeName(),t.mseLivePlayback=t.msePlayback&&t.networkStreamIO,t.mseH265Playback=R.supportMSEH265Playback(),t.nativeMP4H264Playback=R.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeMP4H265Playback=R.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),t.nativeWebmVP8Playback=R.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=R.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},R}(),l=x(2),g=x(21),K=x(22),$=x(11),ae=x(3),de=function(){function R(t,e){this.TAG="PlayerEngineMainThread",this._emitter=new y,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=t,this._config=c(),typeof e=="object"&&Object.assign(this._config,e),t.isLive===!0&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return R.prototype.destroy=function(){this._emitter.emit(O.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(t,e){var i=this;this._emitter.addListener(t,e),t===O.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return i._emitter.emit(O.a.MEDIA_INFO,i.mediaInfo)}):t==O.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return i._emitter.emit(O.a.STATISTICS_INFO,i.statisticsInfo)})},R.prototype.off=function(t,e){this._emitter.removeListener(t,e)},R.prototype.attachMediaElement=function(t){var e=this;this._media_element=t,t.src="",t.removeAttribute("src"),t.srcObject=null,t.load(),t.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new g.a(this._config),this._mse_controller.on(E.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(E.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(E.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(E.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(E.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(E.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return e._media_element.currentTime},getReadyState:function(){return e._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(t.disableRemotePlayback=!0,t.srcObject=this._mse_controller.getObject()):t.src=this._mse_controller.getObjectURL()},R.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},R.prototype.load=function(){var t=this;if(!this._media_element)throw new ae.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new ae.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new K.a(this._media_data_source,this._config),this._transmuxer.on(G.a.INIT_SEGMENT,function(e,i){t._mse_controller.appendInitSegment(i)}),this._transmuxer.on(G.a.MEDIA_SEGMENT,function(e,i){t._mse_controller.appendMediaSegment(i),!t._config.isLive&&e==="video"&&i.data&&i.data.byteLength>0&&"info"in i&&t._seeking_handler.appendSyncPoints(i.info.syncPoints),t._loading_controller.notifyBufferedPositionChanged(i.info.endDts/1e3)}),this._transmuxer.on(G.a.LOADING_COMPLETE,function(){t._mse_controller.endOfStream(),t._emitter.emit(O.a.LOADING_COMPLETE)}),this._transmuxer.on(G.a.RECOVERED_EARLY_EOF,function(){t._emitter.emit(O.a.RECOVERED_EARLY_EOF)}),this._transmuxer.on(G.a.IO_ERROR,function(e,i){t._emitter.emit(O.a.ERROR,$.b.NETWORK_ERROR,e,i)}),this._transmuxer.on(G.a.DEMUX_ERROR,function(e,i){t._emitter.emit(O.a.ERROR,$.b.MEDIA_ERROR,e,i)}),this._transmuxer.on(G.a.MEDIA_INFO,function(e){t._media_info=e,t._emitter.emit(O.a.MEDIA_INFO,Object.assign({},e))}),this._transmuxer.on(G.a.STATISTICS_INFO,function(e){t._statistics_info=t._fillStatisticsInfo(e),t._emitter.emit(O.a.STATISTICS_INFO,Object.assign({},e))}),this._transmuxer.on(G.a.RECOMMEND_SEEKPOINT,function(e){t._media_element&&!t._config.accurateSeek&&t._seeking_handler.directSeek(e/1e3)}),this._transmuxer.on(G.a.METADATA_ARRIVED,function(e){t._emitter.emit(O.a.METADATA_ARRIVED,e)}),this._transmuxer.on(G.a.SCRIPTDATA_ARRIVED,function(e){t._emitter.emit(O.a.SCRIPTDATA_ARRIVED,e)}),this._transmuxer.on(G.a.TIMED_ID3_METADATA_ARRIVED,function(e){t._emitter.emit(O.a.TIMED_ID3_METADATA_ARRIVED,e)}),this._transmuxer.on(G.a.PGS_SUBTITLE_ARRIVED,function(e){t._emitter.emit(O.a.PGS_SUBTITLE_ARRIVED,e)}),this._transmuxer.on(G.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(e){t._emitter.emit(O.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e)}),this._transmuxer.on(G.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(e){t._emitter.emit(O.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)}),this._transmuxer.on(G.a.SMPTE2038_METADATA_ARRIVED,function(e){t._emitter.emit(O.a.SMPTE2038_METADATA_ARRIVED,e)}),this._transmuxer.on(G.a.SCTE35_METADATA_ARRIVED,function(e){t._emitter.emit(O.a.SCTE35_METADATA_ARRIVED,e)}),this._transmuxer.on(G.a.PES_PRIVATE_DATA_DESCRIPTOR,function(e){t._emitter.emit(O.a.PES_PRIVATE_DATA_DESCRIPTOR,e)}),this._transmuxer.on(G.a.PES_PRIVATE_DATA_ARRIVED,function(e){t._emitter.emit(O.a.PES_PRIVATE_DATA_ARRIVED,e)}),this._seeking_handler=new q(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new C(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new J(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new ee(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new U(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},R.prototype.unload=function(){var t,e,i,o,r,v,k,b,w;(t=this._media_element)===null||t===void 0||t.pause(),(e=this._live_latency_synchronizer)===null||e===void 0||e.destroy(),this._live_latency_synchronizer=null,(i=this._live_latency_chaser)===null||i===void 0||i.destroy(),this._live_latency_chaser=null,(o=this._startup_stall_jumper)===null||o===void 0||o.destroy(),this._startup_stall_jumper=null,(r=this._loading_controller)===null||r===void 0||r.destroy(),this._loading_controller=null,(v=this._seeking_handler)===null||v===void 0||v.destroy(),this._seeking_handler=null,(k=this._mse_controller)===null||k===void 0||k.flush(),(b=this._transmuxer)===null||b===void 0||b.close(),(w=this._transmuxer)===null||w===void 0||w.destroy(),this._transmuxer=null},R.prototype.play=function(){return this._media_element.play()},R.prototype.pause=function(){this._media_element.pause()},R.prototype.seek=function(t){this._media_element&&this._seeking_handler?this._seeking_handler.seek(t):this._pending_seek_time=t},R.prototype.switchPrimaryAudio=function(){this._transmuxer.switchPrimaryAudio()},R.prototype.switchSecondaryAudio=function(){this._transmuxer.switchSecondaryAudio()},Object.defineProperty(R.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),R.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},R.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},R.prototype._onMSEBufferFull=function(){f.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},R.prototype._onMSEError=function(t){this._emitter.emit(O.a.ERROR,$.b.MEDIA_ERROR,$.a.MEDIA_MSE_ERROR,t)},R.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(f.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},R.prototype._onMSEEndStreaming=function(){this._config.isLive||(f.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},R.prototype._onMediaLoadedMetadata=function(t){this._loaded_metadata_received=!0,this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},R.prototype._onRequestDirectSeek=function(t){this._seeking_handler.directSeek(t)},R.prototype._onRequiredUnbufferedSeek=function(t){this._mse_controller.flush(),this._transmuxer.seek(t)},R.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},R.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},R.prototype._fillStatisticsInfo=function(t){if(t.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return t;var e=!0,i=0,o=0;if(this._media_element.getVideoPlaybackQuality){var r=this._media_element.getVideoPlaybackQuality();i=r.totalVideoFrames,o=r.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(i=this._media_element.webkitDecodedFrameCount,o=this._media_element.webkitDroppedFrameCount):e=!1;return e&&(t.decodedFrames=i,t.droppedFrames=o),t},R}(),H=function(){function R(t,e){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var i=t.type.toLowerCase();if(i!=="mse"&&i!=="mpegts"&&i!=="m2ts"&&i!=="flv")throw new ae.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");if(e&&e.enableWorkerForMSE&&u.isSupported())try{this._player_engine=new u(t,e)}catch{f.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new de(t,e)}else this._player_engine=new de(t,e)}return R.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},R.prototype.on=function(t,e){this._player_engine.on(t,e)},R.prototype.off=function(t,e){this._player_engine.off(t,e)},R.prototype.attachMediaElement=function(t){this._media_element=t,this._player_engine.attachMediaElement(t)},R.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},R.prototype.load=function(){this._player_engine.load()},R.prototype.unload=function(){this._player_engine.unload()},R.prototype.play=function(){return this._player_engine.play()},R.prototype.pause=function(){this._player_engine.pause()},R.prototype.switchPrimaryAudio=function(){this._player_engine.switchPrimaryAudio()},R.prototype.switchSecondaryAudio=function(){this._player_engine.switchSecondaryAudio()},Object.defineProperty(R.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"volume",{get:function(){return this._media_element.volume},set:function(t){this._media_element.volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"muted",{get:function(){return this._media_element.muted},set:function(t){this._media_element.muted=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(t){this._player_engine.seek(t)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),R}(),ne=function(){function R(t,e){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new a.a,this._config=c(),typeof e=="object"&&Object.assign(this._config,e);var i=t.type.toLowerCase();if(i==="mse"||i==="mpegts"||i==="m2ts"||i==="flv")throw new ae.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(t.hasOwnProperty("segments"))throw new ae.b("NativePlayer(".concat(t.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=t,this._mediaElement=null}return R.prototype.destroy=function(){this._emitter.emit(O.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(t,e){var i=this;t===O.a.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){i._emitter.emit(O.a.MEDIA_INFO,i.mediaInfo)}):t===O.a.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){i._emitter.emit(O.a.STATISTICS_INFO,i.statisticsInfo)}),this._emitter.addListener(t,e)},R.prototype.off=function(t,e){this._emitter.removeListener(t,e)},R.prototype.attachMediaElement=function(t){if(this._mediaElement=t,t.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{t.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},R.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},R.prototype.load=function(){if(!this._mediaElement)throw new ae.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},R.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},R.prototype.play=function(){return this._mediaElement.play()},R.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(R.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(t){this._mediaElement.volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(t){this._mediaElement.muted=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(t){this._mediaElement?this._mediaElement.currentTime=t:this._pendingSeekTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"mediaInfo",{get:function(){var t={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(t.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(t.width=this._mediaElement.videoWidth,t.height=this._mediaElement.videoHeight)),t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){var t={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return t;var e=!0,i=0,o=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();i=r.totalVideoFrames,o=r.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(i=this._mediaElement.webkitDecodedFrameCount,o=this._mediaElement.webkitDroppedFrameCount):e=!1;return e&&(t.decodedFrames=i,t.droppedFrames=o),t},enumerable:!1,configurable:!0}),R.prototype._onvLoadedMetadata=function(t){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(O.a.MEDIA_INFO,this.mediaInfo)},R.prototype._reportStatisticsInfo=function(){this._emitter.emit(O.a.STATISTICS_INFO,this.statisticsInfo)},R}();V.a.install();var re={createPlayer:function(R,t){var e=R;if(e==null||typeof e!="object")throw new ae.b("MediaDataSource must be an javascript object!");if(!e.hasOwnProperty("type"))throw new ae.b("MediaDataSource must has type field to indicate video file type!");switch(e.type){case"mse":case"mpegts":case"m2ts":case"flv":return new H(e,t);default:return new ne(e,t)}},isSupported:function(){return d.supportMSEH264Playback()},getFeatureList:function(){return d.getFeatureList()},supportWorkerForMSEH265Playback:function(){return d.supportWorkerForMSEH265Playback()}};re.BaseLoader=l.a,re.LoaderStatus=l.c,re.LoaderErrors=l.b,re.Events=O.a,re.ErrorTypes=$.b,re.ErrorDetails=$.a,re.MSEPlayer=H,re.NativePlayer=ne,re.LoggingControl=A.a,Object.defineProperty(re,"version",{enumerable:!0,get:function(){return"1.8.0"}}),_e.default=re}])})})(Ke);var Je=Ke.exports;const et=Qe(Je);export{et as m};
