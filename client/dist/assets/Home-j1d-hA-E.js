import{I as H,aL as M,aK as m,aC as B,aM as U,aE as $,a4 as o,p as l,aw as e,a3 as _,a1 as u,ac as p,a5 as f,ad as S,F as v,a8 as w,a7 as h,aN as T,a2 as L,_ as a,Z as C,ax as r,ay as d}from"./SnackbarsStore-DIk21UOt.js";import{S as z,a as V}from"./swiper-XVfzbPiK.js";import{N as j,H as N}from"./Navigation-B47x4_i7.js";import{S as I}from"./SPHeaderBar-2Yas3nt6.js";import{C as O,u as Z}from"./ChannelsStore-BWUcXsJf.js";import{_ as R,v as K,V as X,w as E,R as g}from"./top-C3_z9XjD.js";import{V as q}from"./ssrBoot-CuFyBO7j.js";import"./logo-C7_TYzD2.js";import"./VersionStore-D4pVBsth.js";const G=H({name:"TV-Home",components:{SPHeaderBar:I,HeaderBar:N,Navigation:j,Swiper:V,SwiperSlide:z},data(){return{Utils:Object.freeze(B),ChannelUtils:Object.freeze(O),ProgramUtils:Object.freeze(U),Message:Object.freeze(m),active_tab_index:0,swiper_instance:null,scroll_abort_controller:new AbortController,is_loading:!0,interval_ids:[]}},computed:{...M(Z,$)},watch:{active_tab_index(){this.swiper_instance?.updateAutoHeight(),this.swiper_instance?.slideTo(this.active_tab_index,this.is_loading===!0?0:void 0)}},async mounted(){this.settingsStore.settings.pinned_channel_ids.length===0&&(this.active_tab_index=1);const n=60-new Date().getSeconds();this.interval_ids.push(window.setTimeout(()=>{this.channelsStore.update(!0),this.interval_ids.push(window.setInterval(()=>this.channelsStore.update(!0),30*1e3))},n*1e3)),await this.channelsStore.update(),this.channelsStore.channels_list_with_pinned.get("ピン留め")?.length===0&&(this.active_tab_index=1),this.swiper_instance?.updateAutoHeight(),window.addEventListener("scroll",()=>{this.swiper_instance?.updateAutoHeight()},{passive:!0,signal:this.scroll_abort_controller.signal}),await B.sleep(.01),this.is_loading=!1},beforeUnmount(){for(const n of this.interval_ids)window.clearInterval(n);this.scroll_abort_controller.abort(),this.scroll_abort_controller=new AbortController},methods:{addPinnedChannel(n){this.settingsStore.settings.pinned_channel_ids=[...this.settingsStore.settings.pinned_channel_ids,n.id],m.show(`${n.name}をピン留めしました。`)},removePinnedChannel(n){this.settingsStore.settings.pinned_channel_ids=this.settingsStore.settings.pinned_channel_ids.filter(t=>t!==n.id),this.channelsStore.channels_list_with_pinned.get("ピン留め")?.length===0&&(this.active_tab_index=1),m.show(`${n.name}のピン留めを外しました。`)},isPinnedChannel(n){return this.settingsStore.settings.pinned_channel_ids.includes(n.id)}}}),J={class:"route-container"},Q={class:"channels-tab"},W={class:"channel__broadcaster"},Y=["src"],ee={class:"channel__broadcaster-content"},te={class:"channel__broadcaster-name"},ne={class:"channel__broadcaster-status"},se={class:"ml-1"},ie={class:"channel__broadcaster-status-viewers ml-4"},ae={class:"ml-1"},oe=["onClick"],re={class:"channel__program-present"},le={class:"channel__program-present-title-wrapper"},ue=["innerHTML"],de={class:"channel__program-present-time"},ce=["innerHTML"],_e={class:"channel__program-following"},pe={class:"channel__program-following-title"},he=["innerHTML"],ge={class:"channel__program-following-time"},me={class:"channel__progressbar"},fe={key:0,class:"channel custom-link d-flex justify-center align-center",draggable:"false",href:"/konomitv/wholech/"},ve={key:1,class:"pinned-container d-flex justify-center align-center w-100"},we={class:"d-flex justify-center align-center flex-column"},Ce={class:"mt-4 text-text-darken-1"},be={key:0,class:"channels-list pinned-container d-flex justify-center align-center w-100",style:{"flex-grow":"1"}},Be={class:"floating-button__content"};function Se(n,t,Ee,ye,De,Fe){const y=u("HeaderBar"),D=u("Navigation"),F=u("SPHeaderBar"),x=u("router-link"),b=u("Icon"),k=u("SwiperSlide"),A=u("Swiper"),P=L("ftooltip");return a(),o("div",J,[l(y),e("main",null,[l(D),e("div",{class:p(["channels-container channels-container--home",{"channels-container--loading":n.is_loading}])},[l(F),e("div",Q,[e("div",{class:"channels-tab__buttons",style:S({"--tab-length":Array.from(n.channelsStore.channels_list_with_pinned).length,"--active-tab-index":n.active_tab_index})},[(a(!0),o(v,null,w(Array.from(n.channelsStore.channels_list_with_pinned),([i],c)=>(a(),C(X,{variant:"flat",class:"channels-tab__button",key:i,onClick:s=>n.active_tab_index=c},{default:h(()=>[r(d(i),1)]),_:2},1032,["onClick"]))),128)),t[4]||(t[4]=e("div",{class:"channels-tab__highlight"},null,-1))],4)]),_(l(A,{class:"channels-list","space-between":32,"auto-height":!0,"touch-start-prevent-default":!1,observer:!0,"observe-parents":!0,onSwiper:t[1]||(t[1]=i=>n.swiper_instance=i),onSlideChange:t[2]||(t[2]=i=>n.active_tab_index=i.activeIndex)},{default:h(()=>[(a(!0),o(v,null,w(Array.from(n.channelsStore.channels_list_with_pinned),([i,c])=>(a(),C(k,{key:i},{default:h(()=>[e("div",{class:p(["channels",`channels--tab-${i} channels--length-${c.length}`])},[(a(!0),o(v,null,w(c,s=>_((a(),C(x,{class:"channel",draggable:"false",key:s.id,to:`/tv/watch/${s.display_channel_id}`},{default:h(()=>[e("div",W,[e("img",{class:"channel__broadcaster-icon",loading:"lazy",decoding:"async",src:`${n.Utils.getApiBaseUrl()}/channels/${s.id}/logo`},null,8,Y),e("div",ee,[e("span",te,"Ch: "+d(s.channel_number)+" "+d(s.name),1),e("div",ne,[e("div",{class:p(["channel__broadcaster-status-force",`channel__broadcaster-status-force--${n.ChannelUtils.getChannelForceType(s.jikkyo_force)}`])},[t[5]||(t[5]=e("svg",{class:"iconify iconify--fa-solid",width:"10.5px",height:"12px",viewBox:"0 0 448 512"},[e("path",{fill:"currentColor",d:"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z"})],-1)),t[6]||(t[6]=e("span",{class:"ml-1"},"勢い:",-1)),e("span",se,d(s.jikkyo_force??"--"),1),t[7]||(t[7]=e("span",{style:{"margin-left":"3px"}}," コメ/分",-1))],2),e("div",ie,[t[8]||(t[8]=e("svg",{class:"iconify iconify--fa-solid",width:"15.75px",height:"14px",viewBox:"0 0 576 512"},[e("path",{fill:"currentColor",d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144a143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79a47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"})],-1)),t[9]||(t[9]=e("span",{class:"ml-1"},"視聴数:",-1)),e("span",ae,d(s.viewer_count),1)])])]),_((a(),o("div",{class:p(["channel__broadcaster-pin",{"channel__broadcaster-pin--pinned":n.isPinnedChannel(s)}]),onClick:E(xe=>n.isPinnedChannel(s)?n.removePinnedChannel(s):n.addPinnedChannel(s),["prevent","stop"]),onMousedown:t[0]||(t[0]=E(()=>{},["prevent","stop"]))},t[10]||(t[10]=[e("svg",{class:"iconify iconify--fluent",width:"24px",height:"24px",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M13.325 2.617a2 2 0 0 0-3.203.52l-1.73 3.459a1.5 1.5 0 0 1-.784.721l-3.59 1.436a1 1 0 0 0-.335 1.636L6.293 13L3 16.292V17h.707L7 13.706l2.61 2.61a1 1 0 0 0 1.636-.335l1.436-3.59a1.5 1.5 0 0 1 .722-.784l3.458-1.73a2 2 0 0 0 .52-3.203l-4.057-4.057Z"})],-1)]),42,oe)),[[g],[P,n.isPinnedChannel(s)?"ピン留めを外す":"ピン留めする"]])]),e("div",re,[e("div",le,[e("span",{class:"channel__program-present-title",innerHTML:n.ProgramUtils.decorateProgramInfo(s.program_present,"title")},null,8,ue),e("span",de,d(n.ProgramUtils.getProgramTime(s.program_present)),1)]),e("span",{class:"channel__program-present-description",innerHTML:n.ProgramUtils.decorateProgramInfo(s.program_present,"description")},null,8,ce)]),l(q),e("div",_e,[e("div",pe,[t[11]||(t[11]=e("span",{class:"channel__program-following-title-decorate"},"NEXT",-1)),t[12]||(t[12]=e("svg",{class:"channel__program-following-title-icon iconify iconify--fluent",width:"16px",height:"16px",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z"})],-1)),e("span",{class:"channel__program-following-title-text",innerHTML:n.ProgramUtils.decorateProgramInfo(s.program_following,"title")},null,8,he)]),e("span",ge,d(n.ProgramUtils.getProgramTime(s.program_following)),1)]),e("div",me,[e("div",{class:"channel__progressbar-progress",style:S(`width:${n.ProgramUtils.getProgramProgress(s.program_present)}%;`)},null,4)])]),_:2},1032,["to"])),[[g]])),128)),i==="地デジ"&&c.length!==0?_((a(),o("a",fe,t[13]||(t[13]=[r(" 全てのチャンネルを視聴 ")]))),[[g]]):f("",!0),i==="ピン留め"&&c.length===0?(a(),o("div",ve,[e("div",we,[t[18]||(t[18]=e("h2",null,[r("ピン留めされているチャンネルが"),e("br"),r("ありません。")],-1)),e("div",Ce,[t[14]||(t[14]=r("各チャンネルの ")),l(b,{style:{position:"relative",bottom:"-5px"},icon:"fluent:pin-20-filled",width:"22px"}),t[15]||(t[15]=r(" アイコンから、よくみる")),t[16]||(t[16]=e("br",null,null,-1)),t[17]||(t[17]=r("チャンネルをこのタブにピン留めできます。"))]),t[19]||(t[19]=e("div",{class:"mt-2 text-text-darken-1"},[r("チャンネルをピン留めすると、"),e("br"),r("このタブが最初に表示されます。")],-1))])])):f("",!0)],2)]),_:2},1024))),128))]),_:1},512),[[K,Array.from(n.channelsStore.channels_list_with_pinned).length>0]]),Array.from(n.channelsStore.channels_list_with_pinned).length===0?(a(),o("div",be,t[20]||(t[20]=[T('<div class="d-flex justify-center align-center flex-column" data-v-30b96279><h2 data-v-30b96279>視聴可能なチャンネルが<br class="d-sm-none" data-v-30b96279>ありません。</h2><div class="mt-4 text-text-darken-1" data-v-30b96279>前回チャンネルスキャンしたときに<br class="d-sm-none" data-v-30b96279>受信可能なチャンネルを見つけられませんでした。</div><div class="mt-1 text-text-darken-1" data-v-30b96279>再度チャンネルスキャンを行ってください。</div></div>',1)]))):f("",!0)],2)]),_((a(),o("div",{class:"floating-button",onClick:t[3]||(t[3]=i=>n.Message.warning("番組表は現在開発中です。"))},[e("div",Be,[l(b,{class:"floating-button__icon",icon:"fluent:calendar-20-regular",width:"26px"}),t[21]||(t[21]=e("div",{class:"floating-button__text"},"番組表",-1))])])),[[g]])])}const ze=R(G,[["render",Se],["__scopeId","data-v-30b96279"]]);export{ze as default};
