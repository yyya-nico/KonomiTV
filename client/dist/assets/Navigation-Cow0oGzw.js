import{u as D,j as L,v as z,V as $,a as H,R as y,_ as B,g as M,p as q,ba as G,G as U,x as K,au as Q,H as j,L as A,f as F,bb as X,ar as J,X as Y,d as Z,k as x,M as tt,b4 as nt,m as at,bc as et,N as it,Q as ot,a0 as st,b as lt,S as rt,bd as ct}from"./top-BIFAtjVO.js";import{_ as ut}from"./logo-C_ijiYXP.js";import{V as P,u as vt}from"./ssrBoot-COfk37xD.js";import{I as T,W as V,M as dt,N as ht,ai as O,a5 as _,a4 as p,p as s,a7 as gt,a6 as f,ay as b,_ as k,a8 as h,a2 as C,G as _t,az as pt,$ as r,ar as W,ad as v,aM as mt,a3 as yt,ax as ft}from"./SnackbarsStore-C4icXDBu.js";import{u as kt}from"./VersionStore-CJVA931X.js";function bt(t,i,a,u){function o(e){return e instanceof a?e:new a(function(l){l(e)})}return new(a||(a=Promise))(function(e,l){function c(g){try{n(u.next(g))}catch(S){l(S)}}function w(g){try{n(u.throw(g))}catch(S){l(S)}}function n(g){g.done?e(g.value):o(g.value).then(c,w)}n((u=u.apply(t,[])).next())})}function wt(t,i){var a={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,o,e,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(g){return w([n,g])}}function w(n){if(u)throw new TypeError("Generator is already executing.");for(;l&&(l=0,n[0]&&(a=0)),a;)try{if(u=1,o&&(e=n[0]&2?o.return:n[0]?o.throw||((e=o.return)&&e.call(o),0):o.next)&&!(e=e.call(o,n[1])).done)return e;switch(o=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(e=a.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){a=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){a.label=n[1];break}if(n[0]===6&&a.label<e[1]){a.label=e[1],e=n;break}if(e&&a.label<e[2]){a.label=e[2],a.ops.push(n);break}e[2]&&a.ops.pop(),a.trys.pop();continue}n=i.call(t,a)}catch(g){n=[6,g],o=0}finally{u=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}var St=function(){function t(){var i=this;this.event=null,this.callbacks=[],this.install=function(){return bt(i,void 0,void 0,function(){var a=this;return wt(this,function(u){switch(u.label){case 0:return this.event?(this.event.prompt(),[4,this.event.userChoice.then(function(o){var e=o.outcome;return a.updateEvent(null),e==="accepted"})]):[3,2];case 1:return[2,u.sent()];case 2:throw new Error("Not allowed to prompt.")}})})},!(typeof window>"u")&&(window.addEventListener("beforeinstallprompt",function(a){a.preventDefault(),i.updateEvent(a)}),window.addEventListener("appinstalled",function(){i.updateEvent(null)}))}return t.prototype.getEvent=function(){return this.event},t.prototype.canInstall=function(){return this.event!==null},t.prototype.updateEvent=function(i){var a=this;i!==this.event&&(this.event=i,this.callbacks.forEach(function(u){return u(a.canInstall())}))},t.prototype.addListener=function(i){i(this.canInstall()),this.callbacks.push(i)},t.prototype.removeListener=function(i){this.callbacks=this.callbacks.filter(function(a){return i!==a})},t}(),E=new St;const Ot={class:"header"},$t={key:0,class:"search-box"},Ct=["placeholder"],Wt=T({__name:"HeaderBar",setup(t){const i=V(!1),a=V(""),u=H(),o=D(),e=()=>{o.path.endsWith("/search")&&o.query.query&&(a.value=decodeURIComponent(o.query.query))};dt(()=>{E.addListener(d=>{i.value=d}),e()}),ht(()=>o.fullPath,e);const l=O(()=>o.path.startsWith("/videos")||o.path.startsWith("/mylist")||o.path.startsWith("/watched-history")?"録画番組を検索...":"放送予定の番組を検索..."),c=()=>o.path.startsWith("/videos")||o.path.startsWith("/mylist")||o.path.startsWith("/watched-history")?"/videos/search":"/tv/search",w=d=>{d.key==="Enter"&&!d.isComposing&&n()},n=()=>{if(a.value.trim()){const d=c();u.push(`${d}?query=${encodeURIComponent(a.value.trim())}`)}},g=O(()=>{const d=o.path;return!d.startsWith("/captures")&&!d.startsWith("/settings")&&!d.startsWith("/login")&&!d.startsWith("/register")}),S=O(()=>o.path.startsWith("/timetable"));return(d,m)=>{const R=C("router-link"),I=C("Icon");return r(),_("header",Ot,[p((r(),k(R,{class:"konomitv-logo ml-3 ml-md-6",to:"/tv/"},{default:h(()=>[...m[2]||(m[2]=[b("img",{class:"konomitv-logo__image",src:ut,height:"21"},null,-1)])]),_:1})),[[y]]),s(P),gt(d.$slots,"timetable-controls",{},void 0,!0),g.value?(r(),_("div",$t,[p(b("input",{class:"search-input",type:"search",enterkeyhint:"search",placeholder:l.value,"onUpdate:modelValue":m[0]||(m[0]=N=>a.value=N),onKeydown:w},null,40,Ct),[[L,a.value]]),s(I,{class:"search-input__icon",icon:"fluent:search-20-filled",height:"24px",onClick:n})])):f("",!0),p(s($,{variant:"flat",class:"pwa-install-button",onClick:m[1]||(m[1]=N=>_t(E).install())},{default:h(()=>[s(I,{icon:"material-symbols:install-desktop-rounded",height:"20px",class:"mr-1"}),m[3]||(m[3]=pt(" アプリとしてインストール ",-1))]),_:1},512),[[z,i.value&&!S.value]]),m[4]||(m[4]=b("div",{class:"mr-3 mr-md-6"},null,-1))])}}}),Jt=B(Wt,[["__scopeId","data-v-e95246c2"]]),Bt=q({baseColor:String,bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:t=>!t||["horizontal","shift"].includes(t)},height:{type:[Number,String],default:56},active:{type:Boolean,default:!0},...rt(),...lt(),...st(),...ot(),...it(),...et({name:"bottom-navigation"}),...at({tag:"header"}),...nt({selectedClass:"v-btn--selected"}),...tt()},"VBottomNavigation"),It=M()({name:"VBottomNavigation",props:Bt(),emits:{"update:active":t=>!0,"update:modelValue":t=>!0},setup(t,i){let{slots:a}=i;const{themeClasses:u}=G(),{borderClasses:o}=U(t),{backgroundColorClasses:e,backgroundColorStyles:l}=K(W(t,"bgColor")),{densityClasses:c}=Q(t),{elevationClasses:w}=j(t),{roundedClasses:n}=A(t),{ssrBootStyles:g}=vt(),S=O(()=>Number(t.height)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0)),d=F(t,"active",t.active),{layoutItemStyles:m}=X({id:t.name,order:O(()=>parseInt(t.order,10)),position:O(()=>"bottom"),layoutSize:O(()=>d.value?S.value:0),elementSize:S,active:d,absolute:W(t,"absolute")});return J(t,ct),Y({VBtn:{baseColor:W(t,"baseColor"),color:W(t,"color"),density:W(t,"density"),stacked:O(()=>t.mode!=="horizontal"),variant:"text"}},{scoped:!0}),Z(()=>s(t.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":d.value,"v-bottom-navigation--grow":t.grow,"v-bottom-navigation--shift":t.mode==="shift"},u.value,e.value,o.value,c.value,w.value,n.value,t.class],style:[l.value,m.value,{height:x(S.value)},g.value,t.style]},{default:()=>[a.default&&s("div",{class:"v-bottom-navigation__content"},[a.default()])]})),{}}}),Nt={};function Vt(t,i){const a=C("Icon");return r(),k(It,{class:"bottom-navigation-container elevation-12",color:"primary",grow:"",active:""},{default:h(()=>[s($,{class:v(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/tv")}]),to:"/tv/"},{default:h(()=>[s(a,{icon:"fluent:tv-20-regular",width:"30px"}),i[0]||(i[0]=b("span",{class:"mt-1"},"テレビをみる",-1))]),_:1},8,["class"]),s($,{class:v(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/videos")}]),to:"/videos/"},{default:h(()=>[s(a,{icon:"fluent:movies-and-tv-20-regular",width:"30px"}),i[1]||(i[1]=b("span",{class:"mt-1"},"ビデオをみる",-1))]),_:1},8,["class"]),s($,{class:v(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/reservations")}]),to:"/reservations/"},{default:h(()=>[s(a,{icon:"fluent:timer-16-regular",width:"30px"}),i[2]||(i[2]=b("span",{class:"mt-1"},"録画予約",-1))]),_:1},8,["class"]),s($,{class:v(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/captures")}]),to:"/captures/"},{default:h(()=>[s(a,{icon:"fluent:image-multiple-24-regular",width:"30px"}),i[3]||(i[3]=b("span",{class:"mt-1"},"キャプチャ",-1))]),_:1},8,["class"]),s($,{class:v(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/mypage")}]),to:"/mypage/"},{default:h(()=>[s(a,{icon:"fluent:person-20-regular",width:"30px"}),i[4]||(i[4]=b("span",{class:"mt-1"},"マイページ",-1))]),_:1},8,["class"])]),_:1})}const Et=B(Nt,[["render",Vt],["__scopeId","data-v-58f8356e"]]),Pt=T({name:"Navigation",components:{BottomNavigation:Et},props:{iconOnly:{type:Boolean,default:!1}},computed:{...mt(kt)},async created(){await this.versionStore.fetchServerVersion()}}),Tt={key:0,class:"navigation__link-text"},Rt={key:0,class:"navigation__link-text"},Dt={key:0,class:"navigation__link-text"},Lt={key:0,class:"navigation__link-text"},zt={key:0,class:"navigation__link-text"},Ht={key:0,class:"navigation__link-text"},Mt={key:0,class:"navigation__link-text"},qt={key:0,class:"navigation__link-text"},Gt={key:0,class:"navigation__link-text"},Ut={key:0,class:"navigation__link-text"};function Kt(t,i,a,u,o,e){const l=C("Icon"),c=C("router-link"),w=C("BottomNavigation"),n=yt("ftooltip");return r(),_("div",null,[b("div",{class:v(["navigation-container elevation-8",{"navigation-container--icon-only":t.iconOnly}])},[b("nav",{class:v(["navigation",{"navigation--icon-only":t.iconOnly}])},[b("div",{class:v(["navigation-scroll",{"navigation-scroll--icon-only":t.iconOnly}])},[p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/tv"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/tv/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:tv-20-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Tt,"テレビをみる"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"テレビをみる":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/videos"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/videos/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:movies-and-tv-20-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Rt,"ビデオをみる"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"ビデオをみる":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/timetable"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/timetable/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:calendar-ltr-20-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Dt,"番組表"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"番組表":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/pastepg"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/pastepg/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:calendar-ltr-20-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Lt,"過去番組表"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"過去番組表":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/reservations"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/reservations/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:timer-16-regular",width:"26px",style:{padding:"0.5px"}}),t.iconOnly?f("",!0):(r(),_("span",zt,"録画予約"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"録画予約":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/captures"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/captures/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:image-multiple-24-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Ht,"キャプチャ"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"キャプチャ":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/mylist"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/mylist/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"ic:round-playlist-play",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Mt,"マイリスト"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"マイリスト":"",void 0,{right:!0}]]),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/watched-history"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/watched-history/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:history-20-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",qt,"視聴履歴"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"視聴履歴":"",void 0,{right:!0}]]),s(P),p((r(),k(c,{class:v(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/settings"),"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",to:"/settings/"},{default:h(()=>[s(l,{class:"navigation__link-icon",icon:"fluent:settings-20-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Gt,"設定"))]),_:1},8,["class"])),[[y],[n,t.iconOnly?"設定":"",void 0,{right:!0}]]),p((r(),_("a",{class:v(["navigation__link",{"navigation__link--develop-version":t.versionStore.is_client_develop_version,"navigation__link--highlight":t.versionStore.is_update_available,"navigation__link--icon-only":t.iconOnly}]),"active-class":"navigation__link--active",href:"https://github.com/yyya-nico/KonomiTV",target:"_blank"},[s(l,{class:"navigation__link-icon",icon:"fluent:info-16-regular",width:"26px"}),t.iconOnly?f("",!0):(r(),_("span",Ut,"version "+ft(t.versionStore.client_version),1))],2)),[[y],[n,t.iconOnly?t.versionStore.is_update_available?`アップデートがあります (version ${t.versionStore.latest_version})`:`version ${t.versionStore.client_version}`:t.versionStore.is_update_available?`アップデートがあります (version ${t.versionStore.latest_version})`:"",void 0,{right:!0}]])],2)],2)],2),s(w)])}const Yt=B(Pt,[["render",Kt],["__scopeId","data-v-66c20dad"]]);export{Jt as H,Yt as N};
