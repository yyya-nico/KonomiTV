import{I as m,aL as d,aK as u,aC as a,a4 as p,aw as s,p as o,a7 as r,ax as f,a1 as v,_ as V}from"./SnackbarsStore-Buj_rJWA.js";import{V as h,u as _}from"./VersionStore-fcAF5g0F.js";import{_ as w,w as y,V as x}from"./top-aD5lPKb-.js";import{_ as C}from"./logo-BltHngw8.js";import{V as $,a as g}from"./VCard-DwpKVMOk.js";import{V as B,a as S}from"./VTextField-B8oY6v10.js";import{V as b}from"./VForm-srCQyXOu.js";import"./VAvatar-DCfDeH7P.js";const A=m({name:"Connect",data(){return{is_form_dense:a.isSmartphoneHorizontal(),host:"",rules:[e=>e?!0:"ホストが空です。",e=>/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$/.test(e)?!0:"IPv4のホストを入力してください。",async e=>{const[t,n]=e.split(":"),i=`${t.replaceAll(".","-")}.local.konomi.tv:${n??7e3}`;return a.saveApiHost(i),await h.fetchServerVersion(!0)!==null?!0:(a.deleteApiHost(),"接続先ホストはKonomiTVサーバーではありません。")}]}},computed:{...d(_)},methods:{async connect(){const e=await this.$refs.connect.validate();if(!e.valid){u.error(e.errors[0].errorMessages[0]);return}await this.versionStore.fetchServerVersion(!0),this.versionStore.is_version_mismatch&&u.warning("このKonomiTVクライアントとKonomiTVサーバーのバージョンが異なるため、正常な動作が保証されません。"),await this.$router.replace({path:"/tv/"})}}}),I={class:"route-container"},T={class:"connect-container-wrapper d-flex align-center w-100 mb-13"};function k(e,t,n,i,D,H){const l=v("Icon");return V(),p("div",I,[s("main",null,[s("div",T,[o(g,{class:"connect-container px-10 pt-8 pb-11 mx-auto",elevation:"10",width:"100%","max-width":"450"},{default:r(()=>[o($,{class:"connect__logo py-4 d-flex flex-column justify-center align-center"},{default:r(()=>t[1]||(t[1]=[s("img",{class:"d-block",src:C,style:{"max-width":"250px"}},null,-1),s("h4",{class:"mt-10"},"接続",-1)])),_:1}),o(B),o(b,{ref:"connect",onSubmit:y(e.connect,["prevent"])},{default:r(()=>[o(S,{class:"mt-12",name:"ipv4-host",color:"primary",variant:"outlined",type:"url",placeholder:"ホスト",autofocus:"","validate-on":"submit",pattern:"^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$",hint:"IPv4のホストを入力してください。","persistent-hint":"",rules:e.rules,density:e.is_form_dense?"compact":"default",modelValue:e.host,"onUpdate:modelValue":t[0]||(t[0]=c=>e.host=c)},null,8,["rules","density","modelValue"]),o(x,{type:"submit",class:"connect-button mt-5",color:"secondary",variant:"flat",width:"100%",height:"56"},{default:r(()=>[o(l,{icon:"fa:sign-in",class:"mr-2"}),t[2]||(t[2]=f("接続 "))]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])])}const z=w(A,[["render",k],["__scopeId","data-v-76420695"]]);export{z as default};
