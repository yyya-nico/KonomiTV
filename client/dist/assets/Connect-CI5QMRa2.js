import{x as d,az as r,aI as m,aH as i,Y as p,T as f,$ as h,at as a,k as t,a2 as s,au as _,Q as v,R as V}from"./SnackbarsStore-DxiM_ro_.js";import{V as w,u as S}from"./VersionStore-DPzwN7Gd.js";import{_ as y,w as $,V as x}from"./top-BadExMer.js";import{_ as C}from"./logo-DFqgSWDU.js";import{V as g,a as B}from"./VCard-CgOKXwuX.js";import{V as I,a as b}from"./VTextField-Q_B64ykT.js";import{V as A}from"./VForm-BC6oy40g.js";import"./VAvatar-VTQd6ETC.js";const T=d({name:"Connect",data(){return{is_form_dense:r.isSmartphoneHorizontal(),host:"",rules:[e=>e?!0:"ホストが空です。",e=>/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$/.test(e)?!0:"IPv4のホストを入力してください。",async e=>{const o=e.split(":"),n=`${o[0].replaceAll(".","-")}.local.konomi.tv:${o[1]??7e3}`;return r.saveApiHost(n),await w.fetchServerVersion(!0)!==null?!0:(r.deleteApiHost(),"接続先ホストはKonomiTVサーバーではありません。")}]}},computed:{...m(S)},methods:{async connect(){const e=await this.$refs.connect.validate();if(!e.valid){i.error(e.errors[0].errorMessages[0]);return}await this.versionStore.fetchServerVersion(!0),this.versionStore.is_version_mismatch&&i.warning("このKonomiTVクライアントとKonomiTVサーバーのバージョンが異なるため、正常な動作が保証されません。"),await this.$router.replace({path:"/tv/"})}}}),c=e=>(v("data-v-4a1a2c67"),e=e(),V(),e),k={class:"route-container"},D={class:"connect-container-wrapper d-flex align-center w-100 mb-13"},H=c(()=>a("img",{class:"d-block",src:C,style:{"max-width":"250px"}},null,-1)),F=c(()=>a("h4",{class:"mt-10"},"接続",-1));function K(e,o,n,M,N,z){const u=p("Icon");return f(),h("div",k,[a("main",null,[a("div",D,[t(g,{class:"connect-container px-10 pt-8 pb-11 mx-auto",elevation:"10",width:"100%","max-width":"450"},{default:s(()=>[t(B,{class:"connect__logo py-4 d-flex flex-column justify-center align-center"},{default:s(()=>[H,F]),_:1}),t(I),t(A,{ref:"connect",onSubmit:$(e.connect,["prevent"])},{default:s(()=>[t(b,{class:"mt-12",color:"primary",variant:"outlined",type:"url",placeholder:"ホスト",autofocus:"","validate-on":"submit",pattern:"^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$",hint:"IPv4のホストを入力してください。","persistent-hint":"",rules:e.rules,density:e.is_form_dense?"compact":"default",modelValue:e.host,"onUpdate:modelValue":o[0]||(o[0]=l=>e.host=l)},null,8,["rules","density","modelValue"]),t(x,{type:"submit",class:"connect-button mt-5",color:"secondary",variant:"flat",width:"100%",height:"56"},{default:s(()=>[t(u,{icon:"fa:sign-in",class:"mr-2"}),_("接続 ")]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])])}const G=y(T,[["render",K],["__scopeId","data-v-4a1a2c67"]]);export{G as default};
