import{I as u,aM as d,aL as l,aD as a,a5 as p,ay as s,p as o,a8 as r,az as f,a2 as v,$ as V}from"./SnackbarsStore-BWrzfOQC.js";import{V as h,u as _}from"./VersionStore-CY9AnbST.js";import{_ as w,w as y,V as $}from"./top-Bz3ZAoHa.js";import{_ as g}from"./logo-YvUELjFu.js";import{V as x,a as S}from"./VCard-FINQH904.js";import{V as b,a as C}from"./VTextField-GOl929RL.js";import{V as I}from"./VForm--New4RDG.js";import"./VAvatar-DAKSuPGG.js";const T=u({name:"Connect",data(){return{is_form_dense:a.isSmartphoneHorizontal(),host:"",rules:[e=>e?!0:"ホストが空です。",e=>/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$/.test(e)?!0:"IPv4のホストを入力してください。",async e=>{const[t,n]=e.split(":"),i=`${t.replaceAll(".","-")}.local.konomi.tv:${n??7e3}`;return a.saveApiHost(i),await h.fetchServerVersion(!0)!==null?!0:(a.deleteApiHost(),"接続先ホストはKonomiTVサーバーではありません。")}]}},computed:{...d(_)},methods:{async connect(){const e=await this.$refs.connect.validate();if(!e.valid){l.error(e.errors[0].errorMessages[0]);return}await this.versionStore.fetchServerVersion(!0),this.versionStore.is_version_mismatch&&l.warning("このKonomiTVクライアントとKonomiTVサーバーのバージョンが異なるため、正常な動作が保証されません。"),await this.$router.replace({path:"/tv/"})}}}),k={class:"route-container"},B={class:"connect-container-wrapper d-flex align-center w-100 mb-13"};function H(e,t,n,i,M,A){const c=v("Icon");return V(),p("div",k,[s("main",null,[s("div",B,[o(S,{class:"connect-container px-10 pt-8 pb-11 mx-auto",elevation:"10",width:"100%","max-width":"450"},{default:r(()=>[o(x,{class:"connect__logo py-4 d-flex flex-column justify-center align-center"},{default:r(()=>[...t[1]||(t[1]=[s("img",{class:"d-block",src:g,style:{"max-width":"250px"}},null,-1),s("h4",{class:"mt-10"},"接続",-1)])]),_:1}),o(b),o(I,{ref:"connect",onSubmit:y(e.connect,["prevent"])},{default:r(()=>[o(C,{class:"mt-12",name:"ipv4-host",color:"primary",variant:"outlined",type:"url",placeholder:"ホスト",autofocus:"","validate-on":"submit",pattern:"^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$",hint:"IPv4のホストを入力してください。","persistent-hint":"",rules:e.rules,density:e.is_form_dense?"compact":"default",modelValue:e.host,"onUpdate:modelValue":t[0]||(t[0]=m=>e.host=m)},null,8,["rules","density","modelValue"]),o($,{type:"submit",class:"connect-button mt-5",color:"secondary",variant:"flat",width:"100%",height:"56"},{default:r(()=>[o(c,{icon:"fa:sign-in",class:"mr-2"}),t[2]||(t[2]=f("接続 ",-1))]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])])}const E=w(T,[["render",H],["__scopeId","data-v-76420695"]]);export{E as default};
