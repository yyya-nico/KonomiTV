import{g as We}from"./_commonjsHelpers-CSPQI3rM.js";var qe={exports:{}};(function(Ke,Xe){(function(pe,oe){Ke.exports=oe()})(window,function(){return function(pe){var oe={};function x(V){if(oe[V])return oe[V].exports;var k=oe[V]={i:V,l:!1,exports:{}};return pe[V].call(k.exports,k,k.exports,x),k.l=!0,k.exports}return x.m=pe,x.c=oe,x.d=function(V,k,T){x.o(V,k)||Object.defineProperty(V,k,{enumerable:!0,get:T})},x.r=function(V){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(V,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(V,"__esModule",{value:!0})},x.t=function(V,k){if(1&k&&(V=x(V)),8&k||4&k&&typeof V=="object"&&V&&V.__esModule)return V;var T=Object.create(null);if(x.r(T),Object.defineProperty(T,"default",{enumerable:!0,value:V}),2&k&&typeof V!="string")for(var u in V)x.d(T,u,(function(g){return V[g]}).bind(null,u));return T},x.n=function(V){var k=V&&V.__esModule?function(){return V.default}:function(){return V};return x.d(k,"a",k),k},x.o=function(V,k){return Object.prototype.hasOwnProperty.call(V,k)},x.p="",x(x.s=25)}([function(pe,oe,x){var V=x(10),k=x.n(V),T=function(){function u(){}return u.e=function(g,i){g&&!u.FORCE_GLOBAL_TAG||(g=u.GLOBAL_TAG);var h="[".concat(g,"] > ").concat(i);u.ENABLE_CALLBACK&&u.emitter.emit("log","error",h),u.ENABLE_ERROR&&(console.error?console.error(h):console.warn?console.warn(h):console.log(h))},u.i=function(g,i){g&&!u.FORCE_GLOBAL_TAG||(g=u.GLOBAL_TAG);var h="[".concat(g,"] > ").concat(i);u.ENABLE_CALLBACK&&u.emitter.emit("log","info",h),u.ENABLE_INFO&&(console.info?console.info(h):console.log(h))},u.w=function(g,i){g&&!u.FORCE_GLOBAL_TAG||(g=u.GLOBAL_TAG);var h="[".concat(g,"] > ").concat(i);u.ENABLE_CALLBACK&&u.emitter.emit("log","warn",h),u.ENABLE_WARN&&(console.warn?console.warn(h):console.log(h))},u.d=function(g,i){g&&!u.FORCE_GLOBAL_TAG||(g=u.GLOBAL_TAG);var h="[".concat(g,"] > ").concat(i);u.ENABLE_CALLBACK&&u.emitter.emit("log","debug",h),u.ENABLE_DEBUG&&(console.debug?console.debug(h):console.log(h))},u.v=function(g,i){g&&!u.FORCE_GLOBAL_TAG||(g=u.GLOBAL_TAG);var h="[".concat(g,"] > ").concat(i);u.ENABLE_CALLBACK&&u.emitter.emit("log","verbose",h),u.ENABLE_VERBOSE&&console.log(h)},u}();T.GLOBAL_TAG="mpegts.js",T.FORCE_GLOBAL_TAG=!1,T.ENABLE_ERROR=!0,T.ENABLE_INFO=!0,T.ENABLE_WARN=!0,T.ENABLE_DEBUG=!0,T.ENABLE_VERBOSE=!0,T.ENABLE_CALLBACK=!1,T.emitter=new k.a,oe.a=T},function(pe,oe,x){var V;(function(k){k.IO_ERROR="io_error",k.DEMUX_ERROR="demux_error",k.INIT_SEGMENT="init_segment",k.MEDIA_SEGMENT="media_segment",k.LOADING_COMPLETE="loading_complete",k.RECOVERED_EARLY_EOF="recovered_early_eof",k.MEDIA_INFO="media_info",k.METADATA_ARRIVED="metadata_arrived",k.SCRIPTDATA_ARRIVED="scriptdata_arrived",k.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",k.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",k.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",k.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",k.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",k.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",k.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",k.STATISTICS_INFO="statistics_info",k.RECOMMEND_SEEKPOINT="recommend_seekpoint"})(V||(V={})),oe.a=V},function(pe,oe,x){x.d(oe,"c",function(){return k}),x.d(oe,"b",function(){return T}),x.d(oe,"a",function(){return u});var V=x(3),k={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},T={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},u=function(){function g(i){this._type=i||"undefined",this._status=k.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return g.prototype.destroy=function(){this._status=k.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},g.prototype.isWorking=function(){return this._status===k.kConnecting||this._status===k.kBuffering},Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(i){this._onContentLengthKnown=i},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(i){this._onURLRedirect=i},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(i){this._onDataArrival=i},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onError",{get:function(){return this._onError},set:function(i){this._onError=i},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onComplete",{get:function(){return this._onComplete},set:function(i){this._onComplete=i},enumerable:!1,configurable:!0}),g.prototype.open=function(i,h){throw new V.c("Unimplemented abstract function!")},g.prototype.abort=function(){throw new V.c("Unimplemented abstract function!")},g}()},function(pe,oe,x){x.d(oe,"d",function(){return T}),x.d(oe,"a",function(){return u}),x.d(oe,"b",function(){return g}),x.d(oe,"c",function(){return i});var V,k=(V=function(h,p){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,E){A.__proto__=E}||function(A,E){for(var O in E)Object.prototype.hasOwnProperty.call(E,O)&&(A[O]=E[O])})(h,p)},function(h,p){if(typeof p!="function"&&p!==null)throw new TypeError("Class extends value "+String(p)+" is not a constructor or null");function A(){this.constructor=h}V(h,p),h.prototype=p===null?Object.create(p):(A.prototype=p.prototype,new A)}),T=function(){function h(p){this._message=p}return Object.defineProperty(h.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),h.prototype.toString=function(){return this.name+": "+this.message},h}(),u=function(h){function p(A){return h.call(this,A)||this}return k(p,h),Object.defineProperty(p.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),p}(T),g=function(h){function p(A){return h.call(this,A)||this}return k(p,h),Object.defineProperty(p.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),p}(T),i=function(h){function p(A){return h.call(this,A)||this}return k(p,h),Object.defineProperty(p.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),p}(T)},function(pe,oe,x){var V;(function(k){k.ERROR="error",k.LOADING_COMPLETE="loading_complete",k.RECOVERED_EARLY_EOF="recovered_early_eof",k.MEDIA_INFO="media_info",k.METADATA_ARRIVED="metadata_arrived",k.SCRIPTDATA_ARRIVED="scriptdata_arrived",k.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",k.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",k.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",k.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",k.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",k.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",k.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",k.STATISTICS_INFO="statistics_info",k.DESTROYING="destroying"})(V||(V={})),oe.a=V},function(pe,oe,x){var V={};(function(){var k=self.navigator.userAgent.toLowerCase(),T=/(edge)\/([\w.]+)/.exec(k)||/(opr)[\/]([\w.]+)/.exec(k)||/(chrome)[ \/]([\w.]+)/.exec(k)||/(iemobile)[\/]([\w.]+)/.exec(k)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(k)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(k)||/(webkit)[ \/]([\w.]+)/.exec(k)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(k)||/(msie) ([\w.]+)/.exec(k)||k.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(k)||k.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(k)||[],u=/(ipad)/.exec(k)||/(ipod)/.exec(k)||/(windows phone)/.exec(k)||/(iphone)/.exec(k)||/(kindle)/.exec(k)||/(android)/.exec(k)||/(windows)/.exec(k)||/(mac)/.exec(k)||/(linux)/.exec(k)||/(cros)/.exec(k)||[],g={browser:T[5]||T[3]||T[1]||"",version:T[2]||T[4]||"0",majorVersion:T[4]||T[2]||"0",platform:u[0]||""},i={};if(g.browser){i[g.browser]=!0;var h=g.majorVersion.split(".");i.version={major:parseInt(g.majorVersion,10),string:g.version},h.length>1&&(i.version.minor=parseInt(h[1],10)),h.length>2&&(i.version.build=parseInt(h[2],10))}g.platform&&(i[g.platform]=!0),(i.chrome||i.opr||i.safari)&&(i.webkit=!0),(i.rv||i.iemobile)&&(i.rv&&delete i.rv,g.browser="msie",i.msie=!0),i.edge&&(delete i.edge,g.browser="msedge",i.msedge=!0),i.opr&&(g.browser="opera",i.opera=!0),i.safari&&i.android&&(g.browser="android",i.android=!0);for(var p in i.name=g.browser,i.platform=g.platform,V)V.hasOwnProperty(p)&&delete V[p];Object.assign(V,i)})(),oe.a=V},function(pe,oe,x){oe.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(pe,oe,x){var V;(function(k){k.ERROR="error",k.SOURCE_OPEN="source_open",k.UPDATE_END="update_end",k.BUFFER_FULL="buffer_full",k.START_STREAMING="start_streaming",k.END_STREAMING="end_streaming"})(V||(V={})),oe.a=V},function(pe,oe,x){var V=x(3),k=function(){function T(u){this.TAG="ExpGolomb",this._buffer=u,this._buffer_index=0,this._total_bytes=u.byteLength,this._total_bits=8*u.byteLength,this._current_word=0,this._current_word_bits_left=0}return T.prototype.destroy=function(){this._buffer=null},T.prototype._fillCurrentWord=function(){var u=this._total_bytes-this._buffer_index;if(u<=0)throw new V.a("ExpGolomb: _fillCurrentWord() but no bytes available");var g=Math.min(4,u),i=new Uint8Array(4);i.set(this._buffer.subarray(this._buffer_index,this._buffer_index+g)),this._current_word=new DataView(i.buffer).getUint32(0,!1),this._buffer_index+=g,this._current_word_bits_left=8*g},T.prototype.readBits=function(u){if(u>32)throw new V.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(u<=this._current_word_bits_left){var g=this._current_word>>>32-u;return this._current_word<<=u,this._current_word_bits_left-=u,g}var i=this._current_word_bits_left?this._current_word:0;i>>>=32-this._current_word_bits_left;var h=u-this._current_word_bits_left;this._fillCurrentWord();var p=Math.min(h,this._current_word_bits_left),A=this._current_word>>>32-p;return this._current_word<<=p,this._current_word_bits_left-=p,i=i<<p|A},T.prototype.readBool=function(){return this.readBits(1)===1},T.prototype.readByte=function(){return this.readBits(8)},T.prototype._skipLeadingZero=function(){var u;for(u=0;u<this._current_word_bits_left;u++)if(this._current_word&2147483648>>>u)return this._current_word<<=u,this._current_word_bits_left-=u,u;return this._fillCurrentWord(),u+this._skipLeadingZero()},T.prototype.readUEG=function(){var u=this._skipLeadingZero();return this.readBits(u+1)-1},T.prototype.readSEG=function(){var u=this.readUEG();return 1&u?u+1>>>1:-1*(u>>>1)},T}();oe.a=k},function(pe,oe,x){var V=x(10),k=x.n(V),T=x(0),u=function(){function g(){}return Object.defineProperty(g,"forceGlobalTag",{get:function(){return T.a.FORCE_GLOBAL_TAG},set:function(i){T.a.FORCE_GLOBAL_TAG=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"globalTag",{get:function(){return T.a.GLOBAL_TAG},set:function(i){T.a.GLOBAL_TAG=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableAll",{get:function(){return T.a.ENABLE_VERBOSE&&T.a.ENABLE_DEBUG&&T.a.ENABLE_INFO&&T.a.ENABLE_WARN&&T.a.ENABLE_ERROR},set:function(i){T.a.ENABLE_VERBOSE=i,T.a.ENABLE_DEBUG=i,T.a.ENABLE_INFO=i,T.a.ENABLE_WARN=i,T.a.ENABLE_ERROR=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableDebug",{get:function(){return T.a.ENABLE_DEBUG},set:function(i){T.a.ENABLE_DEBUG=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableVerbose",{get:function(){return T.a.ENABLE_VERBOSE},set:function(i){T.a.ENABLE_VERBOSE=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableInfo",{get:function(){return T.a.ENABLE_INFO},set:function(i){T.a.ENABLE_INFO=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableWarn",{get:function(){return T.a.ENABLE_WARN},set:function(i){T.a.ENABLE_WARN=i,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableError",{get:function(){return T.a.ENABLE_ERROR},set:function(i){T.a.ENABLE_ERROR=i,g._notifyChange()},enumerable:!1,configurable:!0}),g.getConfig=function(){return{globalTag:T.a.GLOBAL_TAG,forceGlobalTag:T.a.FORCE_GLOBAL_TAG,enableVerbose:T.a.ENABLE_VERBOSE,enableDebug:T.a.ENABLE_DEBUG,enableInfo:T.a.ENABLE_INFO,enableWarn:T.a.ENABLE_WARN,enableError:T.a.ENABLE_ERROR,enableCallback:T.a.ENABLE_CALLBACK}},g.applyConfig=function(i){T.a.GLOBAL_TAG=i.globalTag,T.a.FORCE_GLOBAL_TAG=i.forceGlobalTag,T.a.ENABLE_VERBOSE=i.enableVerbose,T.a.ENABLE_DEBUG=i.enableDebug,T.a.ENABLE_INFO=i.enableInfo,T.a.ENABLE_WARN=i.enableWarn,T.a.ENABLE_ERROR=i.enableError,T.a.ENABLE_CALLBACK=i.enableCallback},g._notifyChange=function(){var i=g.emitter;if(i.listenerCount("change")>0){var h=g.getConfig();i.emit("change",h)}},g.registerListener=function(i){g.emitter.addListener("change",i)},g.removeListener=function(i){g.emitter.removeListener("change",i)},g.addLogListener=function(i){T.a.emitter.addListener("log",i),T.a.emitter.listenerCount("log")>0&&(T.a.ENABLE_CALLBACK=!0,g._notifyChange())},g.removeLogListener=function(i){T.a.emitter.removeListener("log",i),T.a.emitter.listenerCount("log")===0&&(T.a.ENABLE_CALLBACK=!1,g._notifyChange())},g}();u.emitter=new k.a,oe.a=u},function(pe,oe,x){var V,k=typeof Reflect=="object"?Reflect:null,T=k&&typeof k.apply=="function"?k.apply:function(C,Z,ie){return Function.prototype.apply.call(C,Z,ie)};V=k&&typeof k.ownKeys=="function"?k.ownKeys:Object.getOwnPropertySymbols?function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:function(C){return Object.getOwnPropertyNames(C)};var u=Number.isNaN||function(C){return C!=C};function g(){g.init.call(this)}pe.exports=g,pe.exports.once=function(C,Z){return new Promise(function(ie,U){function c(_){C.removeListener(Z,d),U(_)}function d(){typeof C.removeListener=="function"&&C.removeListener("error",c),ie([].slice.call(arguments))}H(C,Z,d,{once:!0}),Z!=="error"&&function(_,m,q){typeof _.on=="function"&&H(_,"error",m,q)}(C,c,{once:!0})})},g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var i=10;function h(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}function p(C){return C._maxListeners===void 0?g.defaultMaxListeners:C._maxListeners}function A(C,Z,ie,U){var c,d,_,m;if(h(ie),(d=C._events)===void 0?(d=C._events=Object.create(null),C._eventsCount=0):(d.newListener!==void 0&&(C.emit("newListener",Z,ie.listener?ie.listener:ie),d=C._events),_=d[Z]),_===void 0)_=d[Z]=ie,++C._eventsCount;else if(typeof _=="function"?_=d[Z]=U?[ie,_]:[_,ie]:U?_.unshift(ie):_.push(ie),(c=p(C))>0&&_.length>c&&!_.warned){_.warned=!0;var q=new Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(Z)+" listeners added. Use emitter.setMaxListeners() to increase limit");q.name="MaxListenersExceededWarning",q.emitter=C,q.type=Z,q.count=_.length,m=q,console&&console.warn&&console.warn(m)}return C}function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function O(C,Z,ie){var U={fired:!1,wrapFn:void 0,target:C,type:Z,listener:ie},c=E.bind(U);return c.listener=ie,U.wrapFn=c,c}function F(C,Z,ie){var U=C._events;if(U===void 0)return[];var c=U[Z];return c===void 0?[]:typeof c=="function"?ie?[c.listener||c]:[c]:ie?function(d){for(var _=new Array(d.length),m=0;m<_.length;++m)_[m]=d[m].listener||d[m];return _}(c):j(c,c.length)}function P(C){var Z=this._events;if(Z!==void 0){var ie=Z[C];if(typeof ie=="function")return 1;if(ie!==void 0)return ie.length}return 0}function j(C,Z){for(var ie=new Array(Z),U=0;U<Z;++U)ie[U]=C[U];return ie}function H(C,Z,ie,U){if(typeof C.on=="function")U.once?C.once(Z,ie):C.on(Z,ie);else{if(typeof C.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C);C.addEventListener(Z,function c(d){U.once&&C.removeEventListener(Z,c),ie(d)})}}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(C){if(typeof C!="number"||C<0||u(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");i=C}}),g.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||u(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this},g.prototype.getMaxListeners=function(){return p(this)},g.prototype.emit=function(C){for(var Z=[],ie=1;ie<arguments.length;ie++)Z.push(arguments[ie]);var U=C==="error",c=this._events;if(c!==void 0)U=U&&c.error===void 0;else if(!U)return!1;if(U){var d;if(Z.length>0&&(d=Z[0]),d instanceof Error)throw d;var _=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw _.context=d,_}var m=c[C];if(m===void 0)return!1;if(typeof m=="function")T(m,this,Z);else{var q=m.length,te=j(m,q);for(ie=0;ie<q;++ie)T(te[ie],this,Z)}return!0},g.prototype.addListener=function(C,Z){return A(this,C,Z,!1)},g.prototype.on=g.prototype.addListener,g.prototype.prependListener=function(C,Z){return A(this,C,Z,!0)},g.prototype.once=function(C,Z){return h(Z),this.on(C,O(this,C,Z)),this},g.prototype.prependOnceListener=function(C,Z){return h(Z),this.prependListener(C,O(this,C,Z)),this},g.prototype.removeListener=function(C,Z){var ie,U,c,d,_;if(h(Z),(U=this._events)===void 0)return this;if((ie=U[C])===void 0)return this;if(ie===Z||ie.listener===Z)--this._eventsCount==0?this._events=Object.create(null):(delete U[C],U.removeListener&&this.emit("removeListener",C,ie.listener||Z));else if(typeof ie!="function"){for(c=-1,d=ie.length-1;d>=0;d--)if(ie[d]===Z||ie[d].listener===Z){_=ie[d].listener,c=d;break}if(c<0)return this;c===0?ie.shift():function(m,q){for(;q+1<m.length;q++)m[q]=m[q+1];m.pop()}(ie,c),ie.length===1&&(U[C]=ie[0]),U.removeListener!==void 0&&this.emit("removeListener",C,_||Z)}return this},g.prototype.off=g.prototype.removeListener,g.prototype.removeAllListeners=function(C){var Z,ie,U;if((ie=this._events)===void 0)return this;if(ie.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ie[C]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete ie[C]),this;if(arguments.length===0){var c,d=Object.keys(ie);for(U=0;U<d.length;++U)(c=d[U])!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(Z=ie[C])=="function")this.removeListener(C,Z);else if(Z!==void 0)for(U=Z.length-1;U>=0;U--)this.removeListener(C,Z[U]);return this},g.prototype.listeners=function(C){return F(this,C,!0)},g.prototype.rawListeners=function(C){return F(this,C,!1)},g.listenerCount=function(C,Z){return typeof C.listenerCount=="function"?C.listenerCount(Z):P.call(C,Z)},g.prototype.listenerCount=P,g.prototype.eventNames=function(){return this._eventsCount>0?V(this._events):[]}},function(pe,oe,x){x.d(oe,"b",function(){return T}),x.d(oe,"a",function(){return u});var V=x(2),k=x(6),T={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},u={NETWORK_EXCEPTION:V.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:V.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:V.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:V.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:k.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:k.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:k.a.CODEC_UNSUPPORTED}},function(pe,oe,x){x.d(oe,"d",function(){return V}),x.d(oe,"b",function(){return k}),x.d(oe,"a",function(){return T}),x.d(oe,"c",function(){return u});var V=function(g,i,h,p,A){this.dts=g,this.pts=i,this.duration=h,this.originalDts=p,this.isSyncPoint=A,this.fileposition=null},k=function(){function g(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return g.prototype.appendSyncPoint=function(i){i.isSyncPoint=!0,this.syncPoints.push(i)},g}(),T=function(){function g(){this._list=[]}return g.prototype.clear=function(){this._list=[]},g.prototype.appendArray=function(i){var h=this._list;i.length!==0&&(h.length>0&&i[0].originalDts<h[h.length-1].originalDts&&this.clear(),Array.prototype.push.apply(h,i))},g.prototype.getLastSyncPointBeforeDts=function(i){if(this._list.length==0)return null;var h=this._list,p=0,A=h.length-1,E=0,O=0,F=A;for(i<h[0].dts&&(p=0,O=F+1);O<=F;){if((E=O+Math.floor((F-O)/2))===A||i>=h[E].dts&&i<h[E+1].dts){p=E;break}h[E].dts<i?O=E+1:F=E-1}return this._list[p]},g}(),u=function(){function g(i){this._type=i,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),g.prototype.isEmpty=function(){return this._list.length===0},g.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},g.prototype._searchNearestSegmentBefore=function(i){var h=this._list;if(h.length===0)return-2;var p=h.length-1,A=0,E=0,O=p,F=0;if(i<h[0].originalBeginDts)return F=-1;for(;E<=O;){if((A=E+Math.floor((O-E)/2))===p||i>h[A].lastSample.originalDts&&i<h[A+1].originalBeginDts){F=A;break}h[A].originalBeginDts<i?E=A+1:O=A-1}return F},g.prototype._searchNearestSegmentAfter=function(i){return this._searchNearestSegmentBefore(i)+1},g.prototype.append=function(i){var h=this._list,p=i,A=this._lastAppendLocation,E=0;A!==-1&&A<h.length&&p.originalBeginDts>=h[A].lastSample.originalDts&&(A===h.length-1||A<h.length-1&&p.originalBeginDts<h[A+1].originalBeginDts)?E=A+1:h.length>0&&(E=this._searchNearestSegmentBefore(p.originalBeginDts)+1),this._lastAppendLocation=E,this._list.splice(E,0,p)},g.prototype.getLastSegmentBefore=function(i){var h=this._searchNearestSegmentBefore(i);return h>=0?this._list[h]:null},g.prototype.getLastSampleBefore=function(i){var h=this.getLastSegmentBefore(i);return h!=null?h.lastSample:null},g.prototype.getLastSyncPointBefore=function(i){for(var h=this._searchNearestSegmentBefore(i),p=this._list[h].syncPoints;p.length===0&&h>0;)h--,p=this._list[h].syncPoints;return p.length>0?p[p.length-1]:null},g}()},function(pe,oe,x){var V=function(){function k(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return k.prototype.isComplete=function(){var T=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,u=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&T&&u},k.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},k.prototype.getNearestKeyframe=function(T){if(this.keyframesIndex==null)return null;var u=this.keyframesIndex,g=this._search(u.times,T);return{index:g,milliseconds:u.times[g],fileposition:u.filepositions[g]}},k.prototype._search=function(T,u){var g=0,i=T.length-1,h=0,p=0,A=i;for(u<T[0]&&(g=0,p=A+1);p<=A;){if((h=p+Math.floor((A-p)/2))===i||u>=T[h]&&u<T[h+1]){g=h;break}T[h]<u?p=h+1:A=h-1}return g},k}();oe.a=V},function(pe,oe,x){var V,k=x(0),T=x(13),u=x(3),g=function(){function l(){}return l.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},l}(),i=function(){this.program_pmt_pid={}};(function(l){l[l.kMPEG1Audio=3]="kMPEG1Audio",l[l.kMPEG2Audio=4]="kMPEG2Audio",l[l.kPESPrivateData=6]="kPESPrivateData",l[l.kADTSAAC=15]="kADTSAAC",l[l.kLOASAAC=17]="kLOASAAC",l[l.kAC3=129]="kAC3",l[l.kEAC3=135]="kEAC3",l[l.kMetadata=21]="kMetadata",l[l.kSCTE35=134]="kSCTE35",l[l.kH264=27]="kH264",l[l.kH265=36]="kH265"})(V||(V={}));var h,p=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,av1:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},A=function(){},E=function(){},O=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(l){l[l.kUnspecified=0]="kUnspecified",l[l.kSliceNonIDR=1]="kSliceNonIDR",l[l.kSliceDPA=2]="kSliceDPA",l[l.kSliceDPB=3]="kSliceDPB",l[l.kSliceDPC=4]="kSliceDPC",l[l.kSliceIDR=5]="kSliceIDR",l[l.kSliceSEI=6]="kSliceSEI",l[l.kSliceSPS=7]="kSliceSPS",l[l.kSlicePPS=8]="kSlicePPS",l[l.kSliceAUD=9]="kSliceAUD",l[l.kEndOfSequence=10]="kEndOfSequence",l[l.kEndOfStream=11]="kEndOfStream",l[l.kFiller=12]="kFiller",l[l.kSPSExt=13]="kSPSExt",l[l.kReserved0=14]="kReserved0"})(h||(h={}));var F,P,j=function(){},H=function(l){var y=l.data.byteLength;this.type=l.type,this.data=new Uint8Array(4+y),new DataView(this.data.buffer).setUint32(0,y),this.data.set(l.data,4)},C=function(){function l(y){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=y,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return l.prototype.findNextStartCodeOffset=function(y){for(var s=y,n=this.data_;;){if(s+3>=n.byteLength)return this.eof_flag_=!0,n.byteLength;var S=n[s+0]<<24|n[s+1]<<16|n[s+2]<<8|n[s+3],w=n[s+0]<<16|n[s+1]<<8|n[s+2];if(S===1||w===1)return s;s++}},l.prototype.readNextNaluPayload=function(){for(var y=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_startcode_offset_,S=31&y[n+=(y[n]<<24|y[n+1]<<16|y[n+2]<<8|y[n+3])===1?4:3],w=(128&y[n])>>>7,f=this.findNextStartCodeOffset(n);if(this.current_startcode_offset_=f,!(S>=h.kReserved0)&&w===0){var D=y.subarray(n,f);(s=new j).type=S,s.data=D}}return s},l}(),Z=function(){function l(y,s,n){var S=8+y.byteLength+1+2+s.byteLength,w=!1;y[3]!==66&&y[3]!==77&&y[3]!==88&&(w=!0,S+=4);var f=this.data=new Uint8Array(S);f[0]=1,f[1]=y[1],f[2]=y[2],f[3]=y[3],f[4]=255,f[5]=225;var D=y.byteLength;f[6]=D>>>8,f[7]=255&D;var G=8;f.set(y,8),f[G+=D]=1;var B=s.byteLength;f[G+1]=B>>>8,f[G+2]=255&B,f.set(s,G+3),G+=3+B,w&&(f[G]=252|n.chroma_format_idc,f[G+1]=248|n.bit_depth_luma-8,f[G+2]=248|n.bit_depth_chroma-8,f[G+3]=0,G+=4)}return l.prototype.getData=function(){return this.data},l}(),ie=x(23),U=x(8);(function(l){l[l.kNull=0]="kNull",l[l.kAACMain=1]="kAACMain",l[l.kAAC_LC=2]="kAAC_LC",l[l.kAAC_SSR=3]="kAAC_SSR",l[l.kAAC_LTP=4]="kAAC_LTP",l[l.kAAC_SBR=5]="kAAC_SBR",l[l.kAAC_Scalable=6]="kAAC_Scalable",l[l.kLayer1=32]="kLayer1",l[l.kLayer2=33]="kLayer2",l[l.kLayer3=34]="kLayer3"})(F||(F={})),function(l){l[l.k96000Hz=0]="k96000Hz",l[l.k88200Hz=1]="k88200Hz",l[l.k64000Hz=2]="k64000Hz",l[l.k48000Hz=3]="k48000Hz",l[l.k44100Hz=4]="k44100Hz",l[l.k32000Hz=5]="k32000Hz",l[l.k24000Hz=6]="k24000Hz",l[l.k22050Hz=7]="k22050Hz",l[l.k16000Hz=8]="k16000Hz",l[l.k12000Hz=9]="k12000Hz",l[l.k11025Hz=10]="k11025Hz",l[l.k8000Hz=11]="k8000Hz",l[l.k7350Hz=12]="k7350Hz"}(P||(P={}));var c,d,_=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],m=(c=function(l,y){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var S in n)Object.prototype.hasOwnProperty.call(n,S)&&(s[S]=n[S])})(l,y)},function(l,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function s(){this.constructor=l}c(l,y),l.prototype=y===null?Object.create(y):(s.prototype=y.prototype,new s)}),q=function(){},te=function(l){function y(){return l!==null&&l.apply(this,arguments)||this}return m(y,l),y}(q),ne=function(){function l(y){this.TAG="AACADTSParser",this.data_=y,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return l.prototype.findNextSyncwordOffset=function(y){for(var s=y,n=this.data_;;){if(s+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<8|n[s+1])>>>4===4095)return s;s++}},l.prototype.readNextAACFrame=function(){for(var y=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_syncword_offset_,S=(8&y[n+1])>>>3,w=(6&y[n+1])>>>1,f=1&y[n+1],D=(192&y[n+2])>>>6,G=(60&y[n+2])>>>2,B=(1&y[n+2])<<2|(192&y[n+3])>>>6,X=(3&y[n+3])<<11|y[n+4]<<3|(224&y[n+5])>>>5;if(y[n+6],n+X>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var J=f===1?7:9,Q=X-J;n+=J;var $=this.findNextSyncwordOffset(n+Q);if(this.current_syncword_offset_=$,(S===0||S===1)&&w===0){var de=y.subarray(n,n+Q);(s=new q).audio_object_type=D+1,s.sampling_freq_index=G,s.sampling_frequency=_[G],s.channel_config=B,s.data=de}}return s},l.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},l.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},l}(),Y=function(){function l(y){this.TAG="AACLOASParser",this.data_=y,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return l.prototype.findNextSyncwordOffset=function(y){for(var s=y,n=this.data_;;){if(s+1>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<3|n[s+1]>>>5)===695)return s;s++}},l.prototype.getLATMValue=function(y){for(var s=y.readBits(2),n=0,S=0;S<=s;S++)n<<=8,n|=y.readByte();return n},l.prototype.readNextAACFrame=function(y){for(var s=this.data_,n=null;n==null&&!this.eof_flag_;){var S=this.current_syncword_offset_,w=(31&s[S+1])<<8|s[S+2];if(S+3+w>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var f=new U.a(s.subarray(S+3,S+3+w)),D=null;if(f.readBool()){if(y==null){k.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(S+3+w),f.destroy();continue}D=y}else{var G=f.readBool();if(G&&f.readBool()){k.a.e(this.TAG,"audioMuxVersionA is Not Supported"),f.destroy();break}if(G&&this.getLATMValue(f),!f.readBool()){k.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),f.destroy();break}if(f.readBits(6)!==0){k.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),f.destroy();break}if(f.readBits(4)!==0){k.a.e(this.TAG,"more than 2 numProgram Not Supported"),f.destroy();break}if(f.readBits(3)!==0){k.a.e(this.TAG,"more than 2 numLayer Not Supported"),f.destroy();break}var B=G?this.getLATMValue(f):0,X=f.readBits(5);B-=5;var J=f.readBits(4);B-=4;var Q=f.readBits(4);B-=4,f.readBits(3),(B-=3)>0&&f.readBits(B);var $=f.readBits(3);if($!==0){k.a.e(this.TAG,"frameLengthType = ".concat($,". Only frameLengthType = 0 Supported")),f.destroy();break}f.readByte();var de=f.readBool();if(de)if(G)this.getLATMValue(f);else{for(var ue=0;;){ue<<=8;var Ae=f.readBool();if(ue+=f.readByte(),!Ae)break}console.log(ue)}f.readBool()&&f.readByte(),(D=new te).audio_object_type=X,D.sampling_freq_index=J,D.sampling_frequency=_[D.sampling_freq_index],D.channel_config=Q,D.other_data_present=de}for(var Te=0;;){var be=f.readByte();if(Te+=be,be!==255)break}for(var ge=new Uint8Array(Te),Oe=0;Oe<Te;Oe++)ge[Oe]=f.readByte();(n=new te).audio_object_type=D.audio_object_type,n.sampling_freq_index=D.sampling_freq_index,n.sampling_frequency=_[D.sampling_freq_index],n.channel_config=D.channel_config,n.other_data_present=D.other_data_present,n.data=ge,this.current_syncword_offset_=this.findNextSyncwordOffset(S+3+w)}return n},l.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},l.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},l}(),W=function(l){var y=null,s=l.audio_object_type,n=l.audio_object_type,S=l.sampling_freq_index,w=l.channel_config,f=0,D=navigator.userAgent.toLowerCase();D.indexOf("firefox")!==-1?S>=6?(n=5,y=new Array(4),f=S-3):(n=2,y=new Array(2),f=S):D.indexOf("android")!==-1?(n=2,y=new Array(2),f=S):(n=5,f=S,y=new Array(4),S>=6?f=S-3:w===1&&(n=2,y=new Array(2),f=S)),y[0]=n<<3,y[0]|=(15&S)>>>1,y[1]=(15&S)<<7,y[1]|=(15&w)<<3,n===5&&(y[1]|=(15&f)>>>1,y[2]=(1&f)<<7,y[2]|=8,y[3]=0),this.config=y,this.sampling_rate=_[S],this.channel_count=w,this.codec_mimetype="mp4a.40."+n,this.original_codec_mimetype="mp4a.40."+s},he=function(){},se=function(){};(function(l){l[l.kSpliceNull=0]="kSpliceNull",l[l.kSpliceSchedule=4]="kSpliceSchedule",l[l.kSpliceInsert=5]="kSpliceInsert",l[l.kTimeSignal=6]="kTimeSignal",l[l.kBandwidthReservation=7]="kBandwidthReservation",l[l.kPrivateCommand=255]="kPrivateCommand"})(d||(d={}));var R,e=function(l){var y=l.readBool();return y?(l.readBits(6),{time_specified_flag:y,pts_time:4*l.readBits(31)+l.readBits(2)}):(l.readBits(7),{time_specified_flag:y})},t=function(l){var y=l.readBool();return l.readBits(6),{auto_return:y,duration:4*l.readBits(31)+l.readBits(2)}},a=function(l,y){var s=y.readBits(8);return l?{component_tag:s}:{component_tag:s,splice_time:e(y)}},o=function(l){return{component_tag:l.readBits(8),utc_splice_time:l.readBits(32)}},r=function(l){var y=l.readBits(32),s=l.readBool();l.readBits(7);var n={splice_event_id:y,splice_event_cancel_indicator:s};if(s)return n;if(n.out_of_network_indicator=l.readBool(),n.program_splice_flag=l.readBool(),n.duration_flag=l.readBool(),l.readBits(5),n.program_splice_flag)n.utc_splice_time=l.readBits(32);else{n.component_count=l.readBits(8),n.components=[];for(var S=0;S<n.component_count;S++)n.components.push(o(l))}return n.duration_flag&&(n.break_duration=t(l)),n.unique_program_id=l.readBits(16),n.avail_num=l.readBits(8),n.avails_expected=l.readBits(8),n},v=function(l,y,s,n){return{descriptor_tag:l,descriptor_length:y,identifier:s,provider_avail_id:n.readBits(32)}},L=function(l,y,s,n){var S=n.readBits(8),w=n.readBits(3);n.readBits(5);for(var f="",D=0;D<w;D++)f+=String.fromCharCode(n.readBits(8));return{descriptor_tag:l,descriptor_length:y,identifier:s,preroll:S,dtmf_count:w,DTMF_char:f}},b=function(l){var y=l.readBits(8);return l.readBits(7),{component_tag:y,pts_offset:4*l.readBits(31)+l.readBits(2)}},M=function(l,y,s,n){var S=n.readBits(32),w=n.readBool();n.readBits(7);var f={descriptor_tag:l,descriptor_length:y,identifier:s,segmentation_event_id:S,segmentation_event_cancel_indicator:w};if(w)return f;if(f.program_segmentation_flag=n.readBool(),f.segmentation_duration_flag=n.readBool(),f.delivery_not_restricted_flag=n.readBool(),f.delivery_not_restricted_flag?n.readBits(5):(f.web_delivery_allowed_flag=n.readBool(),f.no_regional_blackout_flag=n.readBool(),f.archive_allowed_flag=n.readBool(),f.device_restrictions=n.readBits(2)),!f.program_segmentation_flag){f.component_count=n.readBits(8),f.components=[];for(var D=0;D<f.component_count;D++)f.components.push(b(n))}f.segmentation_duration_flag&&(f.segmentation_duration=n.readBits(40)),f.segmentation_upid_type=n.readBits(8),f.segmentation_upid_length=n.readBits(8);var G=new Uint8Array(f.segmentation_upid_length);for(D=0;D<f.segmentation_upid_length;D++)G[D]=n.readBits(8);return f.segmentation_upid=G.buffer,f.segmentation_type_id=n.readBits(8),f.segment_num=n.readBits(8),f.segments_expected=n.readBits(8),f.segmentation_type_id!==52&&f.segmentation_type_id!==54&&f.segmentation_type_id!==56&&f.segmentation_type_id!==58||(f.sub_segment_num=n.readBits(8),f.sub_segments_expected=n.readBits(8)),f},N=function(l,y,s,n){return{descriptor_tag:l,descriptor_length:y,identifier:s,TAI_seconds:n.readBits(48),TAI_ns:n.readBits(32),UTC_offset:n.readBits(16)}},I=function(l){return{component_tag:l.readBits(8),ISO_code:String.fromCharCode(l.readBits(8),l.readBits(8),l.readBits(8)),Bit_Stream_Mode:l.readBits(3),Num_Channels:l.readBits(4),Full_Srvc_Audio:l.readBool()}},z=function(l,y,s,n){for(var S=n.readBits(4),w=[],f=0;f<S;f++)w.push(I(n));return{descriptor_tag:l,descriptor_length:y,identifier:s,audio_count:S,components:w}},K=function(l){var y=new U.a(l),s=y.readBits(8),n=y.readBool(),S=y.readBool();y.readBits(2);var w=y.readBits(12),f=y.readBits(8),D=y.readBool(),G=y.readBits(6),B=4*y.readBits(31)+y.readBits(2),X=y.readBits(8),J=y.readBits(12),Q=y.readBits(12),$=y.readBits(8),de=null;$===d.kSpliceNull?de={}:$===d.kSpliceSchedule?de=function(Le){for(var Ne=Le.readBits(8),Fe=[],Ee=0;Ee<Ne;Ee++)Fe.push(r(Le));return{splice_count:Ne,events:Fe}}(y):$===d.kSpliceInsert?de=function(Le){var Ne=Le.readBits(32),Fe=Le.readBool();Le.readBits(7);var Ee={splice_event_id:Ne,splice_event_cancel_indicator:Fe};if(Fe)return Ee;if(Ee.out_of_network_indicator=Le.readBool(),Ee.program_splice_flag=Le.readBool(),Ee.duration_flag=Le.readBool(),Ee.splice_immediate_flag=Le.readBool(),Le.readBits(4),Ee.program_splice_flag&&!Ee.splice_immediate_flag&&(Ee.splice_time=e(Le)),!Ee.program_splice_flag){Ee.component_count=Le.readBits(8),Ee.components=[];for(var Ge=0;Ge<Ee.component_count;Ge++)Ee.components.push(a(Ee.splice_immediate_flag,Le))}return Ee.duration_flag&&(Ee.break_duration=t(Le)),Ee.unique_program_id=Le.readBits(16),Ee.avail_num=Le.readBits(8),Ee.avails_expected=Le.readBits(8),Ee}(y):$===d.kTimeSignal?de=function(Le){return{splice_time:e(Le)}}(y):$===d.kBandwidthReservation?de={}:$===d.kPrivateCommand?de=function(Le,Ne){for(var Fe=String.fromCharCode(Ne.readBits(8),Ne.readBits(8),Ne.readBits(8),Ne.readBits(8)),Ee=new Uint8Array(Le-4),Ge=0;Ge<Le-4;Ge++)Ee[Ge]=Ne.readBits(8);return{identifier:Fe,private_data:Ee.buffer}}(Q,y):y.readBits(8*Q);for(var ue=[],Ae=y.readBits(16),Te=0;Te<Ae;){var be=y.readBits(8),ge=y.readBits(8),Oe=String.fromCharCode(y.readBits(8),y.readBits(8),y.readBits(8),y.readBits(8));be===0?ue.push(v(be,ge,Oe,y)):be===1?ue.push(L(be,ge,Oe,y)):be===2?ue.push(M(be,ge,Oe,y)):be===3?ue.push(N(be,ge,Oe,y)):be===4?ue.push(z(be,ge,Oe,y)):y.readBits(8*(ge-4)),Te+=2+ge}var Pe={table_id:s,section_syntax_indicator:n,private_indicator:S,section_length:w,protocol_version:f,encrypted_packet:D,encryption_algorithm:G,pts_adjustment:B,cw_index:X,tier:J,splice_command_length:Q,splice_command_type:$,splice_command:de,descriptor_loop_length:Ae,splice_descriptors:ue,E_CRC32:D?y.readBits(32):void 0,CRC32:y.readBits(32)};if($===d.kSpliceInsert){var Ce=de;if(Ce.splice_event_cancel_indicator)return{splice_command_type:$,detail:Pe,data:l};if(Ce.program_splice_flag&&!Ce.splice_immediate_flag){var Be=Ce.duration_flag?Ce.break_duration.auto_return:void 0,je=Ce.duration_flag?Ce.break_duration.duration/90:void 0;return Ce.splice_time.time_specified_flag?{splice_command_type:$,pts:(B+Ce.splice_time.pts_time)%Math.pow(2,33),auto_return:Be,duraiton:je,detail:Pe,data:l}:{splice_command_type:$,auto_return:Be,duraiton:je,detail:Pe,data:l}}return{splice_command_type:$,auto_return:Be=Ce.duration_flag?Ce.break_duration.auto_return:void 0,duraiton:je=Ce.duration_flag?Ce.break_duration.duration/90:void 0,detail:Pe,data:l}}if($===d.kTimeSignal){var ze=de;return ze.splice_time.time_specified_flag?{splice_command_type:$,pts:(B+ze.splice_time.pts_time)%Math.pow(2,33),detail:Pe,data:l}:{splice_command_type:$,detail:Pe,data:l}}return{splice_command_type:$,detail:Pe,data:l}};(function(l){l[l.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",l[l.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",l[l.kSliceCRA_NUT=21]="kSliceCRA_NUT",l[l.kSliceVPS=32]="kSliceVPS",l[l.kSliceSPS=33]="kSliceSPS",l[l.kSlicePPS=34]="kSlicePPS",l[l.kSliceAUD=35]="kSliceAUD"})(R||(R={}));var ae=function(){},re=function(l){var y=l.data.byteLength;this.type=l.type,this.data=new Uint8Array(4+y),new DataView(this.data.buffer).setUint32(0,y),this.data.set(l.data,4)},le=function(){function l(y){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=y,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return l.prototype.findNextStartCodeOffset=function(y){for(var s=y,n=this.data_;;){if(s+3>=n.byteLength)return this.eof_flag_=!0,n.byteLength;var S=n[s+0]<<24|n[s+1]<<16|n[s+2]<<8|n[s+3],w=n[s+0]<<16|n[s+1]<<8|n[s+2];if(S===1||w===1)return s;s++}},l.prototype.readNextNaluPayload=function(){for(var y=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_startcode_offset_,S=y[n+=(y[n]<<24|y[n+1]<<16|y[n+2]<<8|y[n+3])===1?4:3]>>1&63,w=(128&y[n])>>>7,f=this.findNextStartCodeOffset(n);if(this.current_startcode_offset_=f,w===0){var D=y.subarray(n,f);(s=new ae).type=S,s.data=D}}return s},l}(),ee=function(){function l(y,s,n,S){var w=23+(5+y.byteLength)+(5+s.byteLength)+(5+n.byteLength),f=this.data=new Uint8Array(w);f[0]=1,f[1]=(3&S.general_profile_space)<<6|(S.general_tier_flag?1:0)<<5|31&S.general_profile_idc,f[2]=S.general_profile_compatibility_flags_1,f[3]=S.general_profile_compatibility_flags_2,f[4]=S.general_profile_compatibility_flags_3,f[5]=S.general_profile_compatibility_flags_4,f[6]=S.general_constraint_indicator_flags_1,f[7]=S.general_constraint_indicator_flags_2,f[8]=S.general_constraint_indicator_flags_3,f[9]=S.general_constraint_indicator_flags_4,f[10]=S.general_constraint_indicator_flags_5,f[11]=S.general_constraint_indicator_flags_6,f[12]=S.general_level_idc,f[13]=240|(3840&S.min_spatial_segmentation_idc)>>8,f[14]=255&S.min_spatial_segmentation_idc,f[15]=252|3&S.parallelismType,f[16]=252|3&S.chroma_format_idc,f[17]=248|7&S.bit_depth_luma_minus8,f[18]=248|7&S.bit_depth_chroma_minus8,f[19]=0,f[20]=0,f[21]=(3&S.constant_frame_rate)<<6|(7&S.num_temporal_layers)<<3|(S.temporal_id_nested?1:0)<<2|3,f[22]=3,f[23]=128|R.kSliceVPS,f[24]=0,f[25]=1,f[26]=(65280&y.byteLength)>>8,f[27]=(255&y.byteLength)>>0,f.set(y,28),f[23+(5+y.byteLength)+0]=128|R.kSliceSPS,f[23+(5+y.byteLength)+1]=0,f[23+(5+y.byteLength)+2]=1,f[23+(5+y.byteLength)+3]=(65280&s.byteLength)>>8,f[23+(5+y.byteLength)+4]=(255&s.byteLength)>>0,f.set(s,23+(5+y.byteLength)+5),f[23+(5+y.byteLength+5+s.byteLength)+0]=128|R.kSlicePPS,f[23+(5+y.byteLength+5+s.byteLength)+1]=0,f[23+(5+y.byteLength+5+s.byteLength)+2]=1,f[23+(5+y.byteLength+5+s.byteLength)+3]=(65280&n.byteLength)>>8,f[23+(5+y.byteLength+5+s.byteLength)+4]=(255&n.byteLength)>>0,f.set(n,23+(5+y.byteLength+5+s.byteLength)+5)}return l.prototype.getData=function(){return this.data},l}(),fe=x(15),me=function(){},_e=function(){},ye=function(){},ke=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],ce=function(){function l(y){this.TAG="AC3Parser",this.data_=y,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return l.prototype.findNextSyncwordOffset=function(y){for(var s=y,n=this.data_;;){if(s+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<8|n[s+1]<<0)===2935)return s;s++}},l.prototype.readNextAC3Frame=function(){for(var y=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_syncword_offset_,S=y[n+4]>>6,w=[48e3,44200,33e3][S],f=63&y[n+4],D=2*ke[S][f];if(isNaN(D)||n+D>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var G=this.findNextSyncwordOffset(n+D);this.current_syncword_offset_=G;var B=y[n+5]>>3,X=7&y[n+5],J=y[n+6]>>5,Q=0;1&J&&J!==1&&(Q+=2),4&J&&(Q+=2),J===2&&(Q+=2);var $=(y[n+6]<<8|y[n+7]<<0)>>12-Q&1,de=[2,1,2,3,3,4,4,5][J]+$;(s=new ye).sampling_frequency=w,s.channel_count=de,s.channel_mode=J,s.bit_stream_identification=B,s.low_frequency_effects_channel_on=$,s.bit_stream_mode=X,s.frame_size_code=f,s.data=y.subarray(n,n+D)}return s},l.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},l.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},l}(),ve=function(l){var y;y=[l.sampling_rate_code<<6|l.bit_stream_identification<<1|l.bit_stream_mode>>2,(3&l.bit_stream_mode)<<6|l.channel_mode<<3|l.low_frequency_effects_channel_on<<2|l.frame_size_code>>4,l.frame_size_code<<4&224],this.config=y,this.sampling_rate=l.sampling_frequency,this.bit_stream_identification=l.bit_stream_identification,this.bit_stream_mode=l.bit_stream_mode,this.low_frequency_effects_channel_on=l.low_frequency_effects_channel_on,this.channel_count=l.channel_count,this.channel_mode=l.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},Se=function(){},we=function(){function l(y){this.TAG="EAC3Parser",this.data_=y,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return l.prototype.findNextSyncwordOffset=function(y){for(var s=y,n=this.data_;;){if(s+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<8|n[s+1]<<0)===2935)return s;s++}},l.prototype.readNextEAC3Frame=function(){for(var y=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_syncword_offset_,S=new U.a(y.subarray(n+2)),w=(S.readBits(2),S.readBits(3),S.readBits(11)+1<<1),f=S.readBits(2),D=null,G=null;f===3?(D=[24e3,22060,16e3][f=S.readBits(2)],G=3):(D=[48e3,44100,32e3][f],G=S.readBits(2));var B=S.readBits(3),X=S.readBits(1),J=S.readBits(5);if(n+w>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var Q=this.findNextSyncwordOffset(n+w);this.current_syncword_offset_=Q;var $=[2,1,2,3,3,4,4,5][B]+X;S.destroy(),(s=new Se).sampling_frequency=D,s.channel_count=$,s.channel_mode=B,s.bit_stream_identification=J,s.low_frequency_effects_channel_on=X,s.frame_size=w,s.num_blks=[1,2,3,6][G],s.data=y.subarray(n,n+w)}return s},l.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},l.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},l}(),Ie=function(l){var y,s=Math.floor(l.frame_size*l.sampling_frequency/(16*l.num_blks));y=[255&s,248&s,l.sampling_rate_code<<6|l.bit_stream_identification<<1|0,0|l.channel_mode<<1|l.low_frequency_effects_channel_on<<0,0],this.config=y,this.sampling_rate=l.sampling_frequency,this.bit_stream_identification=l.bit_stream_identification,this.num_blks=l.num_blks,this.low_frequency_effects_channel_on=l.low_frequency_effects_channel_on,this.channel_count=l.channel_count,this.channel_mode=l.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},De=function(){},Ue=function(){function l(y){this.TAG="AV1OBUInMpegTsParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=y,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&k.a.e(this.TAG,"Could not find AV1 startcode until payload end!")}return l._ebsp2rbsp=function(y){for(var s=y,n=s.byteLength,S=new Uint8Array(n),w=0,f=0;f<n;f++)f>=2&&s[f]===3&&s[f-1]===0&&s[f-2]===0||(S[w]=s[f],w++);return new Uint8Array(S.buffer,0,w)},l.prototype.findNextStartCodeOffset=function(y){for(var s=y,n=this.data_;;){if(s+2>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if((n[s+0]<<16|n[s+1]<<8|n[s+2])===1)return s;s++}},l.prototype.readNextOBUPayload=function(){for(var y=this.data_,s=null;s==null&&!this.eof_flag_;){var n=this.current_startcode_offset_+3,S=this.findNextStartCodeOffset(n);this.current_startcode_offset_=S,s=l._ebsp2rbsp(y.subarray(n,S))}return s},l}(),Ve=x(16),Me=function(){var l=function(y,s){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,S){n.__proto__=S}||function(n,S){for(var w in S)Object.prototype.hasOwnProperty.call(S,w)&&(n[w]=S[w])})(y,s)};return function(y,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function n(){this.constructor=y}l(y,s),y.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}}(),Re=function(){return(Re=Object.assign||function(l){for(var y,s=1,n=arguments.length;s<n;s++)for(var S in y=arguments[s])Object.prototype.hasOwnProperty.call(y,S)&&(l[S]=y[S]);return l}).apply(this,arguments)},xe=function(l){function y(s,n){var S=l.call(this)||this;return S.TAG="TSDemuxer",S.first_parse_=!0,S.media_info_=new T.a,S.timescale_=90,S.duration_=0,S.current_pmt_pid_=-1,S.program_pmt_map_={},S.pes_slice_queues_={},S.section_slice_queues_={},S.video_metadata_={vps:void 0,sps:void 0,pps:void 0,av1c:void 0,details:void 0},S.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},S.last_pcr_base_=NaN,S.timestamp_offset_=0,S.audio_last_sample_pts_=void 0,S.aac_last_incomplete_data_=null,S.has_video_=!1,S.has_audio_=!1,S.video_init_segment_dispatched_=!1,S.audio_init_segment_dispatched_=!1,S.video_metadata_changed_=!1,S.loas_previous_frame=null,S.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},S.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},S.preferred_secondary_audio=!1,S.ts_packet_size_=s.ts_packet_size,S.sync_offset_=s.sync_offset,S.config_=n,S}return Me(y,l),y.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,l.prototype.destroy.call(this)},y.probe=function(s){var n=new Uint8Array(s),S=-1,w=188;if(n.byteLength<=3*w)return{needMoreData:!0};for(;S===-1;){for(var f=Math.min(1e3,n.byteLength-3*w),D=0;D<f;){if(n[D]===71&&n[D+w]===71&&n[D+2*w]===71){S=D;break}D++}if(S===-1)if(w===188)w=192;else{if(w!==192)break;w=204}}return S===-1?{match:!1}:(w===192&&S>=4?(k.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),S-=4):w===204&&k.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:w,sync_offset:S})},y.prototype.bindDataSource=function(s){return s.onDataArrival=this.parseChunks.bind(this),this},y.prototype.resetMediaInfo=function(){this.media_info_=new T.a},y.prototype.parseChunks=function(s,n){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new u.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var S=0;for(this.first_parse_&&(this.first_parse_=!1,S=this.sync_offset_);S+this.ts_packet_size_<=s.byteLength;){var w=n+S;this.ts_packet_size_===192&&(S+=4);var f=new Uint8Array(s,S,188),D=f[0];if(D!==71){k.a.e(this.TAG,"sync_byte = ".concat(D,", not 0x47"));break}var G=(64&f[1])>>>6,B=(f[1],(31&f[1])<<8|f[2]),X=(48&f[3])>>>4,J=15&f[3],Q=!(!this.pmt_||this.pmt_.pcr_pid!==B),$={},de=4;if(X==2||X==3){var ue=f[4];if(ue>0&&(Q||X==3)&&($.discontinuity_indicator=(128&f[5])>>>7,$.random_access_indicator=(64&f[5])>>>6,$.elementary_stream_priority_indicator=(32&f[5])>>>5,(16&f[5])>>>4)){var Ae=300*this.getPcrBase(f)+((1&f[10])<<8|f[11]);this.last_pcr_=Ae}if(X==2||5+ue===188){S+=188,this.ts_packet_size_===204&&(S+=16);continue}de=5+ue}if(X==1||X==3){if(B===0||B===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[B]===V.kSCTE35){var Te=188-de;this.handleSectionSlice(s,S+de,Te,{pid:B,file_position:w,payload_unit_start_indicator:G,continuity_conunter:J,random_access_indicator:$.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[B]!=null){Te=188-de;var be=this.pmt_.pid_stream_type[B];B!==this.pmt_.common_pids.h264&&B!==this.pmt_.common_pids.h265&&B!==this.pmt_.common_pids.av1&&B!==this.pmt_.common_pids.adts_aac&&B!==this.pmt_.common_pids.loas_aac&&B!==this.pmt_.common_pids.ac3&&B!==this.pmt_.common_pids.eac3&&B!==this.pmt_.common_pids.opus&&B!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[B]!==!0&&this.pmt_.timed_id3_pids[B]!==!0&&this.pmt_.synchronous_klv_pids[B]!==!0&&this.pmt_.asynchronous_klv_pids[B]!==!0||this.handlePESSlice(s,S+de,Te,{pid:B,stream_type:be,file_position:w,payload_unit_start_indicator:G,continuity_conunter:J,random_access_indicator:$.random_access_indicator})}}S+=188,this.ts_packet_size_===204&&(S+=16)}return this.dispatchAudioVideoMediaSegment(),S},y.prototype.handleSectionSlice=function(s,n,S,w){var f=new Uint8Array(s,n,S),D=this.section_slice_queues_[w.pid];if(w.payload_unit_start_indicator){var G=f[0];if(D!=null&&D.total_length!==0){var B=new Uint8Array(s,n+1,Math.min(S,G));D.slices.push(B),D.total_length+=B.byteLength,D.total_length===D.expected_length?this.emitSectionSlices(D,w):this.clearSlices(D,w)}for(var X=1+G;X<f.byteLength&&f[X+0]!==255;){var J=(15&f[X+1])<<8|f[X+2];this.section_slice_queues_[w.pid]=new O,(D=this.section_slice_queues_[w.pid]).expected_length=J+3,D.file_position=w.file_position,D.random_access_indicator=w.random_access_indicator,B=new Uint8Array(s,n+X,Math.min(S-X,D.expected_length-D.total_length)),D.slices.push(B),D.total_length+=B.byteLength,D.total_length===D.expected_length?this.emitSectionSlices(D,w):D.total_length>=D.expected_length&&this.clearSlices(D,w),X+=B.byteLength}}else D!=null&&D.total_length!==0&&(B=new Uint8Array(s,n,Math.min(S,D.expected_length-D.total_length)),D.slices.push(B),D.total_length+=B.byteLength,D.total_length===D.expected_length?this.emitSectionSlices(D,w):D.total_length>=D.expected_length&&this.clearSlices(D,w))},y.prototype.handlePESSlice=function(s,n,S,w){var f=new Uint8Array(s,n,S),D=f[0]<<16|f[1]<<8|f[2],G=(f[3],f[4]<<8|f[5]);if(w.payload_unit_start_indicator){if(D!==1)return void k.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(D));var B=this.pes_slice_queues_[w.pid];B&&(B.expected_length===0||B.expected_length===B.total_length?this.emitPESSlices(B,w):this.clearSlices(B,w)),this.pes_slice_queues_[w.pid]=new O,this.pes_slice_queues_[w.pid].file_position=w.file_position,this.pes_slice_queues_[w.pid].random_access_indicator=w.random_access_indicator}if(this.pes_slice_queues_[w.pid]!=null){var X=this.pes_slice_queues_[w.pid];X.slices.push(f),w.payload_unit_start_indicator&&(X.expected_length=G===0?0:G+6),X.total_length+=f.byteLength,X.expected_length>0&&X.expected_length===X.total_length?this.emitPESSlices(X,w):X.expected_length>0&&X.expected_length<X.total_length&&this.clearSlices(X,w)}},y.prototype.emitSectionSlices=function(s,n){for(var S=new Uint8Array(s.total_length),w=0,f=0;w<s.slices.length;w++){var D=s.slices[w];S.set(D,f),f+=D.byteLength}s.slices=[],s.expected_length=-1,s.total_length=0;var G=new E;G.pid=n.pid,G.data=S,G.file_position=s.file_position,G.random_access_indicator=s.random_access_indicator,this.parseSection(G)},y.prototype.emitPESSlices=function(s,n){for(var S=new Uint8Array(s.total_length),w=0,f=0;w<s.slices.length;w++){var D=s.slices[w];S.set(D,f),f+=D.byteLength}s.slices=[],s.expected_length=-1,s.total_length=0;var G=new A;G.pid=n.pid,G.data=S,G.stream_type=n.stream_type,G.file_position=s.file_position,G.random_access_indicator=s.random_access_indicator,this.parsePES(G)},y.prototype.clearSlices=function(s,n){s.slices=[],s.expected_length=-1,s.total_length=0},y.prototype.parseSection=function(s){var n=s.data,S=s.pid;S===0?this.parsePAT(n):S===this.current_pmt_pid_?this.parsePMT(n):this.pmt_!=null&&this.pmt_.scte_35_pids[S]&&this.parseSCTE35(n)},y.prototype.parsePES=function(s){var n=s.data,S=n[0]<<16|n[1]<<8|n[2],w=n[3],f=n[4]<<8|n[5];if(S===1)if(w!==188&&w!==190&&w!==191&&w!==240&&w!==241&&w!==255&&w!==242&&w!==248){n[6];var D=(192&n[7])>>>6,G=n[8],B=void 0,X=void 0;D!==2&&D!==3||(B=this.getTimestamp(n,9),X=D===3?this.getTimestamp(n,14):B);var J=9+G,Q=void 0;if(f!==0){if(f<3+G)return void k.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");Q=f-3-G}else Q=n.byteLength-J;var $=n.subarray(J,J+Q);switch(s.stream_type){case V.kMPEG1Audio:case V.kMPEG2Audio:this.parseMP3Payload($,B);break;case V.kPESPrivateData:this.pmt_.common_pids.av1===s.pid?this.parseAV1Payload($,B,X,s.file_position,s.random_access_indicator):this.pmt_.common_pids.opus===s.pid?this.parseOpusPayload($,B):this.pmt_.common_pids.ac3===s.pid?this.parseAC3Payload($,B):this.pmt_.common_pids.eac3===s.pid?this.parseEAC3Payload($,B):this.pmt_.asynchronous_klv_pids[s.pid]?this.parseAsynchronousKLVMetadataPayload($,s.pid,w):this.pmt_.smpte2038_pids[s.pid]?this.parseSMPTE2038MetadataPayload($,B,X,s.pid,w):this.parsePESPrivateDataPayload($,B,X,s.pid,w);break;case V.kADTSAAC:this.parseADTSAACPayload($,B);break;case V.kLOASAAC:this.parseLOASAACPayload($,B);break;case V.kAC3:this.parseAC3Payload($,B);break;case V.kEAC3:this.parseEAC3Payload($,B);break;case V.kMetadata:this.pmt_.timed_id3_pids[s.pid]?this.parseTimedID3MetadataPayload($,B,X,s.pid,w):this.pmt_.synchronous_klv_pids[s.pid]&&this.parseSynchronousKLVMetadataPayload($,B,X,s.pid,w);break;case V.kH264:this.parseH264Payload($,B,X,s.file_position,s.random_access_indicator);break;case V.kH265:this.parseH265Payload($,B,X,s.file_position,s.random_access_indicator)}}else(w===188||w===191||w===240||w===241||w===255||w===242||w===248)&&s.stream_type===V.kPESPrivateData&&(J=6,Q=void 0,Q=f!==0?f:n.byteLength-J,$=n.subarray(J,J+Q),this.parsePESPrivateDataPayload($,void 0,void 0,s.pid,w));else k.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(S))},y.prototype.parsePAT=function(s){var n=s[0];if(n===0){var S=(15&s[1])<<8|s[2],w=(s[3],s[4],(62&s[5])>>>1),f=1&s[5],D=s[6],G=(s[7],null);if(f===1&&D===0)(G=new i).version_number=w;else if((G=this.pat_)==null)return;for(var B=S-5-4,X=-1,J=-1,Q=8;Q<8+B;Q+=4){var $=s[Q]<<8|s[Q+1],de=(31&s[Q+2])<<8|s[Q+3];$===0?G.network_pid=de:(G.program_pmt_pid[$]=de,X===-1&&(X=$),J===-1&&(J=de))}f===1&&D===0&&(this.pat_==null&&k.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(G))),this.pat_=G,this.current_program_=X,this.current_pmt_pid_=J)}else k.a.e(this.TAG,"parsePAT: table_id ".concat(n," is not corresponded to PAT!"))},y.prototype.parsePMT=function(s){var n=s[0];if(n===2){var S=(15&s[1])<<8|s[2],w=s[3]<<8|s[4],f=(62&s[5])>>>1,D=1&s[5],G=s[6],B=(s[7],null);if(D===1&&G===0)(B=new p).program_number=w,B.version_number=f,this.program_pmt_map_[w]=B;else if((B=this.program_pmt_map_[w])==null)return;B.pcr_pid=(31&s[8])<<8|s[9];for(var X=(15&s[10])<<8|s[11],J=12+X,Q=S-9-X-4,$=J;$<J+Q;){var de=s[$],ue=(31&s[$+1])<<8|s[$+2],Ae=(15&s[$+3])<<8|s[$+4];B.pid_stream_type[ue]=de;var Te=B.common_pids.h264||B.common_pids.h265,be=B.common_pids.adts_aac||B.common_pids.loas_aac||B.common_pids.ac3||B.common_pids.eac3||B.common_pids.opus||B.common_pids.mp3;if(de!==V.kH264||Te)if(de!==V.kH265||Te)if(de!==V.kADTSAAC||be&&!this.preferred_secondary_audio)if(de!==V.kLOASAAC||be&&!this.preferred_secondary_audio)if(de!==V.kAC3||be&&!this.preferred_secondary_audio)if(de!==V.kEAC3||be&&!this.preferred_secondary_audio)if(de!==V.kMPEG1Audio&&de!==V.kMPEG2Audio||be&&!this.preferred_secondary_audio)if(de===V.kPESPrivateData){if(B.pes_private_data_pids[ue]=!0,Ae>0){for(var ge=$+5;ge<$+5+Ae;){var Oe=s[ge+0],Pe=s[ge+1];if(Oe===5){var Ce=String.fromCharCode.apply(String,Array.from(s.subarray(ge+2,ge+2+Pe)));Ce==="VANC"?B.smpte2038_pids[ue]=!0:Ce==="AV01"?B.common_pids.av1=ue:Ce==="Opus"?B.common_pids.opus=ue:Ce==="KLVA"&&(B.asynchronous_klv_pids[ue]=!0)}else if(Oe===127){if(ue===B.common_pids.opus){var Be=null;if(s[ge+2]===128&&(Be=s[ge+3]),Be==null){k.a.e(this.TAG,"Not Supported Opus channel count.");continue}var je={codec:"opus",channel_count:15&Be?15&Be:2,channel_config_code:Be,sample_rate:48e3},ze={codec:"opus",meta:je};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(ze))&&(this.audio_metadata_=je,this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(ze))}}else Oe===128&&ue===B.common_pids.av1&&(this.video_metadata_.av1c=s.subarray(ge+2,ge+2+Pe));ge+=2+Pe}var Le=s.subarray($+5,$+5+Ae);this.dispatchPESPrivateDataDescriptor(ue,de,Le)}}else if(de===V.kMetadata){if(Ae>0)for(ge=$+5;ge<$+5+Ae;){Oe=s[ge+0];var Ne=s[ge+1];if(Oe===38){var Fe=s[ge+2]<<8|s[ge+3]<<0,Ee=null;Fe===65535&&(Ee=String.fromCharCode.apply(String,Array.from(s.subarray(ge+4,ge+4+4))));var Ge=null;if(s[ge+4+(Fe===65535?4:0)]===255){var He=4+(Fe===65535?4:0)+1;Ge=String.fromCharCode.apply(String,Array.from(s.subarray(ge+He,ge+He+4)))}Ee==="ID3 "&&Ge==="ID3 "?B.timed_id3_pids[ue]=!0:Ge==="KLVA"&&(B.synchronous_klv_pids[ue]=!0)}ge+=2+Ne}}else de===V.kSCTE35&&(B.scte_35_pids[ue]=!0);else B.common_pids.mp3=ue;else B.common_pids.eac3=ue;else B.common_pids.ac3=ue;else B.common_pids.loas_aac=ue;else B.common_pids.adts_aac=ue;else B.common_pids.h265=ue;else B.common_pids.h264=ue;$+=5+Ae}w===this.current_program_&&(this.pmt_==null&&k.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(B))),this.pmt_=B,(B.common_pids.h264||B.common_pids.h265||B.common_pids.av1)&&(this.has_video_=!0),(B.common_pids.adts_aac||B.common_pids.loas_aac||B.common_pids.ac3||B.common_pids.opus||B.common_pids.mp3)&&(this.has_audio_=!0))}else k.a.e(this.TAG,"parsePMT: table_id ".concat(n," is not corresponded to PMT!"))},y.prototype.parseSCTE35=function(s){var n=K(s);if(n.pts!=null){var S=Math.floor(n.pts/this.timescale_);n.pts=S}else n.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata(n)},y.prototype.parseAV1Payload=function(s,n,S,w,f){for(var D=new Ue(s),G=null,B=[],X=0,J=!1,Q=null;(G=D.readNextOBUPayload())!=null;){if((Q=Ve.a.parseOBUs(G,this.video_metadata_.details))&&Q.keyframe===!0)if(this.video_init_segment_dispatched_){if(this.detectVideoMetadataChange(null,Q)===!0){var $;this.video_metadata_changed_=!0,this.dispatchVideoMediaSegment(!0),($=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+Q.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),$.set(Q.sequence_header_data,this.video_metadata_.av1c.byteLength),Q.av1c=$,this.dispatchVideoInitSegment()}}else($=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+Q.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),$.set(Q.sequence_header_data,this.video_metadata_.av1c.byteLength),Q.av1c=$,this.video_metadata_.details=Q,this.dispatchVideoInitSegment();this.video_metadata_.details=Q,J||(J=Q.keyframe),B.push({data:G}),X+=G.byteLength}var de=Math.floor(n/this.timescale_),ue=Math.floor(S/this.timescale_);if(B.length){var Ae=this.video_track_,Te={units:B,length:X,isKeyframe:J,dts:ue,pts:de,cts:de-ue,file_position:w};Ae.samples.push(Te),Ae.length+=X}},y.prototype.parseH264Payload=function(s,n,S,w,f){for(var D=new C(s),G=null,B=[],X=0,J=!1;(G=D.readNextNaluPayload())!=null;){var Q=new H(G);if(Q.type===h.kSliceSPS){var $=ie.a.parseSPS(G.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(Q,$)===!0&&(k.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:Q,pps:void 0,av1c:void 0,details:$}):(this.video_metadata_.sps=Q,this.video_metadata_.details=$)}else Q.type===h.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=Q,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())):(Q.type===h.kSliceIDR||Q.type===h.kSliceNonIDR&&f===1)&&(J=!0);this.video_init_segment_dispatched_&&(B.push(Q),X+=Q.data.byteLength)}var de=Math.floor(n/this.timescale_),ue=Math.floor(S/this.timescale_);if(B.length){var Ae=this.video_track_,Te={units:B,length:X,isKeyframe:J,dts:ue,pts:de,cts:de-ue,file_position:w};Ae.samples.push(Te),Ae.length+=X}},y.prototype.parseH265Payload=function(s,n,S,w,f){for(var D=new le(s),G=null,B=[],X=0,J=!1;(G=D.readNextNaluPayload())!=null;){var Q=new re(G);if(Q.type===R.kSliceVPS){if(!this.video_init_segment_dispatched_){var $=fe.a.parseVPS(G.data);this.video_metadata_.vps=Q,this.video_metadata_.details=Re(Re({},this.video_metadata_.details),$)}}else Q.type===R.kSliceSPS?($=fe.a.parseSPS(G.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(Q,$)===!0&&(k.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:Q,pps:void 0,av1c:void 0,details:$}):(this.video_metadata_.sps=Q,this.video_metadata_.details=Re(Re({},this.video_metadata_.details),$))):Q.type===R.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&($=fe.a.parsePPS(G.data),this.video_metadata_.pps=Q,this.video_metadata_.details=Re(Re({},this.video_metadata_.details),$),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())):Q.type!==R.kSliceIDR_W_RADL&&Q.type!==R.kSliceIDR_N_LP&&Q.type!==R.kSliceCRA_NUT||(J=!0);this.video_init_segment_dispatched_&&(B.push(Q),X+=Q.data.byteLength)}var de=Math.floor(n/this.timescale_),ue=Math.floor(S/this.timescale_);if(B.length){var Ae=this.video_track_,Te={units:B,length:X,isKeyframe:J,dts:ue,pts:de,cts:de-ue,file_position:w};Ae.samples.push(Te),Ae.length+=X}},y.prototype.detectVideoMetadataChange=function(s,n){if(n.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return k.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(n.codec_mimetype)),!0;if(n.codec_size.width!==this.video_metadata_.details.codec_size.width||n.codec_size.height!==this.video_metadata_.details.codec_size.height){var S=this.video_metadata_.details.codec_size,w=n.codec_size;return k.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(S.width,"x").concat(S.height," to ").concat(w.width,"x").concat(w.height)),!0}return n.present_size.width!==this.video_metadata_.details.present_size.width&&(k.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(n.present_size.width)),!0)},y.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},y.prototype.dispatchVideoInitSegment=function(){var s=this.video_metadata_.details,n={type:"video"};n.id=this.video_track_.id,n.timescale=1e3,n.duration=this.duration_,n.codecWidth=s.codec_size.width,n.codecHeight=s.codec_size.height,n.presentWidth=s.present_size.width,n.presentHeight=s.present_size.height,n.profile=s.profile_string,n.level=s.level_string,n.bitDepth=s.bit_depth,n.chromaFormat=s.chroma_format,n.sarRatio=s.sar_ratio,n.frameRate=s.frame_rate;var S=n.frameRate.fps_den,w=n.frameRate.fps_num;if(n.refSampleDuration=S/w*1e3,n.codec=s.codec_mimetype,this.video_metadata_.av1c)n.av1c=this.video_metadata_.av1c,this.video_init_segment_dispatched_==0&&k.a.v(this.TAG,"Generated first AV1 for mimeType: ".concat(n.codec));else if(this.video_metadata_.vps){var f=this.video_metadata_.vps.data.subarray(4),D=this.video_metadata_.sps.data.subarray(4),G=this.video_metadata_.pps.data.subarray(4),B=new ee(f,D,G,s);n.hvcc=B.getData(),this.video_init_segment_dispatched_==0&&k.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(n.codec))}else{D=this.video_metadata_.sps.data.subarray(4),G=this.video_metadata_.pps.data.subarray(4);var X=new Z(D,G,s);n.avcc=X.getData(),this.video_init_segment_dispatched_==0&&k.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat(n.codec))}this.onTrackMetadata("video",n),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var J=this.media_info_;J.hasVideo=!0,J.width=n.codecWidth,J.height=n.codecHeight,J.fps=n.frameRate.fps,J.profile=n.profile,J.level=n.level,J.refFrames=s.ref_frames,J.chromaFormat=s.chroma_format_string,J.sarNum=n.sarRatio.width,J.sarDen=n.sarRatio.height,J.videoCodec=n.codec,J.hasAudio&&J.audioCodec?J.mimeType='video/mp2t; codecs="'.concat(J.videoCodec,",").concat(J.audioCodec,'"'):J.mimeType='video/mp2t; codecs="'.concat(J.videoCodec,'"'),J.isComplete()&&this.onMediaInfo(J)},y.prototype.dispatchVideoMediaSegment=function(s){s===void 0&&(s=!1),this.isInitSegmentDispatched()&&(this.video_track_.length||s)&&this.onDataAvailable(null,this.video_track_,s)},y.prototype.dispatchAudioMediaSegment=function(s){s===void 0&&(s=!1),this.isInitSegmentDispatched()&&(this.audio_track_.length||s)&&this.onDataAvailable(this.audio_track_,null,s)},y.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},y.prototype.parseADTSAACPayload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var S=new Uint8Array(s.byteLength+this.aac_last_incomplete_data_.byteLength);S.set(this.aac_last_incomplete_data_,0),S.set(s,this.aac_last_incomplete_data_.byteLength),s=S}var w,f;if(n!=null&&(f=n/this.timescale_),this.audio_metadata_.codec==="aac"){if(n==null&&this.audio_last_sample_pts_!=null)w=1024/this.audio_metadata_.sampling_frequency*1e3,f=this.audio_last_sample_pts_+w;else if(n==null)return void k.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){w=1024/this.audio_metadata_.sampling_frequency*1e3;var D=this.audio_last_sample_pts_+w;Math.abs(D-f)>1&&(k.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(D,"ms, PES pts: ").concat(f,"ms")),f=D)}}for(var G,B=new ne(s),X=null,J=f;(X=B.readNextAACFrame())!=null;){w=1024/X.sampling_frequency*1e3;var Q={codec:"aac",data:X};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(Q))&&(this.audio_metadata_={codec:"aac",audio_object_type:X.audio_object_type,sampling_freq_index:X.sampling_freq_index,sampling_frequency:X.sampling_frequency,channel_config:X.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(Q)),G=J;var $=Math.floor(J),de={unit:X.data,length:X.data.byteLength,pts:$,dts:$};this.audio_track_.samples.push(de),this.audio_track_.length+=X.data.byteLength,J+=w}B.hasIncompleteData()&&(this.aac_last_incomplete_data_=B.getIncompleteData()),G&&(this.audio_last_sample_pts_=G)}},y.prototype.parseLOASAACPayload=function(s,n){var S;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var w=new Uint8Array(s.byteLength+this.aac_last_incomplete_data_.byteLength);w.set(this.aac_last_incomplete_data_,0),w.set(s,this.aac_last_incomplete_data_.byteLength),s=w}var f,D;if(n!=null&&(D=n/this.timescale_),this.audio_metadata_.codec==="aac"){if(n==null&&this.audio_last_sample_pts_!=null)f=1024/this.audio_metadata_.sampling_frequency*1e3,D=this.audio_last_sample_pts_+f;else if(n==null)return void k.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){f=1024/this.audio_metadata_.sampling_frequency*1e3;var G=this.audio_last_sample_pts_+f;Math.abs(G-D)>1&&(k.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(G,"ms, PES pts: ").concat(D,"ms")),D=G)}}for(var B,X=new Y(s),J=null,Q=D;(J=X.readNextAACFrame((S=this.loas_previous_frame)!==null&&S!==void 0?S:void 0))!=null;){this.loas_previous_frame=J,f=1024/J.sampling_frequency*1e3;var $={codec:"aac",data:J};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange($))&&(this.audio_metadata_={codec:"aac",audio_object_type:J.audio_object_type,sampling_freq_index:J.sampling_freq_index,sampling_frequency:J.sampling_frequency,channel_config:J.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment($)),B=Q;var de=Math.floor(Q),ue={unit:J.data,length:J.data.byteLength,pts:de,dts:de};this.audio_track_.samples.push(ue),this.audio_track_.length+=J.data.byteLength,Q+=f}X.hasIncompleteData()&&(this.aac_last_incomplete_data_=X.getIncompleteData()),B&&(this.audio_last_sample_pts_=B)}},y.prototype.parseAC3Payload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var S,w;if(n!=null&&(w=n/this.timescale_),this.audio_metadata_.codec==="ac-3"){if(n==null&&this.audio_last_sample_pts_!=null)S=1536/this.audio_metadata_.sampling_frequency*1e3,w=this.audio_last_sample_pts_+S;else if(n==null)return void k.a.w(this.TAG,"AC3: Unknown pts")}for(var f,D=new ce(s),G=null,B=w;(G=D.readNextAC3Frame())!=null;){S=1536/G.sampling_frequency*1e3;var X={codec:"ac-3",data:G};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(X))&&(this.audio_metadata_={codec:"ac-3",sampling_frequency:G.sampling_frequency,bit_stream_identification:G.bit_stream_identification,bit_stream_mode:G.bit_stream_mode,low_frequency_effects_channel_on:G.low_frequency_effects_channel_on,channel_mode:G.channel_mode},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(X)),f=B;var J=Math.floor(B),Q={unit:G.data,length:G.data.byteLength,pts:J,dts:J};this.audio_track_.samples.push(Q),this.audio_track_.length+=G.data.byteLength,B+=S}f&&(this.audio_last_sample_pts_=f)}},y.prototype.parseEAC3Payload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var S,w;if(n!=null&&(w=n/this.timescale_),this.audio_metadata_.codec==="ec-3"){if(n==null&&this.audio_last_sample_pts_!=null)S=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,w=this.audio_last_sample_pts_+S;else if(n==null)return void k.a.w(this.TAG,"EAC3: Unknown pts")}for(var f,D=new we(s),G=null,B=w;(G=D.readNextEAC3Frame())!=null;){S=1536/G.sampling_frequency*1e3;var X={codec:"ec-3",data:G};(this.audio_init_segment_dispatched_==0||this.detectAudioMetadataChange(X))&&(this.audio_metadata_={codec:"ec-3",sampling_frequency:G.sampling_frequency,bit_stream_identification:G.bit_stream_identification,low_frequency_effects_channel_on:G.low_frequency_effects_channel_on,num_blks:G.num_blks,channel_mode:G.channel_mode},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(X)),f=B;var J=Math.floor(B),Q={unit:G.data,length:G.data.byteLength,pts:J,dts:J};this.audio_track_.samples.push(Q),this.audio_track_.length+=G.data.byteLength,B+=S}f&&(this.audio_last_sample_pts_=f)}},y.prototype.parseOpusPayload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var S,w;if(n!=null&&(w=n/this.timescale_),this.audio_metadata_.codec==="opus"){if(n==null&&this.audio_last_sample_pts_!=null)S=20,w=this.audio_last_sample_pts_+S;else if(n==null)return void k.a.w(this.TAG,"Opus: Unknown pts")}for(var f,D=w,G=0;G<s.length;){S=20;for(var B=(16&s[G+1])!=0,X=(8&s[G+1])!=0,J=G+2,Q=0;s[J]===255;)Q+=255,J+=1;Q+=s[J],J+=1,J+=B?2:0,J+=X?2:0,f=D;var $=Math.floor(D),de=s.slice(J,J+Q),ue={unit:de,length:de.byteLength,pts:$,dts:$};this.audio_track_.samples.push(ue),this.audio_track_.length+=de.byteLength,D+=S,G=J+Q}f&&(this.audio_last_sample_pts_=f)}},y.prototype.parseMP3Payload=function(s,n){if(!this.has_video_||this.video_init_segment_dispatched_){var S=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],w=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],f=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],D=s[1]>>>3&3,G=(6&s[1])>>1,B=(240&s[2])>>>4,X=(12&s[2])>>>2,J=(s[3]>>>6&3)!==3?2:1,Q=0,$=34;switch(D){case 0:Q=[11025,12e3,8e3,0][X];break;case 2:Q=[22050,24e3,16e3,0][X];break;case 3:Q=[44100,48e3,32e3,0][X]}switch(G){case 1:$=34,B<f.length&&f[B];break;case 2:$=33,B<w.length&&w[B];break;case 3:$=32,B<S.length&&S[B]}var de=new _e;de.object_type=$,de.sample_rate=Q,de.channel_count=J,de.data=s;var ue={codec:"mp3",data:de};this.audio_init_segment_dispatched_==0&&(this.audio_metadata_={codec:"mp3",object_type:$,sample_rate:Q,channel_count:J},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(ue));var Ae={unit:s,length:s.byteLength,pts:n/this.timescale_,dts:n/this.timescale_};this.audio_track_.samples.push(Ae),this.audio_track_.length+=s.byteLength}},y.prototype.detectAudioMetadataChange=function(s){if(s.codec!==this.audio_metadata_.codec)return k.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(s.codec)),!0;if(s.codec==="aac"&&this.audio_metadata_.codec==="aac"){if((n=s.data).audio_object_type!==this.audio_metadata_.audio_object_type)return k.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(n.audio_object_type)),!0;if(n.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return k.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(n.sampling_freq_index)),!0;if(n.channel_config!==this.audio_metadata_.channel_config)return k.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(n.channel_config)),!0}else if(s.codec==="ac-3"&&this.audio_metadata_.codec==="ac-3"){var n;if((n=s.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return k.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat(n.sampling_frequency)),!0;if(n.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return k.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat(n.bit_stream_identification)),!0;if(n.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return k.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat(n.bit_stream_mode)),!0;if(n.channel_mode!==this.audio_metadata_.channel_mode)return k.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat(n.channel_mode)),!0;if(n.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return k.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat(n.low_frequency_effects_channel_on)),!0}else if(s.codec==="opus"&&this.audio_metadata_.codec==="opus"){if((S=s.meta).sample_rate!==this.audio_metadata_.sample_rate)return k.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(S.sample_rate)),!0;if(S.channel_count!==this.audio_metadata_.channel_count)return k.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(S.channel_count)),!0}else if(s.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var S;if((S=s.data).object_type!==this.audio_metadata_.object_type)return k.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(S.object_type)),!0;if(S.sample_rate!==this.audio_metadata_.sample_rate)return k.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(S.sample_rate)),!0;if(S.channel_count!==this.audio_metadata_.channel_count)return k.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(S.channel_count)),!0}return!1},y.prototype.dispatchAudioInitSegment=function(s){var n={type:"audio"};if(n.id=this.audio_track_.id,n.timescale=1e3,n.duration=this.duration_,this.audio_metadata_.codec==="aac"){var S=s.codec==="aac"?s.data:null,w=new W(S);n.audioSampleRate=w.sampling_rate,n.channelCount=w.channel_count,n.codec=w.codec_mimetype,n.originalCodec=w.original_codec_mimetype,n.config=w.config,n.refSampleDuration=1024/n.audioSampleRate*n.timescale}else if(this.audio_metadata_.codec==="ac-3"){var f=s.codec==="ac-3"?s.data:null,D=new ve(f);n.audioSampleRate=D.sampling_rate,n.channelCount=D.channel_count,n.codec=D.codec_mimetype,n.originalCodec=D.original_codec_mimetype,n.config=D.config,n.refSampleDuration=1536/n.audioSampleRate*n.timescale}else if(this.audio_metadata_.codec==="ec-3"){var G=s.codec==="ec-3"?s.data:null,B=new Ie(G);n.audioSampleRate=B.sampling_rate,n.channelCount=B.channel_count,n.codec=B.codec_mimetype,n.originalCodec=B.original_codec_mimetype,n.config=B.config,n.refSampleDuration=256*B.num_blks/n.audioSampleRate*n.timescale}else this.audio_metadata_.codec==="opus"?(n.audioSampleRate=this.audio_metadata_.sample_rate,n.channelCount=this.audio_metadata_.channel_count,n.channelConfigCode=this.audio_metadata_.channel_config_code,n.codec="opus",n.originalCodec="opus",n.config=void 0,n.refSampleDuration=20):this.audio_metadata_.codec==="mp3"&&(n.audioSampleRate=this.audio_metadata_.sample_rate,n.channelCount=this.audio_metadata_.channel_count,n.codec="mp3",n.originalCodec="mp3",n.config=void 0);this.audio_init_segment_dispatched_==0&&k.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(n.codec)),this.onTrackMetadata("audio",n),this.audio_init_segment_dispatched_=!0;var X=this.media_info_;X.hasAudio=!0,X.audioCodec=n.originalCodec,X.audioSampleRate=n.audioSampleRate,X.audioChannelCount=n.channelCount,X.hasVideo&&X.videoCodec?X.mimeType='video/mp2t; codecs="'.concat(X.videoCodec,",").concat(X.audioCodec,'"'):X.mimeType='video/mp2t; codecs="'.concat(X.audioCodec,'"'),X.isComplete()&&this.onMediaInfo(X)},y.prototype.dispatchPESPrivateDataDescriptor=function(s,n,S){var w=new se;w.pid=s,w.stream_type=n,w.descriptor=S,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(w)},y.prototype.parsePESPrivateDataPayload=function(s,n,S,w,f){var D=new he;if(D.pid=w,D.stream_id=f,D.len=s.byteLength,D.data=s,n!=null){var G=Math.floor(n/this.timescale_);D.pts=G}else D.nearest_pts=this.getNearestTimestampMilliseconds();if(S!=null){var B=Math.floor(S/this.timescale_);D.dts=B}this.onPESPrivateData&&this.onPESPrivateData(D)},y.prototype.parseTimedID3MetadataPayload=function(s,n,S,w,f){var D=new he;if(D.pid=w,D.stream_id=f,D.len=s.byteLength,D.data=s,n!=null){var G=Math.floor(n/this.timescale_);D.pts=G}if(S!=null){var B=Math.floor(S/this.timescale_);D.dts=B}this.onTimedID3Metadata&&this.onTimedID3Metadata(D)},y.prototype.parseSynchronousKLVMetadataPayload=function(s,n,S,w,f){var D=new De;if(D.pid=w,D.stream_id=f,D.len=s.byteLength,D.data=s,n!=null){var G=Math.floor(n/this.timescale_);D.pts=G}if(S!=null){var B=Math.floor(S/this.timescale_);D.dts=B}D.access_units=function(X){for(var J=[],Q=0;Q+5<X.byteLength;){var $=X[Q+0],de=X[Q+1],ue=X[Q+2],Ae=X[Q+3]<<8|X[Q+4]<<0,Te=X.slice(Q+5,Q+5+Ae);J.push({service_id:$,sequence_number:de,flags:ue,data:Te}),Q+=5+Ae}return J}(s),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(D)},y.prototype.parseAsynchronousKLVMetadataPayload=function(s,n,S){var w=new he;w.pid=n,w.stream_id=S,w.len=s.byteLength,w.data=s,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(w)},y.prototype.parseSMPTE2038MetadataPayload=function(s,n,S,w,f){var D=new me;if(D.pid=w,D.stream_id=f,D.len=s.byteLength,D.data=s,n!=null){var G=Math.floor(n/this.timescale_);D.pts=G}if(D.nearest_pts=this.getNearestTimestampMilliseconds(),S!=null){var B=Math.floor(S/this.timescale_);D.dts=B}D.ancillaries=function(X){for(var J=new U.a(X),Q=0,$=[];Q+=6,J.readBits(6)===0;){var de=J.readBool();Q+=1;var ue=J.readBits(11);Q+=11;var Ae=J.readBits(12);Q+=12;var Te=255&J.readBits(10);Q+=10;var be=255&J.readBits(10);Q+=10;var ge=255&J.readBits(10);Q+=10;for(var Oe=new Uint8Array(ge),Pe=0;Pe<ge;Pe++){var Ce=255&J.readBits(10);Q+=10,Oe[Pe]=Ce}J.readBits(10),Q+=10;var Be="User Defined";Te===65?be===7&&(Be="SCTE-104"):Te===95?be===220?Be="ARIB STD-B37 (1SEG)":be===221?Be="ARIB STD-B37 (ANALOG)":be===222?Be="ARIB STD-B37 (SD)":be===223&&(Be="ARIB STD-B37 (HD)"):Te===97&&(be===1?Be="EIA-708":be===2&&(Be="EIA-608")),$.push({yc_indicator:de,line_number:ue,horizontal_offset:Ae,did:Te,sdid:be,user_data:Oe,description:Be,information:{}}),J.readBits(8-(Q-Math.floor(Q/8))%8),Q+=(8-(Q-Math.floor(Q/8)))%8}return J.destroy(),J=null,$}(s),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(D)},y.prototype.getNearestTimestampMilliseconds=function(){return this.audio_last_sample_pts_!=null?Math.floor(this.audio_last_sample_pts_):this.last_pcr_!=null?Math.floor(this.last_pcr_/300/this.timescale_):void 0},y.prototype.getPcrBase=function(s){var n=33554432*s[6]+131072*s[7]+512*s[8]+2*s[9]+(128&s[10])/128+this.timestamp_offset_;return n+4294967296<this.last_pcr_base_&&(n+=8589934592,this.timestamp_offset_+=8589934592),this.last_pcr_base_=n,n},y.prototype.getTimestamp=function(s,n){var S=536870912*(14&s[n])+4194304*(255&s[n+1])+16384*(254&s[n+2])+128*(255&s[n+3])+(254&s[n+4])/2+this.timestamp_offset_;return S+4294967296<this.last_pcr_base_&&(S+=8589934592),S},y}(g);oe.a=xe},function(pe,oe,x){var V=x(8),k=function(){function T(){}return T._ebsp2rbsp=function(u){for(var g=u,i=g.byteLength,h=new Uint8Array(i),p=0,A=0;A<i;A++)A>=2&&g[A]===3&&g[A-1]===0&&g[A-2]===0||(h[p]=g[A],p++);return new Uint8Array(h.buffer,0,p)},T.parseVPS=function(u){var g=T._ebsp2rbsp(u),i=new V.a(g);return i.readByte(),i.readByte(),i.readBits(4),i.readBits(2),i.readBits(6),{num_temporal_layers:i.readBits(3)+1,temporal_id_nested:i.readBool()}},T.parseSPS=function(u){var g=T._ebsp2rbsp(u),i=new V.a(g);i.readByte(),i.readByte();for(var h=0,p=0,A=0,E=0,O=(i.readBits(4),i.readBits(3)),F=(i.readBool(),i.readBits(2)),P=i.readBool(),j=i.readBits(5),H=i.readByte(),C=i.readByte(),Z=i.readByte(),ie=i.readByte(),U=i.readByte(),c=i.readByte(),d=i.readByte(),_=i.readByte(),m=i.readByte(),q=i.readByte(),te=i.readByte(),ne=[],Y=[],W=0;W<O;W++)ne.push(i.readBool()),Y.push(i.readBool());if(O>0)for(W=O;W<8;W++)i.readBits(2);for(W=0;W<O;W++)ne[W]&&(i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte()),Y[W]&&i.readByte();i.readUEG();var he=i.readUEG();he==3&&i.readBits(1);var se=i.readUEG(),R=i.readUEG();i.readBool()&&(h+=i.readUEG(),p+=i.readUEG(),A+=i.readUEG(),E+=i.readUEG());var e=i.readUEG(),t=i.readUEG(),a=i.readUEG();for(W=i.readBool()?0:O;W<=O;W++)i.readUEG(),i.readUEG(),i.readUEG();if(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readBool()&&i.readBool())for(var o=0;o<4;o++)for(var r=0;r<(o===3?2:6);r++)if(i.readBool()){var v=Math.min(64,1<<4+(o<<1));for(o>1&&i.readSEG(),W=0;W<v;W++)i.readSEG()}else i.readUEG();i.readBool(),i.readBool(),i.readBool()&&(i.readByte(),i.readUEG(),i.readUEG(),i.readBool());var L=i.readUEG(),b=0;for(W=0;W<L;W++){var M=!1;if(W!==0&&(M=i.readBool()),M){W===L&&i.readUEG(),i.readBool(),i.readUEG();for(var N=0,I=0;I<=b;I++){var z=i.readBool(),K=!1;z||(K=i.readBool()),(z||K)&&N++}b=N}else{var ae=i.readUEG(),re=i.readUEG();for(b=ae+re,I=0;I<ae;I++)i.readUEG(),i.readBool();for(I=0;I<re;I++)i.readUEG(),i.readBool()}}if(i.readBool()){var le=i.readUEG();for(W=0;W<le;W++){for(I=0;I<a+4;I++)i.readBits(1);i.readBits(1)}}var ee=0,fe=1,me=1,_e=!1,ye=1,ke=1,ce=(i.readBool(),i.readBool(),2),ve=2,Se=2;if(i.readBool()){if(i.readBool()){var we=i.readByte();we>0&&we<=16?(fe=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][we-1],me=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][we-1]):we===255&&(fe=i.readBits(16),me=i.readBits(16))}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(3),i.readBool(),i.readBool()&&(ce=i.readByte(),ve=i.readByte(),Se=i.readByte())),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool(),i.readBool(),i.readBool(),i.readBool()&&(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG()),i.readBool()&&(ye=i.readBits(32),ke=i.readBits(32),i.readBool()&&i.readUEG(),i.readBool())){var Ie=!1,De=!1,Ue=!1;for(Ie=i.readBool(),De=i.readBool(),(Ie||De)&&((Ue=i.readBool())&&(i.readByte(),i.readBits(5),i.readBool(),i.readBits(5)),i.readBits(4),i.readBits(4),Ue&&i.readBits(4),i.readBits(5),i.readBits(5),i.readBits(5)),W=0;W<=O;W++){var Ve=i.readBool();_e=Ve;var Me=!0,Re=1;Ve||(Me=i.readBool());var xe=!1;if(Me?i.readUEG():xe=i.readBool(),xe||(Re=i.readUEG()+1),Ie){for(I=0;I<Re;I++)i.readUEG(),i.readUEG(),Ue&&(i.readUEG(),i.readUEG());i.readBool()}if(De){for(I=0;I<Re;I++)i.readUEG(),i.readUEG(),Ue&&(i.readUEG(),i.readUEG());i.readBool()}}}i.readBool()&&(i.readBool(),i.readBool(),i.readBool(),ee=i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG())}i.readBool();var l="hvc1.".concat(j,".1.L").concat(te,".B0"),y=se-(h+p)*(he===1||he===2?2:1),s=R-(A+E)*(he===1?2:1),n=1;return fe!==1&&me!==1&&(n=fe/me),i.destroy(),i=null,{codec_mimetype:l,profile_string:T.getProfileString(j),level_string:T.getLevelString(te),profile_idc:j,bit_depth:e+8,ref_frames:1,chroma_format:he,chroma_format_string:T.getChromaFormatString(he),general_level_idc:te,general_profile_space:F,general_tier_flag:P,general_profile_idc:j,general_profile_compatibility_flags_1:H,general_profile_compatibility_flags_2:C,general_profile_compatibility_flags_3:Z,general_profile_compatibility_flags_4:ie,general_constraint_indicator_flags_1:U,general_constraint_indicator_flags_2:c,general_constraint_indicator_flags_3:d,general_constraint_indicator_flags_4:_,general_constraint_indicator_flags_5:m,general_constraint_indicator_flags_6:q,min_spatial_segmentation_idc:ee,constant_frame_rate:0,chroma_format_idc:he,bit_depth_luma_minus8:e,bit_depth_chroma_minus8:t,colour_primaries:ce,transfer_characteristics:ve,matrix_coeffs:Se,frame_rate:{fixed:_e,fps:ke/ye,fps_den:ye,fps_num:ke},sar_ratio:{width:fe,height:me},codec_size:{width:y,height:s},present_size:{width:y*n,height:s}}},T.parsePPS=function(u){var g=T._ebsp2rbsp(u),i=new V.a(g);i.readByte(),i.readByte(),i.readUEG(),i.readUEG(),i.readBool(),i.readBool(),i.readBits(3),i.readBool(),i.readBool(),i.readUEG(),i.readUEG(),i.readSEG(),i.readBool(),i.readBool(),i.readBool()&&i.readUEG(),i.readSEG(),i.readSEG(),i.readBool(),i.readBool(),i.readBool(),i.readBool();var h=i.readBool(),p=i.readBool(),A=1;return p&&h?A=0:p?A=3:h&&(A=2),{parallelismType:A}},T.getChromaFormatString=function(u){switch(u){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},T.getProfileString=function(u){switch(u){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},T.getLevelString=function(u){return(u/30).toFixed(1)},T}();oe.a=k},function(pe,oe,x){var V=x(8),k=function(){return(k=Object.assign||function(u){for(var g,i=1,h=arguments.length;i<h;i++)for(var p in g=arguments[i])Object.prototype.hasOwnProperty.call(g,p)&&(u[p]=g[p]);return u}).apply(this,arguments)},T=function(){function u(){}return u.parseOBUs=function(g,i){for(var h=0;h<g.byteLength;){var p=h,A=(g[h],(120&g[h])>>3),E=(4&g[h])!=0,O=(2&g[h])!=0;g[h],h+=1,E&&(h+=1);var F=Number.POSITIVE_INFINITY;if(O){F=0;for(var P=0;;P++){var j=g[h++];if(F|=(127&j)<<7*P,(128&j)==0)break}}console.log(A),A===1?i=k(k({},u.parseSeuqneceHeader(g.subarray(h,h+F))),{sequence_header_data:g.subarray(p,h+F)}):(A==3&&i||A==6&&i)&&(i=u.parseOBUFrameHeader(g.subarray(h,h+F),0,0,i)),h+=F}return i},u.parseSeuqneceHeader=function(g){var i=new V.a(g),h=i.readBits(3),p=(i.readBool(),i.readBool()),A=!0,E=0,O=1,F=void 0,P=[];if(p)P.push({operating_point_idc:0,level:i.readBits(5),tier:0});else{if(i.readBool()){var j=i.readBits(32),H=i.readBits(32),C=i.readBool();if(C){for(var Z=0;i.readBits(1)===0;)Z+=1;Z>=32||(1<<Z)-1+i.readBits(Z)}(E=H)/(O=j),A=C,i.readBool()&&(i.readBits(5),i.readBits(32),F=i.readBits(5),i.readBits(5))}for(var ie=i.readBool(),U=i.readBits(5),c=0;c<=U;c++){var d=i.readBits(12),_=i.readBits(5),m=_>7?i.readBits(1):0;P.push({operating_point_idc:d,level:_,tier:m}),ie&&i.readBool()&&i.readBits(4)}}var q=P[0],te=q.level,ne=q.tier,Y=i.readBits(4),W=i.readBits(4),he=i.readBits(Y+1)+1,se=i.readBits(W+1)+1,R=!1;p||(R=i.readBool()),R&&(i.readBits(4),i.readBits(4)),i.readBool(),i.readBool(),i.readBool();var e=!1,t=2,a=2,o=0;p||(i.readBool(),i.readBool(),i.readBool(),i.readBool(),(e=i.readBool())&&(i.readBool(),i.readBool()),(t=i.readBool()?2:i.readBits(1))?a=i.readBool()?2:i.readBits(1):a=2,e?o=i.readBits(3)+1:o=0);var r=i.readBool(),v=(i.readBool(),i.readBool(),i.readBool()),L=8;h===2&&v?L=i.readBool()?12:10:L=v?10:8;var b=!1;h!==1&&(b=i.readBool()),i.readBool()&&(i.readBits(8),i.readBits(8),i.readBits(8));var M=1,N=1;return b?(i.readBits(1),M=1,N=1):(i.readBits(1),h==0?(M=1,N=1):h==1?(M=0,N=0):L==12?i.readBits(1)&&i.readBits(1):(M=1,N=0),M&&N&&i.readBits(2),i.readBits(1)),i.readBool(),i.destroy(),i=null,{codec_mimetype:"av01.".concat(h,".").concat(u.getLevelString(te,ne),".").concat(L.toString(10).padStart(2,"0")),level:te,tier:ne,level_string:u.getLevelString(te,ne),profile_idc:h,profile_string:"".concat(h),bit_depth:L,ref_frames:1,chroma_format:u.getChromaFormat(b,M,N),chroma_format_string:u.getChromaFormatString(b,M,N),sequence_header:{frame_id_numbers_present_flag:R,additional_frame_id_length_minus_1:void 0,delta_frame_id_length_minus_2:void 0,reduced_still_picture_header:p,decoder_model_info_present_flag:!1,operating_points:P,buffer_removal_time_length_minus_1:F,equal_picture_interval:A,seq_force_screen_content_tools:t,seq_force_integer_mv:a,enable_order_hint:e,order_hint_bits:o,enable_superres:r,frame_width_bit:Y+1,frame_height_bit:W+1,max_frame_width:he,max_frame_height:se},keyframe:void 0,frame_rate:{fixed:A,fps:E/O,fps_den:O,fps_num:E}}},u.parseOBUFrameHeader=function(g,i,h,p){var A=p.sequence_header,E=new V.a(g),O=(A.max_frame_width,A.max_frame_height,0);A.frame_id_numbers_present_flag&&(O=A.additional_frame_id_length_minus_1+A.delta_frame_id_length_minus_2+3);var F=0,P=!0,j=!0,H=!1;if(!A.reduced_still_picture_header){if(E.readBool())return p;P=(F=E.readBits(2))===2||F===0,(j=E.readBool())&&A.decoder_model_info_present_flag&&A.equal_picture_interval,j&&E.readBool(),H=!!(F===3||F===0&&j)||E.readBool()}p.keyframe=P,E.readBool();var C=A.seq_force_screen_content_tools;A.seq_force_screen_content_tools===2&&(C=E.readBits(1)),C&&(A.seq_force_integer_mv,A.seq_force_integer_mv==2&&E.readBits(1)),A.frame_id_numbers_present_flag&&E.readBits(O);var Z=!1;if(Z=F==3||!A.reduced_still_picture_header&&E.readBool(),E.readBits(A.order_hint_bits),P||H||E.readBits(3),A.decoder_model_info_present_flag&&E.readBool()){for(var ie=0;ie<=A.operating_points_cnt_minus_1;ie++)if(A.operating_points[ie].decoder_model_present_for_this_op[ie]){var U=A.operating_points[ie].operating_point_idc;(U===0||U>>i&1&&U>>h+8&1)&&E.readBits(A.buffer_removal_time_length_minus_1+1)}}var c=255;if(F===3||F==0&&j||(c=E.readBits(8)),(P||c!==255)&&H&&A.enable_order_hint)for(var d=0;d<8;d++)E.readBits(A.order_hint_bits);if(P){var _=u.frameSizeAndRenderSize(E,Z,A);p.codec_size={width:_.FrameWidth,height:_.FrameHeight},p.present_size={width:_.RenderWidth,height:_.RenderHeight},p.sar_ratio={width:_.RenderWidth/_.FrameWidth,height:_.RenderHeight/_.FrameHeight}}return E.destroy(),E=null,p},u.frameSizeAndRenderSize=function(g,i,h){var p=h.max_frame_width,A=h.max_frame_height;i&&(p=g.readBits(h.frame_width_bit)+1,A=g.readBits(h.frame_height_bit)+1);var E=!1;h.enable_superres&&(E=g.readBool());var O=8;E&&(O=g.readBits(3)+9);var F=p;p=Math.floor((8*F+O/2)/O);var P=F,j=A;if(g.readBool()){var H=g.readBits(16)+1,C=g.readBits(16)+1;P=g.readBits(H)+1,j=g.readBits(C)+1}return{UpscaledWidth:F,FrameWidth:p,FrameHeight:A,RenderWidth:P,RenderHeight:j}},u.getLevelString=function(g,i){return"".concat(g.toString(10).padStart(2,"0")).concat(i===0?"M":"H")},u.getChromaFormat=function(g,i,h){return g?0:i===0&&h===0?3:i===1&&h===0?2:i===1&&h===1?1:Number.NaN},u.getChromaFormatString=function(g,i,h){return g?"4:0:0":i===0&&h===0?"4:4:4":i===1&&h===0?"4:2:2":i===1&&h===1?"4:2:0":"Unknown"},u}();oe.a=T},function(pe,oe,x){var V,k=x(0),T=function(){function U(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return U.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},U.prototype.addBytes=function(c){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=c,this._totalBytes+=c):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=c,this._totalBytes+=c):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=c,this._totalBytes+=c,this._lastCheckpoint=this._now())},Object.defineProperty(U.prototype,"currentKBps",{get:function(){this.addBytes(0);var c=(this._now()-this._lastCheckpoint)/1e3;return c==0&&(c=1),this._intervalBytes/c/1024},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"averageKBps",{get:function(){var c=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/c/1024},enumerable:!1,configurable:!0}),U}(),u=x(2),g=x(5),i=x(3),h=(V=function(U,c){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,_){d.__proto__=_}||function(d,_){for(var m in _)Object.prototype.hasOwnProperty.call(_,m)&&(d[m]=_[m])})(U,c)},function(U,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function d(){this.constructor=U}V(U,c),U.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}),p=function(U){function c(d,_){var m=U.call(this,"fetch-stream-loader")||this;return m.TAG="FetchStreamLoader",m._seekHandler=d,m._config=_,m._needStash=!0,m._requestAbort=!1,m._abortController=null,m._contentLength=null,m._receivedLength=0,m}return h(c,U),c.isSupported=function(){try{var d=g.a.msedge&&g.a.version.minor>=15048,_=!g.a.msedge||d;return self.fetch&&self.ReadableStream&&_}catch{return!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),U.prototype.destroy.call(this)},c.prototype.open=function(d,_){var m=this;this._dataSource=d,this._range=_;var q=d.url;this._config.reuseRedirectedURL&&d.redirectedURL!=null&&(q=d.redirectedURL);var te=this._seekHandler.getConfig(q,_),ne=new self.Headers;if(typeof te.headers=="object"){var Y=te.headers;for(var W in Y)Y.hasOwnProperty(W)&&ne.append(W,Y[W])}var he={method:"GET",headers:ne,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var W in this._config.headers)ne.append(W,this._config.headers[W]);d.cors===!1&&(he.mode="same-origin"),d.withCredentials&&(he.credentials="include"),d.referrerPolicy&&(he.referrerPolicy=d.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,he.signal=this._abortController.signal),this._status=u.c.kConnecting,self.fetch(te.url,he).then(function(se){if(m._requestAbort)return m._status=u.c.kIdle,void se.body.cancel();if(se.ok&&se.status>=200&&se.status<=299){if(se.url!==te.url&&m._onURLRedirect){var R=m._seekHandler.removeURLParameters(se.url);m._onURLRedirect(R)}var e=se.headers.get("Content-Length");return e!=null&&(m._contentLength=parseInt(e),m._contentLength!==0&&m._onContentLengthKnown&&m._onContentLengthKnown(m._contentLength)),m._pump.call(m,se.body.getReader())}if(m._status=u.c.kError,!m._onError)throw new i.d("FetchStreamLoader: Http code invalid, "+se.status+" "+se.statusText);m._onError(u.b.HTTP_STATUS_CODE_INVALID,{code:se.status,msg:se.statusText})}).catch(function(se){if(!m._abortController||!m._abortController.signal.aborted){if(m._status=u.c.kError,!m._onError)throw se;m._onError(u.b.EXCEPTION,{code:-1,msg:se.message})}})},c.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==u.c.kBuffering||!g.a.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},c.prototype._pump=function(d){var _=this;return d.read().then(function(m){if(m.done)if(_._contentLength!==null&&_._receivedLength<_._contentLength){_._status=u.c.kError;var q=u.b.EARLY_EOF,te={code:-1,msg:"Fetch stream meet Early-EOF"};if(!_._onError)throw new i.d(te.msg);_._onError(q,te)}else _._status=u.c.kComplete,_._onComplete&&_._onComplete(_._range.from,_._range.from+_._receivedLength-1);else{if(_._abortController&&_._abortController.signal.aborted)return void(_._status=u.c.kComplete);if(_._requestAbort===!0)return _._status=u.c.kComplete,d.cancel();_._status=u.c.kBuffering;var ne=m.value.buffer,Y=_._range.from+_._receivedLength;_._receivedLength+=ne.byteLength,_._onDataArrival&&_._onDataArrival(ne,Y,_._receivedLength),_._pump(d)}}).catch(function(m){if(_._abortController&&_._abortController.signal.aborted)_._status=u.c.kComplete;else if(m.code!==11||!g.a.msedge){_._status=u.c.kError;var q=0,te=null;if(m.code!==19&&m.message!=="network error"||!(_._contentLength===null||_._contentLength!==null&&_._receivedLength<_._contentLength)?(q=u.b.EXCEPTION,te={code:m.code,msg:m.message}):(q=u.b.EARLY_EOF,te={code:m.code,msg:"Fetch stream meet Early-EOF"}),!_._onError)throw new i.d(te.msg);_._onError(q,te)}})},c}(u.a),A=function(){var U=function(c,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var q in m)Object.prototype.hasOwnProperty.call(m,q)&&(_[q]=m[q])})(c,d)};return function(c,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function _(){this.constructor=c}U(c,d),c.prototype=d===null?Object.create(d):(_.prototype=d.prototype,new _)}}(),E=function(U){function c(d,_){var m=U.call(this,"xhr-moz-chunked-loader")||this;return m.TAG="MozChunkedLoader",m._seekHandler=d,m._config=_,m._needStash=!0,m._xhr=null,m._requestAbort=!1,m._contentLength=null,m._receivedLength=0,m}return A(c,U),c.isSupported=function(){try{var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="moz-chunked-arraybuffer",d.responseType==="moz-chunked-arraybuffer"}catch(_){return k.a.w("MozChunkedLoader",_.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),U.prototype.destroy.call(this)},c.prototype.open=function(d,_){this._dataSource=d,this._range=_;var m=d.url;this._config.reuseRedirectedURL&&d.redirectedURL!=null&&(m=d.redirectedURL);var q=this._seekHandler.getConfig(m,_);this._requestURL=q.url;var te=this._xhr=new XMLHttpRequest;if(te.open("GET",q.url,!0),te.responseType="moz-chunked-arraybuffer",te.onreadystatechange=this._onReadyStateChange.bind(this),te.onprogress=this._onProgress.bind(this),te.onloadend=this._onLoadEnd.bind(this),te.onerror=this._onXhrError.bind(this),d.withCredentials&&(te.withCredentials=!0),typeof q.headers=="object"){var ne=q.headers;for(var Y in ne)ne.hasOwnProperty(Y)&&te.setRequestHeader(Y,ne[Y])}if(typeof this._config.headers=="object"){ne=this._config.headers;for(var Y in ne)ne.hasOwnProperty(Y)&&te.setRequestHeader(Y,ne[Y])}this._status=u.c.kConnecting,te.send()},c.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=u.c.kComplete},c.prototype._onReadyStateChange=function(d){var _=d.target;if(_.readyState===2){if(_.responseURL!=null&&_.responseURL!==this._requestURL&&this._onURLRedirect){var m=this._seekHandler.removeURLParameters(_.responseURL);this._onURLRedirect(m)}if(_.status!==0&&(_.status<200||_.status>299)){if(this._status=u.c.kError,!this._onError)throw new i.d("MozChunkedLoader: Http code invalid, "+_.status+" "+_.statusText);this._onError(u.b.HTTP_STATUS_CODE_INVALID,{code:_.status,msg:_.statusText})}else this._status=u.c.kBuffering}},c.prototype._onProgress=function(d){if(this._status!==u.c.kError){this._contentLength===null&&d.total!==null&&d.total!==0&&(this._contentLength=d.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var _=d.target.response,m=this._range.from+this._receivedLength;this._receivedLength+=_.byteLength,this._onDataArrival&&this._onDataArrival(_,m,this._receivedLength)}},c.prototype._onLoadEnd=function(d){this._requestAbort!==!0?this._status!==u.c.kError&&(this._status=u.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},c.prototype._onXhrError=function(d){this._status=u.c.kError;var _=0,m=null;if(this._contentLength&&d.loaded<this._contentLength?(_=u.b.EARLY_EOF,m={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(_=u.b.EXCEPTION,m={code:-1,msg:d.constructor.name+" "+d.type}),!this._onError)throw new i.d(m.msg);this._onError(_,m)},c}(u.a),O=function(){var U=function(c,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var q in m)Object.prototype.hasOwnProperty.call(m,q)&&(_[q]=m[q])})(c,d)};return function(c,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function _(){this.constructor=c}U(c,d),c.prototype=d===null?Object.create(d):(_.prototype=d.prototype,new _)}}(),F=(function(U){function c(d,_){var m=U.call(this,"xhr-msstream-loader")||this;return m.TAG="MSStreamLoader",m._seekHandler=d,m._config=_,m._needStash=!0,m._xhr=null,m._reader=null,m._totalRange=null,m._currentRange=null,m._currentRequestURL=null,m._currentRedirectedURL=null,m._contentLength=null,m._receivedLength=0,m._bufferLimit=16777216,m._lastTimeBufferSize=0,m._isReconnecting=!1,m}O(c,U),c.isSupported=function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="ms-stream",d.responseType==="ms-stream"}catch(_){return k.a.w("MSStreamLoader",_.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),U.prototype.destroy.call(this)},c.prototype.open=function(d,_){this._internalOpen(d,_,!1)},c.prototype._internalOpen=function(d,_,m){this._dataSource=d,m?this._currentRange=_:this._totalRange=_;var q=d.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?q=this._currentRedirectedURL:d.redirectedURL!=null&&(q=d.redirectedURL));var te=this._seekHandler.getConfig(q,_);this._currentRequestURL=te.url;var ne=this._reader=new self.MSStreamReader;ne.onprogress=this._msrOnProgress.bind(this),ne.onload=this._msrOnLoad.bind(this),ne.onerror=this._msrOnError.bind(this);var Y=this._xhr=new XMLHttpRequest;if(Y.open("GET",te.url,!0),Y.responseType="ms-stream",Y.onreadystatechange=this._xhrOnReadyStateChange.bind(this),Y.onerror=this._xhrOnError.bind(this),d.withCredentials&&(Y.withCredentials=!0),typeof te.headers=="object"){var W=te.headers;for(var he in W)W.hasOwnProperty(he)&&Y.setRequestHeader(he,W[he])}if(typeof this._config.headers=="object"){W=this._config.headers;for(var he in W)W.hasOwnProperty(he)&&Y.setRequestHeader(he,W[he])}this._isReconnecting?this._isReconnecting=!1:this._status=u.c.kConnecting,Y.send()},c.prototype.abort=function(){this._internalAbort(),this._status=u.c.kComplete},c.prototype._internalAbort=function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},c.prototype._xhrOnReadyStateChange=function(d){var _=d.target;if(_.readyState===2)if(_.status>=200&&_.status<=299){if(this._status=u.c.kBuffering,_.responseURL!=null){var m=this._seekHandler.removeURLParameters(_.responseURL);_.responseURL!==this._currentRequestURL&&m!==this._currentRedirectedURL&&(this._currentRedirectedURL=m,this._onURLRedirect&&this._onURLRedirect(m))}var q=_.getResponseHeader("Content-Length");if(q!=null&&this._contentLength==null){var te=parseInt(q);te>0&&(this._contentLength=te,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=u.c.kError,!this._onError)throw new i.d("MSStreamLoader: Http code invalid, "+_.status+" "+_.statusText);this._onError(u.b.HTTP_STATUS_CODE_INVALID,{code:_.status,msg:_.statusText})}else if(_.readyState===3&&_.status>=200&&_.status<=299){this._status=u.c.kBuffering;var ne=_.response;this._reader.readAsArrayBuffer(ne)}},c.prototype._xhrOnError=function(d){this._status=u.c.kError;var _=u.b.EXCEPTION,m={code:-1,msg:d.constructor.name+" "+d.type};if(!this._onError)throw new i.d(m.msg);this._onError(_,m)},c.prototype._msrOnProgress=function(d){var _=d.target.result;if(_!=null){var m=_.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=_.byteLength;var q=this._totalRange.from+this._receivedLength;this._receivedLength+=m.byteLength,this._onDataArrival&&this._onDataArrival(m,q,this._receivedLength),_.byteLength>=this._bufferLimit&&(k.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(q+m.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},c.prototype._doReconnectIfNeeded=function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var d={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,d,!0)}},c.prototype._msrOnLoad=function(d){this._status=u.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},c.prototype._msrOnError=function(d){this._status=u.c.kError;var _=0,m=null;if(this._contentLength&&this._receivedLength<this._contentLength?(_=u.b.EARLY_EOF,m={code:-1,msg:"MSStream meet Early-Eof"}):(_=u.b.EARLY_EOF,m={code:-1,msg:d.constructor.name+" "+d.type}),!this._onError)throw new i.d(m.msg);this._onError(_,m)}}(u.a),function(){var U=function(c,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var q in m)Object.prototype.hasOwnProperty.call(m,q)&&(_[q]=m[q])})(c,d)};return function(c,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function _(){this.constructor=c}U(c,d),c.prototype=d===null?Object.create(d):(_.prototype=d.prototype,new _)}}()),P=function(U){function c(d,_){var m=U.call(this,"xhr-range-loader")||this;return m.TAG="RangeLoader",m._seekHandler=d,m._config=_,m._needStash=!1,m._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],m._currentChunkSizeKB=384,m._currentSpeedNormalized=0,m._zeroSpeedChunkCount=0,m._xhr=null,m._speedSampler=new T,m._requestAbort=!1,m._waitForTotalLength=!1,m._totalLengthReceived=!1,m._currentRequestURL=null,m._currentRedirectedURL=null,m._currentRequestRange=null,m._totalLength=null,m._contentLength=null,m._receivedLength=0,m._lastTimeLoaded=0,m}return F(c,U),c.isSupported=function(){try{var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="arraybuffer",d.responseType==="arraybuffer"}catch(_){return k.a.w("RangeLoader",_.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),U.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),c.prototype.open=function(d,_){this._dataSource=d,this._range=_,this._status=u.c.kConnecting;var m=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(m=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||m?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},c.prototype._openSubRange=function(){var d=1024*this._currentChunkSizeKB,_=this._range.from+this._receivedLength,m=_+d;this._contentLength!=null&&m-this._range.from>=this._contentLength&&(m=this._range.from+this._contentLength-1),this._currentRequestRange={from:_,to:m},this._internalOpen(this._dataSource,this._currentRequestRange)},c.prototype._internalOpen=function(d,_){this._lastTimeLoaded=0;var m=d.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?m=this._currentRedirectedURL:d.redirectedURL!=null&&(m=d.redirectedURL));var q=this._seekHandler.getConfig(m,_);this._currentRequestURL=q.url;var te=this._xhr=new XMLHttpRequest;if(te.open("GET",q.url,!0),te.responseType="arraybuffer",te.onreadystatechange=this._onReadyStateChange.bind(this),te.onprogress=this._onProgress.bind(this),te.onload=this._onLoad.bind(this),te.onerror=this._onXhrError.bind(this),d.withCredentials&&(te.withCredentials=!0),typeof q.headers=="object"){var ne=q.headers;for(var Y in ne)ne.hasOwnProperty(Y)&&te.setRequestHeader(Y,ne[Y])}if(typeof this._config.headers=="object"){ne=this._config.headers;for(var Y in ne)ne.hasOwnProperty(Y)&&te.setRequestHeader(Y,ne[Y])}te.send()},c.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=u.c.kComplete},c.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},c.prototype._onReadyStateChange=function(d){var _=d.target;if(_.readyState===2){if(_.responseURL!=null){var m=this._seekHandler.removeURLParameters(_.responseURL);_.responseURL!==this._currentRequestURL&&m!==this._currentRedirectedURL&&(this._currentRedirectedURL=m,this._onURLRedirect&&this._onURLRedirect(m))}if(_.status>=200&&_.status<=299){if(this._waitForTotalLength)return;this._status=u.c.kBuffering}else{if(this._status=u.c.kError,!this._onError)throw new i.d("RangeLoader: Http code invalid, "+_.status+" "+_.statusText);this._onError(u.b.HTTP_STATUS_CODE_INVALID,{code:_.status,msg:_.statusText})}}},c.prototype._onProgress=function(d){if(this._status!==u.c.kError){if(this._contentLength===null){var _=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,_=!0;var m=d.total;this._internalAbort(),m!=null&m!==0&&(this._totalLength=m)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,_)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var q=d.loaded-this._lastTimeLoaded;this._lastTimeLoaded=d.loaded,this._speedSampler.addBytes(q)}},c.prototype._normalizeSpeed=function(d){var _=this._chunkSizeKBList,m=_.length-1,q=0,te=0,ne=m;if(d<_[0])return _[0];for(;te<=ne;){if((q=te+Math.floor((ne-te)/2))===m||d>=_[q]&&d<_[q+1])return _[q];_[q]<d?te=q+1:ne=q-1}},c.prototype._onLoad=function(d){if(this._status!==u.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var _=this._speedSampler.lastSecondKBps;if(_===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(_=this._speedSampler.currentKBps)),_!==0){var m=this._normalizeSpeed(_);this._currentSpeedNormalized!==m&&(this._currentSpeedNormalized=m,this._currentChunkSizeKB=m)}var q=d.target.response,te=this._range.from+this._receivedLength;this._receivedLength+=q.byteLength;var ne=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():ne=!0,this._onDataArrival&&this._onDataArrival(q,te,this._receivedLength),ne&&(this._status=u.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},c.prototype._onXhrError=function(d){this._status=u.c.kError;var _=0,m=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(_=u.b.EARLY_EOF,m={code:-1,msg:"RangeLoader meet Early-Eof"}):(_=u.b.EXCEPTION,m={code:-1,msg:d.constructor.name+" "+d.type}),!this._onError)throw new i.d(m.msg);this._onError(_,m)},c}(u.a),j=function(){var U=function(c,d){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var q in m)Object.prototype.hasOwnProperty.call(m,q)&&(_[q]=m[q])})(c,d)};return function(c,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function _(){this.constructor=c}U(c,d),c.prototype=d===null?Object.create(d):(_.prototype=d.prototype,new _)}}(),H=function(U){function c(){var d=U.call(this,"websocket-loader")||this;return d.TAG="WebSocketLoader",d._needStash=!0,d._ws=null,d._requestAbort=!1,d._receivedLength=0,d}return j(c,U),c.isSupported=function(){try{return self.WebSocket!==void 0}catch{return!1}},c.prototype.destroy=function(){this._ws&&this.abort(),U.prototype.destroy.call(this)},c.prototype.open=function(d){try{var _=this._ws=new self.WebSocket(d.url);_.binaryType="arraybuffer",_.onopen=this._onWebSocketOpen.bind(this),_.onclose=this._onWebSocketClose.bind(this),_.onmessage=this._onWebSocketMessage.bind(this),_.onerror=this._onWebSocketError.bind(this),this._status=u.c.kConnecting}catch(q){this._status=u.c.kError;var m={code:q.code,msg:q.message};if(!this._onError)throw new i.d(m.msg);this._onError(u.b.EXCEPTION,m)}},c.prototype.abort=function(){var d=this._ws;!d||d.readyState!==0&&d.readyState!==1||(this._requestAbort=!0,d.close()),this._ws=null,this._status=u.c.kComplete},c.prototype._onWebSocketOpen=function(d){this._status=u.c.kBuffering},c.prototype._onWebSocketClose=function(d){this._requestAbort!==!0?(this._status=u.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},c.prototype._onWebSocketMessage=function(d){var _=this;if(d.data instanceof ArrayBuffer)this._dispatchArrayBuffer(d.data);else if(d.data instanceof Blob){var m=new FileReader;m.onload=function(){_._dispatchArrayBuffer(m.result)},m.readAsArrayBuffer(d.data)}else{this._status=u.c.kError;var q={code:-1,msg:"Unsupported WebSocket message type: "+d.data.constructor.name};if(!this._onError)throw new i.d(q.msg);this._onError(u.b.EXCEPTION,q)}},c.prototype._dispatchArrayBuffer=function(d){var _=d,m=this._receivedLength;this._receivedLength+=_.byteLength,this._onDataArrival&&this._onDataArrival(_,m,this._receivedLength)},c.prototype._onWebSocketError=function(d){this._status=u.c.kError;var _={code:d.code,msg:d.message};if(!this._onError)throw new i.d(_.msg);this._onError(u.b.EXCEPTION,_)},c}(u.a),C=function(){function U(c){this._zeroStart=c||!1}return U.prototype.getConfig=function(c,d){var _={};if(d.from!==0||d.to!==-1){var m=void 0;m=d.to!==-1?"bytes=".concat(d.from.toString(),"-").concat(d.to.toString()):"bytes=".concat(d.from.toString(),"-"),_.Range=m}else this._zeroStart&&(_.Range="bytes=0-");return{url:c,headers:_}},U.prototype.removeURLParameters=function(c){return c},U}(),Z=function(){function U(c,d){this._startName=c,this._endName=d}return U.prototype.getConfig=function(c,d){var _=c;if(d.from!==0||d.to!==-1){var m=!0;_.indexOf("?")===-1&&(_+="?",m=!1),m&&(_+="&"),_+="".concat(this._startName,"=").concat(d.from.toString()),d.to!==-1&&(_+="&".concat(this._endName,"=").concat(d.to.toString()))}return{url:_,headers:{}}},U.prototype.removeURLParameters=function(c){var d=c.split("?")[0],_=void 0,m=c.indexOf("?");m!==-1&&(_=c.substring(m+1));var q="";if(_!=null&&_.length>0)for(var te=_.split("&"),ne=0;ne<te.length;ne++){var Y=te[ne].split("="),W=ne>0;Y[0]!==this._startName&&Y[0]!==this._endName&&(W&&(q+="&"),q+=te[ne])}return q.length===0?d:d+"?"+q},U}(),ie=function(){function U(c,d,_){this.TAG="IOController",this._config=d,this._extraData=_,this._stashInitialSize=65536,d.stashInitialSize!=null&&d.stashInitialSize>0&&(this._stashInitialSize=d.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,d.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=c,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(c.url),this._refTotalLength=c.filesize?c.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new T,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return U.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},U.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},U.prototype.isPaused=function(){return this._paused},Object.defineProperty(U.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"extraData",{get:function(){return this._extraData},set:function(c){this._extraData=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(c){this._onDataArrival=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(c){this._onSeeked=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onError",{get:function(){return this._onError},set:function(c){this._onError=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onComplete",{get:function(){return this._onComplete},set:function(c){this._onComplete=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(c){this._onRedirect=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(c){this._onRecoveredEarlyEof=c},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"currentSpeed",{get:function(){return this._loaderClass===P?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),U.prototype._selectSeekHandler=function(){var c=this._config;if(c.seekType==="range")this._seekHandler=new C(this._config.rangeLoadZeroStart);else if(c.seekType==="param"){var d=c.seekParamStart||"bstart",_=c.seekParamEnd||"bend";this._seekHandler=new Z(d,_)}else{if(c.seekType!=="custom")throw new i.b("Invalid seekType in config: ".concat(c.seekType));if(typeof c.customSeekHandler!="function")throw new i.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new c.customSeekHandler}},U.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=H;else if(p.isSupported())this._loaderClass=p;else if(E.isSupported())this._loaderClass=E;else{if(!P.isSupported())throw new i.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=P}},U.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},U.prototype.open=function(c){this._currentRange={from:0,to:-1},c&&(this._currentRange.from=c),this._speedSampler.reset(),c||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},U.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},U.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},U.prototype.resume=function(){if(this._paused){this._paused=!1;var c=this._resumeFrom;this._resumeFrom=0,this._internalSeek(c,!0)}},U.prototype.seek=function(c){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(c,!0)},U.prototype._internalSeek=function(c,d){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(d),this._loader.destroy(),this._loader=null;var _={from:c,to:-1};this._currentRange={from:_.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,_),this._onSeeked&&this._onSeeked()},U.prototype.updateUrl=function(c){if(!c||typeof c!="string"||c.length===0)throw new i.b("Url must be a non-empty string!");this._dataSource.url=c},U.prototype._expandBuffer=function(c){for(var d=this._stashSize;d+1048576<c;)d*=2;if((d+=1048576)!==this._bufferSize){var _=new ArrayBuffer(d);if(this._stashUsed>0){var m=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(_,0,d).set(m,0)}this._stashBuffer=_,this._bufferSize=d}},U.prototype._normalizeSpeed=function(c){var d=this._speedNormalizeList,_=d.length-1,m=0,q=0,te=_;if(c<d[0])return d[0];for(;q<=te;){if((m=q+Math.floor((te-q)/2))===_||c>=d[m]&&c<d[m+1])return d[m];d[m]<c?q=m+1:te=m-1}},U.prototype._adjustStashSize=function(c){var d=0;(d=this._config.isLive?c/8:c<512?c:c>=512&&c<=1024?Math.floor(1.5*c):2*c)>8192&&(d=8192);var _=1024*d+1048576;this._bufferSize<_&&this._expandBuffer(_),this._stashSize=1024*d},U.prototype._dispatchChunks=function(c,d){return this._currentRange.to=d+c.byteLength-1,this._onDataArrival(c,d)},U.prototype._onURLRedirect=function(c){this._redirectedURL=c,this._onRedirect&&this._onRedirect(c)},U.prototype._onContentLengthKnown=function(c){c&&this._fullRequestFlag&&(this._totalLength=c,this._fullRequestFlag=!1)},U.prototype._onLoaderChunkArrival=function(c,d,_){if(!this._onDataArrival)throw new i.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(c.byteLength);var m=this._speedSampler.lastSecondKBps;if(m!==0){var q=this._normalizeSpeed(m);this._speedNormalized!==q&&(this._speedNormalized=q,this._adjustStashSize(q))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=d),this._stashUsed+c.byteLength<=this._stashSize)(Y=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(c),this._stashUsed),this._stashUsed+=c.byteLength;else if(Y=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var te=this._stashBuffer.slice(0,this._stashUsed);(W=this._dispatchChunks(te,this._stashByteStart))<te.byteLength?W>0&&(he=new Uint8Array(te,W),Y.set(he,0),this._stashUsed=he.byteLength,this._stashByteStart+=W):(this._stashUsed=0,this._stashByteStart+=W),this._stashUsed+c.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+c.byteLength),Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),Y.set(new Uint8Array(c),this._stashUsed),this._stashUsed+=c.byteLength}else(W=this._dispatchChunks(c,d))<c.byteLength&&((ne=c.byteLength-W)>this._bufferSize&&(this._expandBuffer(ne),Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),Y.set(new Uint8Array(c,W),0),this._stashUsed+=ne,this._stashByteStart=d+W);else if(this._stashUsed===0){var ne;(W=this._dispatchChunks(c,d))<c.byteLength&&((ne=c.byteLength-W)>this._bufferSize&&this._expandBuffer(ne),(Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(c,W),0),this._stashUsed+=ne,this._stashByteStart=d+W)}else{var Y,W;if(this._stashUsed+c.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+c.byteLength),(Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(c),this._stashUsed),this._stashUsed+=c.byteLength,(W=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&W>0){var he=new Uint8Array(this._stashBuffer,W);Y.set(he,0)}this._stashUsed-=W,this._stashByteStart+=W}}},U.prototype._flushStashBuffer=function(c){if(this._stashUsed>0){var d=this._stashBuffer.slice(0,this._stashUsed),_=this._dispatchChunks(d,this._stashByteStart),m=d.byteLength-_;if(_<d.byteLength){if(!c){if(_>0){var q=new Uint8Array(this._stashBuffer,0,this._bufferSize),te=new Uint8Array(d,_);q.set(te,0),this._stashUsed=te.byteLength,this._stashByteStart+=_}return 0}k.a.w(this.TAG,"".concat(m," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,m}return 0},U.prototype._onLoaderComplete=function(c,d){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},U.prototype._onLoaderError=function(c,d){switch(k.a.e(this.TAG,"Loader error, code = ".concat(d.code,", msg = ").concat(d.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,c=u.b.UNRECOVERABLE_EARLY_EOF),c){case u.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var _=this._currentRange.to+1;return void(_<this._totalLength&&(k.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(_,!1)))}c=u.b.UNRECOVERABLE_EARLY_EOF;break;case u.b.UNRECOVERABLE_EARLY_EOF:case u.b.CONNECTING_TIMEOUT:case u.b.HTTP_STATUS_CODE_INVALID:case u.b.EXCEPTION:}if(!this._onError)throw new i.d("IOException: "+d.msg);this._onError(c,d)},U}();oe.a=ie},function(pe,oe,x){var V=x(10),k=x.n(V),T=x(0),u=x(5),g=x(13);function i(e,t,a){var o=e;if(t+a<o.length){for(;a--;)if((192&o[++t])!=128)return!1;return!0}return!1}var h,p=function(e){for(var t=[],a=e,o=0,r=e.length;o<r;)if(a[o]<128)t.push(String.fromCharCode(a[o])),++o;else{if(!(a[o]<192)){if(a[o]<224){if(i(a,o,1)&&(v=(31&a[o])<<6|63&a[o+1])>=128){t.push(String.fromCharCode(65535&v)),o+=2;continue}}else if(a[o]<240){if(i(a,o,2)&&(v=(15&a[o])<<12|(63&a[o+1])<<6|63&a[o+2])>=2048&&(63488&v)!=55296){t.push(String.fromCharCode(65535&v)),o+=3;continue}}else if(a[o]<248){var v;if(i(a,o,3)&&(v=(7&a[o])<<18|(63&a[o+1])<<12|(63&a[o+2])<<6|63&a[o+3])>65536&&v<1114112){v-=65536,t.push(String.fromCharCode(v>>>10|55296)),t.push(String.fromCharCode(1023&v|56320)),o+=4;continue}}}t.push(""),++o}return t.join("")},A=x(3),E=(h=new ArrayBuffer(2),new DataView(h).setInt16(0,256,!0),new Int16Array(h)[0]===256),O=function(){function e(){}return e.parseScriptData=function(t,a,o){var r={};try{var v=e.parseValue(t,a,o),L=e.parseValue(t,a+v.size,o-v.size);r[v.data]=L.data}catch(b){T.a.e("AMF",b.toString())}return r},e.parseObject=function(t,a,o){if(o<3)throw new A.a("Data not enough when parse ScriptDataObject");var r=e.parseString(t,a,o),v=e.parseValue(t,a+r.size,o-r.size),L=v.objectEnd;return{data:{name:r.data,value:v.data},size:r.size+v.size,objectEnd:L}},e.parseVariable=function(t,a,o){return e.parseObject(t,a,o)},e.parseString=function(t,a,o){if(o<2)throw new A.a("Data not enough when parse String");var r=new DataView(t,a,o).getUint16(0,!E);return{data:r>0?p(new Uint8Array(t,a+2,r)):"",size:2+r}},e.parseLongString=function(t,a,o){if(o<4)throw new A.a("Data not enough when parse LongString");var r=new DataView(t,a,o).getUint32(0,!E);return{data:r>0?p(new Uint8Array(t,a+4,r)):"",size:4+r}},e.parseDate=function(t,a,o){if(o<10)throw new A.a("Data size invalid when parse Date");var r=new DataView(t,a,o),v=r.getFloat64(0,!E),L=r.getInt16(8,!E);return{data:new Date(v+=60*L*1e3),size:10}},e.parseValue=function(t,a,o){if(o<1)throw new A.a("Data not enough when parse Value");var r,v=new DataView(t,a,o),L=1,b=v.getUint8(0),M=!1;try{switch(b){case 0:r=v.getFloat64(1,!E),L+=8;break;case 1:r=!!v.getUint8(1),L+=1;break;case 2:var N=e.parseString(t,a+1,o-1);r=N.data,L+=N.size;break;case 3:r={};var I=0;for((16777215&v.getUint32(o-4,!E))==9&&(I=3);L<o-4;){var z=e.parseObject(t,a+L,o-L-I);if(z.objectEnd)break;r[z.data.name]=z.data.value,L+=z.size}L<=o-3&&(16777215&v.getUint32(L-1,!E))===9&&(L+=3);break;case 8:for(r={},L+=4,I=0,(16777215&v.getUint32(o-4,!E))==9&&(I=3);L<o-8;){var K=e.parseVariable(t,a+L,o-L-I);if(K.objectEnd)break;r[K.data.name]=K.data.value,L+=K.size}L<=o-3&&(16777215&v.getUint32(L-1,!E))===9&&(L+=3);break;case 9:r=void 0,L=1,M=!0;break;case 10:r=[];var ae=v.getUint32(1,!E);L+=4;for(var re=0;re<ae;re++){var le=e.parseValue(t,a+L,o-L);r.push(le.data),L+=le.size}break;case 11:var ee=e.parseDate(t,a+1,o-1);r=ee.data,L+=ee.size;break;case 12:var fe=e.parseString(t,a+1,o-1);r=fe.data,L+=fe.size;break;default:L=o,T.a.w("AMF","Unsupported AMF value type "+b)}}catch(me){T.a.e("AMF",me.toString())}return{data:r,size:L,objectEnd:M}},e}(),F=x(23),P=x(6),j=x(15);function H(e){return e.byteOffset%2==0&&e.byteLength%2==0}function C(e){return e.byteOffset%4==0&&e.byteLength%4==0}function Z(e,t){for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var ie=function(e,t){return e.byteLength===t.byteLength&&(C(e)&&C(t)?function(a,o){return Z(new Uint32Array(a.buffer,a.byteOffset,a.byteLength/4),new Uint32Array(o.buffer,o.byteOffset,o.byteLength/4))}(e,t):H(e)&&H(t)?function(a,o){return Z(new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2),new Uint16Array(o.buffer,o.byteOffset,o.byteLength/2))}(e,t):function(a,o){return Z(a,o)}(e,t))},U=x(16),c=x(8),d=function(){function e(t,a){this.TAG="FLVDemuxer",this._config=a,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=t.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=t.hasAudioTrack,this._hasVideo=t.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new g.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var o=new ArrayBuffer(2);return new DataView(o).setInt16(0,256,!0),new Int16Array(o)[0]===256}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(t){var a=new Uint8Array(t);if(a.byteLength<9)return{needMoreData:!0};var o={match:!1};if(a[0]!==70||a[1]!==76||a[2]!==86||a[3]!==1)return o;var r,v,L=(4&a[4])>>>2!=0,b=(1&a[4])!=0,M=(r=a)[v=5]<<24|r[v+1]<<16|r[v+2]<<8|r[v+3];return M<9?o:{match:!0,consumed:M,dataOffset:M,hasAudioTrack:L,hasVideoTrack:b}},e.prototype.bindDataSource=function(t){return t.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(t){this._onTrackMetadata=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(t){this._onMediaInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(t){this._onMetaDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(t){this._onScriptDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(t){this._onDataAvailable=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(t){this._timestampBase=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(t){this._durationOverrided=!0,this._duration=t,this._mediaInfo.duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(t){this._hasAudioFlagOverrided=!0,this._hasAudio=t,this._mediaInfo.hasAudio=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(t){this._hasVideoFlagOverrided=!0,this._hasVideo=t,this._mediaInfo.hasVideo=t},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new g.a},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,a){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new A.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var o=0,r=this._littleEndian;if(a===0){if(!(t.byteLength>13))return 0;o=e.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,a+o!==this._dataOffset&&T.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(v=new DataView(t,o)).getUint32(0,!r)!==0&&T.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),o+=4);o<t.byteLength;){this._dispatch=!0;var v=new DataView(t,o);if(o+11+4>t.byteLength)break;var L=v.getUint8(0),b=16777215&v.getUint32(0,!r);if(o+11+b+4>t.byteLength)break;if(L===8||L===9||L===18){var M=v.getUint8(4),N=v.getUint8(5),I=v.getUint8(6)|N<<8|M<<16|v.getUint8(7)<<24;16777215&v.getUint32(7,!r)&&T.a.w(this.TAG,"Meet tag which has StreamID != 0!");var z=o+11;switch(L){case 8:this._parseAudioData(t,z,b,I);break;case 9:this._parseVideoData(t,z,b,I,a+o);break;case 18:this._parseScriptData(t,z,b)}var K=v.getUint32(11+b,!r);K!==11+b&&T.a.w(this.TAG,"Invalid PrevTagSize ".concat(K)),o+=11+b+4}else T.a.w(this.TAG,"Unsupported tag type ".concat(L,", skipped")),o+=11+b+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),o},e.prototype._parseScriptData=function(t,a,o){var r=O.parseScriptData(t,a,o);if(r.hasOwnProperty("onMetaData")){if(r.onMetaData==null||typeof r.onMetaData!="object")return void T.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&T.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=r;var v=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},v)),typeof v.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=v.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof v.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=v.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof v.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=v.audiodatarate),typeof v.videodatarate=="number"&&(this._mediaInfo.videoDataRate=v.videodatarate),typeof v.width=="number"&&(this._mediaInfo.width=v.width),typeof v.height=="number"&&(this._mediaInfo.height=v.height),typeof v.duration=="number"){if(!this._durationOverrided){var L=Math.floor(v.duration*this._timescale);this._duration=L,this._mediaInfo.duration=L}}else this._mediaInfo.duration=0;if(typeof v.framerate=="number"){var b=Math.floor(1e3*v.framerate);if(b>0){var M=b/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=M,this._referenceFrameRate.fps_num=b,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=M}}if(typeof v.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var N=v.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(N),v.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=v,T.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(r).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},r))},e.prototype._parseKeyframesIndex=function(t){for(var a=[],o=[],r=1;r<t.times.length;r++){var v=this._timestampBase+Math.floor(1e3*t.times[r]);a.push(v),o.push(t.filepositions[r])}return{times:a,filepositions:o}},e.prototype._parseAudioData=function(t,a,o,r){if(o<=1)T.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var v=new DataView(t,a,o).getUint8(0),L=v>>>4;if(L!==9)if(L===2||L===10){var b=0,M=(12&v)>>>2;if(M>=0&&M<=4){b=this._flvSoundRateTable[M];var N=1&v,I=this._audioMetadata,z=this._audioTrack;if(I||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(I=this._audioMetadata={}).type="audio",I.id=z.id,I.timescale=this._timescale,I.duration=this._duration,I.audioSampleRate=b,I.channelCount=N===0?1:2),L===10){var K=this._parseAACAudioData(t,a+1,o-1);if(K==null)return;if(K.packetType===0){if(I.config){if(ie(K.data.config,I.config))return;T.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var ae=K.data;I.audioSampleRate=ae.samplingRate,I.channelCount=ae.channelCount,I.codec=ae.codec,I.originalCodec=ae.originalCodec,I.config=ae.config,I.refSampleDuration=1024/I.audioSampleRate*I.timescale,T.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",I),(ee=this._mediaInfo).audioCodec=I.originalCodec,ee.audioSampleRate=I.audioSampleRate,ee.audioChannelCount=I.channelCount,ee.hasVideo?ee.videoCodec!=null&&(ee.mimeType='video/x-flv; codecs="'+ee.videoCodec+","+ee.audioCodec+'"'):ee.mimeType='video/x-flv; codecs="'+ee.audioCodec+'"',ee.isComplete()&&this._onMediaInfo(ee)}else if(K.packetType===1){var re=this._timestampBase+r,le={unit:K.data,length:K.data.byteLength,dts:re,pts:re};z.samples.push(le),z.length+=K.data.length}else T.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(K.packetType))}else if(L===2){if(!I.codec){var ee;if((ae=this._parseMP3AudioData(t,a+1,o-1,!0))==null)return;I.audioSampleRate=ae.samplingRate,I.channelCount=ae.channelCount,I.codec=ae.codec,I.originalCodec=ae.originalCodec,I.refSampleDuration=1152/I.audioSampleRate*I.timescale,T.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",I),(ee=this._mediaInfo).audioCodec=I.codec,ee.audioSampleRate=I.audioSampleRate,ee.audioChannelCount=I.channelCount,ee.audioDataRate=ae.bitRate,ee.hasVideo?ee.videoCodec!=null&&(ee.mimeType='video/x-flv; codecs="'+ee.videoCodec+","+ee.audioCodec+'"'):ee.mimeType='video/x-flv; codecs="'+ee.audioCodec+'"',ee.isComplete()&&this._onMediaInfo(ee)}var fe=this._parseMP3AudioData(t,a+1,o-1,!1);if(fe==null)return;re=this._timestampBase+r;var me={unit:fe,length:fe.byteLength,dts:re,pts:re};z.samples.push(me),z.length+=fe.length}}else this._onError(P.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+M)}else this._onError(P.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+L);else{if(o<=5)return void T.a.w(this.TAG,"Flv: Invalid audio packet, missing AudioFourCC in Ehnanced FLV payload!");var _e=15&v,ye=String.fromCharCode.apply(String,new Uint8Array(t,a,o).slice(1,5));switch(ye){case"Opus":this._parseOpusAudioPacket(t,a+5,o-5,r,_e);break;case"fLaC":this._parseFlacAudioPacket(t,a+5,o-5,r,_e);break;default:this._onError(P.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec: "+ye)}}}},e.prototype._parseAACAudioData=function(t,a,o){if(!(o<=1)){var r={},v=new Uint8Array(t,a,o);return r.packetType=v[0],v[0]===0?r.data=this._parseAACAudioSpecificConfig(t,a+1,o-1):r.data=v.subarray(1),r}T.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(t,a,o){var r,v,L=new Uint8Array(t,a,o),b=null,M=0,N=null;if(M=r=L[0]>>>3,(v=(7&L[0])<<1|L[1]>>>7)<0||v>=this._mpegSamplingRates.length)this._onError(P.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var I=this._mpegSamplingRates[v],z=(120&L[1])>>>3;if(!(z<0||z>=8)){M===5&&(N=(7&L[1])<<1|L[2]>>>7,(124&L[2])>>>2);var K=self.navigator.userAgent.toLowerCase();return K.indexOf("firefox")!==-1?v>=6?(M=5,b=new Array(4),N=v-3):(M=2,b=new Array(2),N=v):K.indexOf("android")!==-1?(M=2,b=new Array(2),N=v):(M=5,N=v,b=new Array(4),v>=6?N=v-3:z===1&&(M=2,b=new Array(2),N=v)),b[0]=M<<3,b[0]|=(15&v)>>>1,b[1]=(15&v)<<7,b[1]|=(15&z)<<3,M===5&&(b[1]|=(15&N)>>>1,b[2]=(1&N)<<7,b[2]|=8,b[3]=0),{config:b,samplingRate:I,channelCount:z,codec:"mp4a.40."+M,originalCodec:"mp4a.40."+r}}this._onError(P.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(t,a,o,r){if(!(o<4)){this._littleEndian;var v=new Uint8Array(t,a,o),L=null;if(r){if(v[0]!==255)return;var b=v[1]>>>3&3,M=(6&v[1])>>1,N=(240&v[2])>>>4,I=(12&v[2])>>>2,z=(v[3]>>>6&3)!==3?2:1,K=0,ae=0;switch(b){case 0:K=this._mpegAudioV25SampleRateTable[I];break;case 2:K=this._mpegAudioV20SampleRateTable[I];break;case 3:K=this._mpegAudioV10SampleRateTable[I]}switch(M){case 1:N<this._mpegAudioL3BitRateTable.length&&(ae=this._mpegAudioL3BitRateTable[N]);break;case 2:N<this._mpegAudioL2BitRateTable.length&&(ae=this._mpegAudioL2BitRateTable[N]);break;case 3:N<this._mpegAudioL1BitRateTable.length&&(ae=this._mpegAudioL1BitRateTable[N])}L={bitRate:ae,samplingRate:K,channelCount:z,codec:"mp3",originalCodec:"mp3"}}else L=v;return L}T.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseOpusAudioPacket=function(t,a,o,r,v){if(v===0)this._parseOpusSequenceHeader(t,a,o);else if(v===1)this._parseOpusAudioData(t,a,o,r);else if(v!==2)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(v))},e.prototype._parseOpusSequenceHeader=function(t,a,o){if(o<=16)T.a.w(this.TAG,"Flv: Invalid OpusSequenceHeader, lack of data!");else{var r=this._audioMetadata,v=this._audioTrack;r||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(r=this._audioMetadata={}).type="audio",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration);var L=new DataView(t,a,o);L.setUint8(8,0);var b=L.getUint8(9);L.setUint16(10,L.getUint16(10,!0),!1);var M=L.getUint32(12,!0);L.setUint32(12,L.getUint32(12,!0),!1);var N={config:new Uint8Array(t,a+8,o-8),channelCount:b,samplingFrequence:M,codec:"opus",originalCodec:"opus"};if(r.config){if(ie(N.config,r.config))return;T.a.w(this.TAG,"OpusSequenceHeader has been changed, re-generate initialization segment")}r.audioSampleRate=N.samplingFrequence,r.channelCount=N.channelCount,r.codec=N.codec,r.originalCodec=N.originalCodec,r.config=N.config,r.refSampleDuration=20,T.a.v(this.TAG,"Parsed OpusSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",r);var I=this._mediaInfo;I.audioCodec=r.originalCodec,I.audioSampleRate=r.audioSampleRate,I.audioChannelCount=r.channelCount,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}},e.prototype._parseOpusAudioData=function(t,a,o,r){var v=this._audioTrack,L=new Uint8Array(t,a,o),b=this._timestampBase+r,M={unit:L,length:L.byteLength,dts:b,pts:b};v.samples.push(M),v.length+=L.length},e.prototype._parseFlacAudioPacket=function(t,a,o,r,v){if(v===0)this._parseFlacSequenceHeader(t,a,o);else if(v===1)this._parseFlacAudioData(t,a,o,r);else if(v!==2)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid Flac audio packet type ".concat(v))},e.prototype._parseFlacSequenceHeader=function(t,a,o){var r=this._audioMetadata,v=this._audioTrack;r||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(r=this._audioMetadata={}).type="audio",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration);var L=new Uint8Array(t,a+4,o-4),b=new c.a(L),M=b.readBits(16),N=b.readBits(16),I=N===M?N:null;b.readBits(24),b.readBits(24);var z=b.readBits(20),K=b.readBits(3)+1,ae=b.readBits(5)+1;b.destroy();var re=new Uint8Array(L.byteLength+4);re.set(L,4),re[0]=128,re[1]=L.byteLength>>>16&255,re[2]=L.byteLength>>>8&255,re[3]=L.byteLength>>>0&255;var le={config:re,channelCount:K,samplingFrequence:z,sampleSize:ae,codec:"flac",originalCodec:"flac"};if(r.config){if(ie(le.config,r.config))return;T.a.w(this.TAG,"FlacSequenceHeader has been changed, re-generate initialization segment")}r.audioSampleRate=le.samplingFrequence,r.channelCount=le.channelCount,r.sampleSize=le.sampleSize,r.codec=le.codec,r.originalCodec=le.originalCodec,r.config=le.config,r.refSampleDuration=I!=null?1e3*I/le.samplingFrequence:null,T.a.v(this.TAG,"Parsed FlacSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",r);var ee=this._mediaInfo;ee.audioCodec=r.originalCodec,ee.audioSampleRate=r.audioSampleRate,ee.audioChannelCount=r.channelCount,ee.hasVideo?ee.videoCodec!=null&&(ee.mimeType='video/x-flv; codecs="'+ee.videoCodec+","+ee.audioCodec+'"'):ee.mimeType='video/x-flv; codecs="'+ee.audioCodec+'"',ee.isComplete()&&this._onMediaInfo(ee)},e.prototype._parseFlacAudioData=function(t,a,o,r){var v=this._audioTrack,L=new Uint8Array(t,a,o),b=this._timestampBase+r,M={unit:L,length:L.byteLength,dts:b,pts:b};v.samples.push(M),v.length+=L.length},e.prototype._parseVideoData=function(t,a,o,r,v){if(o<=1)T.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var L=new Uint8Array(t,a,o)[0],b=(112&L)>>>4;if(128&L){var M=15&L,N=String.fromCharCode.apply(String,new Uint8Array(t,a,o).slice(1,5));if(N==="hvc1")this._parseEnhancedHEVCVideoPacket(t,a+5,o-5,r,v,b,M);else{if(N!=="av01")return void this._onError(P.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(N));this._parseEnhancedAV1VideoPacket(t,a+5,o-5,r,v,b,M)}}else{var I=15&L;if(I===7)this._parseAVCVideoPacket(t,a+1,o-1,r,v,b);else{if(I!==12)return void this._onError(P.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(I));this._parseHEVCVideoPacket(t,a+1,o-1,r,v,b)}}}},e.prototype._parseAVCVideoPacket=function(t,a,o,r,v,L){if(o<4)T.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var b=this._littleEndian,M=new DataView(t,a,o),N=M.getUint8(0),I=(16777215&M.getUint32(0,!b))<<8>>8;if(N===0)this._parseAVCDecoderConfigurationRecord(t,a+4,o-4);else if(N===1)this._parseAVCVideoData(t,a+4,o-4,r,v,L,I);else if(N!==2)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(N))}},e.prototype._parseHEVCVideoPacket=function(t,a,o,r,v,L){if(o<4)T.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var b=this._littleEndian,M=new DataView(t,a,o),N=M.getUint8(0),I=(16777215&M.getUint32(0,!b))<<8>>8;if(N===0)this._parseHEVCDecoderConfigurationRecord(t,a+4,o-4);else if(N===1)this._parseHEVCVideoData(t,a+4,o-4,r,v,L,I);else if(N!==2)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(N))}},e.prototype._parseEnhancedHEVCVideoPacket=function(t,a,o,r,v,L,b){var M=this._littleEndian,N=new DataView(t,a,o);if(b===0)this._parseHEVCDecoderConfigurationRecord(t,a,o);else if(b===1){var I=(4294967040&N.getUint32(0,!M))>>8;this._parseHEVCVideoData(t,a+3,o-3,r,v,L,I)}else if(b===3)this._parseHEVCVideoData(t,a,o,r,v,L,0);else if(b!==2)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(b))},e.prototype._parseEnhancedAV1VideoPacket=function(t,a,o,r,v,L,b){if(this._littleEndian,b===0)this._parseAV1CodecConfigurationRecord(t,a,o);else if(b===1)this._parseAV1VideoData(t,a,o,r,v,L,0);else{if(b===5)return void this._onError(P.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(b));if(b!==2)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(b))}},e.prototype._parseAVCDecoderConfigurationRecord=function(t,a,o){if(o<7)T.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var r=this._videoMetadata,v=this._videoTrack,L=this._littleEndian,b=new DataView(t,a,o);if(r){if(r.avcc!==void 0){var M=new Uint8Array(t,a,o);if(ie(M,r.avcc))return;T.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(r=this._videoMetadata={}).type="video",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration;var N=b.getUint8(0),I=b.getUint8(1);if(b.getUint8(2),b.getUint8(3),N===1&&I!==0)if(this._naluLengthSize=1+(3&b.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var z=31&b.getUint8(5);if(z!==0){z>1&&T.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(z));for(var K=6,ae=0;ae<z;ae++){var re=b.getUint16(K,!L);if(K+=2,re!==0){var le=new Uint8Array(t,a+K,re);K+=re;var ee=F.a.parseSPS(le);if(ae===0){r.codecWidth=ee.codec_size.width,r.codecHeight=ee.codec_size.height,r.presentWidth=ee.present_size.width,r.presentHeight=ee.present_size.height,r.profile=ee.profile_string,r.level=ee.level_string,r.bitDepth=ee.bit_depth,r.chromaFormat=ee.chroma_format,r.sarRatio=ee.sar_ratio,r.frameRate=ee.frame_rate,ee.frame_rate.fixed!==!1&&ee.frame_rate.fps_num!==0&&ee.frame_rate.fps_den!==0||(r.frameRate=this._referenceFrameRate);var fe=r.frameRate.fps_den,me=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(fe/me);for(var _e=le.subarray(1,4),ye="avc1.",ke=0;ke<3;ke++){var ce=_e[ke].toString(16);ce.length<2&&(ce="0"+ce),ye+=ce}r.codec=ye;var ve=this._mediaInfo;ve.width=r.codecWidth,ve.height=r.codecHeight,ve.fps=r.frameRate.fps,ve.profile=r.profile,ve.level=r.level,ve.refFrames=ee.ref_frames,ve.chromaFormat=ee.chroma_format_string,ve.sarNum=r.sarRatio.width,ve.sarDen=r.sarRatio.height,ve.videoCodec=ye,ve.hasAudio?ve.audioCodec!=null&&(ve.mimeType='video/x-flv; codecs="'+ve.videoCodec+","+ve.audioCodec+'"'):ve.mimeType='video/x-flv; codecs="'+ve.videoCodec+'"',ve.isComplete()&&this._onMediaInfo(ve)}}}var Se=b.getUint8(K);if(Se!==0){for(Se>1&&T.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(Se)),K++,ae=0;ae<Se;ae++)re=b.getUint16(K,!L),K+=2,re!==0&&(K+=re);r.avcc=new Uint8Array(o),r.avcc.set(new Uint8Array(t,a,o),0),T.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",r)}else this._onError(P.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(P.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(P.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(P.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseHEVCDecoderConfigurationRecord=function(t,a,o){if(o<22)T.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var r=this._videoMetadata,v=this._videoTrack,L=this._littleEndian,b=new DataView(t,a,o);if(r){if(r.hvcc!==void 0){var M=new Uint8Array(t,a,o);if(ie(M,r.hvcc))return;T.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(r=this._videoMetadata={}).type="video",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration;var N=b.getUint8(0),I=31&b.getUint8(1);if(N!==0&&N!==1||I===0)this._onError(P.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord");else if(this._naluLengthSize=1+(3&b.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var z=b.getUint8(22),K=0,ae=23;K<z;K++){var re=63&b.getUint8(ae+0),le=b.getUint16(ae+1,!L);ae+=3;for(var ee=0;ee<le;ee++){var fe=b.getUint16(ae+0,!L);if(ee===0)if(re===33){ae+=2;var me=new Uint8Array(t,a+ae,fe),_e=j.a.parseSPS(me);r.codecWidth=_e.codec_size.width,r.codecHeight=_e.codec_size.height,r.presentWidth=_e.present_size.width,r.presentHeight=_e.present_size.height,r.profile=_e.profile_string,r.level=_e.level_string,r.bitDepth=_e.bit_depth,r.chromaFormat=_e.chroma_format,r.sarRatio=_e.sar_ratio,r.frameRate=_e.frame_rate,_e.frame_rate.fixed!==!1&&_e.frame_rate.fps_num!==0&&_e.frame_rate.fps_den!==0||(r.frameRate=this._referenceFrameRate);var ye=r.frameRate.fps_den,ke=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(ye/ke),r.codec=_e.codec_mimetype;var ce=this._mediaInfo;ce.width=r.codecWidth,ce.height=r.codecHeight,ce.fps=r.frameRate.fps,ce.profile=r.profile,ce.level=r.level,ce.refFrames=_e.ref_frames,ce.chromaFormat=_e.chroma_format_string,ce.sarNum=r.sarRatio.width,ce.sarDen=r.sarRatio.height,ce.videoCodec=_e.codec_mimetype,ce.hasAudio?ce.audioCodec!=null&&(ce.mimeType='video/x-flv; codecs="'+ce.videoCodec+","+ce.audioCodec+'"'):ce.mimeType='video/x-flv; codecs="'+ce.videoCodec+'"',ce.isComplete()&&this._onMediaInfo(ce),ae+=fe}else ae+=2+fe;else ae+=2+fe}}r.hvcc=new Uint8Array(o),r.hvcc.set(new Uint8Array(t,a,o),0),T.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",r)}else this._onError(P.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1))}},e.prototype._parseAV1CodecConfigurationRecord=function(t,a,o){if(o<4)T.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var r=this._videoMetadata,v=this._videoTrack,L=(this._littleEndian,new DataView(t,a,o));r?r.av1c!==void 0&&T.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(r=this._videoMetadata={}).type="video",r.id=v.id,r.timescale=this._timescale,r.duration=this._duration);var b=127&L.getUint8(0);if(L.getUint8(1),L.getUint8(1),L.getUint8(2),b===1){var M=U.a.parseOBUs(new Uint8Array(t,a+4,o-4));if(M!=null){r.profile=M.profile_string,r.level=M.level_string,r.bitDepth=M.bit_depth,r.chromaFormat=M.chroma_format,r.frameRate=M.frame_rate,M.frame_rate.fixed!==!1&&M.frame_rate.fps_num!==0&&M.frame_rate.fps_den!==0||(r.frameRate=this._referenceFrameRate);var N=r.frameRate.fps_den,I=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(N/I),r.codec=M.codec_mimetype,r.extra=M;var z=this._mediaInfo;z.fps=r.frameRate.fps,z.profile=r.profile,z.level=r.level,z.refFrames=M.ref_frames,z.chromaFormat=M.chroma_format_string,z.videoCodec=M.codec_mimetype,z.hasAudio?z.audioCodec!=null&&(z.mimeType='video/x-flv; codecs="'+z.videoCodec+","+z.audioCodec+'"'):z.mimeType='video/x-flv; codecs="'+z.videoCodec+'"',z.isComplete()&&this._onMediaInfo(z),r.av1c=new Uint8Array(o),r.av1c.set(new Uint8Array(t,a,o),0),T.a.v(this.TAG,"Preparing AV1CodecConfigurationRecord")}else this._onError(P.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(P.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},e.prototype._parseAVCVideoData=function(t,a,o,r,v,L,b){for(var M=this._littleEndian,N=new DataView(t,a,o),I=[],z=0,K=0,ae=this._naluLengthSize,re=this._timestampBase+r,le=L===1;K<o;){if(K+4>=o){T.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(re,", offset = ").concat(K,", dataSize = ").concat(o));break}var ee=N.getUint32(K,!M);if(ae===3&&(ee>>>=8),ee>o-ae)return void T.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(re,", NaluSize > DataSize!"));var fe=31&N.getUint8(K+ae);fe===5&&(le=!0);var me=new Uint8Array(t,a+K,ae+ee),_e={type:fe,data:me};I.push(_e),z+=me.byteLength,K+=ae+ee}if(I.length){var ye=this._videoTrack,ke={units:I,length:z,isKeyframe:le,dts:re,cts:b,pts:re+b};le&&(ke.fileposition=v),ye.samples.push(ke),ye.length+=z}},e.prototype._parseHEVCVideoData=function(t,a,o,r,v,L,b){for(var M=this._littleEndian,N=new DataView(t,a,o),I=[],z=0,K=0,ae=this._naluLengthSize,re=this._timestampBase+r,le=L===1;K<o;){if(K+4>=o){T.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(re,", offset = ").concat(K,", dataSize = ").concat(o));break}var ee=N.getUint32(K,!M);if(ae===3&&(ee>>>=8),ee>o-ae)return void T.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(re,", NaluSize > DataSize!"));var fe=N.getUint8(K+ae)>>1&63;fe!==19&&fe!==20&&fe!==21||(le=!0);var me=new Uint8Array(t,a+K,ae+ee),_e={type:fe,data:me};I.push(_e),z+=me.byteLength,K+=ae+ee}if(I.length){var ye=this._videoTrack,ke={units:I,length:z,isKeyframe:le,dts:re,cts:b,pts:re+b};le&&(ke.fileposition=v),ye.samples.push(ke),ye.length+=z}},e.prototype._parseAV1VideoData=function(t,a,o,r,v,L,b){this._littleEndian;var M,N=[],I=this._timestampBase+r,z=L===1;if(z){var K=this._videoMetadata,ae=U.a.parseOBUs(new Uint8Array(t,a,o),K.extra);if(ae==null)return void this._onError(P.a.FORMAT_ERROR,"Flv: Invalid AV1 VideoData");console.log(ae),K.codecWidth=ae.codec_size.width,K.codecHeight=ae.codec_size.height,K.presentWidth=ae.present_size.width,K.presentHeight=ae.present_size.height,K.sarRatio=ae.sar_ratio;var re=this._mediaInfo;re.width=K.codecWidth,re.height=K.codecHeight,re.sarNum=K.sarRatio.width,re.sarDen=K.sarRatio.height,T.a.v(this.TAG,"Parsed AV1DecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",K)}if(M=o,N.push({unitType:0,data:new Uint8Array(t,a+0,o)}),N.length){var le=this._videoTrack,ee={units:N,length:M,isKeyframe:z,dts:I,cts:b,pts:I+b};z&&(ee.fileposition=v),le.samples.push(ee),le.length+=M}},e}(),_=x(14),m=function(e,t,a){for(var o,r=0,v=t.length;r<v;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},q=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[],fLaC:[],dfLa:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var a=e.constants={};a.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),a.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),a.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),a.STSC=a.STCO=a.STTS,a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),a.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),a.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(t){for(var a=8,o=null,r=Array.prototype.slice.call(arguments,1),v=r.length,L=0;L<v;L++)a+=r[L].byteLength;(o=new Uint8Array(a))[0]=a>>>24&255,o[1]=a>>>16&255,o[2]=a>>>8&255,o[3]=255&a,o.set(t,4);var b=8;for(L=0;L<v;L++)o.set(r[L],b),b+=r[L].byteLength;return o},e.generateInitSegment=function(t){var a=e.box(e.types.ftyp,e.constants.FTYP),o=e.moov(t),r=new Uint8Array(a.byteLength+o.byteLength);return r.set(a,0),r.set(o,a.byteLength),r},e.moov=function(t){var a=e.mvhd(t.timescale,t.duration),o=e.trak(t),r=e.mvex(t);return e.box(e.types.moov,a,o,r)},e.mvhd=function(t,a){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var a=t.id,o=t.duration,r=t.presentWidth,v=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>>8&255,255&r,0,0,v>>>8&255,255&v,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var a=t.timescale,o=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,85,196,0,0]))},e.hdlr=function(t){var a=null;return a=t.type==="audio"?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,a)},e.minf=function(t){var a=null;return a=t.type==="audio"?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,a,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return t.type==="audio"?t.codec==="mp3"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):t.codec==="ac-3"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ac3(t)):t.codec==="ec-3"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ec3(t)):t.codec==="opus"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.Opus(t)):t.codec=="flac"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.fLaC(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):t.type==="video"&&t.codec.startsWith("hvc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hvc1(t)):t.type==="video"&&t.codec.startsWith("av01")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.av01(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var a=t.channelCount,o=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return e.box(e.types[".mp3"],r)},e.mp4a=function(t){var a=t.channelCount,o=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return e.box(e.types.mp4a,r,e.esds(t))},e.ac3=function(t){var a=t.channelCount,o=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return e.box(e.types["ac-3"],r,e.box(e.types.dac3,new Uint8Array(t.config)))},e.ec3=function(t){var a=t.channelCount,o=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return e.box(e.types["ec-3"],r,e.box(e.types.dec3,new Uint8Array(t.config)))},e.esds=function(t){var a=t.config||[],o=a.length,r=new Uint8Array([0,0,0,0,3,23+o,0,1,0,4,15+o,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([o]).concat(a).concat([6,1,2]));return e.box(e.types.esds,r)},e.Opus=function(t){var a=t.channelCount,o=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,o>>>8&255,255&o,0,0]);return e.box(e.types.Opus,r,e.dOps(t))},e.dOps=function(t){var a=t.channelCount,o=t.channelConfigCode,r=t.audioSampleRate;if(t.config)return e.box(e.types.dOps,t.config);var v=[];switch(o){case 1:case 2:v=[0];break;case 0:v=[255,1,1,0,1];break;case 128:v=[255,2,0,0,1];break;case 3:v=[1,2,1,0,2,1];break;case 4:v=[1,2,2,0,1,2,3];break;case 5:v=[1,3,2,0,4,1,2,3];break;case 6:v=[1,4,2,0,4,1,2,3,5];break;case 7:v=[1,4,2,0,4,1,2,3,5,6];break;case 8:v=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:v=[1,1,2,0,1];break;case 131:v=[1,1,3,0,1,2];break;case 132:v=[1,1,4,0,1,2,3];break;case 133:v=[1,1,5,0,1,2,3,4];break;case 134:v=[1,1,6,0,1,2,3,4,5];break;case 135:v=[1,1,7,0,1,2,3,4,5,6];break;case 136:v=[1,1,8,0,1,2,3,4,5,6,7]}var L=new Uint8Array(m([0,a,0,0,r>>>24&255,r>>>17&255,r>>>8&255,r>>>0&255,0,0],v));return e.box(e.types.dOps,L)},e.fLaC=function(t){var a=t.channelCount,o=Math.min(t.audioSampleRate,65535),r=t.sampleSize,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,r,0,0,0,0,o>>>8&255,255&o,0,0]);return e.box(e.types.fLaC,v,e.dfLa(t))},e.dfLa=function(t){var a=new Uint8Array(m([0,0,0,0],t.config));return e.box(e.types.dfLa,a)},e.avc1=function(t){var a=t.avcc,o=t.codecWidth,r=t.codecHeight,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,v,e.box(e.types.avcC,a))},e.hvc1=function(t){var a=t.hvcc,o=t.codecWidth,r=t.codecHeight,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hvc1,v,e.box(e.types.hvcC,a))},e.av01=function(t){var a=t.av1c,o=t.codecWidth||192,r=t.codecHeight||108,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.av01,v,e.box(e.types.av1C,a))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var a=t.id,o=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,o)},e.moof=function(t,a){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,a))},e.mfhd=function(t){var a=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,a)},e.traf=function(t,a){var o=t.id,r=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),v=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a])),L=e.sdtp(t),b=e.trun(t,L.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,r,v,b,L)},e.sdtp=function(t){for(var a=t.samples||[],o=a.length,r=new Uint8Array(4+o),v=0;v<o;v++){var L=a[v].flags;r[v+4]=L.isLeading<<6|L.dependsOn<<4|L.isDependedOn<<2|L.hasRedundancy}return e.box(e.types.sdtp,r)},e.trun=function(t,a){var o=t.samples||[],r=o.length,v=12+16*r,L=new Uint8Array(v);a+=8+v,L.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,a>>>24&255,a>>>16&255,a>>>8&255,255&a],0);for(var b=0;b<r;b++){var M=o[b].duration,N=o[b].size,I=o[b].flags,z=o[b].cts;L.set([M>>>24&255,M>>>16&255,M>>>8&255,255&M,N>>>24&255,N>>>16&255,N>>>8&255,255&N,I.isLeading<<2|I.dependsOn,I.isDependedOn<<6|I.hasRedundancy<<4|I.isNonSync,0,0,z>>>24&255,z>>>16&255,z>>>8&255,255&z],12+16*b)}return e.box(e.types.trun,L)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();q.init();var te=q,ne=function(){function e(){}return e.getSilentFrame=function(t,a){if(t==="mp4a.40.2"){if(a===1)return new Uint8Array([0,200,0,128,35,128]);if(a===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(a===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(a===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(a===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(a===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(a===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(a===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(a===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),Y=x(12),W=function(){function e(t){this.TAG="MP4Remuxer",this._config=t,this._isLive=t.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Y.c("audio"),this._videoSegmentInfoList=new Y.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!u.a.chrome||!(u.a.version.major<50||u.a.version.major===50&&u.a.version.build<2661)),this._fillSilentAfterSeek=u.a.msedge||u.a.msie,this._mp3UseMpegAudio=!u.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},e.prototype.bindDataSource=function(t){return t.onDataAvailable=this.remux.bind(this),t.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(t){this._onInitSegment=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(t){this._onMediaSegment=t},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(t){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(t,a,o){if(o===void 0&&(o=!1),!this._onMediaSegment)throw new A.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(t,a),a&&this._remuxVideo(a,o),t&&this._remuxAudio(t,o)},e.prototype._onTrackMetadataReceived=function(t,a){var o=null,r="mp4",v=a.codec;if(t==="audio")this._audioMeta=a,a.codec==="mp3"&&this._mp3UseMpegAudio?(r="mpeg",v="",o=new Uint8Array):o=te.generateInitSegment(a);else{if(t!=="video")return;this._videoMeta=a,o=te.generateInitSegment(a)}if(!this._onInitSegment)throw new A.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(t,{type:t,data:o.buffer,codec:v,container:"".concat(t,"/").concat(r),mediaDuration:a.duration})},e.prototype._calculateDtsBase=function(t,a){this._dtsBaseInited||(t&&t.samples&&t.samples.length&&(this._audioDtsBase=t.samples[0].dts),a&&a.samples&&a.samples.length&&(this._videoDtsBase=a.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},e.prototype.flushStashedSamples=function(){var t=this._videoStashedLastSample,a=this._audioStashedLastSample,o={type:"video",id:1,sequenceNumber:0,samples:[],length:0};t!=null&&(o.samples.push(t),o.length=t.length);var r={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};a!=null&&(r.samples.push(a),r.length=a.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(o,!0),this._remuxAudio(r,!0)},e.prototype._remuxAudio=function(t,a){if(this._audioMeta!=null){var o,r=t,v=r.samples,L=void 0,b=-1,M=this._audioMeta.refSampleDuration,N=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,I=this._dtsBaseInited&&this._audioNextDts===void 0,z=!1;if((v&&v.length!==0||a&&this._audioStashedLastSample!=null)&&(v.length!==1||a)){var K=0,ae=null,re=0;N?(K=0,re=r.length):(K=8,re=8+r.length);var le=null;if(v.length>1&&!a&&(re-=(le=v.pop()).length),this._audioStashedLastSample!=null){var ee=this._audioStashedLastSample;this._audioStashedLastSample=null,v.unshift(ee),re+=ee.length}le!=null&&(this._audioStashedLastSample=le);var fe=v[0].dts-this._dtsBase;if(this._audioNextDts)L=fe-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())L=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(z=!0);else{var me=this._audioSegmentInfoList.getLastSampleBefore(fe);if(me!=null){var _e=fe-(me.originalDts+me.duration);_e<=3&&(_e=0),L=fe-(me.dts+me.duration+_e)}else L=0}if(z){var ye=fe-L,ke=this._videoSegmentInfoList.getLastSegmentBefore(fe);if(ke!=null&&ke.beginDts<ye){if(xe=ne.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var ce=ke.beginDts,ve=ye-ke.beginDts;T.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(ce,", duration: ").concat(ve)),v.unshift({unit:xe,dts:ce,pts:ce}),re+=xe.byteLength}}else z=!1}for(var Se=[],we=0;we<v.length;we++){var Ie=(ee=v[we]).unit,De=ee.dts-this._dtsBase,Ue=(ce=De,!1),Ve=null,Me=0;if(!(De<-.001)){if(this._audioMeta.codec!=="mp3"&&M!=null){var Re=De;if(this._audioNextDts&&(Re=this._audioNextDts),(L=De-Re)<=-3*M){T.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(De," ms ,curRefDts: ").concat(Re," ms)  due to dtsCorrection: ").concat(L," ms overlap."));continue}if(L>=3*M&&this._fillAudioTimestampGap&&!u.a.safari){Ue=!0;var xe,l=Math.floor(L/M);T.a.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+"originalDts: ".concat(De," ms, curRefDts: ").concat(Re," ms, ")+"dtsCorrection: ".concat(Math.round(L)," ms, generate: ").concat(l," frames")),ce=Math.floor(Re),Me=Math.floor(Re+M)-ce,(xe=ne.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(T.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),xe=Ie),Ve=[];for(var y=0;y<l;y++){Re+=M;var s=Math.floor(Re),n=Math.floor(Re+M)-s,S={dts:s,pts:s,cts:0,unit:xe,size:xe.byteLength,duration:n,originalDts:De,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Ve.push(S),re+=S.size}this._audioNextDts=Re+M}else ce=Math.floor(Re),Me=Math.floor(Re+M)-ce,this._audioNextDts=Re+M}else ce=De-L,we!==v.length-1?Me=v[we+1].dts-this._dtsBase-L-ce:le!=null?Me=le.dts-this._dtsBase-L-ce:Me=Se.length>=1?Se[Se.length-1].duration:Math.floor(M),this._audioNextDts=ce+Me;b===-1&&(b=ce),Se.push({dts:ce,pts:ce,cts:0,unit:ee.unit,size:ee.unit.byteLength,duration:Me,originalDts:De,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Ue&&Se.push.apply(Se,Ve)}}if(Se.length===0)return r.samples=[],void(r.length=0);for(N?ae=new Uint8Array(re):((ae=new Uint8Array(re))[0]=re>>>24&255,ae[1]=re>>>16&255,ae[2]=re>>>8&255,ae[3]=255&re,ae.set(te.types.mdat,4)),we=0;we<Se.length;we++)Ie=Se[we].unit,ae.set(Ie,K),K+=Ie.byteLength;var w=Se[Se.length-1];o=w.dts+w.duration;var f=new Y.b;f.beginDts=b,f.endDts=o,f.beginPts=b,f.endPts=o,f.originalBeginDts=Se[0].originalDts,f.originalEndDts=w.originalDts+w.duration,f.firstSample=new Y.d(Se[0].dts,Se[0].pts,Se[0].duration,Se[0].originalDts,!1),f.lastSample=new Y.d(w.dts,w.pts,w.duration,w.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(f),r.samples=Se,r.sequenceNumber++;var D=null;D=N?new Uint8Array:te.moof(r,b),r.samples=[],r.length=0;var G={type:"audio",data:this._mergeBoxes(D,ae).buffer,sampleCount:Se.length,info:f};N&&I&&(G.timestampOffset=b),this._onMediaSegment("audio",G)}}},e.prototype._remuxVideo=function(t,a){if(this._videoMeta!=null){var o,r,v=t,L=v.samples,b=void 0,M=-1,N=-1;if(L&&L.length!==0){if(L.length!==1||a){var I=8,z=null,K=8+t.length,ae=null;if(L.length>1&&!a&&(K-=(ae=L.pop()).length),this._videoStashedLastSample!=null){var re=this._videoStashedLastSample;this._videoStashedLastSample=null,L.unshift(re),K+=re.length}ae!=null&&(this._videoStashedLastSample=ae);var le=L[0].dts-this._dtsBase;if(this._videoNextDts)b=le-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())b=0;else{var ee=this._videoSegmentInfoList.getLastSampleBefore(le);if(ee!=null){var fe=le-(ee.originalDts+ee.duration);fe<=3&&(fe=0),b=le-(ee.dts+ee.duration+fe)}else b=0}for(var me=new Y.b,_e=[],ye=0;ye<L.length;ye++){var ke=(re=L[ye]).dts-this._dtsBase,ce=re.isKeyframe,ve=ke-b,Se=re.cts,we=ve+Se;M===-1&&(M=ve,N=we);var Ie=0;if(ye!==L.length-1?Ie=L[ye+1].dts-this._dtsBase-b-ve:ae!=null?Ie=ae.dts-this._dtsBase-b-ve:Ie=_e.length>=1?_e[_e.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),ce){var De=new Y.d(ve,we,Ie,re.dts,!0);De.fileposition=re.fileposition,me.appendSyncPoint(De)}_e.push({dts:ve,pts:we,cts:Se,units:re.units,size:re.length,isKeyframe:ce,duration:Ie,originalDts:ke,flags:{isLeading:0,dependsOn:ce?2:1,isDependedOn:ce?1:0,hasRedundancy:0,isNonSync:ce?0:1}})}for((z=new Uint8Array(K))[0]=K>>>24&255,z[1]=K>>>16&255,z[2]=K>>>8&255,z[3]=255&K,z.set(te.types.mdat,4),ye=0;ye<_e.length;ye++)for(var Ue=_e[ye].units;Ue.length;){var Ve=Ue.shift().data;z.set(Ve,I),I+=Ve.byteLength}var Me=_e[_e.length-1];if(o=Me.dts+Me.duration,r=Me.pts+Me.duration,this._videoNextDts=o,me.beginDts=M,me.endDts=o,me.beginPts=N,me.endPts=r,me.originalBeginDts=_e[0].originalDts,me.originalEndDts=Me.originalDts+Me.duration,me.firstSample=new Y.d(_e[0].dts,_e[0].pts,_e[0].duration,_e[0].originalDts,_e[0].isKeyframe),me.lastSample=new Y.d(Me.dts,Me.pts,Me.duration,Me.originalDts,Me.isKeyframe),this._isLive||this._videoSegmentInfoList.append(me),v.samples=_e,v.sequenceNumber++,this._forceFirstIDR){var Re=_e[0].flags;Re.dependsOn=2,Re.isNonSync=0}var xe=te.moof(v,M);v.samples=[],v.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(xe,z).buffer,sampleCount:_e.length,info:me})}}else!a||this._videoStashedLastSample}},e.prototype._mergeBoxes=function(t,a){var o=new Uint8Array(t.byteLength+a.byteLength);return o.set(t,0),o.set(a,t.byteLength),o},e}(),he=x(17),se=x(1),R=(x(2),function(){function e(t,a){this.TAG="TransmuxingController",this._emitter=new k.a,this._config=a,t.segments||(t.segments=[{duration:t.duration,filesize:t.filesize,url:t.url}]),typeof t.cors!="boolean"&&(t.cors=!0),typeof t.withCredentials!="boolean"&&(t.withCredentials=!1),this._mediaDataSource=t,this._currentSegmentIndex=0;var o=0;this._mediaDataSource.segments.forEach(function(r){r.timestampBase=o,o+=r.duration,r.cors=t.cors,r.withCredentials=t.withCredentials,a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy)}),isNaN(o)||this._mediaDataSource.duration===o||(this._mediaDataSource.duration=o),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(t,a){this._emitter.addListener(t,a)},e.prototype.off=function(t,a){this._emitter.removeListener(t,a)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(t,a){this._currentSegmentIndex=t;var o=this._mediaDataSource.segments[t],r=this._ioctl=new he.a(o,this._config,t);r.onError=this._onIOException.bind(this),r.onSeeked=this._onIOSeeked.bind(this),r.onComplete=this._onIOComplete.bind(this),r.onRedirect=this._onIORedirect.bind(this),r.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),a?this._demuxer.bindDataSource(this._ioctl):r.onDataArrival=this._onInitChunkArrival.bind(this),r.open(a)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(t){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var a=this._searchSegmentIndexContains(t);if(a===this._currentSegmentIndex){var o=this._mediaInfo.segments[a];if(o==null)this._pendingSeekTime=t;else{var r=o.getNearestKeyframe(t);this._remuxer.seek(r.milliseconds),this._ioctl.seek(r.fileposition),this._pendingResolveSeekPoint=r.milliseconds}}else{var v=this._mediaInfo.segments[a];v==null?(this._pendingSeekTime=t,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(a)):(r=v.getNearestKeyframe(t),this._internalAbort(),this._remuxer.seek(t),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[a].timestampBase,this._loadSegment(a,r.fileposition),this._pendingResolveSeekPoint=r.milliseconds,this._reportSegmentMediaInfo(a))}this._enableStatisticsReporter()}},e.prototype._searchSegmentIndexContains=function(t){for(var a=this._mediaDataSource.segments,o=a.length-1,r=0;r<a.length;r++)if(t<a[r].timestampBase){o=r-1;break}return o},e.prototype._onInitChunkArrival=function(t,a){var o=this,r=0;if(a>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,r=this._demuxer.parseChunks(t,a);else{var v=null;(v=d.probe(t)).match&&(this._setupFLVDemuxerRemuxer(v),r=this._demuxer.parseChunks(t,a)),v.match||v.needMoreData||(v=_.a.probe(t)).match&&(this._setupTSDemuxerRemuxer(v),r=this._demuxer.parseChunks(t,a)),v.match||v.needMoreData||(v=null,T.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(function(){o._internalAbort()}),this._emitter.emit(se.a.DEMUX_ERROR,P.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return r},e.prototype._setupFLVDemuxerRemuxer=function(t){this._demuxer=new d(t,this._config),this._remuxer||(this._remuxer=new W(this._config));var a=this._mediaDataSource;a.duration==null||isNaN(a.duration)||(this._demuxer.overridedDuration=a.duration),typeof a.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=a.hasAudio),typeof a.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=a.hasVideo),this._demuxer.timestampBase=a.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupTSDemuxerRemuxer=function(t){var a=this._demuxer=new _.a(t,this._config);this._remuxer||(this._remuxer=new W(this._config)),a.onError=this._onDemuxException.bind(this),a.onMediaInfo=this._onMediaInfo.bind(this),a.onMetaDataArrived=this._onMetaDataArrived.bind(this),a.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),a.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),a.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),a.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),a.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),a.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),a.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._onMediaInfo=function(t){var a=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},t),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,g.a.prototype));var o=Object.assign({},t);Object.setPrototypeOf(o,g.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=o,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var r=a._pendingSeekTime;a._pendingSeekTime=null,a.seek(r)})},e.prototype._onMetaDataArrived=function(t){this._emitter.emit(se.a.METADATA_ARRIVED,t)},e.prototype._onScriptDataArrived=function(t){this._emitter.emit(se.a.SCRIPTDATA_ARRIVED,t)},e.prototype._onTimedID3Metadata=function(t){var a=this._remuxer.getTimestampBase();a!=null&&(t.pts!=null&&(t.pts-=a),t.dts!=null&&(t.dts-=a),this._emitter.emit(se.a.TIMED_ID3_METADATA_ARRIVED,t))},e.prototype._onSynchronousKLVMetadata=function(t){var a=this._remuxer.getTimestampBase();a!=null&&(t.pts!=null&&(t.pts-=a),t.dts!=null&&(t.dts-=a),this._emitter.emit(se.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,t))},e.prototype._onAsynchronousKLVMetadata=function(t){this._emitter.emit(se.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)},e.prototype._onSMPTE2038Metadata=function(t){var a=this._remuxer.getTimestampBase();a!=null&&(t.pts!=null&&(t.pts-=a),t.dts!=null&&(t.dts-=a),t.nearest_pts!=null&&(t.nearest_pts-=a),this._emitter.emit(se.a.SMPTE2038_METADATA_ARRIVED,t))},e.prototype._onSCTE35Metadata=function(t){var a=this._remuxer.getTimestampBase();a!=null&&(t.pts!=null&&(t.pts-=a),t.nearest_pts!=null&&(t.nearest_pts-=a),this._emitter.emit(se.a.SCTE35_METADATA_ARRIVED,t))},e.prototype._onPESPrivateDataDescriptor=function(t){this._emitter.emit(se.a.PES_PRIVATE_DATA_DESCRIPTOR,t)},e.prototype._onPESPrivateData=function(t){var a=this._remuxer.getTimestampBase();a!=null&&(t.pts!=null&&(t.pts-=a),t.nearest_pts!=null&&(t.nearest_pts-=a),t.dts!=null&&(t.dts-=a),this._emitter.emit(se.a.PES_PRIVATE_DATA_ARRIVED,t))},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(t){var a=t+1;a<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(a)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(se.a.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(t){var a=this._ioctl.extraData;this._mediaDataSource.segments[a].redirectedURL=t},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(se.a.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(t,a){T.a.e(this.TAG,"IOException: type = ".concat(t,", code = ").concat(a.code,", msg = ").concat(a.msg)),this._emitter.emit(se.a.IO_ERROR,t,a),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(t,a){T.a.e(this.TAG,"DemuxException: type = ".concat(t,", info = ").concat(a)),this._emitter.emit(se.a.DEMUX_ERROR,t,a)},e.prototype._onRemuxerInitSegmentArrival=function(t,a){this._emitter.emit(se.a.INIT_SEGMENT,t,a)},e.prototype._onRemuxerMediaSegmentArrival=function(t,a){if(this._pendingSeekTime==null&&(this._emitter.emit(se.a.MEDIA_SEGMENT,t,a),this._pendingResolveSeekPoint!=null&&t==="video")){var o=a.info.syncPoints,r=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,u.a.safari&&o.length>0&&o[0].originalDts===r&&(r=o[0].pts),this._emitter.emit(se.a.RECOMMEND_SEEKPOINT,r)}},e.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(t){var a=this._mediaInfo.segments[t],o=Object.assign({},a);o.duration=this._mediaInfo.duration,o.segmentCount=this._mediaInfo.segmentCount,delete o.segments,delete o.keyframesIndex,this._emitter.emit(se.a.MEDIA_INFO,o)},e.prototype._reportStatisticsInfo=function(){var t={};t.url=this._ioctl.currentURL,t.hasRedirect=this._ioctl.hasRedirect,t.hasRedirect&&(t.redirectedURL=this._ioctl.currentRedirectedURL),t.speed=this._ioctl.currentSpeed,t.loaderType=this._ioctl.loaderType,t.currentSegmentIndex=this._currentSegmentIndex,t.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(se.a.STATISTICS_INFO,t)},e}());oe.a=R},function(pe,oe,x){var V=function(){function k(){}return k.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(T,u){return T.__proto__=u,T},Object.assign=Object.assign||function(T){if(T==null)throw new TypeError("Cannot convert undefined or null to object");for(var u=Object(T),g=1;g<arguments.length;g++){var i=arguments[g];if(i!=null)for(var h in i)i.hasOwnProperty(h)&&(u[h]=i[h])}return u},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(T,u){var g=u>0?0|u:0;return this.substring(g,g+T.length)===T}}),typeof self.Promise!="function"&&x(26).polyfill()},k}();V.install(),oe.a=V},function(pe,oe,x){function V(g){var i={};function h(A){if(i[A])return i[A].exports;var E=i[A]={i:A,l:!1,exports:{}};return g[A].call(E.exports,E,E.exports,h),E.l=!0,E.exports}h.m=g,h.c=i,h.i=function(A){return A},h.d=function(A,E,O){h.o(A,E)||Object.defineProperty(A,E,{configurable:!1,enumerable:!0,get:O})},h.r=function(A){Object.defineProperty(A,"__esModule",{value:!0})},h.n=function(A){var E=A&&A.__esModule?function(){return A.default}:function(){return A};return h.d(E,"a",E),E},h.o=function(A,E){return Object.prototype.hasOwnProperty.call(A,E)},h.p="/",h.oe=function(A){throw console.error(A),A};var p=h(h.s=ENTRY_MODULE);return p.default||p}function k(g){return(g+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function T(g,i,h){var p={};p[h]=[];var A=i.toString(),E=A.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!E)return p;for(var O,F=E[1],P=new RegExp("(\\\\n|\\W)"+k(F)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");O=P.exec(A);)O[3]!=="dll-reference"&&p[h].push(O[3]);for(P=new RegExp("\\("+k(F)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");O=P.exec(A);)g[O[2]]||(p[h].push(O[1]),g[O[2]]=x(O[1]).m),p[O[2]]=p[O[2]]||[],p[O[2]].push(O[4]);for(var j,H=Object.keys(p),C=0;C<H.length;C++)for(var Z=0;Z<p[H[C]].length;Z++)j=p[H[C]][Z],isNaN(1*j)||(p[H[C]][Z]=1*p[H[C]][Z]);return p}function u(g){return Object.keys(g).reduce(function(i,h){return i||g[h].length>0},!1)}pe.exports=function(g,i){i=i||{};var h={main:x.m},p=i.all?{main:Object.keys(h.main)}:function(P,j){for(var H={main:[j]},C={main:[]},Z={main:{}};u(H);)for(var ie=Object.keys(H),U=0;U<ie.length;U++){var c=ie[U],d=H[c].pop();if(Z[c]=Z[c]||{},!Z[c][d]&&P[c][d]){Z[c][d]=!0,C[c]=C[c]||[],C[c].push(d);for(var _=T(P,P[c][d],c),m=Object.keys(_),q=0;q<m.length;q++)H[m[q]]=H[m[q]]||[],H[m[q]]=H[m[q]].concat(_[m[q]])}}return C}(h,g),A="";Object.keys(p).filter(function(P){return P!=="main"}).forEach(function(P){for(var j=0;p[P][j];)j++;p[P].push(j),h[P][j]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",A=A+"var "+P+" = ("+V.toString().replace("ENTRY_MODULE",JSON.stringify(j))+")({"+p[P].map(function(H){return JSON.stringify(H)+": "+h[P][H].toString()}).join(",")+`});
`}),A=A+"new (("+V.toString().replace("ENTRY_MODULE",JSON.stringify(g))+")({"+p.main.map(function(P){return JSON.stringify(P)+": "+h.main[P].toString()}).join(",")+"}))(self);";var E=new self.Blob([A],{type:"text/javascript"});if(i.bare)return E;var O=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(E),F=new self.Worker(O);return F.objectURL=O,F}},function(pe,oe,x){var V=x(10),k=x.n(V),T=x(0),u=x(5),g=x(7),i=x(3),h=function(){function p(A){this.TAG="MSEController",this._config=A,this._emitter=new k.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return p.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},p.prototype.on=function(A,E){this._emitter.addListener(A,E)},p.prototype.off=function(A,E){this._emitter.removeListener(A,E)},p.prototype.initialize=function(A){if(this._mediaSource)throw new i.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&T.a.v(this.TAG,"Using ManagedMediaSource");var E=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;E.addEventListener("sourceopen",this.e.onSourceOpen),E.addEventListener("sourceended",this.e.onSourceEnded),E.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(E.addEventListener("startstreaming",this.e.onStartStreaming),E.addEventListener("endstreaming",this.e.onEndStreaming),E.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=A},p.prototype.shutdown=function(){if(this._mediaSource){var A=this._mediaSource;for(var E in this._sourceBuffers){var O=this._pendingSegments[E];O.splice(0,O.length),this._pendingSegments[E]=null,this._pendingRemoveRanges[E]=null,this._lastInitSegments[E]=null;var F=this._sourceBuffers[E];if(F){if(A.readyState!=="closed"){try{A.removeSourceBuffer(F)}catch(P){T.a.e(this.TAG,P.message)}F.removeEventListener("error",this.e.onSourceBufferError),F.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[E]=null,this._sourceBuffers[E]=null}}if(A.readyState==="open")try{A.endOfStream()}catch(P){T.a.e(this.TAG,P.message)}this._mediaElementProxy=null,A.removeEventListener("sourceopen",this.e.onSourceOpen),A.removeEventListener("sourceended",this.e.onSourceEnded),A.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(A.removeEventListener("startstreaming",this.e.onStartStreaming),A.removeEventListener("endstreaming",this.e.onEndStreaming),A.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},p.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},p.prototype.getObject=function(){if(!this._mediaSource)throw new i.a("MediaSource has not been initialized yet!");return this._mediaSource},p.prototype.getHandle=function(){if(!this._mediaSource)throw new i.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},p.prototype.getObjectURL=function(){if(!this._mediaSource)throw new i.a("MediaSource has not been initialized yet!");return this._mediaSourceObjectURL==null&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},p.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},p.prototype.appendInitSegment=function(A,E){if(E===void 0&&(E=void 0),!this._mediaSource||this._mediaSource.readyState!=="open"||this._mediaSource.streaming===!1)return this._pendingSourceBufferInit.push(A),void this._pendingSegments[A.type].push(A);var O=A,F="".concat(O.container);O.codec&&O.codec.length>0&&(O.codec==="opus"&&u.a.safari&&(O.codec="Opus"),F+=";codecs=".concat(O.codec));var P=!1;if(T.a.v(this.TAG,"Received Initialization Segment, mimeType: "+F),this._lastInitSegments[O.type]=O,F!==this._mimeTypes[O.type]){if(this._mimeTypes[O.type])T.a.v(this.TAG,"Notice: ".concat(O.type," mimeType changed, origin: ").concat(this._mimeTypes[O.type],", target: ").concat(F));else{P=!0;try{var j=this._sourceBuffers[O.type]=this._mediaSource.addSourceBuffer(F);j.addEventListener("error",this.e.onSourceBufferError),j.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(H){return T.a.e(this.TAG,H.message),void this._emitter.emit(g.a.ERROR,{code:H.code,msg:H.message})}}this._mimeTypes[O.type]=F}E||this._pendingSegments[O.type].push(O),P||this._sourceBuffers[O.type]&&!this._sourceBuffers[O.type].updating&&this._doAppendSegments(),u.a.safari&&O.container==="audio/mpeg"&&O.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=O.mediaDuration/1e3,this._updateMediaSourceDuration())},p.prototype.appendMediaSegment=function(A){var E=A;this._pendingSegments[E.type].push(E),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var O=this._sourceBuffers[E.type];!O||O.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},p.prototype.flush=function(){for(var A in this._sourceBuffers)if(this._sourceBuffers[A]){var E=this._sourceBuffers[A];if(this._mediaSource.readyState==="open")try{E.abort()}catch(C){T.a.e(this.TAG,C.message)}var O=this._pendingSegments[A];if(O.splice(0,O.length),this._mediaSource.readyState!=="closed"){for(var F=0;F<E.buffered.length;F++){var P=E.buffered.start(F),j=E.buffered.end(F);this._pendingRemoveRanges[A].push({start:P,end:j})}if(E.updating||this._doRemoveRanges(),u.a.safari){var H=this._lastInitSegments[A];H&&(this._pendingSegments[A].push(H),E.updating||this._doAppendSegments())}}}},p.prototype.endOfStream=function(){var A=this._mediaSource,E=this._sourceBuffers;A&&A.readyState==="open"?E.video&&E.video.updating||E.audio&&E.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,A.endOfStream()):A&&A.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},p.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var A=this._mediaElementProxy.getCurrentTime();for(var E in this._sourceBuffers){var O=this._sourceBuffers[E];if(O){var F=O.buffered;if(F.length>=1&&A-F.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},p.prototype._doCleanupSourceBuffer=function(){var A=this._mediaElementProxy.getCurrentTime();for(var E in this._sourceBuffers){var O=this._sourceBuffers[E];if(O){for(var F=O.buffered,P=!1,j=0;j<F.length;j++){var H=F.start(j),C=F.end(j);if(H<=A&&A<C+3){if(A-H>=this._config.autoCleanupMaxBackwardDuration){P=!0;var Z=A-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[E].push({start:H,end:Z})}}else C<A&&(P=!0,this._pendingRemoveRanges[E].push({start:H,end:C}))}P&&!O.updating&&this._doRemoveRanges()}}},p.prototype._updateMediaSourceDuration=function(){var A=this._sourceBuffers;if(this._mediaElementProxy.getReadyState()!==0&&this._mediaSource.readyState==="open"&&!(A.video&&A.video.updating||A.audio&&A.audio.updating)){var E=this._mediaSource.duration,O=this._pendingMediaDuration;O>0&&(isNaN(E)||O>E)&&(T.a.v(this.TAG,"Update MediaSource duration from ".concat(E," to ").concat(O)),this._mediaSource.duration=O),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},p.prototype._doRemoveRanges=function(){for(var A in this._pendingRemoveRanges)if(this._sourceBuffers[A]&&!this._sourceBuffers[A].updating)for(var E=this._sourceBuffers[A],O=this._pendingRemoveRanges[A];O.length&&!E.updating;){var F=O.shift();E.remove(F.start,F.end)}},p.prototype._doAppendSegments=function(){var A=this._pendingSegments;for(var E in A)if(this._sourceBuffers[E]&&!this._sourceBuffers[E].updating&&this._mediaSource.streaming!==!1&&A[E].length>0){var O=A[E].shift();if(typeof O.timestampOffset=="number"&&isFinite(O.timestampOffset)){var F=this._sourceBuffers[E].timestampOffset,P=O.timestampOffset/1e3;Math.abs(F-P)>.1&&(T.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(F," to ").concat(P)),this._sourceBuffers[E].timestampOffset=P),delete O.timestampOffset}if(!O.data||O.data.byteLength===0)continue;try{this._sourceBuffers[E].appendBuffer(O.data),this._isBufferFull=!1}catch(j){this._pendingSegments[E].unshift(O),j.code===22?(this._isBufferFull||this._emitter.emit(g.a.BUFFER_FULL),this._isBufferFull=!0):(T.a.e(this.TAG,j.message),this._emitter.emit(g.a.ERROR,{code:j.code,msg:j.message}))}}},p.prototype._onSourceOpen=function(){if(T.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var A=this._pendingSourceBufferInit;A.length;){var E=A.shift();this.appendInitSegment(E,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(g.a.SOURCE_OPEN)},p.prototype._onStartStreaming=function(){T.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(g.a.START_STREAMING)},p.prototype._onEndStreaming=function(){T.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(g.a.END_STREAMING)},p.prototype._onQualityChange=function(){T.a.v(this.TAG,"ManagedMediaSource onQualityChange")},p.prototype._onSourceEnded=function(){T.a.v(this.TAG,"MediaSource onSourceEnded")},p.prototype._onSourceClose=function(){T.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstreaming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},p.prototype._hasPendingSegments=function(){var A=this._pendingSegments;return A.video.length>0||A.audio.length>0},p.prototype._hasPendingRemoveRanges=function(){var A=this._pendingRemoveRanges;return A.video.length>0||A.audio.length>0},p.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(g.a.UPDATE_END)},p.prototype._onSourceBufferError=function(A){T.a.e(this.TAG,"SourceBuffer Error: ".concat(A))},p}();oe.a=h},function(pe,oe,x){var V=x(10),k=x.n(V),T=x(20),u=x.n(T),g=x(0),i=x(9),h=x(18),p=x(1),A=(x(24),x(13)),E=x(14),O=function(){function F(P,j){if(this.TAG="Transmuxer",this._emitter=new k.a,j.enableWorker&&typeof Worker<"u")try{this._worker=u()(24),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[P,j]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},i.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:i.a.getConfig()})}catch{g.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new h.a(P,j)}else this._controller=new h.a(P,j);if(this._controller){var H=this._controller;H.on(p.a.IO_ERROR,this._onIOError.bind(this)),H.on(p.a.DEMUX_ERROR,this._onDemuxError.bind(this)),H.on(p.a.INIT_SEGMENT,this._onInitSegment.bind(this)),H.on(p.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),H.on(p.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),H.on(p.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),H.on(p.a.MEDIA_INFO,this._onMediaInfo.bind(this)),H.on(p.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),H.on(p.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),H.on(p.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),H.on(p.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),H.on(p.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),H.on(p.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),H.on(p.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),H.on(p.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),H.on(p.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),H.on(p.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),H.on(p.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return F.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),i.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},F.prototype.on=function(P,j){this._emitter.addListener(P,j)},F.prototype.off=function(P,j){this._emitter.removeListener(P,j)},F.prototype.hasWorker=function(){return this._worker!=null},F.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},F.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},F.prototype.seek=function(P){this._worker?this._worker.postMessage({cmd:"seek",param:P}):this._controller.seek(P)},F.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},F.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},F.prototype.switchPrimaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"primary"}):this._controller._demuxer instanceof E.a&&(this._controller._demuxer.preferred_secondary_audio=!1)},F.prototype.switchSecondaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"secondary"}):this._controller._demuxer instanceof E.a&&(this._controller._demuxer.preferred_secondary_audio=!0)},F.prototype._onInitSegment=function(P,j){var H=this;Promise.resolve().then(function(){H._emitter.emit(p.a.INIT_SEGMENT,P,j)})},F.prototype._onMediaSegment=function(P,j){var H=this;Promise.resolve().then(function(){H._emitter.emit(p.a.MEDIA_SEGMENT,P,j)})},F.prototype._onLoadingComplete=function(){var P=this;Promise.resolve().then(function(){P._emitter.emit(p.a.LOADING_COMPLETE)})},F.prototype._onRecoveredEarlyEof=function(){var P=this;Promise.resolve().then(function(){P._emitter.emit(p.a.RECOVERED_EARLY_EOF)})},F.prototype._onMediaInfo=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.MEDIA_INFO,P)})},F.prototype._onMetaDataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.METADATA_ARRIVED,P)})},F.prototype._onScriptDataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.SCRIPTDATA_ARRIVED,P)})},F.prototype._onTimedID3MetadataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.TIMED_ID3_METADATA_ARRIVED,P)})},F.prototype._onSynchronousKLVMetadataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,P)})},F.prototype._onAsynchronousKLVMetadataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,P)})},F.prototype._onSMPTE2038MetadataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.SMPTE2038_METADATA_ARRIVED,P)})},F.prototype._onSCTE35MetadataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.SCTE35_METADATA_ARRIVED,P)})},F.prototype._onPESPrivateDataDescriptor=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.PES_PRIVATE_DATA_DESCRIPTOR,P)})},F.prototype._onPESPrivateDataArrived=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.PES_PRIVATE_DATA_ARRIVED,P)})},F.prototype._onStatisticsInfo=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.STATISTICS_INFO,P)})},F.prototype._onIOError=function(P,j){var H=this;Promise.resolve().then(function(){H._emitter.emit(p.a.IO_ERROR,P,j)})},F.prototype._onDemuxError=function(P,j){var H=this;Promise.resolve().then(function(){H._emitter.emit(p.a.DEMUX_ERROR,P,j)})},F.prototype._onRecommendSeekpoint=function(P){var j=this;Promise.resolve().then(function(){j._emitter.emit(p.a.RECOMMEND_SEEKPOINT,P)})},F.prototype._onLoggingConfigChanged=function(P){this._worker&&this._worker.postMessage({cmd:"logging_config",param:P})},F.prototype._onWorkerMessage=function(P){var j=P.data,H=j.data;if(j.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(j.msg){case p.a.INIT_SEGMENT:case p.a.MEDIA_SEGMENT:this._emitter.emit(j.msg,H.type,H.data);break;case p.a.LOADING_COMPLETE:case p.a.RECOVERED_EARLY_EOF:this._emitter.emit(j.msg);break;case p.a.MEDIA_INFO:Object.setPrototypeOf(H,A.a.prototype),this._emitter.emit(j.msg,H);break;case p.a.METADATA_ARRIVED:case p.a.SCRIPTDATA_ARRIVED:case p.a.TIMED_ID3_METADATA_ARRIVED:case p.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case p.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case p.a.SMPTE2038_METADATA_ARRIVED:case p.a.SCTE35_METADATA_ARRIVED:case p.a.PES_PRIVATE_DATA_DESCRIPTOR:case p.a.PES_PRIVATE_DATA_ARRIVED:case p.a.STATISTICS_INFO:this._emitter.emit(j.msg,H);break;case p.a.IO_ERROR:case p.a.DEMUX_ERROR:this._emitter.emit(j.msg,H.type,H.info);break;case p.a.RECOMMEND_SEEKPOINT:this._emitter.emit(j.msg,H);break;case"logcat_callback":g.a.emitter.emit("log",H.type,H.logcat)}},F}();oe.a=O},function(pe,oe,x){var V=x(8),k=function(){function T(){}return T._ebsp2rbsp=function(u){for(var g=u,i=g.byteLength,h=new Uint8Array(i),p=0,A=0;A<i;A++)A>=2&&g[A]===3&&g[A-1]===0&&g[A-2]===0||(h[p]=g[A],p++);return new Uint8Array(h.buffer,0,p)},T.parseSPS=function(u){for(var g=u.subarray(1,4),i="avc1.",h=0;h<3;h++){var p=g[h].toString(16);p.length<2&&(p="0"+p),i+=p}var A=T._ebsp2rbsp(u),E=new V.a(A);E.readByte();var O=E.readByte();E.readByte();var F=E.readByte();E.readUEG();var P=T.getProfileString(O),j=T.getLevelString(F),H=1,C=420,Z=8,ie=8;if((O===100||O===110||O===122||O===244||O===44||O===83||O===86||O===118||O===128||O===138||O===144)&&((H=E.readUEG())===3&&E.readBits(1),H<=3&&(C=[0,420,422,444][H]),Z=E.readUEG()+8,ie=E.readUEG()+8,E.readBits(1),E.readBool()))for(var U=H!==3?8:12,c=0;c<U;c++)E.readBool()&&(c<6?T._skipScalingList(E,16):T._skipScalingList(E,64));E.readUEG();var d=E.readUEG();if(d===0)E.readUEG();else if(d===1){E.readBits(1),E.readSEG(),E.readSEG();var _=E.readUEG();for(c=0;c<_;c++)E.readSEG()}var m=E.readUEG();E.readBits(1);var q=E.readUEG(),te=E.readUEG(),ne=E.readBits(1);ne===0&&E.readBits(1),E.readBits(1);var Y=0,W=0,he=0,se=0;E.readBool()&&(Y=E.readUEG(),W=E.readUEG(),he=E.readUEG(),se=E.readUEG());var R=1,e=1,t=0,a=!0,o=0,r=0;if(E.readBool()){if(E.readBool()){var v=E.readByte();v>0&&v<16?(R=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][v-1],e=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][v-1]):v===255&&(R=E.readByte()<<8|E.readByte(),e=E.readByte()<<8|E.readByte())}if(E.readBool()&&E.readBool(),E.readBool()&&(E.readBits(4),E.readBool()&&E.readBits(24)),E.readBool()&&(E.readUEG(),E.readUEG()),E.readBool()){var L=E.readBits(32),b=E.readBits(32);a=E.readBool(),t=(o=b)/(r=2*L)}}var M=1;R===1&&e===1||(M=R/e);var N=0,I=0;H===0?(N=1,I=2-ne):(N=H===3?1:2,I=(H===1?2:1)*(2-ne));var z=16*(q+1),K=16*(te+1)*(2-ne);z-=(Y+W)*N,K-=(he+se)*I;var ae=Math.ceil(z*M);return E.destroy(),E=null,{codec_mimetype:i,profile_idc:O,level_idc:F,profile_string:P,level_string:j,chroma_format_idc:H,bit_depth:Z,bit_depth_luma:Z,bit_depth_chroma:ie,ref_frames:m,chroma_format:C,chroma_format_string:T.getChromaFormatString(C),frame_rate:{fixed:a,fps:t,fps_den:r,fps_num:o},sar_ratio:{width:R,height:e},codec_size:{width:z,height:K},present_size:{width:ae,height:K}}},T._skipScalingList=function(u,g){for(var i=8,h=8,p=0;p<g;p++)h!==0&&(h=(i+u.readSEG()+256)%256),i=h===0?i:h},T.getProfileString=function(u){switch(u){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},T.getLevelString=function(u){return(u/10).toFixed(1)},T.getChromaFormatString=function(u){switch(u){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},T}();oe.a=k},function(pe,oe,x){x.r(oe),x(0);var V=x(9),k=x(19),T=x(18),u=x(1),g=x(14);oe.default=function(i){var h=null,p=(function(Y,W){i.postMessage({msg:"logcat_callback",data:{type:Y,logcat:W}})}).bind(this);function A(Y,W){var he={msg:u.a.INIT_SEGMENT,data:{type:Y,data:W}};i.postMessage(he,[W.data])}function E(Y,W){var he={msg:u.a.MEDIA_SEGMENT,data:{type:Y,data:W}};i.postMessage(he,[W.data])}function O(){var Y={msg:u.a.LOADING_COMPLETE};i.postMessage(Y)}function F(){var Y={msg:u.a.RECOVERED_EARLY_EOF};i.postMessage(Y)}function P(Y){var W={msg:u.a.MEDIA_INFO,data:Y};i.postMessage(W)}function j(Y){var W={msg:u.a.METADATA_ARRIVED,data:Y};i.postMessage(W)}function H(Y){var W={msg:u.a.SCRIPTDATA_ARRIVED,data:Y};i.postMessage(W)}function C(Y){var W={msg:u.a.TIMED_ID3_METADATA_ARRIVED,data:Y};i.postMessage(W)}function Z(Y){var W={msg:u.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:Y};i.postMessage(W)}function ie(Y){var W={msg:u.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:Y};i.postMessage(W)}function U(Y){var W={msg:u.a.SMPTE2038_METADATA_ARRIVED,data:Y};i.postMessage(W)}function c(Y){var W={msg:u.a.SCTE35_METADATA_ARRIVED,data:Y};i.postMessage(W)}function d(Y){var W={msg:u.a.PES_PRIVATE_DATA_DESCRIPTOR,data:Y};i.postMessage(W)}function _(Y){var W={msg:u.a.PES_PRIVATE_DATA_ARRIVED,data:Y};i.postMessage(W)}function m(Y){var W={msg:u.a.STATISTICS_INFO,data:Y};i.postMessage(W)}function q(Y,W){i.postMessage({msg:u.a.IO_ERROR,data:{type:Y,info:W}})}function te(Y,W){i.postMessage({msg:u.a.DEMUX_ERROR,data:{type:Y,info:W}})}function ne(Y){i.postMessage({msg:u.a.RECOMMEND_SEEKPOINT,data:Y})}k.a.install(),i.addEventListener("message",function(Y){switch(Y.data.cmd){case"init":(h=new T.a(Y.data.param[0],Y.data.param[1])).on(u.a.IO_ERROR,q.bind(this)),h.on(u.a.DEMUX_ERROR,te.bind(this)),h.on(u.a.INIT_SEGMENT,A.bind(this)),h.on(u.a.MEDIA_SEGMENT,E.bind(this)),h.on(u.a.LOADING_COMPLETE,O.bind(this)),h.on(u.a.RECOVERED_EARLY_EOF,F.bind(this)),h.on(u.a.MEDIA_INFO,P.bind(this)),h.on(u.a.METADATA_ARRIVED,j.bind(this)),h.on(u.a.SCRIPTDATA_ARRIVED,H.bind(this)),h.on(u.a.TIMED_ID3_METADATA_ARRIVED,C.bind(this)),h.on(u.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,Z.bind(this)),h.on(u.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,ie.bind(this)),h.on(u.a.SMPTE2038_METADATA_ARRIVED,U.bind(this)),h.on(u.a.SCTE35_METADATA_ARRIVED,c.bind(this)),h.on(u.a.PES_PRIVATE_DATA_DESCRIPTOR,d.bind(this)),h.on(u.a.PES_PRIVATE_DATA_ARRIVED,_.bind(this)),h.on(u.a.STATISTICS_INFO,m.bind(this)),h.on(u.a.RECOMMEND_SEEKPOINT,ne.bind(this));break;case"destroy":h&&(h.destroy(),h=null),i.postMessage({msg:"destroyed"});break;case"start":h.start();break;case"stop":h.stop();break;case"seek":h.seek(Y.data.param);break;case"pause":h.pause();break;case"resume":h.resume();break;case"logging_config":var W=Y.data.param;V.a.applyConfig(W),W.enableCallback===!0?V.a.addLogListener(p):V.a.removeLogListener(p);break;case"switch_audio":h._demuxer instanceof g.a&&(Y.data.param==="primary"?h._demuxer.preferred_secondary_audio=!1:Y.data.param==="secondary"&&(h._demuxer.preferred_secondary_audio=!0))}})}},function(pe,oe,x){pe.exports=x(30).default},function(pe,oe,x){(function(V,k){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var T;T=function(){function u(b){return typeof b=="function"}var g=Array.isArray?Array.isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"},i=0,h=void 0,p=void 0,A=function(b,M){C[i]=b,C[i+1]=M,(i+=2)===2&&(p?p(Z):_())},E=typeof window<"u"?window:void 0,O=E||{},F=O.MutationObserver||O.WebKitMutationObserver,P=typeof self>"u"&&V!==void 0&&{}.toString.call(V)==="[object process]",j=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function H(){var b=setTimeout;return function(){return b(Z,1)}}var C=new Array(1e3);function Z(){for(var b=0;b<i;b+=2)(0,C[b])(C[b+1]),C[b]=void 0,C[b+1]=void 0;i=0}var ie,U,c,d,_=void 0;function m(b,M){var N=this,I=new this.constructor(ne);I[te]===void 0&&r(I);var z=N._state;if(z){var K=arguments[z-1];A(function(){return a(z,I,K,N._result)})}else e(N,I,b,M);return I}function q(b){if(b&&typeof b=="object"&&b.constructor===this)return b;var M=new this(ne);return W(M,b),M}P?_=function(){return V.nextTick(Z)}:F?(U=0,c=new F(Z),d=document.createTextNode(""),c.observe(d,{characterData:!0}),_=function(){d.data=U=++U%2}):j?((ie=new MessageChannel).port1.onmessage=Z,_=function(){return ie.port2.postMessage(0)}):_=E===void 0?function(){try{var b=Function("return this")().require("vertx");return(h=b.runOnLoop||b.runOnContext)!==void 0?function(){h(Z)}:H()}catch{return H()}}():H();var te=Math.random().toString(36).substring(2);function ne(){}function Y(b,M,N){M.constructor===b.constructor&&N===m&&M.constructor.resolve===q?function(I,z){z._state===1?se(I,z._result):z._state===2?R(I,z._result):e(z,void 0,function(K){return W(I,K)},function(K){return R(I,K)})}(b,M):N===void 0?se(b,M):u(N)?function(I,z,K){A(function(ae){var re=!1,le=function(ee,fe,me,_e){try{ee.call(fe,me,_e)}catch(ye){return ye}}(K,z,function(ee){re||(re=!0,z!==ee?W(ae,ee):se(ae,ee))},function(ee){re||(re=!0,R(ae,ee))},ae._label);!re&&le&&(re=!0,R(ae,le))},I)}(b,M,N):se(b,M)}function W(b,M){if(b===M)R(b,new TypeError("You cannot resolve a promise with itself"));else if(z=typeof(I=M),I===null||z!=="object"&&z!=="function")se(b,M);else{var N=void 0;try{N=M.then}catch(K){return void R(b,K)}Y(b,M,N)}var I,z}function he(b){b._onerror&&b._onerror(b._result),t(b)}function se(b,M){b._state===void 0&&(b._result=M,b._state=1,b._subscribers.length!==0&&A(t,b))}function R(b,M){b._state===void 0&&(b._state=2,b._result=M,A(he,b))}function e(b,M,N,I){var z=b._subscribers,K=z.length;b._onerror=null,z[K]=M,z[K+1]=N,z[K+2]=I,K===0&&b._state&&A(t,b)}function t(b){var M=b._subscribers,N=b._state;if(M.length!==0){for(var I=void 0,z=void 0,K=b._result,ae=0;ae<M.length;ae+=3)I=M[ae],z=M[ae+N],I?a(N,I,z,K):z(K);b._subscribers.length=0}}function a(b,M,N,I){var z=u(N),K=void 0,ae=void 0,re=!0;if(z){try{K=N(I)}catch(le){re=!1,ae=le}if(M===K)return void R(M,new TypeError("A promises callback cannot return that same promise."))}else K=I;M._state!==void 0||(z&&re?W(M,K):re===!1?R(M,ae):b===1?se(M,K):b===2&&R(M,K))}var o=0;function r(b){b[te]=o++,b._state=void 0,b._result=void 0,b._subscribers=[]}var v=function(){function b(M,N){this._instanceConstructor=M,this.promise=new M(ne),this.promise[te]||r(this.promise),g(N)?(this.length=N.length,this._remaining=N.length,this._result=new Array(this.length),this.length===0?se(this.promise,this._result):(this.length=this.length||0,this._enumerate(N),this._remaining===0&&se(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}return b.prototype._enumerate=function(M){for(var N=0;this._state===void 0&&N<M.length;N++)this._eachEntry(M[N],N)},b.prototype._eachEntry=function(M,N){var I=this._instanceConstructor,z=I.resolve;if(z===q){var K=void 0,ae=void 0,re=!1;try{K=M.then}catch(ee){re=!0,ae=ee}if(K===m&&M._state!==void 0)this._settledAt(M._state,N,M._result);else if(typeof K!="function")this._remaining--,this._result[N]=M;else if(I===L){var le=new I(ne);re?R(le,ae):Y(le,M,K),this._willSettleAt(le,N)}else this._willSettleAt(new I(function(ee){return ee(M)}),N)}else this._willSettleAt(z(M),N)},b.prototype._settledAt=function(M,N,I){var z=this.promise;z._state===void 0&&(this._remaining--,M===2?R(z,I):this._result[N]=I),this._remaining===0&&se(z,this._result)},b.prototype._willSettleAt=function(M,N){var I=this;e(M,void 0,function(z){return I._settledAt(1,N,z)},function(z){return I._settledAt(2,N,z)})},b}(),L=function(){function b(M){this[te]=o++,this._result=this._state=void 0,this._subscribers=[],ne!==M&&(typeof M!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof b?function(N,I){try{I(function(z){W(N,z)},function(z){R(N,z)})}catch(z){R(N,z)}}(this,M):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return b.prototype.catch=function(M){return this.then(null,M)},b.prototype.finally=function(M){var N=this.constructor;return u(M)?this.then(function(I){return N.resolve(M()).then(function(){return I})},function(I){return N.resolve(M()).then(function(){throw I})}):this.then(M,M)},b}();return L.prototype.then=m,L.all=function(b){return new v(this,b).promise},L.race=function(b){var M=this;return g(b)?new M(function(N,I){for(var z=b.length,K=0;K<z;K++)M.resolve(b[K]).then(N,I)}):new M(function(N,I){return I(new TypeError("You must pass an array to race."))})},L.resolve=q,L.reject=function(b){var M=new this(ne);return R(M,b),M},L._setScheduler=function(b){p=b},L._setAsap=function(b){A=b},L._asap=A,L.polyfill=function(){var b=void 0;if(k!==void 0)b=k;else if(typeof self<"u")b=self;else try{b=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var M=b.Promise;if(M){var N=null;try{N=Object.prototype.toString.call(M.resolve())}catch{}if(N==="[object Promise]"&&!M.cast)return}b.Promise=L},L.Promise=L,L},pe.exports=T()}).call(this,x(27),x(28))},function(pe,oe){var x,V,k=pe.exports={};function T(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function g(j){if(x===setTimeout)return setTimeout(j,0);if((x===T||!x)&&setTimeout)return x=setTimeout,setTimeout(j,0);try{return x(j,0)}catch{try{return x.call(null,j,0)}catch{return x.call(this,j,0)}}}(function(){try{x=typeof setTimeout=="function"?setTimeout:T}catch{x=T}try{V=typeof clearTimeout=="function"?clearTimeout:u}catch{V=u}})();var i,h=[],p=!1,A=-1;function E(){p&&i&&(p=!1,i.length?h=i.concat(h):A=-1,h.length&&O())}function O(){if(!p){var j=g(E);p=!0;for(var H=h.length;H;){for(i=h,h=[];++A<H;)i&&i[A].run();A=-1,H=h.length}i=null,p=!1,function(C){if(V===clearTimeout)return clearTimeout(C);if((V===u||!V)&&clearTimeout)return V=clearTimeout,clearTimeout(C);try{V(C)}catch{try{return V.call(null,C)}catch{return V.call(this,C)}}}(j)}}function F(j,H){this.fun=j,this.array=H}function P(){}k.nextTick=function(j){var H=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)H[C-1]=arguments[C];h.push(new F(j,H)),h.length!==1||p||g(O)},F.prototype.run=function(){this.fun.apply(null,this.array)},k.title="browser",k.browser=!0,k.env={},k.argv=[],k.version="",k.versions={},k.on=P,k.addListener=P,k.once=P,k.off=P,k.removeListener=P,k.removeAllListeners=P,k.emit=P,k.prependListener=P,k.prependOnceListener=P,k.listeners=function(j){return[]},k.binding=function(j){throw new Error("process.binding is not supported")},k.cwd=function(){return"/"},k.chdir=function(j){throw new Error("process.chdir is not supported")},k.umask=function(){return 0}},function(pe,oe){var x;x=function(){return this}();try{x=x||new Function("return this")()}catch{typeof window=="object"&&(x=window)}pe.exports=x},function(pe,oe,x){x.r(oe);var V=x(0),k=x(9),T=x(3),u=x(7),g=x(21),i=x(22),h=x(1),p=x(4),A=x(11);oe.default=function(E){var O="PlayerEngineWorker",F=(function(R,e){E.postMessage({msg:"logcat_callback",type:R,logcat:e})}).bind(void 0),P=null,j=null,H=null,C=null,Z=!1,ie=!1,U=0,c=0,d=!1;function _(){H&&(H.shutdown(),H.destroy(),H=null)}function m(){if(P==null||j==null)throw new T.a("Worker not initialized");if(C)throw new T.a("Transmuxer has been initialized");ie||(!j.deferLoadAfterSourceOpen||Z?((C=new i.a(P,j)).on(h.a.INIT_SEGMENT,function(R,e){H.appendInitSegment(e)}),C.on(h.a.MEDIA_SEGMENT,function(R,e){H.appendMediaSegment(e),E.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:e.info.endDts})}),C.on(h.a.LOADING_COMPLETE,function(){H.endOfStream(),E.postMessage({msg:"player_event",event:p.a.LOADING_COMPLETE})}),C.on(h.a.RECOVERED_EARLY_EOF,function(){E.postMessage({msg:"player_event",event:p.a.RECOVERED_EARLY_EOF})}),C.on(h.a.IO_ERROR,function(R,e){E.postMessage({msg:"player_event",event:p.a.ERROR,error_type:A.b.NETWORK_ERROR,error_detail:R,info:e})}),C.on(h.a.DEMUX_ERROR,function(R,e){E.postMessage({msg:"player_event",event:p.a.ERROR,error_type:A.b.MEDIA_ERROR,error_detail:R,info:e})}),C.on(h.a.MEDIA_INFO,function(R){he(h.a.MEDIA_INFO,R)}),C.on(h.a.STATISTICS_INFO,function(R){he(h.a.STATISTICS_INFO,R)}),C.on(h.a.RECOMMEND_SEEKPOINT,function(R){(function(e){E.postMessage({msg:"transmuxing_event",event:h.a.RECOMMEND_SEEKPOINT,milliseconds:e})})(R)}),C.on(h.a.METADATA_ARRIVED,function(R){se(p.a.METADATA_ARRIVED,R)}),C.on(h.a.SCRIPTDATA_ARRIVED,function(R){se(p.a.SCRIPTDATA_ARRIVED,R)}),C.on(h.a.TIMED_ID3_METADATA_ARRIVED,function(R){se(p.a.TIMED_ID3_METADATA_ARRIVED,R)}),C.on(h.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(R){se(p.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,R)}),C.on(h.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(R){se(p.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,R)}),C.on(h.a.SMPTE2038_METADATA_ARRIVED,function(R){se(p.a.SMPTE2038_METADATA_ARRIVED,R)}),C.on(h.a.SCTE35_METADATA_ARRIVED,function(R){se(p.a.SCTE35_METADATA_ARRIVED,R)}),C.on(h.a.PES_PRIVATE_DATA_DESCRIPTOR,function(R){se(p.a.PES_PRIVATE_DATA_DESCRIPTOR,R)}),C.on(h.a.PES_PRIVATE_DATA_ARRIVED,function(R){se(p.a.PES_PRIVATE_DATA_ARRIVED,R)}),C.open()):ie=!0)}function q(){H&&H.flush(),C&&(C.close(),C.destroy(),C=null)}function te(){Z=!0,ie&&(ie=!1,m())}function ne(){E.postMessage({msg:"mse_event",event:u.a.UPDATE_END})}function Y(){V.a.v(O,"MSE SourceBuffer is full, report to main thread"),E.postMessage({msg:"mse_event",event:u.a.BUFFER_FULL})}function W(R){E.postMessage({msg:"player_event",event:p.a.ERROR,error_type:A.b.MEDIA_ERROR,error_detail:A.b.MEDIA_MSE_ERROR,info:R})}function he(R,e){E.postMessage({msg:"transmuxing_event",event:R,info:e})}function se(R,e){E.postMessage({msg:"player_event",event:R,extraData:e})}E.addEventListener("message",function(R){if(!d){var e=R.data;switch(e.cmd){case"logging_config":var t=e;k.a.applyConfig(t.logging_config),t.logging_config.enableCallback===!0?k.a.addLogListener(F):k.a.removeLogListener(F);break;case"init":P=(t=e).media_data_source,j=t.config;break;case"destroy":(function(){C&&q(),H&&_(),d=!0,E.postMessage({msg:"destroyed"})})();break;case"initialize_mse":(function(){V.a.v(O,"Initializing MediaSource in DedicatedWorker"),(H=new g.a(j)).on(u.a.SOURCE_OPEN,te.bind(this)),H.on(u.a.UPDATE_END,ne.bind(this)),H.on(u.a.BUFFER_FULL,Y.bind(this)),H.on(u.a.ERROR,W.bind(this)),H.initialize({getCurrentTime:function(){return U},getReadyState:function(){return c}});var a=H.getHandle();E.postMessage({msg:"mse_init",handle:a},[a])})();break;case"shutdown_mse":_();break;case"load":m();break;case"unload":q();break;case"unbuffered_seek":t=e,H.flush(),C.seek(t.milliseconds);break;case"timeupdate":U=(t=e).current_time;break;case"readystatechange":c=(t=e).ready_state;break;case"pause_transmuxer":C.pause();break;case"resume_transmuxer":C.resume();break;case"switch_audio":(t=e).audio_track==="primary"?C.switchPrimaryAudio():t.audio_track==="secondary"&&C.switchSecondaryAudio()}}})}},function(pe,oe,x){x.r(oe);var V=x(19),k=x(17),T={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,liveSyncMinLatency:void 0,liveSyncMinPlaybackRate:.95,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function u(){return Object.assign({},T)}var g=x(10),i=x.n(g),h=x(20),p=x(0),A=x(9),E=x(7),O=x(4),F=x(1),P=x(5),j=x(12),H=function(){function R(e,t,a){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new j.a,this.e=null,this._config=e,this._media_element=t,this._on_unbuffered_seek=a,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var o=P.a.chrome&&(P.a.version.major<50||P.a.version.major===50&&P.a.version.build<2661);this._always_seek_keyframe=!!(o||P.a.msedge||P.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return R.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},R.prototype.seek=function(e){var t=this._isPositionBuffered(e),a=!1;if(e<1&&this._media_element.buffered.length>0){var o=this._media_element.buffered.start(0);(o<1&&e<o||P.a.safari)&&(a=!0,e=P.a.safari?.1:o)}if(a)this.directSeek(e);else if(t)if(this._always_seek_keyframe){var r=this._getNearestKeyframe(Math.floor(1e3*e));r!=null&&(e=r.dts/1e3),this.directSeek(e)}else this.directSeek(e);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*e)),this._config.accurateSeek&&this.directSeek(e)},R.prototype.directSeek=function(e){this._request_set_current_time=!0,this._media_element.currentTime=e},R.prototype.appendSyncPoints=function(e){this._idr_sample_list.appendArray(e)},R.prototype._onMediaSeeking=function(e){if(this._request_set_current_time)this._request_set_current_time=!1;else{var t=this._media_element.currentTime,a=this._media_element.buffered;if(t<1&&a.length>0){var o=a.start(0);if(o<1&&t<o||P.a.safari){var r=P.a.safari?.1:o;return void this.directSeek(r)}}if(this._isPositionBuffered(t)){if(this._always_seek_keyframe){var v=this._getNearestKeyframe(Math.floor(1e3*t));v!=null&&(t=v.dts/1e3,this.directSeek(t))}}else this._seek_request_record_clocktime=R._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},R.prototype._pollAndApplyUnbufferedSeek=function(){if(this._seek_request_record_clocktime!=null)if(this._seek_request_record_clocktime<=R._getClockTime()-100){var e=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(e)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*e)),this._config.accurateSeek&&this.directSeek(e))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},R.prototype._isPositionBuffered=function(e){for(var t=this._media_element.buffered,a=0;a<t.length;a++){var o=t.start(a),r=t.end(a);if(e>=o&&e<r)return!0}return!1},R.prototype._getNearestKeyframe=function(e){return this._idr_sample_list.getLastSyncPointBeforeDts(e)},R._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},R}(),C=function(){function R(e,t,a,o){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=e,this._media_element=t,this._on_pause_transmuxer=a,this._on_resume_transmuxer=o,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return R.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},R.prototype.notifyBufferedPositionChanged=function(e){!this._config.isLive&&this._config.lazyLoad&&(e==null?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(e))},R.prototype._onMediaTimeUpdate=function(e){this._paused&&this._resumeTransmuxerIfNeeded()},R.prototype._suspendTransmuxerIfNeeded=function(){for(var e=this._media_element.buffered,t=this._media_element.currentTime,a=0,o=0;o<e.length;o++){var r=e.start(o),v=e.end(o);if(r<=t&&t<v){a=v;break}}a>0&&this._suspendTransmuxerIfBufferedPositionExceeded(a)},R.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(e){e>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(p.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},R.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},R.prototype._resumeTransmuxerIfNeeded=function(){for(var e=this._media_element.buffered,t=this._media_element.currentTime,a=this._config.lazyLoadRecoverDuration,o=!1,r=0;r<e.length;r++){var v=e.start(r),L=e.end(r);if(t>=v&&t<L){t>=L-a&&(o=!0);break}}o&&(p.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},R.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},R}(),Z=function(){function R(e,t){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=e,this._on_direct_seek=t,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return R.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},R.prototype._onMediaCanPlay=function(e){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},R.prototype._onMediaStalled=function(e){this._detectAndFixStuckPlayback(!0)},R.prototype._onMediaProgress=function(e){this._detectAndFixStuckPlayback()},R.prototype._detectAndFixStuckPlayback=function(e){var t=this._media_element,a=t.buffered;e||!this._canplay_received||t.readyState<2?a.length>0&&t.currentTime<a.start(0)&&(p.a.w(this.TAG,"Playback seems stuck at ".concat(t.currentTime,", seek to ").concat(a.start(0))),this._on_direct_seek(a.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},R}(),ie=function(){function R(e,t,a){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=e,this._media_element=t,this._on_direct_seek=a}return R.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},R.prototype.notifyBufferedRangeUpdate=function(){this._chaseLiveLatency()},R.prototype._chaseLiveLatency=function(){var e=this._media_element.buffered,t=this._media_element.currentTime,a=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&e.length!=0&&(this._config.liveBufferLatencyChasingOnPaused||!a)){var o=e.end(e.length-1);if(o>this._config.liveBufferLatencyMaxLatency&&o-t>this._config.liveBufferLatencyMaxLatency){var r=o-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(r)}}},R}(),U=function(){function R(e,t){this.TAG="LiveLatencySynchronizer",this._config=null,this._media_element=null,this.e=null,this._config=e,this._media_element=t,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return R.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},R.prototype._onMediaTimeUpdate=function(e){if(this._config.isLive&&this._config.liveSync){var t=this._getCurrentLatency();if(t>this._config.liveSyncMaxLatency){var a=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate!==a&&(p.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => ").concat(a)),this._media_element.playbackRate=a)}else t>this._config.liveSyncTargetLatency||(this._config.liveSyncMinLatency!=null&&t<this._config.liveSyncMinLatency?(a=Math.min(1,Math.max(.5,this._config.liveSyncMinPlaybackRate)),this._media_element.playbackRate!==a&&(p.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => ").concat(a)),this._media_element.playbackRate=a)):this._media_element.playbackRate!==1&&this._media_element.playbackRate!==0&&(p.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => 1")),this._media_element.playbackRate=1))}},R.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var e=this._media_element.buffered,t=this._media_element.currentTime;return e.length==0?0:e.end(e.length-1)-t},R}(),c=function(){function R(e,t){this.TAG="PlayerEngineDedicatedThread",this._emitter=new g,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._prev_ready_state=0,this._media_data_source=e,this._config=u(),typeof t=="object"&&Object.assign(this._config,t),e.isLive===!0&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},A.a.registerListener(this.e.onLoggingConfigChanged),this._worker=h(29,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:A.a.getConfig()})}return R.isSupported=function(){return!!self.Worker&&(!(!self.MediaSource||!("canConstructInDedicatedWorker"in self.MediaSource)||self.MediaSource.canConstructInDedicatedWorker!==!0)||!(!self.ManagedMediaSource||!("canConstructInDedicatedWorker"in self.ManagedMediaSource)||self.ManagedMediaSource.canConstructInDedicatedWorker!==!0))},R.prototype.destroy=function(){this._emitter.emit(O.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),A.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(e,t){var a=this;this._emitter.addListener(e,t),e===O.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return a._emitter.emit(O.a.MEDIA_INFO,a.mediaInfo)}):e==O.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return a._emitter.emit(O.a.STATISTICS_INFO,a.statisticsInfo)})},R.prototype.off=function(e,t){this._emitter.removeListener(e,t)},R.prototype.attachMediaElement=function(e){this._media_element=e,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("emptied",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("ended",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("waiting",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("canplay",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("canplaythrough",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadstart",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadeddata",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadedmetadata",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("progress",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("stalled",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},R.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("emptied",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("ended",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("waiting",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("canplay",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("canplaythrough",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadstart",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadeddata",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("progress",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("stalled",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},R.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new H(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new C(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new Z(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new ie(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new U(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},R.prototype.unload=function(){var e,t,a,o,r,v;(e=this._media_element)===null||e===void 0||e.pause(),this._worker.postMessage({cmd:"unload"}),(t=this._live_latency_synchronizer)===null||t===void 0||t.destroy(),this._live_latency_synchronizer=null,(a=this._live_latency_chaser)===null||a===void 0||a.destroy(),this._live_latency_chaser=null,(o=this._startup_stall_jumper)===null||o===void 0||o.destroy(),this._startup_stall_jumper=null,(r=this._loading_controller)===null||r===void 0||r.destroy(),this._loading_controller=null,(v=this._seeking_handler)===null||v===void 0||v.destroy(),this._seeking_handler=null},R.prototype.play=function(){return this._media_element.play()},R.prototype.pause=function(){this._media_element.pause()},R.prototype.seek=function(e){this._media_element&&this._seeking_handler?this._seeking_handler.seek(e):this._pending_seek_time=e},R.prototype.switchPrimaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"primary"})},R.prototype.switchSecondaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"secondary"})},Object.defineProperty(R.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),R.prototype._onLoggingConfigChanged=function(e){var t;(t=this._worker)===null||t===void 0||t.postMessage({cmd:"logging_config",logging_config:e})},R.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},R.prototype._onMSEBufferFull=function(){p.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},R.prototype._onMediaLoadedMetadata=function(e){this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},R.prototype._onRequestDirectSeek=function(e){this._seeking_handler.directSeek(e)},R.prototype._onRequiredUnbufferedSeek=function(e){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:e})},R.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},R.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},R.prototype._onMediaTimeUpdate=function(e){this._worker.postMessage({cmd:"timeupdate",current_time:e.target.currentTime})},R.prototype._onMediaReadyStateChange=function(){var e;this._media_element!=null&&this._prev_ready_state!==((e=this._media_element)===null||e===void 0?void 0:e.readyState)&&(this._prev_ready_state=this._media_element.readyState,this._worker.postMessage({cmd:"readystatechange",ready_state:this._media_element.readyState}))},R.prototype._onWorkerMessage=function(e){var t,a=e.data,o=a.msg;if(o=="destroyed"||this._worker_destroying)return this._worker_destroying=!1,(t=this._worker)===null||t===void 0||t.terminate(),void(this._worker=null);switch(o){case"mse_init":var r=a;"ManagedMediaSource"in self&&!("MediaSource"in self)&&(this._media_element.disableRemotePlayback=!0),this._media_element.srcObject=r.handle;break;case"mse_event":(r=a).event==E.a.UPDATE_END?this._onMSEUpdateEnd():r.event==E.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((r=a).event==F.a.MEDIA_INFO){var v=a;this._media_info=v.info,this._emitter.emit(O.a.MEDIA_INFO,Object.assign({},v.info))}else if(r.event==F.a.STATISTICS_INFO){var L=a;this._statistics_info=this._fillStatisticsInfo(L.info),this._emitter.emit(O.a.STATISTICS_INFO,Object.assign({},L.info))}else if(r.event==F.a.RECOMMEND_SEEKPOINT){var b=a;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(b.milliseconds/1e3)}break;case"player_event":if((r=a).event==O.a.ERROR){var M=a;this._emitter.emit(O.a.ERROR,M.error_type,M.error_detail,M.info)}else if("extraData"in r){var N=a;this._emitter.emit(N.event,N.extraData)}break;case"logcat_callback":r=a,p.a.emitter.emit("log",r.type,r.logcat);break;case"buffered_position_changed":r=a,this._loading_controller.notifyBufferedPositionChanged(r.buffered_position_milliseconds/1e3)}},R.prototype._fillStatisticsInfo=function(e){if(e.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return e;var t=!0,a=0,o=0;if(this._media_element.getVideoPlaybackQuality){var r=this._media_element.getVideoPlaybackQuality();a=r.totalVideoFrames,o=r.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(a=this._media_element.webkitDecodedFrameCount,o=this._media_element.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=o),e},R}(),d=function(){function R(){}return R.supportMSEH264Playback=function(){var e=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return e===!0||t===!0},R.supportMSEH265Playback=function(){var e=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),t=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return e===!0||t===!0},R.supportWorkerForMSEH265Playback=function(){return new Promise(function(e){if(c.isSupported()){var t=URL.createObjectURL(new Blob([`
                const hevc_mime_type = 'video/mp4; codecs="hvc1.1.6.L93.B0"';
                const support_w3c_mse = self.MediaSource && self.MediaSource.isTypeSupported(hevc_mime_type);
                const support_apple_mme = self.ManagedMediaSource && self.ManagedMediaSource.isTypeSupported(hevc_mime_type);
                self.postMessage(support_w3c_mse === true || support_apple_mme === true);
            `],{type:"application/javascript"}));new Worker(t).addEventListener("message",function(a){return e(a.data)}),URL.revokeObjectURL(t)}else e(!1)})},R.supportNetworkStreamIO=function(){var e=new k.a({},u()),t=e.loaderType;return e.destroy(),t=="fetch-stream-loader"||t=="xhr-moz-chunked-loader"},R.getNetworkLoaderTypeName=function(){var e=new k.a({},u()),t=e.loaderType;return e.destroy(),t},R.supportNativeMediaPlayback=function(e){R.videoElement==null&&(R.videoElement=window.document.createElement("video"));var t=R.videoElement.canPlayType(e);return t==="probably"||t=="maybe"},R.getFeatureList=function(){var e={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return e.msePlayback=R.supportMSEH264Playback(),e.networkStreamIO=R.supportNetworkStreamIO(),e.networkLoaderName=R.getNetworkLoaderTypeName(),e.mseLivePlayback=e.msePlayback&&e.networkStreamIO,e.mseH265Playback=R.supportMSEH265Playback(),e.nativeMP4H264Playback=R.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),e.nativeMP4H265Playback=R.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),e.nativeWebmVP8Playback=R.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),e.nativeWebmVP9Playback=R.supportNativeMediaPlayback('video/webm; codecs="vp9"'),e},R}(),_=x(2),m=x(21),q=x(22),te=x(11),ne=x(3),Y=function(){function R(e,t){this.TAG="PlayerEngineMainThread",this._emitter=new g,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=e,this._config=u(),typeof t=="object"&&Object.assign(this._config,t),e.isLive===!0&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return R.prototype.destroy=function(){this._emitter.emit(O.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(e,t){var a=this;this._emitter.addListener(e,t),e===O.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return a._emitter.emit(O.a.MEDIA_INFO,a.mediaInfo)}):e==O.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return a._emitter.emit(O.a.STATISTICS_INFO,a.statisticsInfo)})},R.prototype.off=function(e,t){this._emitter.removeListener(e,t)},R.prototype.attachMediaElement=function(e){var t=this;this._media_element=e,e.src="",e.removeAttribute("src"),e.srcObject=null,e.load(),e.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new m.a(this._config),this._mse_controller.on(E.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(E.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(E.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(E.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(E.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(E.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return t._media_element.currentTime},getReadyState:function(){return t._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(e.disableRemotePlayback=!0,e.srcObject=this._mse_controller.getObject()):e.src=this._mse_controller.getObjectURL()},R.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},R.prototype.load=function(){var e=this;if(!this._media_element)throw new ne.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new ne.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new q.a(this._media_data_source,this._config),this._transmuxer.on(F.a.INIT_SEGMENT,function(t,a){e._mse_controller.appendInitSegment(a)}),this._transmuxer.on(F.a.MEDIA_SEGMENT,function(t,a){e._mse_controller.appendMediaSegment(a),!e._config.isLive&&t==="video"&&a.data&&a.data.byteLength>0&&"info"in a&&e._seeking_handler.appendSyncPoints(a.info.syncPoints),e._loading_controller.notifyBufferedPositionChanged(a.info.endDts/1e3)}),this._transmuxer.on(F.a.LOADING_COMPLETE,function(){e._mse_controller.endOfStream(),e._emitter.emit(O.a.LOADING_COMPLETE)}),this._transmuxer.on(F.a.RECOVERED_EARLY_EOF,function(){e._emitter.emit(O.a.RECOVERED_EARLY_EOF)}),this._transmuxer.on(F.a.IO_ERROR,function(t,a){e._emitter.emit(O.a.ERROR,te.b.NETWORK_ERROR,t,a)}),this._transmuxer.on(F.a.DEMUX_ERROR,function(t,a){e._emitter.emit(O.a.ERROR,te.b.MEDIA_ERROR,t,a)}),this._transmuxer.on(F.a.MEDIA_INFO,function(t){e._media_info=t,e._emitter.emit(O.a.MEDIA_INFO,Object.assign({},t))}),this._transmuxer.on(F.a.STATISTICS_INFO,function(t){e._statistics_info=e._fillStatisticsInfo(t),e._emitter.emit(O.a.STATISTICS_INFO,Object.assign({},t))}),this._transmuxer.on(F.a.RECOMMEND_SEEKPOINT,function(t){e._media_element&&!e._config.accurateSeek&&e._seeking_handler.directSeek(t/1e3)}),this._transmuxer.on(F.a.METADATA_ARRIVED,function(t){e._emitter.emit(O.a.METADATA_ARRIVED,t)}),this._transmuxer.on(F.a.SCRIPTDATA_ARRIVED,function(t){e._emitter.emit(O.a.SCRIPTDATA_ARRIVED,t)}),this._transmuxer.on(F.a.TIMED_ID3_METADATA_ARRIVED,function(t){e._emitter.emit(O.a.TIMED_ID3_METADATA_ARRIVED,t)}),this._transmuxer.on(F.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(t){e._emitter.emit(O.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,t)}),this._transmuxer.on(F.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(t){e._emitter.emit(O.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)}),this._transmuxer.on(F.a.SMPTE2038_METADATA_ARRIVED,function(t){e._emitter.emit(O.a.SMPTE2038_METADATA_ARRIVED,t)}),this._transmuxer.on(F.a.SCTE35_METADATA_ARRIVED,function(t){e._emitter.emit(O.a.SCTE35_METADATA_ARRIVED,t)}),this._transmuxer.on(F.a.PES_PRIVATE_DATA_DESCRIPTOR,function(t){e._emitter.emit(O.a.PES_PRIVATE_DATA_DESCRIPTOR,t)}),this._transmuxer.on(F.a.PES_PRIVATE_DATA_ARRIVED,function(t){e._emitter.emit(O.a.PES_PRIVATE_DATA_ARRIVED,t)}),this._seeking_handler=new H(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new C(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new Z(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new ie(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new U(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},R.prototype.unload=function(){var e,t,a,o,r,v,L,b,M;(e=this._media_element)===null||e===void 0||e.pause(),(t=this._live_latency_synchronizer)===null||t===void 0||t.destroy(),this._live_latency_synchronizer=null,(a=this._live_latency_chaser)===null||a===void 0||a.destroy(),this._live_latency_chaser=null,(o=this._startup_stall_jumper)===null||o===void 0||o.destroy(),this._startup_stall_jumper=null,(r=this._loading_controller)===null||r===void 0||r.destroy(),this._loading_controller=null,(v=this._seeking_handler)===null||v===void 0||v.destroy(),this._seeking_handler=null,(L=this._mse_controller)===null||L===void 0||L.flush(),(b=this._transmuxer)===null||b===void 0||b.close(),(M=this._transmuxer)===null||M===void 0||M.destroy(),this._transmuxer=null},R.prototype.play=function(){return this._media_element.play()},R.prototype.pause=function(){this._media_element.pause()},R.prototype.seek=function(e){this._media_element&&this._seeking_handler?this._seeking_handler.seek(e):this._pending_seek_time=e},R.prototype.switchPrimaryAudio=function(){this._transmuxer.switchPrimaryAudio()},R.prototype.switchSecondaryAudio=function(){this._transmuxer.switchSecondaryAudio()},Object.defineProperty(R.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),R.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},R.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},R.prototype._onMSEBufferFull=function(){p.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},R.prototype._onMSEError=function(e){this._emitter.emit(O.a.ERROR,te.b.MEDIA_ERROR,te.a.MEDIA_MSE_ERROR,e)},R.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(p.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},R.prototype._onMSEEndStreaming=function(){this._config.isLive||(p.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},R.prototype._onMediaLoadedMetadata=function(e){this._loaded_metadata_received=!0,this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},R.prototype._onRequestDirectSeek=function(e){this._seeking_handler.directSeek(e)},R.prototype._onRequiredUnbufferedSeek=function(e){this._mse_controller.flush(),this._transmuxer.seek(e)},R.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},R.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},R.prototype._fillStatisticsInfo=function(e){if(e.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return e;var t=!0,a=0,o=0;if(this._media_element.getVideoPlaybackQuality){var r=this._media_element.getVideoPlaybackQuality();a=r.totalVideoFrames,o=r.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(a=this._media_element.webkitDecodedFrameCount,o=this._media_element.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=o),e},R}(),W=function(){function R(e,t){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var a=e.type.toLowerCase();if(a!=="mse"&&a!=="mpegts"&&a!=="m2ts"&&a!=="flv")throw new ne.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");if(t&&t.enableWorkerForMSE&&c.isSupported())try{this._player_engine=new c(e,t)}catch{p.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new Y(e,t)}else this._player_engine=new Y(e,t)}return R.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},R.prototype.on=function(e,t){this._player_engine.on(e,t)},R.prototype.off=function(e,t){this._player_engine.off(e,t)},R.prototype.attachMediaElement=function(e){this._media_element=e,this._player_engine.attachMediaElement(e)},R.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},R.prototype.load=function(){this._player_engine.load()},R.prototype.unload=function(){this._player_engine.unload()},R.prototype.play=function(){return this._player_engine.play()},R.prototype.pause=function(){this._player_engine.pause()},R.prototype.switchPrimaryAudio=function(){this._player_engine.switchPrimaryAudio()},R.prototype.switchSecondaryAudio=function(){this._player_engine.switchSecondaryAudio()},Object.defineProperty(R.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"volume",{get:function(){return this._media_element.volume},set:function(e){this._media_element.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"muted",{get:function(){return this._media_element.muted},set:function(e){this._media_element.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(e){this._player_engine.seek(e)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),R}(),he=function(){function R(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new i.a,this._config=u(),typeof t=="object"&&Object.assign(this._config,t);var a=e.type.toLowerCase();if(a==="mse"||a==="mpegts"||a==="m2ts"||a==="flv")throw new ne.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new ne.b("NativePlayer(".concat(e.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return R.prototype.destroy=function(){this._emitter.emit(O.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(e,t){var a=this;e===O.a.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){a._emitter.emit(O.a.MEDIA_INFO,a.mediaInfo)}):e===O.a.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){a._emitter.emit(O.a.STATISTICS_INFO,a.statisticsInfo)}),this._emitter.addListener(e,t)},R.prototype.off=function(e,t){this._emitter.removeListener(e,t)},R.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},R.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},R.prototype.load=function(){if(!this._mediaElement)throw new ne.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},R.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},R.prototype.play=function(){return this._mediaElement.play()},R.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(R.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,a=0,o=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();a=r.totalVideoFrames,o=r.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(a=this._mediaElement.webkitDecodedFrameCount,o=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=o),e},enumerable:!1,configurable:!0}),R.prototype._onvLoadedMetadata=function(e){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(O.a.MEDIA_INFO,this.mediaInfo)},R.prototype._reportStatisticsInfo=function(){this._emitter.emit(O.a.STATISTICS_INFO,this.statisticsInfo)},R}();V.a.install();var se={createPlayer:function(R,e){var t=R;if(t==null||typeof t!="object")throw new ne.b("MediaDataSource must be an javascript object!");if(!t.hasOwnProperty("type"))throw new ne.b("MediaDataSource must has type field to indicate video file type!");switch(t.type){case"mse":case"mpegts":case"m2ts":case"flv":return new W(t,e);default:return new he(t,e)}},isSupported:function(){return d.supportMSEH264Playback()},getFeatureList:function(){return d.getFeatureList()},supportWorkerForMSEH265Playback:function(){return d.supportWorkerForMSEH265Playback()}};se.BaseLoader=_.a,se.LoaderStatus=_.c,se.LoaderErrors=_.b,se.Events=O.a,se.ErrorTypes=te.b,se.ErrorDetails=te.a,se.MSEPlayer=W,se.NativePlayer=he,se.LoggingControl=A.a,Object.defineProperty(se,"version",{enumerable:!0,get:function(){return"1.8.0"}}),oe.default=se}])})})(qe);var Ye=qe.exports;const Je=We(Ye);export{Je as m};
