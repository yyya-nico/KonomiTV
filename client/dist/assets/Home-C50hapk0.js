import{B as y}from"./Breadcrumbs-gjeYzHlt.js";import{H as M,N as w}from"./Navigation-bY9LLAj6.js";import{R as B}from"./ReservationList-C6kYS7i9.js";import{S as U}from"./SPHeaderBar-CQQmXNhf.js";import{a as A}from"./ReservationDetailDrawer-BLpZtYO_.js";import{I as L,W as i,M as S,P as E,a5 as H,p as n,ay as p,ad as N,aQ as l,$ as O}from"./SnackbarsStore-BWrzfOQC.js";import{_ as P}from"./top-D3hOjagl.js";import"./logo-CBG9EVS5.js";import"./ssrBoot-BUHelBu2.js";import"./VersionStore-CY9AnbST.js";import"./VSwitch-BR-KdTo5.js";import"./VTextField-DSl15UGX.js";import"./VAvatar-BdTQWOMT.js";import"./VChip-GJgwFlZE.js";import"./VSelect-YQF1VpoU.js";import"./VPagination-Cg8LaAVm.js";import"./VSlider-BQ63Cl2N.js";import"./VDialog-D0UIGrEj.js";import"./VCard-Ctnk2uLw.js";const F={class:"route-container"},T={class:"reservations-home-container-wrapper"},$={class:"reservations-home-container"},b=30*1e3,C=10,D=L({__name:"Home",setup(V){const c=i([]),u=i(0),o=i(!0),r=i(null),d={upcomingReservations:async()=>{const e=await A.fetchReservations();if(e){const a=l(),v=e.reservations.filter(s=>{const t=l(s.program.start_time),R=t.isAfter(a)&&t.isBefore(a.add(24,"hours")),I=s.is_recording_in_progress;return R||I}).sort((s,t)=>s.is_recording_in_progress&&!t.is_recording_in_progress?-1:!s.is_recording_in_progress&&t.is_recording_in_progress?1:l(s.program.start_time).valueOf()-l(t.program.start_time).valueOf());u.value=v.length,c.value=v.slice(0,C)}}},m=async()=>{try{await Promise.all(Object.values(d).map(e=>e())),o.value=!1}catch(e){console.error("Failed to update reservation sections:",e),o.value=!1}},_=e=>{console.log(`Reservation ${e} deleted, refreshing list...`),m()},g=()=>{r.value===null&&(m(),r.value=window.setInterval(m,b))},f=()=>{r.value!==null&&(clearInterval(r.value),r.value=null)};return S(()=>{g()}),E(()=>{f()}),(e,a)=>(O(),H("div",F,[n(M),p("main",null,[n(w),p("div",T,[n(U),p("div",$,[n(y,{crumbs:[{name:"ホーム",path:"/"},{name:"録画予約",path:"/reservations/",disabled:!0}]}),n(B,{class:N(["reservations-home-container__upcoming-reservations",{"reservations-home-container__upcoming-reservations--loading":c.value.length===0&&o.value}]),title:"放送が近い録画予約",reservations:c.value,total:u.value,hideSort:!0,hidePagination:!0,showMoreButton:!0,isLoading:o.value,showEmptyMessage:!o.value,emptyIcon:"fluent:timer-20-regular",emptyMessage:"まだ録画予約がありません。",emptySubMessage:"番組表から録画予約を追加できます。",onMore:a[0]||(a[0]=h=>e.$router.push("/reservations/all")),onDelete:_},null,8,["class","reservations","total","isLoading","showEmptyMessage"])])])])]))}}),ie=P(D,[["__scopeId","data-v-353f0064"]]);export{ie as default};
