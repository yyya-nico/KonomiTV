import{aP as qe}from"./SnackbarsStore-Duvz5vzr.js";var ze={exports:{}};(function(He,We){(function(me,oe){He.exports=oe()})(window,function(){return function(me){var oe={};function B(N){if(oe[N])return oe[N].exports;var b=oe[N]={i:N,l:!1,exports:{}};return me[N].call(b.exports,b,b.exports,B),b.l=!0,b.exports}return B.m=me,B.c=oe,B.d=function(N,b,A){B.o(N,b)||Object.defineProperty(N,b,{enumerable:!0,get:A})},B.r=function(N){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(N,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(N,"__esModule",{value:!0})},B.t=function(N,b){if(1&b&&(N=B(N)),8&b||4&b&&typeof N=="object"&&N&&N.__esModule)return N;var A=Object.create(null);if(B.r(A),Object.defineProperty(A,"default",{enumerable:!0,value:N}),2&b&&typeof N!="string")for(var l in N)B.d(A,l,(function(R){return N[R]}).bind(null,l));return A},B.n=function(N){var b=N&&N.__esModule?function(){return N.default}:function(){return N};return B.d(b,"a",b),b},B.o=function(N,b){return Object.prototype.hasOwnProperty.call(N,b)},B.p="",B(B.s=24)}([function(me,oe,B){var N=B(9),b=B.n(N),A=function(){function l(){}return l.e=function(R,n){R&&!l.FORCE_GLOBAL_TAG||(R=l.GLOBAL_TAG);var m="[".concat(R,"] > ").concat(n);l.ENABLE_CALLBACK&&l.emitter.emit("log","error",m),l.ENABLE_ERROR&&(console.error?console.error(m):console.warn?console.warn(m):console.log(m))},l.i=function(R,n){R&&!l.FORCE_GLOBAL_TAG||(R=l.GLOBAL_TAG);var m="[".concat(R,"] > ").concat(n);l.ENABLE_CALLBACK&&l.emitter.emit("log","info",m),l.ENABLE_INFO&&(console.info?console.info(m):console.log(m))},l.w=function(R,n){R&&!l.FORCE_GLOBAL_TAG||(R=l.GLOBAL_TAG);var m="[".concat(R,"] > ").concat(n);l.ENABLE_CALLBACK&&l.emitter.emit("log","warn",m),l.ENABLE_WARN&&(console.warn?console.warn(m):console.log(m))},l.d=function(R,n){R&&!l.FORCE_GLOBAL_TAG||(R=l.GLOBAL_TAG);var m="[".concat(R,"] > ").concat(n);l.ENABLE_CALLBACK&&l.emitter.emit("log","debug",m),l.ENABLE_DEBUG&&(console.debug?console.debug(m):console.log(m))},l.v=function(R,n){R&&!l.FORCE_GLOBAL_TAG||(R=l.GLOBAL_TAG);var m="[".concat(R,"] > ").concat(n);l.ENABLE_CALLBACK&&l.emitter.emit("log","verbose",m),l.ENABLE_VERBOSE&&console.log(m)},l}();A.GLOBAL_TAG="mpegts.js",A.FORCE_GLOBAL_TAG=!1,A.ENABLE_ERROR=!0,A.ENABLE_INFO=!0,A.ENABLE_WARN=!0,A.ENABLE_DEBUG=!0,A.ENABLE_VERBOSE=!0,A.ENABLE_CALLBACK=!1,A.emitter=new b.a,oe.a=A},function(me,oe,B){var N;(function(b){b.IO_ERROR="io_error",b.DEMUX_ERROR="demux_error",b.INIT_SEGMENT="init_segment",b.MEDIA_SEGMENT="media_segment",b.LOADING_COMPLETE="loading_complete",b.RECOVERED_EARLY_EOF="recovered_early_eof",b.MEDIA_INFO="media_info",b.METADATA_ARRIVED="metadata_arrived",b.SCRIPTDATA_ARRIVED="scriptdata_arrived",b.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",b.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",b.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",b.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",b.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",b.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",b.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",b.STATISTICS_INFO="statistics_info",b.RECOMMEND_SEEKPOINT="recommend_seekpoint"})(N||(N={})),oe.a=N},function(me,oe,B){B.d(oe,"c",function(){return b}),B.d(oe,"b",function(){return A}),B.d(oe,"a",function(){return l});var N=B(3),b={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},A={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},l=function(){function R(n){this._type=n||"undefined",this._status=b.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return R.prototype.destroy=function(){this._status=b.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},R.prototype.isWorking=function(){return this._status===b.kConnecting||this._status===b.kBuffering},Object.defineProperty(R.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(n){this._onContentLengthKnown=n},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(n){this._onURLRedirect=n},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(n){this._onDataArrival=n},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"onError",{get:function(){return this._onError},set:function(n){this._onError=n},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"onComplete",{get:function(){return this._onComplete},set:function(n){this._onComplete=n},enumerable:!1,configurable:!0}),R.prototype.open=function(n,m){throw new N.c("Unimplemented abstract function!")},R.prototype.abort=function(){throw new N.c("Unimplemented abstract function!")},R}()},function(me,oe,B){B.d(oe,"d",function(){return A}),B.d(oe,"a",function(){return l}),B.d(oe,"b",function(){return R}),B.d(oe,"c",function(){return n});var N,b=(N=function(m,E){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,T){k.__proto__=T}||function(k,T){for(var I in T)Object.prototype.hasOwnProperty.call(T,I)&&(k[I]=T[I])})(m,E)},function(m,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function k(){this.constructor=m}N(m,E),m.prototype=E===null?Object.create(E):(k.prototype=E.prototype,new k)}),A=function(){function m(E){this._message=E}return Object.defineProperty(m.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),m.prototype.toString=function(){return this.name+": "+this.message},m}(),l=function(m){function E(k){return m.call(this,k)||this}return b(E,m),Object.defineProperty(E.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),E}(A),R=function(m){function E(k){return m.call(this,k)||this}return b(E,m),Object.defineProperty(E.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),E}(A),n=function(m){function E(k){return m.call(this,k)||this}return b(E,m),Object.defineProperty(E.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),E}(A)},function(me,oe,B){var N;(function(b){b.ERROR="error",b.LOADING_COMPLETE="loading_complete",b.RECOVERED_EARLY_EOF="recovered_early_eof",b.MEDIA_INFO="media_info",b.METADATA_ARRIVED="metadata_arrived",b.SCRIPTDATA_ARRIVED="scriptdata_arrived",b.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",b.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",b.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",b.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",b.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",b.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",b.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",b.STATISTICS_INFO="statistics_info",b.DESTROYING="destroying"})(N||(N={})),oe.a=N},function(me,oe,B){var N={};(function(){var b=self.navigator.userAgent.toLowerCase(),A=/(edge)\/([\w.]+)/.exec(b)||/(opr)[\/]([\w.]+)/.exec(b)||/(chrome)[ \/]([\w.]+)/.exec(b)||/(iemobile)[\/]([\w.]+)/.exec(b)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||b.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(b)||b.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(b)||[],l=/(ipad)/.exec(b)||/(ipod)/.exec(b)||/(windows phone)/.exec(b)||/(iphone)/.exec(b)||/(kindle)/.exec(b)||/(android)/.exec(b)||/(windows)/.exec(b)||/(mac)/.exec(b)||/(linux)/.exec(b)||/(cros)/.exec(b)||[],R={browser:A[5]||A[3]||A[1]||"",version:A[2]||A[4]||"0",majorVersion:A[4]||A[2]||"0",platform:l[0]||""},n={};if(R.browser){n[R.browser]=!0;var m=R.majorVersion.split(".");n.version={major:parseInt(R.majorVersion,10),string:R.version},m.length>1&&(n.version.minor=parseInt(m[1],10)),m.length>2&&(n.version.build=parseInt(m[2],10))}R.platform&&(n[R.platform]=!0),(n.chrome||n.opr||n.safari)&&(n.webkit=!0),(n.rv||n.iemobile)&&(n.rv&&delete n.rv,R.browser="msie",n.msie=!0),n.edge&&(delete n.edge,R.browser="msedge",n.msedge=!0),n.opr&&(R.browser="opera",n.opera=!0),n.safari&&n.android&&(R.browser="android",n.android=!0);for(var E in n.name=R.browser,n.platform=R.platform,N)N.hasOwnProperty(E)&&delete N[E];Object.assign(N,n)})(),oe.a=N},function(me,oe,B){oe.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(me,oe,B){var N;(function(b){b.ERROR="error",b.SOURCE_OPEN="source_open",b.UPDATE_END="update_end",b.BUFFER_FULL="buffer_full",b.START_STREAMING="start_streaming",b.END_STREAMING="end_streaming"})(N||(N={})),oe.a=N},function(me,oe,B){var N=B(9),b=B.n(N),A=B(0),l=function(){function R(){}return Object.defineProperty(R,"forceGlobalTag",{get:function(){return A.a.FORCE_GLOBAL_TAG},set:function(n){A.a.FORCE_GLOBAL_TAG=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"globalTag",{get:function(){return A.a.GLOBAL_TAG},set:function(n){A.a.GLOBAL_TAG=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"enableAll",{get:function(){return A.a.ENABLE_VERBOSE&&A.a.ENABLE_DEBUG&&A.a.ENABLE_INFO&&A.a.ENABLE_WARN&&A.a.ENABLE_ERROR},set:function(n){A.a.ENABLE_VERBOSE=n,A.a.ENABLE_DEBUG=n,A.a.ENABLE_INFO=n,A.a.ENABLE_WARN=n,A.a.ENABLE_ERROR=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"enableDebug",{get:function(){return A.a.ENABLE_DEBUG},set:function(n){A.a.ENABLE_DEBUG=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"enableVerbose",{get:function(){return A.a.ENABLE_VERBOSE},set:function(n){A.a.ENABLE_VERBOSE=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"enableInfo",{get:function(){return A.a.ENABLE_INFO},set:function(n){A.a.ENABLE_INFO=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"enableWarn",{get:function(){return A.a.ENABLE_WARN},set:function(n){A.a.ENABLE_WARN=n,R._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(R,"enableError",{get:function(){return A.a.ENABLE_ERROR},set:function(n){A.a.ENABLE_ERROR=n,R._notifyChange()},enumerable:!1,configurable:!0}),R.getConfig=function(){return{globalTag:A.a.GLOBAL_TAG,forceGlobalTag:A.a.FORCE_GLOBAL_TAG,enableVerbose:A.a.ENABLE_VERBOSE,enableDebug:A.a.ENABLE_DEBUG,enableInfo:A.a.ENABLE_INFO,enableWarn:A.a.ENABLE_WARN,enableError:A.a.ENABLE_ERROR,enableCallback:A.a.ENABLE_CALLBACK}},R.applyConfig=function(n){A.a.GLOBAL_TAG=n.globalTag,A.a.FORCE_GLOBAL_TAG=n.forceGlobalTag,A.a.ENABLE_VERBOSE=n.enableVerbose,A.a.ENABLE_DEBUG=n.enableDebug,A.a.ENABLE_INFO=n.enableInfo,A.a.ENABLE_WARN=n.enableWarn,A.a.ENABLE_ERROR=n.enableError,A.a.ENABLE_CALLBACK=n.enableCallback},R._notifyChange=function(){var n=R.emitter;if(n.listenerCount("change")>0){var m=R.getConfig();n.emit("change",m)}},R.registerListener=function(n){R.emitter.addListener("change",n)},R.removeListener=function(n){R.emitter.removeListener("change",n)},R.addLogListener=function(n){A.a.emitter.addListener("log",n),A.a.emitter.listenerCount("log")>0&&(A.a.ENABLE_CALLBACK=!0,R._notifyChange())},R.removeLogListener=function(n){A.a.emitter.removeListener("log",n),A.a.emitter.listenerCount("log")===0&&(A.a.ENABLE_CALLBACK=!1,R._notifyChange())},R}();l.emitter=new b.a,oe.a=l},function(me,oe,B){var N,b=typeof Reflect=="object"?Reflect:null,A=b&&typeof b.apply=="function"?b.apply:function(L,Q,ne){return Function.prototype.apply.call(L,Q,ne)};N=b&&typeof b.ownKeys=="function"?b.ownKeys:Object.getOwnPropertySymbols?function(L){return Object.getOwnPropertyNames(L).concat(Object.getOwnPropertySymbols(L))}:function(L){return Object.getOwnPropertyNames(L)};var l=Number.isNaN||function(L){return L!=L};function R(){R.init.call(this)}me.exports=R,me.exports.once=function(L,Q){return new Promise(function(ne,x){function h(c){L.removeListener(Q,_),x(c)}function _(){typeof L.removeListener=="function"&&L.removeListener("error",h),ne([].slice.call(arguments))}j(L,Q,_,{once:!0}),Q!=="error"&&function(c,f,H){typeof c.on=="function"&&j(c,"error",f,H)}(L,h,{once:!0})})},R.EventEmitter=R,R.prototype._events=void 0,R.prototype._eventsCount=0,R.prototype._maxListeners=void 0;var n=10;function m(L){if(typeof L!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof L)}function E(L){return L._maxListeners===void 0?R.defaultMaxListeners:L._maxListeners}function k(L,Q,ne,x){var h,_,c,f;if(m(ne),(_=L._events)===void 0?(_=L._events=Object.create(null),L._eventsCount=0):(_.newListener!==void 0&&(L.emit("newListener",Q,ne.listener?ne.listener:ne),_=L._events),c=_[Q]),c===void 0)c=_[Q]=ne,++L._eventsCount;else if(typeof c=="function"?c=_[Q]=x?[ne,c]:[c,ne]:x?c.unshift(ne):c.push(ne),(h=E(L))>0&&c.length>h&&!c.warned){c.warned=!0;var H=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(Q)+" listeners added. Use emitter.setMaxListeners() to increase limit");H.name="MaxListenersExceededWarning",H.emitter=L,H.type=Q,H.count=c.length,f=H,console&&console.warn&&console.warn(f)}return L}function T(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(L,Q,ne){var x={fired:!1,wrapFn:void 0,target:L,type:Q,listener:ne},h=T.bind(x);return h.listener=ne,x.wrapFn=h,h}function Z(L,Q,ne){var x=L._events;if(x===void 0)return[];var h=x[Q];return h===void 0?[]:typeof h=="function"?ne?[h.listener||h]:[h]:ne?function(_){for(var c=new Array(_.length),f=0;f<c.length;++f)c[f]=_[f].listener||_[f];return c}(h):z(h,h.length)}function U(L){var Q=this._events;if(Q!==void 0){var ne=Q[L];if(typeof ne=="function")return 1;if(ne!==void 0)return ne.length}return 0}function z(L,Q){for(var ne=new Array(Q),x=0;x<Q;++x)ne[x]=L[x];return ne}function j(L,Q,ne,x){if(typeof L.on=="function")x.once?L.once(Q,ne):L.on(Q,ne);else{if(typeof L.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof L);L.addEventListener(Q,function h(_){x.once&&L.removeEventListener(Q,h),ne(_)})}}Object.defineProperty(R,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(L){if(typeof L!="number"||L<0||l(L))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+L+".");n=L}}),R.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},R.prototype.setMaxListeners=function(L){if(typeof L!="number"||L<0||l(L))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+L+".");return this._maxListeners=L,this},R.prototype.getMaxListeners=function(){return E(this)},R.prototype.emit=function(L){for(var Q=[],ne=1;ne<arguments.length;ne++)Q.push(arguments[ne]);var x=L==="error",h=this._events;if(h!==void 0)x=x&&h.error===void 0;else if(!x)return!1;if(x){var _;if(Q.length>0&&(_=Q[0]),_ instanceof Error)throw _;var c=new Error("Unhandled error."+(_?" ("+_.message+")":""));throw c.context=_,c}var f=h[L];if(f===void 0)return!1;if(typeof f=="function")A(f,this,Q);else{var H=f.length,ee=z(f,H);for(ne=0;ne<H;++ne)A(ee[ne],this,Q)}return!0},R.prototype.addListener=function(L,Q){return k(this,L,Q,!1)},R.prototype.on=R.prototype.addListener,R.prototype.prependListener=function(L,Q){return k(this,L,Q,!0)},R.prototype.once=function(L,Q){return m(Q),this.on(L,I(this,L,Q)),this},R.prototype.prependOnceListener=function(L,Q){return m(Q),this.prependListener(L,I(this,L,Q)),this},R.prototype.removeListener=function(L,Q){var ne,x,h,_,c;if(m(Q),(x=this._events)===void 0)return this;if((ne=x[L])===void 0)return this;if(ne===Q||ne.listener===Q)--this._eventsCount==0?this._events=Object.create(null):(delete x[L],x.removeListener&&this.emit("removeListener",L,ne.listener||Q));else if(typeof ne!="function"){for(h=-1,_=ne.length-1;_>=0;_--)if(ne[_]===Q||ne[_].listener===Q){c=ne[_].listener,h=_;break}if(h<0)return this;h===0?ne.shift():function(f,H){for(;H+1<f.length;H++)f[H]=f[H+1];f.pop()}(ne,h),ne.length===1&&(x[L]=ne[0]),x.removeListener!==void 0&&this.emit("removeListener",L,c||Q)}return this},R.prototype.off=R.prototype.removeListener,R.prototype.removeAllListeners=function(L){var Q,ne,x;if((ne=this._events)===void 0)return this;if(ne.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ne[L]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete ne[L]),this;if(arguments.length===0){var h,_=Object.keys(ne);for(x=0;x<_.length;++x)(h=_[x])!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(Q=ne[L])=="function")this.removeListener(L,Q);else if(Q!==void 0)for(x=Q.length-1;x>=0;x--)this.removeListener(L,Q[x]);return this},R.prototype.listeners=function(L){return Z(this,L,!0)},R.prototype.rawListeners=function(L){return Z(this,L,!1)},R.listenerCount=function(L,Q){return typeof L.listenerCount=="function"?L.listenerCount(Q):U.call(L,Q)},R.prototype.listenerCount=U,R.prototype.eventNames=function(){return this._eventsCount>0?N(this._events):[]}},function(me,oe,B){var N=B(3),b=function(){function A(l){this.TAG="ExpGolomb",this._buffer=l,this._buffer_index=0,this._total_bytes=l.byteLength,this._total_bits=8*l.byteLength,this._current_word=0,this._current_word_bits_left=0}return A.prototype.destroy=function(){this._buffer=null},A.prototype._fillCurrentWord=function(){var l=this._total_bytes-this._buffer_index;if(l<=0)throw new N.a("ExpGolomb: _fillCurrentWord() but no bytes available");var R=Math.min(4,l),n=new Uint8Array(4);n.set(this._buffer.subarray(this._buffer_index,this._buffer_index+R)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=R,this._current_word_bits_left=8*R},A.prototype.readBits=function(l){if(l>32)throw new N.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(l<=this._current_word_bits_left){var R=this._current_word>>>32-l;return this._current_word<<=l,this._current_word_bits_left-=l,R}var n=this._current_word_bits_left?this._current_word:0;n>>>=32-this._current_word_bits_left;var m=l-this._current_word_bits_left;this._fillCurrentWord();var E=Math.min(m,this._current_word_bits_left),k=this._current_word>>>32-E;return this._current_word<<=E,this._current_word_bits_left-=E,n=n<<E|k},A.prototype.readBool=function(){return this.readBits(1)===1},A.prototype.readByte=function(){return this.readBits(8)},A.prototype._skipLeadingZero=function(){var l;for(l=0;l<this._current_word_bits_left;l++)if(this._current_word&2147483648>>>l)return this._current_word<<=l,this._current_word_bits_left-=l,l;return this._fillCurrentWord(),l+this._skipLeadingZero()},A.prototype.readUEG=function(){var l=this._skipLeadingZero();return this.readBits(l+1)-1},A.prototype.readSEG=function(){var l=this.readUEG();return 1&l?l+1>>>1:-1*(l>>>1)},A}();oe.a=b},function(me,oe,B){B.d(oe,"b",function(){return A}),B.d(oe,"a",function(){return l});var N=B(2),b=B(6),A={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},l={NETWORK_EXCEPTION:N.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:N.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:N.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:N.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:b.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:b.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:b.a.CODEC_UNSUPPORTED}},function(me,oe,B){B.d(oe,"d",function(){return N}),B.d(oe,"b",function(){return b}),B.d(oe,"a",function(){return A}),B.d(oe,"c",function(){return l});var N=function(R,n,m,E,k){this.dts=R,this.pts=n,this.duration=m,this.originalDts=E,this.isSyncPoint=k,this.fileposition=null},b=function(){function R(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return R.prototype.appendSyncPoint=function(n){n.isSyncPoint=!0,this.syncPoints.push(n)},R}(),A=function(){function R(){this._list=[]}return R.prototype.clear=function(){this._list=[]},R.prototype.appendArray=function(n){var m=this._list;n.length!==0&&(m.length>0&&n[0].originalDts<m[m.length-1].originalDts&&this.clear(),Array.prototype.push.apply(m,n))},R.prototype.getLastSyncPointBeforeDts=function(n){if(this._list.length==0)return null;var m=this._list,E=0,k=m.length-1,T=0,I=0,Z=k;for(n<m[0].dts&&(E=0,I=Z+1);I<=Z;){if((T=I+Math.floor((Z-I)/2))===k||n>=m[T].dts&&n<m[T+1].dts){E=T;break}m[T].dts<n?I=T+1:Z=T-1}return this._list[E]},R}(),l=function(){function R(n){this._type=n,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(R.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),R.prototype.isEmpty=function(){return this._list.length===0},R.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},R.prototype._searchNearestSegmentBefore=function(n){var m=this._list;if(m.length===0)return-2;var E=m.length-1,k=0,T=0,I=E,Z=0;if(n<m[0].originalBeginDts)return Z=-1;for(;T<=I;){if((k=T+Math.floor((I-T)/2))===E||n>m[k].lastSample.originalDts&&n<m[k+1].originalBeginDts){Z=k;break}m[k].originalBeginDts<n?T=k+1:I=k-1}return Z},R.prototype._searchNearestSegmentAfter=function(n){return this._searchNearestSegmentBefore(n)+1},R.prototype.append=function(n){var m=this._list,E=n,k=this._lastAppendLocation,T=0;k!==-1&&k<m.length&&E.originalBeginDts>=m[k].lastSample.originalDts&&(k===m.length-1||k<m.length-1&&E.originalBeginDts<m[k+1].originalBeginDts)?T=k+1:m.length>0&&(T=this._searchNearestSegmentBefore(E.originalBeginDts)+1),this._lastAppendLocation=T,this._list.splice(T,0,E)},R.prototype.getLastSegmentBefore=function(n){var m=this._searchNearestSegmentBefore(n);return m>=0?this._list[m]:null},R.prototype.getLastSampleBefore=function(n){var m=this.getLastSegmentBefore(n);return m!=null?m.lastSample:null},R.prototype.getLastSyncPointBefore=function(n){for(var m=this._searchNearestSegmentBefore(n),E=this._list[m].syncPoints;E.length===0&&m>0;)m--,E=this._list[m].syncPoints;return E.length>0?E[E.length-1]:null},R}()},function(me,oe,B){var N=function(){function b(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return b.prototype.isComplete=function(){var A=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,l=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&A&&l},b.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},b.prototype.getNearestKeyframe=function(A){if(this.keyframesIndex==null)return null;var l=this.keyframesIndex,R=this._search(l.times,A);return{index:R,milliseconds:l.times[R],fileposition:l.filepositions[R]}},b.prototype._search=function(A,l){var R=0,n=A.length-1,m=0,E=0,k=n;for(l<A[0]&&(R=0,E=k+1);E<=k;){if((m=E+Math.floor((k-E)/2))===n||l>=A[m]&&l<A[m+1]){R=m;break}A[m]<l?E=m+1:k=m-1}return R},b}();oe.a=N},function(me,oe,B){var N,b=B(0),A=B(13),l=B(3),R=function(){function d(){}return d.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},d}(),n=function(){this.program_pmt_pid={}};(function(d){d[d.kMPEG1Audio=3]="kMPEG1Audio",d[d.kMPEG2Audio=4]="kMPEG2Audio",d[d.kPESPrivateData=6]="kPESPrivateData",d[d.kADTSAAC=15]="kADTSAAC",d[d.kLOASAAC=17]="kLOASAAC",d[d.kAC3=129]="kAC3",d[d.kEAC3=135]="kEAC3",d[d.kMetadata=21]="kMetadata",d[d.kSCTE35=134]="kSCTE35",d[d.kH264=27]="kH264",d[d.kH265=36]="kH265"})(N||(N={}));var m,E=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},k=function(){},T=function(){},I=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(d){d[d.kUnspecified=0]="kUnspecified",d[d.kSliceNonIDR=1]="kSliceNonIDR",d[d.kSliceDPA=2]="kSliceDPA",d[d.kSliceDPB=3]="kSliceDPB",d[d.kSliceDPC=4]="kSliceDPC",d[d.kSliceIDR=5]="kSliceIDR",d[d.kSliceSEI=6]="kSliceSEI",d[d.kSliceSPS=7]="kSliceSPS",d[d.kSlicePPS=8]="kSlicePPS",d[d.kSliceAUD=9]="kSliceAUD",d[d.kEndOfSequence=10]="kEndOfSequence",d[d.kEndOfStream=11]="kEndOfStream",d[d.kFiller=12]="kFiller",d[d.kSPSExt=13]="kSPSExt",d[d.kReserved0=14]="kReserved0"})(m||(m={}));var Z,U,z=function(){},j=function(d){var u=d.data.byteLength;this.type=d.type,this.data=new Uint8Array(4+u),new DataView(this.data.buffer).setUint32(0,u),this.data.set(d.data,4)},L=function(){function d(u){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=u,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&b.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return d.prototype.findNextStartCodeOffset=function(u){for(var s=u,a=this.data_;;){if(s+3>=a.byteLength)return this.eof_flag_=!0,a.byteLength;var g=a[s+0]<<24|a[s+1]<<16|a[s+2]<<8|a[s+3],D=a[s+0]<<16|a[s+1]<<8|a[s+2];if(g===1||D===1)return s;s++}},d.prototype.readNextNaluPayload=function(){for(var u=this.data_,s=null;s==null&&!this.eof_flag_;){var a=this.current_startcode_offset_,g=31&u[a+=(u[a]<<24|u[a+1]<<16|u[a+2]<<8|u[a+3])===1?4:3],D=(128&u[a])>>>7,p=this.findNextStartCodeOffset(a);if(this.current_startcode_offset_=p,!(g>=m.kReserved0)&&D===0){var M=u.subarray(a,p);(s=new z).type=g,s.data=M}}return s},d}(),Q=function(){function d(u,s,a){var g=8+u.byteLength+1+2+s.byteLength,D=!1;u[3]!==66&&u[3]!==77&&u[3]!==88&&(D=!0,g+=4);var p=this.data=new Uint8Array(g);p[0]=1,p[1]=u[1],p[2]=u[2],p[3]=u[3],p[4]=255,p[5]=225;var M=u.byteLength;p[6]=M>>>8,p[7]=255&M;var V=8;p.set(u,8),p[V+=M]=1;var O=s.byteLength;p[V+1]=O>>>8,p[V+2]=255&O,p.set(s,V+3),V+=3+O,D&&(p[V]=252|a.chroma_format_idc,p[V+1]=248|a.bit_depth_luma-8,p[V+2]=248|a.bit_depth_chroma-8,p[V+3]=0,V+=4)}return d.prototype.getData=function(){return this.data},d}(),ne=B(22),x=B(10);(function(d){d[d.kNull=0]="kNull",d[d.kAACMain=1]="kAACMain",d[d.kAAC_LC=2]="kAAC_LC",d[d.kAAC_SSR=3]="kAAC_SSR",d[d.kAAC_LTP=4]="kAAC_LTP",d[d.kAAC_SBR=5]="kAAC_SBR",d[d.kAAC_Scalable=6]="kAAC_Scalable",d[d.kLayer1=32]="kLayer1",d[d.kLayer2=33]="kLayer2",d[d.kLayer3=34]="kLayer3"})(Z||(Z={})),function(d){d[d.k96000Hz=0]="k96000Hz",d[d.k88200Hz=1]="k88200Hz",d[d.k64000Hz=2]="k64000Hz",d[d.k48000Hz=3]="k48000Hz",d[d.k44100Hz=4]="k44100Hz",d[d.k32000Hz=5]="k32000Hz",d[d.k24000Hz=6]="k24000Hz",d[d.k22050Hz=7]="k22050Hz",d[d.k16000Hz=8]="k16000Hz",d[d.k12000Hz=9]="k12000Hz",d[d.k11025Hz=10]="k11025Hz",d[d.k8000Hz=11]="k8000Hz",d[d.k7350Hz=12]="k7350Hz"}(U||(U={}));var h,_,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],f=(h=function(d,u){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(s[g]=a[g])})(d,u)},function(d,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function s(){this.constructor=d}h(d,u),d.prototype=u===null?Object.create(u):(s.prototype=u.prototype,new s)}),H=function(){},ee=function(d){function u(){return d!==null&&d.apply(this,arguments)||this}return f(u,d),u}(H),ae=function(){function d(u){this.TAG="AACADTSParser",this.data_=u,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&b.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return d.prototype.findNextSyncwordOffset=function(u){for(var s=u,a=this.data_;;){if(s+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if((a[s+0]<<8|a[s+1])>>>4===4095)return s;s++}},d.prototype.readNextAACFrame=function(){for(var u=this.data_,s=null;s==null&&!this.eof_flag_;){var a=this.current_syncword_offset_,g=(8&u[a+1])>>>3,D=(6&u[a+1])>>>1,p=1&u[a+1],M=(192&u[a+2])>>>6,V=(60&u[a+2])>>>2,O=(1&u[a+2])<<2|(192&u[a+3])>>>6,K=(3&u[a+3])<<11|u[a+4]<<3|(224&u[a+5])>>>5;if(u[a+6],a+K>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var X=p===1?7:9,J=K-X;a+=X;var $=this.findNextSyncwordOffset(a+J);if(this.current_syncword_offset_=$,(g===0||g===1)&&D===0){var de=u.subarray(a,a+J);(s=new H).audio_object_type=M+1,s.sampling_freq_index=V,s.sampling_frequency=c[V],s.channel_config=O,s.data=de}}return s},d.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},d.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},d}(),Y=function(){function d(u){this.TAG="AACLOASParser",this.data_=u,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&b.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return d.prototype.findNextSyncwordOffset=function(u){for(var s=u,a=this.data_;;){if(s+1>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if((a[s+0]<<3|a[s+1]>>>5)===695)return s;s++}},d.prototype.getLATMValue=function(u){for(var s=u.readBits(2),a=0,g=0;g<=s;g++)a<<=8,a|=u.readByte();return a},d.prototype.readNextAACFrame=function(u){for(var s=this.data_,a=null;a==null&&!this.eof_flag_;){var g=this.current_syncword_offset_,D=(31&s[g+1])<<8|s[g+2];if(g+3+D>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var p=new x.a(s.subarray(g+3,g+3+D)),M=null;if(p.readBool()){if(u==null){b.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(g+3+D),p.destroy();continue}M=u}else{var V=p.readBool();if(V&&p.readBool()){b.a.e(this.TAG,"audioMuxVersionA is Not Supported"),p.destroy();break}if(V&&this.getLATMValue(p),!p.readBool()){b.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),p.destroy();break}if(p.readBits(6)!==0){b.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),p.destroy();break}if(p.readBits(4)!==0){b.a.e(this.TAG,"more than 2 numProgram Not Supported"),p.destroy();break}if(p.readBits(3)!==0){b.a.e(this.TAG,"more than 2 numLayer Not Supported"),p.destroy();break}var O=V?this.getLATMValue(p):0,K=p.readBits(5);O-=5;var X=p.readBits(4);O-=4;var J=p.readBits(4);O-=4,p.readBits(3),(O-=3)>0&&p.readBits(O);var $=p.readBits(3);if($!==0){b.a.e(this.TAG,"frameLengthType = ".concat($,". Only frameLengthType = 0 Supported")),p.destroy();break}p.readByte();var de=p.readBool();if(de)if(V)this.getLATMValue(p);else{for(var he=0;;){he<<=8;var Te=p.readBool();if(he+=p.readByte(),!Te)break}console.log(he)}p.readBool()&&p.readByte(),(M=new ee).audio_object_type=K,M.sampling_freq_index=X,M.sampling_frequency=c[M.sampling_freq_index],M.channel_config=J,M.other_data_present=de}for(var Le=0;;){var be=p.readByte();if(Le+=be,be!==255)break}for(var Se=new Uint8Array(Le),Ie=0;Ie<Le;Ie++)Se[Ie]=p.readByte();(a=new ee).audio_object_type=M.audio_object_type,a.sampling_freq_index=M.sampling_freq_index,a.sampling_frequency=c[M.sampling_freq_index],a.channel_config=M.channel_config,a.other_data_present=M.other_data_present,a.data=Se,this.current_syncword_offset_=this.findNextSyncwordOffset(g+3+D)}return a},d.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},d.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},d}(),q=function(d){var u=null,s=d.audio_object_type,a=d.audio_object_type,g=d.sampling_freq_index,D=d.channel_config,p=0,M=navigator.userAgent.toLowerCase();M.indexOf("firefox")!==-1?g>=6?(a=5,u=new Array(4),p=g-3):(a=2,u=new Array(2),p=g):M.indexOf("android")!==-1?(a=2,u=new Array(2),p=g):(a=5,p=g,u=new Array(4),g>=6?p=g-3:D===1&&(a=2,u=new Array(2),p=g)),u[0]=a<<3,u[0]|=(15&g)>>>1,u[1]=(15&g)<<7,u[1]|=(15&D)<<3,a===5&&(u[1]|=(15&p)>>>1,u[2]=(1&p)<<7,u[2]|=8,u[3]=0),this.config=u,this.sampling_rate=c[g],this.channel_count=D,this.codec_mimetype="mp4a.40."+a,this.original_codec_mimetype="mp4a.40."+s},le=function(){},re=function(){};(function(d){d[d.kSpliceNull=0]="kSpliceNull",d[d.kSpliceSchedule=4]="kSpliceSchedule",d[d.kSpliceInsert=5]="kSpliceInsert",d[d.kTimeSignal=6]="kTimeSignal",d[d.kBandwidthReservation=7]="kBandwidthReservation",d[d.kPrivateCommand=255]="kPrivateCommand"})(_||(_={}));var v,e=function(d){var u=d.readBool();return u?(d.readBits(6),{time_specified_flag:u,pts_time:4*d.readBits(31)+d.readBits(2)}):(d.readBits(7),{time_specified_flag:u})},t=function(d){var u=d.readBool();return d.readBits(6),{auto_return:u,duration:4*d.readBits(31)+d.readBits(2)}},i=function(d,u){var s=u.readBits(8);return d?{component_tag:s}:{component_tag:s,splice_time:e(u)}},r=function(d){return{component_tag:d.readBits(8),utc_splice_time:d.readBits(32)}},o=function(d){var u=d.readBits(32),s=d.readBool();d.readBits(7);var a={splice_event_id:u,splice_event_cancel_indicator:s};if(s)return a;if(a.out_of_network_indicator=d.readBool(),a.program_splice_flag=d.readBool(),a.duration_flag=d.readBool(),d.readBits(5),a.program_splice_flag)a.utc_splice_time=d.readBits(32);else{a.component_count=d.readBits(8),a.components=[];for(var g=0;g<a.component_count;g++)a.components.push(r(d))}return a.duration_flag&&(a.break_duration=t(d)),a.unique_program_id=d.readBits(16),a.avail_num=d.readBits(8),a.avails_expected=d.readBits(8),a},S=function(d,u,s,a){return{descriptor_tag:d,descriptor_length:u,identifier:s,provider_avail_id:a.readBits(32)}},C=function(d,u,s,a){var g=a.readBits(8),D=a.readBits(3);a.readBits(5);for(var p="",M=0;M<D;M++)p+=String.fromCharCode(a.readBits(8));return{descriptor_tag:d,descriptor_length:u,identifier:s,preroll:g,dtmf_count:D,DTMF_char:p}},y=function(d){var u=d.readBits(8);return d.readBits(7),{component_tag:u,pts_offset:4*d.readBits(31)+d.readBits(2)}},w=function(d,u,s,a){var g=a.readBits(32),D=a.readBool();a.readBits(7);var p={descriptor_tag:d,descriptor_length:u,identifier:s,segmentation_event_id:g,segmentation_event_cancel_indicator:D};if(D)return p;if(p.program_segmentation_flag=a.readBool(),p.segmentation_duration_flag=a.readBool(),p.delivery_not_restricted_flag=a.readBool(),p.delivery_not_restricted_flag?a.readBits(5):(p.web_delivery_allowed_flag=a.readBool(),p.no_regional_blackout_flag=a.readBool(),p.archive_allowed_flag=a.readBool(),p.device_restrictions=a.readBits(2)),!p.program_segmentation_flag){p.component_count=a.readBits(8),p.components=[];for(var M=0;M<p.component_count;M++)p.components.push(y(a))}p.segmentation_duration_flag&&(p.segmentation_duration=a.readBits(40)),p.segmentation_upid_type=a.readBits(8),p.segmentation_upid_length=a.readBits(8);var V=new Uint8Array(p.segmentation_upid_length);for(M=0;M<p.segmentation_upid_length;M++)V[M]=a.readBits(8);return p.segmentation_upid=V.buffer,p.segmentation_type_id=a.readBits(8),p.segment_num=a.readBits(8),p.segments_expected=a.readBits(8),p.segmentation_type_id!==52&&p.segmentation_type_id!==54&&p.segmentation_type_id!==56&&p.segmentation_type_id!==58||(p.sub_segment_num=a.readBits(8),p.sub_segments_expected=a.readBits(8)),p},G=function(d,u,s,a){return{descriptor_tag:d,descriptor_length:u,identifier:s,TAI_seconds:a.readBits(48),TAI_ns:a.readBits(32),UTC_offset:a.readBits(16)}},P=function(d){return{component_tag:d.readBits(8),ISO_code:String.fromCharCode(d.readBits(8),d.readBits(8),d.readBits(8)),Bit_Stream_Mode:d.readBits(3),Num_Channels:d.readBits(4),Full_Srvc_Audio:d.readBool()}},F=function(d,u,s,a){for(var g=a.readBits(4),D=[],p=0;p<g;p++)D.push(P(a));return{descriptor_tag:d,descriptor_length:u,identifier:s,audio_count:g,components:D}},W=function(d){var u=new x.a(d),s=u.readBits(8),a=u.readBool(),g=u.readBool();u.readBits(2);var D=u.readBits(12),p=u.readBits(8),M=u.readBool(),V=u.readBits(6),O=4*u.readBits(31)+u.readBits(2),K=u.readBits(8),X=u.readBits(12),J=u.readBits(12),$=u.readBits(8),de=null;$===_.kSpliceNull?de={}:$===_.kSpliceSchedule?de=function(ke){for(var Ue=ke.readBits(8),Ne=[],Ae=0;Ae<Ue;Ae++)Ne.push(o(ke));return{splice_count:Ue,events:Ne}}(u):$===_.kSpliceInsert?de=function(ke){var Ue=ke.readBits(32),Ne=ke.readBool();ke.readBits(7);var Ae={splice_event_id:Ue,splice_event_cancel_indicator:Ne};if(Ne)return Ae;if(Ae.out_of_network_indicator=ke.readBool(),Ae.program_splice_flag=ke.readBool(),Ae.duration_flag=ke.readBool(),Ae.splice_immediate_flag=ke.readBool(),ke.readBits(4),Ae.program_splice_flag&&!Ae.splice_immediate_flag&&(Ae.splice_time=e(ke)),!Ae.program_splice_flag){Ae.component_count=ke.readBits(8),Ae.components=[];for(var Ve=0;Ve<Ae.component_count;Ve++)Ae.components.push(i(Ae.splice_immediate_flag,ke))}return Ae.duration_flag&&(Ae.break_duration=t(ke)),Ae.unique_program_id=ke.readBits(16),Ae.avail_num=ke.readBits(8),Ae.avails_expected=ke.readBits(8),Ae}(u):$===_.kTimeSignal?de=function(ke){return{splice_time:e(ke)}}(u):$===_.kBandwidthReservation?de={}:$===_.kPrivateCommand?de=function(ke,Ue){for(var Ne=String.fromCharCode(Ue.readBits(8),Ue.readBits(8),Ue.readBits(8),Ue.readBits(8)),Ae=new Uint8Array(ke-4),Ve=0;Ve<ke-4;Ve++)Ae[Ve]=Ue.readBits(8);return{identifier:Ne,private_data:Ae.buffer}}(J,u):u.readBits(8*J);for(var he=[],Te=u.readBits(16),Le=0;Le<Te;){var be=u.readBits(8),Se=u.readBits(8),Ie=String.fromCharCode(u.readBits(8),u.readBits(8),u.readBits(8),u.readBits(8));be===0?he.push(S(be,Se,Ie,u)):be===1?he.push(C(be,Se,Ie,u)):be===2?he.push(w(be,Se,Ie,u)):be===3?he.push(G(be,Se,Ie,u)):be===4?he.push(F(be,Se,Ie,u)):u.readBits(8*(Se-4)),Le+=2+Se}var xe={table_id:s,section_syntax_indicator:a,private_indicator:g,section_length:D,protocol_version:p,encrypted_packet:M,encryption_algorithm:V,pts_adjustment:O,cw_index:K,tier:X,splice_command_length:J,splice_command_type:$,splice_command:de,descriptor_loop_length:Te,splice_descriptors:he,E_CRC32:M?u.readBits(32):void 0,CRC32:u.readBits(32)};if($===_.kSpliceInsert){var Ce=de;if(Ce.splice_event_cancel_indicator)return{splice_command_type:$,detail:xe,data:d};if(Ce.program_splice_flag&&!Ce.splice_immediate_flag){var Be=Ce.duration_flag?Ce.break_duration.auto_return:void 0,Ge=Ce.duration_flag?Ce.break_duration.duration/90:void 0;return Ce.splice_time.time_specified_flag?{splice_command_type:$,pts:(O+Ce.splice_time.pts_time)%Math.pow(2,33),auto_return:Be,duraiton:Ge,detail:xe,data:d}:{splice_command_type:$,auto_return:Be,duraiton:Ge,detail:xe,data:d}}return{splice_command_type:$,auto_return:Be=Ce.duration_flag?Ce.break_duration.auto_return:void 0,duraiton:Ge=Ce.duration_flag?Ce.break_duration.duration/90:void 0,detail:xe,data:d}}if($===_.kTimeSignal){var Fe=de;return Fe.splice_time.time_specified_flag?{splice_command_type:$,pts:(O+Fe.splice_time.pts_time)%Math.pow(2,33),detail:xe,data:d}:{splice_command_type:$,detail:xe,data:d}}return{splice_command_type:$,detail:xe,data:d}};(function(d){d[d.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",d[d.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",d[d.kSliceCRA_NUT=21]="kSliceCRA_NUT",d[d.kSliceVPS=32]="kSliceVPS",d[d.kSliceSPS=33]="kSliceSPS",d[d.kSlicePPS=34]="kSlicePPS",d[d.kSliceAUD=35]="kSliceAUD"})(v||(v={}));var te=function(){},se=function(d){var u=d.data.byteLength;this.type=d.type,this.data=new Uint8Array(4+u),new DataView(this.data.buffer).setUint32(0,u),this.data.set(d.data,4)},fe=function(){function d(u){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=u,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&b.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return d.prototype.findNextStartCodeOffset=function(u){for(var s=u,a=this.data_;;){if(s+3>=a.byteLength)return this.eof_flag_=!0,a.byteLength;var g=a[s+0]<<24|a[s+1]<<16|a[s+2]<<8|a[s+3],D=a[s+0]<<16|a[s+1]<<8|a[s+2];if(g===1||D===1)return s;s++}},d.prototype.readNextNaluPayload=function(){for(var u=this.data_,s=null;s==null&&!this.eof_flag_;){var a=this.current_startcode_offset_,g=u[a+=(u[a]<<24|u[a+1]<<16|u[a+2]<<8|u[a+3])===1?4:3]>>1&63,D=(128&u[a])>>>7,p=this.findNextStartCodeOffset(a);if(this.current_startcode_offset_=p,D===0){var M=u.subarray(a,p);(s=new te).type=g,s.data=M}}return s},d}(),ie=function(){function d(u,s,a,g){var D=23+(5+u.byteLength)+(5+s.byteLength)+(5+a.byteLength),p=this.data=new Uint8Array(D);p[0]=1,p[1]=(3&g.general_profile_space)<<6|(g.general_tier_flag?1:0)<<5|31&g.general_profile_idc,p[2]=g.general_profile_compatibility_flags_1,p[3]=g.general_profile_compatibility_flags_2,p[4]=g.general_profile_compatibility_flags_3,p[5]=g.general_profile_compatibility_flags_4,p[6]=g.general_constraint_indicator_flags_1,p[7]=g.general_constraint_indicator_flags_2,p[8]=g.general_constraint_indicator_flags_3,p[9]=g.general_constraint_indicator_flags_4,p[10]=g.general_constraint_indicator_flags_5,p[11]=g.general_constraint_indicator_flags_6,p[12]=g.general_level_idc,p[13]=240|(3840&g.min_spatial_segmentation_idc)>>8,p[14]=255&g.min_spatial_segmentation_idc,p[15]=252|3&g.parallelismType,p[16]=252|3&g.chroma_format_idc,p[17]=248|7&g.bit_depth_luma_minus8,p[18]=248|7&g.bit_depth_chroma_minus8,p[19]=0,p[20]=0,p[21]=(3&g.constant_frame_rate)<<6|(7&g.num_temporal_layers)<<3|(g.temporal_id_nested?1:0)<<2|3,p[22]=3,p[23]=128|v.kSliceVPS,p[24]=0,p[25]=1,p[26]=(65280&u.byteLength)>>8,p[27]=(255&u.byteLength)>>0,p.set(u,28),p[23+(5+u.byteLength)+0]=128|v.kSliceSPS,p[23+(5+u.byteLength)+1]=0,p[23+(5+u.byteLength)+2]=1,p[23+(5+u.byteLength)+3]=(65280&s.byteLength)>>8,p[23+(5+u.byteLength)+4]=(255&s.byteLength)>>0,p.set(s,23+(5+u.byteLength)+5),p[23+(5+u.byteLength+5+s.byteLength)+0]=128|v.kSlicePPS,p[23+(5+u.byteLength+5+s.byteLength)+1]=0,p[23+(5+u.byteLength+5+s.byteLength)+2]=1,p[23+(5+u.byteLength+5+s.byteLength)+3]=(65280&a.byteLength)>>8,p[23+(5+u.byteLength+5+s.byteLength)+4]=(255&a.byteLength)>>0,p.set(a,23+(5+u.byteLength+5+s.byteLength)+5)}return d.prototype.getData=function(){return this.data},d}(),ue=B(15),pe=function(){},ce=function(){},ge=function(){},Ee=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],_e=function(){function d(u){this.TAG="AC3Parser",this.data_=u,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&b.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return d.prototype.findNextSyncwordOffset=function(u){for(var s=u,a=this.data_;;){if(s+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if((a[s+0]<<8|a[s+1]<<0)===2935)return s;s++}},d.prototype.readNextAC3Frame=function(){for(var u=this.data_,s=null;s==null&&!this.eof_flag_;){var a=this.current_syncword_offset_,g=u[a+4]>>6,D=[48e3,44200,33e3][g],p=63&u[a+4],M=2*Ee[g][p];if(a+M>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var V=this.findNextSyncwordOffset(a+M);this.current_syncword_offset_=V;var O=u[a+5]>>3,K=7&u[a+5],X=u[a+6]>>5,J=0;1&X&&X!==1&&(J+=2),4&X&&(J+=2),X===2&&(J+=2);var $=(u[a+6]<<8|u[a+7]<<0)>>12-J&1,de=[2,1,2,3,3,4,4,5][X]+$;(s=new ge).sampling_frequency=D,s.channel_count=de,s.channel_mode=X,s.bit_stream_identification=O,s.low_frequency_effects_channel_on=$,s.bit_stream_mode=K,s.frame_size_code=p,s.data=u.subarray(a,a+M)}return s},d.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},d.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},d}(),ye=function(d){var u;u=[d.sampling_rate_code<<6|d.bit_stream_identification<<1|d.bit_stream_mode>>2,(3&d.bit_stream_mode)<<6|d.channel_mode<<3|d.low_frequency_effects_channel_on<<2|d.frame_size_code>>4,d.frame_size_code<<4&224],this.config=u,this.sampling_rate=d.sampling_frequency,this.bit_stream_identification=d.bit_stream_identification,this.bit_stream_mode=d.bit_stream_mode,this.low_frequency_effects_channel_on=d.low_frequency_effects_channel_on,this.channel_count=d.channel_count,this.channel_mode=d.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},ve=function(){},we=function(){function d(u){this.TAG="EAC3Parser",this.data_=u,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&b.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return d.prototype.findNextSyncwordOffset=function(u){for(var s=u,a=this.data_;;){if(s+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if((a[s+0]<<8|a[s+1]<<0)===2935)return s;s++}},d.prototype.readNextEAC3Frame=function(){for(var u=this.data_,s=null;s==null&&!this.eof_flag_;){var a=this.current_syncword_offset_,g=new x.a(u.subarray(a+2)),D=(g.readBits(2),g.readBits(3),g.readBits(11)+1<<1),p=g.readBits(2),M=null,V=null;p===3?(M=[24e3,22060,16e3][p=g.readBits(2)],V=3):(M=[48e3,44100,32e3][p],V=g.readBits(2));var O=g.readBits(3),K=g.readBits(1),X=g.readBits(5);if(a+D>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var J=this.findNextSyncwordOffset(a+D);this.current_syncword_offset_=J;var $=[2,1,2,3,3,4,4,5][O]+K;g.destroy(),(s=new ve).sampling_frequency=M,s.channel_count=$,s.channel_mode=O,s.bit_stream_identification=X,s.low_frequency_effects_channel_on=K,s.frame_size=D,s.num_blks=[1,2,3,6][V],s.data=u.subarray(a,a+D)}return s},d.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},d.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},d}(),Oe=function(d){var u,s=Math.floor(d.frame_size*d.sampling_frequency/(16*d.num_blks));u=[255&s,248&s,d.sampling_rate_code<<6|d.bit_stream_identification<<1|0,0|d.channel_mode<<1|d.low_frequency_effects_channel_on<<0,0],this.config=u,this.sampling_rate=d.sampling_frequency,this.bit_stream_identification=d.bit_stream_identification,this.num_blks=d.num_blks,this.low_frequency_effects_channel_on=d.low_frequency_effects_channel_on,this.channel_count=d.channel_count,this.channel_mode=d.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},De=function(){},Pe=function(){var d=function(u,s){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,g){a.__proto__=g}||function(a,g){for(var D in g)Object.prototype.hasOwnProperty.call(g,D)&&(a[D]=g[D])})(u,s)};return function(u,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function a(){this.constructor=u}d(u,s),u.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}(),Me=function(){return(Me=Object.assign||function(d){for(var u,s=1,a=arguments.length;s<a;s++)for(var g in u=arguments[s])Object.prototype.hasOwnProperty.call(u,g)&&(d[g]=u[g]);return d}).apply(this,arguments)},Re=function(d){function u(s,a){var g=d.call(this)||this;return g.TAG="TSDemuxer",g.first_parse_=!0,g.media_info_=new A.a,g.timescale_=90,g.duration_=0,g.current_pmt_pid_=-1,g.program_pmt_map_={},g.pes_slice_queues_={},g.section_slice_queues_={},g.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},g.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},g.audio_last_sample_pts_=void 0,g.aac_last_incomplete_data_=null,g.has_video_=!1,g.has_audio_=!1,g.video_init_segment_dispatched_=!1,g.audio_init_segment_dispatched_=!1,g.video_metadata_changed_=!1,g.audio_metadata_changed_=!1,g.loas_previous_frame=null,g.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},g.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},g.preferred_secondary_audio=!1,g.ts_packet_size_=s.ts_packet_size,g.sync_offset_=s.sync_offset,g.config_=a,g}return Pe(u,d),u.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,d.prototype.destroy.call(this)},u.probe=function(s){var a=new Uint8Array(s),g=-1,D=188;if(a.byteLength<=3*D)return{needMoreData:!0};for(;g===-1;){for(var p=Math.min(1e3,a.byteLength-3*D),M=0;M<p;){if(a[M]===71&&a[M+D]===71&&a[M+2*D]===71){g=M;break}M++}if(g===-1)if(D===188)D=192;else{if(D!==192)break;D=204}}return g===-1?{match:!1}:(D===192&&g>=4?(b.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),g-=4):D===204&&b.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:D,sync_offset:g})},u.prototype.bindDataSource=function(s){return s.onDataArrival=this.parseChunks.bind(this),this},u.prototype.resetMediaInfo=function(){this.media_info_=new A.a},u.prototype.parseChunks=function(s,a){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new l.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var g=0;for(this.first_parse_&&(this.first_parse_=!1,g=this.sync_offset_);g+this.ts_packet_size_<=s.byteLength;){var D=a+g;this.ts_packet_size_===192&&(g+=4);var p=new Uint8Array(s,g,188),M=p[0];if(M!==71){b.a.e(this.TAG,"sync_byte = ".concat(M,", not 0x47"));break}var V=(64&p[1])>>>6,O=(p[1],(31&p[1])<<8|p[2]),K=(48&p[3])>>>4,X=15&p[3],J=!(!this.pmt_||this.pmt_.pcr_pid!==O),$={},de=4;if(K==2||K==3){var he=p[4];if(he>0&&(J||K==3)&&($.discontinuity_indicator=(128&p[5])>>>7,$.random_access_indicator=(64&p[5])>>>6,$.elementary_stream_priority_indicator=(32&p[5])>>>5,(16&p[5])>>>4)){var Te=300*(p[6]<<25|p[7]<<17|p[8]<<9|p[9]<<1|p[10]>>>7)+((1&p[10])<<8|p[11]);this.last_pcr_=Te}if(K==2||5+he===188){g+=188,this.ts_packet_size_===204&&(g+=16);continue}de=5+he}if(K==1||K==3){if(O===0||O===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[O]===N.kSCTE35){var Le=188-de;this.handleSectionSlice(s,g+de,Le,{pid:O,file_position:D,payload_unit_start_indicator:V,continuity_conunter:X,random_access_indicator:$.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[O]!=null){Le=188-de;var be=this.pmt_.pid_stream_type[O];O!==this.pmt_.common_pids.h264&&O!==this.pmt_.common_pids.h265&&O!==this.pmt_.common_pids.adts_aac&&O!==this.pmt_.common_pids.loas_aac&&O!==this.pmt_.common_pids.ac3&&O!==this.pmt_.common_pids.eac3&&O!==this.pmt_.common_pids.opus&&O!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[O]!==!0&&this.pmt_.timed_id3_pids[O]!==!0&&this.pmt_.synchronous_klv_pids[O]!==!0&&this.pmt_.asynchronous_klv_pids[O]!==!0||this.handlePESSlice(s,g+de,Le,{pid:O,stream_type:be,file_position:D,payload_unit_start_indicator:V,continuity_conunter:X,random_access_indicator:$.random_access_indicator})}}g+=188,this.ts_packet_size_===204&&(g+=16)}return this.dispatchAudioVideoMediaSegment(),g},u.prototype.handleSectionSlice=function(s,a,g,D){var p=new Uint8Array(s,a,g),M=this.section_slice_queues_[D.pid];if(D.payload_unit_start_indicator){var V=p[0];if(M!=null&&M.total_length!==0){var O=new Uint8Array(s,a+1,Math.min(g,V));M.slices.push(O),M.total_length+=O.byteLength,M.total_length===M.expected_length?this.emitSectionSlices(M,D):this.clearSlices(M,D)}for(var K=1+V;K<p.byteLength&&p[K+0]!==255;){var X=(15&p[K+1])<<8|p[K+2];this.section_slice_queues_[D.pid]=new I,(M=this.section_slice_queues_[D.pid]).expected_length=X+3,M.file_position=D.file_position,M.random_access_indicator=D.random_access_indicator,O=new Uint8Array(s,a+K,Math.min(g-K,M.expected_length-M.total_length)),M.slices.push(O),M.total_length+=O.byteLength,M.total_length===M.expected_length?this.emitSectionSlices(M,D):M.total_length>=M.expected_length&&this.clearSlices(M,D),K+=O.byteLength}}else M!=null&&M.total_length!==0&&(O=new Uint8Array(s,a,Math.min(g,M.expected_length-M.total_length)),M.slices.push(O),M.total_length+=O.byteLength,M.total_length===M.expected_length?this.emitSectionSlices(M,D):M.total_length>=M.expected_length&&this.clearSlices(M,D))},u.prototype.handlePESSlice=function(s,a,g,D){var p=new Uint8Array(s,a,g),M=p[0]<<16|p[1]<<8|p[2],V=(p[3],p[4]<<8|p[5]);if(D.payload_unit_start_indicator){if(M!==1)return void b.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(M));var O=this.pes_slice_queues_[D.pid];O&&(O.expected_length===0||O.expected_length===O.total_length?this.emitPESSlices(O,D):this.clearSlices(O,D)),this.pes_slice_queues_[D.pid]=new I,this.pes_slice_queues_[D.pid].file_position=D.file_position,this.pes_slice_queues_[D.pid].random_access_indicator=D.random_access_indicator}if(this.pes_slice_queues_[D.pid]!=null){var K=this.pes_slice_queues_[D.pid];K.slices.push(p),D.payload_unit_start_indicator&&(K.expected_length=V===0?0:V+6),K.total_length+=p.byteLength,K.expected_length>0&&K.expected_length===K.total_length?this.emitPESSlices(K,D):K.expected_length>0&&K.expected_length<K.total_length&&this.clearSlices(K,D)}},u.prototype.emitSectionSlices=function(s,a){for(var g=new Uint8Array(s.total_length),D=0,p=0;D<s.slices.length;D++){var M=s.slices[D];g.set(M,p),p+=M.byteLength}s.slices=[],s.expected_length=-1,s.total_length=0;var V=new T;V.pid=a.pid,V.data=g,V.file_position=s.file_position,V.random_access_indicator=s.random_access_indicator,this.parseSection(V)},u.prototype.emitPESSlices=function(s,a){for(var g=new Uint8Array(s.total_length),D=0,p=0;D<s.slices.length;D++){var M=s.slices[D];g.set(M,p),p+=M.byteLength}s.slices=[],s.expected_length=-1,s.total_length=0;var V=new k;V.pid=a.pid,V.data=g,V.stream_type=a.stream_type,V.file_position=s.file_position,V.random_access_indicator=s.random_access_indicator,this.parsePES(V)},u.prototype.clearSlices=function(s,a){s.slices=[],s.expected_length=-1,s.total_length=0},u.prototype.parseSection=function(s){var a=s.data,g=s.pid;g===0?this.parsePAT(a):g===this.current_pmt_pid_?this.parsePMT(a):this.pmt_!=null&&this.pmt_.scte_35_pids[g]&&this.parseSCTE35(a)},u.prototype.parsePES=function(s){var a=s.data,g=a[0]<<16|a[1]<<8|a[2],D=a[3],p=a[4]<<8|a[5];if(g===1)if(D!==188&&D!==190&&D!==191&&D!==240&&D!==241&&D!==255&&D!==242&&D!==248){a[6];var M=(192&a[7])>>>6,V=a[8],O=void 0,K=void 0;M!==2&&M!==3||(O=536870912*(14&a[9])+4194304*(255&a[10])+16384*(254&a[11])+128*(255&a[12])+(254&a[13])/2,K=M===3?536870912*(14&a[14])+4194304*(255&a[15])+16384*(254&a[16])+128*(255&a[17])+(254&a[18])/2:O);var X=9+V,J=void 0;if(p!==0){if(p<3+V)return void b.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");J=p-3-V}else J=a.byteLength-X;var $=a.subarray(X,X+J);switch(s.stream_type){case N.kMPEG1Audio:case N.kMPEG2Audio:this.parseMP3Payload($,O);break;case N.kPESPrivateData:this.pmt_.common_pids.opus===s.pid?this.parseOpusPayload($,O):this.pmt_.common_pids.ac3===s.pid?this.parseAC3Payload($,O):this.pmt_.common_pids.eac3===s.pid?this.parseEAC3Payload($,O):this.pmt_.asynchronous_klv_pids[s.pid]?this.parseAsynchronousKLVMetadataPayload($,s.pid,D):this.pmt_.smpte2038_pids[s.pid]?this.parseSMPTE2038MetadataPayload($,O,K,s.pid,D):this.parsePESPrivateDataPayload($,O,K,s.pid,D);break;case N.kADTSAAC:this.parseADTSAACPayload($,O);break;case N.kLOASAAC:this.parseLOASAACPayload($,O);break;case N.kAC3:this.parseAC3Payload($,O);break;case N.kEAC3:this.parseEAC3Payload($,O);break;case N.kMetadata:this.pmt_.timed_id3_pids[s.pid]?this.parseTimedID3MetadataPayload($,O,K,s.pid,D):this.pmt_.synchronous_klv_pids[s.pid]&&this.parseSynchronousKLVMetadataPayload($,O,K,s.pid,D);break;case N.kH264:this.parseH264Payload($,O,K,s.file_position,s.random_access_indicator);break;case N.kH265:this.parseH265Payload($,O,K,s.file_position,s.random_access_indicator)}}else(D===188||D===191||D===240||D===241||D===255||D===242||D===248)&&s.stream_type===N.kPESPrivateData&&(X=6,J=void 0,J=p!==0?p:a.byteLength-X,$=a.subarray(X,X+J),this.parsePESPrivateDataPayload($,void 0,void 0,s.pid,D));else b.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(g))},u.prototype.parsePAT=function(s){var a=s[0];if(a===0){var g=(15&s[1])<<8|s[2],D=(s[3],s[4],(62&s[5])>>>1),p=1&s[5],M=s[6],V=(s[7],null);if(p===1&&M===0)(V=new n).version_number=D;else if((V=this.pat_)==null)return;for(var O=g-5-4,K=-1,X=-1,J=8;J<8+O;J+=4){var $=s[J]<<8|s[J+1],de=(31&s[J+2])<<8|s[J+3];$===0?V.network_pid=de:(V.program_pmt_pid[$]=de,K===-1&&(K=$),X===-1&&(X=de))}p===1&&M===0&&(this.pat_==null&&b.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(V))),this.pat_=V,this.current_program_=K,this.current_pmt_pid_=X)}else b.a.e(this.TAG,"parsePAT: table_id ".concat(a," is not corresponded to PAT!"))},u.prototype.parsePMT=function(s){var a=s[0];if(a===2){var g=(15&s[1])<<8|s[2],D=s[3]<<8|s[4],p=(62&s[5])>>>1,M=1&s[5],V=s[6],O=(s[7],null);if(M===1&&V===0)(O=new E).program_number=D,O.version_number=p,this.program_pmt_map_[D]=O;else if((O=this.program_pmt_map_[D])==null)return;O.pcr_pid=(31&s[8])<<8|s[9];for(var K=(15&s[10])<<8|s[11],X=12+K,J=g-9-K-4,$=X;$<X+J;){var de=s[$],he=(31&s[$+1])<<8|s[$+2],Te=(15&s[$+3])<<8|s[$+4];O.pid_stream_type[he]=de;var Le=O.common_pids.h264||O.common_pids.h265,be=O.common_pids.adts_aac||O.common_pids.loas_aac||O.common_pids.ac3||O.common_pids.eac3||O.common_pids.opus||O.common_pids.mp3;if(de!==N.kH264||Le)if(de!==N.kH265||Le)if(de!==N.kADTSAAC||be&&!this.preferred_secondary_audio)if(de!==N.kLOASAAC||be&&!this.preferred_secondary_audio)if(de!==N.kAC3||be&&!this.preferred_secondary_audio)if(de!==N.kEAC3||be&&!this.preferred_secondary_audio)if(de!==N.kMPEG1Audio&&de!==N.kMPEG2Audio||be&&!this.preferred_secondary_audio)if(de===N.kPESPrivateData){if(O.pes_private_data_pids[he]=!0,Te>0){for(var Se=$+5;Se<$+5+Te;){var Ie=s[Se+0],xe=s[Se+1];if(Ie===5){var Ce=String.fromCharCode.apply(String,Array.from(s.subarray(Se+2,Se+2+xe)));Ce==="VANC"?O.smpte2038_pids[he]=!0:Ce==="Opus"?O.common_pids.opus=he:Ce==="KLVA"&&(O.asynchronous_klv_pids[he]=!0)}else if(Ie===127&&he===O.common_pids.opus){var Be=null;if(s[Se+2]===128&&(Be=s[Se+3]),Be==null){b.a.e(this.TAG,"Not Supported Opus channel count.");continue}var Ge={codec:"opus",channel_count:15&Be?15&Be:2,channel_config_code:Be,sample_rate:48e3},Fe={codec:"opus",meta:Ge};this.audio_init_segment_dispatched_==0?(this.audio_metadata_=Ge,this.dispatchAudioInitSegment(Fe)):this.detectAudioMetadataChange(Fe)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Fe))}Se+=2+xe}var ke=s.subarray($+5,$+5+Te);this.dispatchPESPrivateDataDescriptor(he,de,ke)}}else if(de===N.kMetadata){if(Te>0)for(Se=$+5;Se<$+5+Te;){Ie=s[Se+0];var Ue=s[Se+1];if(Ie===38){var Ne=s[Se+2]<<8|s[Se+3]<<0,Ae=null;Ne===65535&&(Ae=String.fromCharCode.apply(String,Array.from(s.subarray(Se+4,Se+4+4))));var Ve=null;if(s[Se+4+(Ne===65535?4:0)]===255){var je=4+(Ne===65535?4:0)+1;Ve=String.fromCharCode.apply(String,Array.from(s.subarray(Se+je,Se+je+4)))}Ae==="ID3 "&&Ve==="ID3 "?O.timed_id3_pids[he]=!0:Ve==="KLVA"&&(O.synchronous_klv_pids[he]=!0)}Se+=2+Ue}}else de===N.kSCTE35&&(O.scte_35_pids[he]=!0);else O.common_pids.mp3=he;else O.common_pids.eac3=he;else O.common_pids.ac3=he;else O.common_pids.loas_aac=he;else O.common_pids.adts_aac=he;else O.common_pids.h265=he;else O.common_pids.h264=he;$+=5+Te}D===this.current_program_&&(this.pmt_==null&&b.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(O))),this.pmt_=O,(O.common_pids.h264||O.common_pids.h265)&&(this.has_video_=!0),(O.common_pids.adts_aac||O.common_pids.loas_aac||O.common_pids.ac3||O.common_pids.opus||O.common_pids.mp3)&&(this.has_audio_=!0))}else b.a.e(this.TAG,"parsePMT: table_id ".concat(a," is not corresponded to PMT!"))},u.prototype.parseSCTE35=function(s){var a=W(s);if(a.pts!=null){var g=Math.floor(a.pts/this.timescale_);a.pts=g}else a.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata(a)},u.prototype.parseH264Payload=function(s,a,g,D,p){for(var M=new L(s),V=null,O=[],K=0,X=!1;(V=M.readNextNaluPayload())!=null;){var J=new j(V);if(J.type===m.kSliceSPS){var $=ne.a.parseSPS(V.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(J,$)===!0&&(b.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:J,pps:void 0,details:$}):(this.video_metadata_.sps=J,this.video_metadata_.details=$)}else J.type===m.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=J,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(J.type===m.kSliceIDR||J.type===m.kSliceNonIDR&&p===1)&&(X=!0);this.video_init_segment_dispatched_&&(O.push(J),K+=J.data.byteLength)}var de=Math.floor(a/this.timescale_),he=Math.floor(g/this.timescale_);if(O.length){var Te=this.video_track_,Le={units:O,length:K,isKeyframe:X,dts:he,pts:de,cts:de-he,file_position:D};Te.samples.push(Le),Te.length+=K}},u.prototype.parseH265Payload=function(s,a,g,D,p){for(var M=new fe(s),V=null,O=[],K=0,X=!1;(V=M.readNextNaluPayload())!=null;){var J=new se(V);if(J.type===v.kSliceVPS){if(!this.video_init_segment_dispatched_){var $=ue.a.parseVPS(V.data);this.video_metadata_.vps=J,this.video_metadata_.details=Me(Me({},this.video_metadata_.details),$)}}else J.type===v.kSliceSPS?($=ue.a.parseSPS(V.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(J,$)===!0&&(b.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:J,pps:void 0,details:$}):(this.video_metadata_.sps=J,this.video_metadata_.details=Me(Me({},this.video_metadata_.details),$))):J.type===v.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&($=ue.a.parsePPS(V.data),this.video_metadata_.pps=J,this.video_metadata_.details=Me(Me({},this.video_metadata_.details),$),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):J.type!==v.kSliceIDR_W_RADL&&J.type!==v.kSliceIDR_N_LP&&J.type!==v.kSliceCRA_NUT||(X=!0);this.video_init_segment_dispatched_&&(O.push(J),K+=J.data.byteLength)}var de=Math.floor(a/this.timescale_),he=Math.floor(g/this.timescale_);if(O.length){var Te=this.video_track_,Le={units:O,length:K,isKeyframe:X,dts:he,pts:de,cts:de-he,file_position:D};Te.samples.push(Le),Te.length+=K}},u.prototype.detectVideoMetadataChange=function(s,a){if(a.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return b.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(a.codec_mimetype)),!0;if(a.codec_size.width!==this.video_metadata_.details.codec_size.width||a.codec_size.height!==this.video_metadata_.details.codec_size.height){var g=this.video_metadata_.details.codec_size,D=a.codec_size;return b.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(g.width,"x").concat(g.height," to ").concat(D.width,"x").concat(D.height)),!0}return a.present_size.width!==this.video_metadata_.details.present_size.width&&(b.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(a.present_size.width)),!0)},u.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},u.prototype.dispatchVideoInitSegment=function(){var s=this.video_metadata_.details,a={type:"video"};a.id=this.video_track_.id,a.timescale=1e3,a.duration=this.duration_,a.codecWidth=s.codec_size.width,a.codecHeight=s.codec_size.height,a.presentWidth=s.present_size.width,a.presentHeight=s.present_size.height,a.profile=s.profile_string,a.level=s.level_string,a.bitDepth=s.bit_depth,a.chromaFormat=s.chroma_format,a.sarRatio=s.sar_ratio,a.frameRate=s.frame_rate;var g=a.frameRate.fps_den,D=a.frameRate.fps_num;if(a.refSampleDuration=g/D*1e3,a.codec=s.codec_mimetype,this.video_metadata_.vps){var p=this.video_metadata_.vps.data.subarray(4),M=this.video_metadata_.sps.data.subarray(4),V=this.video_metadata_.pps.data.subarray(4),O=new ie(p,M,V,s);a.hvcc=O.getData(),this.video_init_segment_dispatched_==0&&b.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(a.codec))}else{M=this.video_metadata_.sps.data.subarray(4),V=this.video_metadata_.pps.data.subarray(4);var K=new Q(M,V,s);a.avcc=K.getData(),this.video_init_segment_dispatched_==0&&b.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat(a.codec))}this.onTrackMetadata("video",a),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var X=this.media_info_;X.hasVideo=!0,X.width=a.codecWidth,X.height=a.codecHeight,X.fps=a.frameRate.fps,X.profile=a.profile,X.level=a.level,X.refFrames=s.ref_frames,X.chromaFormat=s.chroma_format_string,X.sarNum=a.sarRatio.width,X.sarDen=a.sarRatio.height,X.videoCodec=a.codec,X.hasAudio&&X.audioCodec?X.mimeType='video/mp2t; codecs="'.concat(X.videoCodec,",").concat(X.audioCodec,'"'):X.mimeType='video/mp2t; codecs="'.concat(X.videoCodec,'"'),X.isComplete()&&this.onMediaInfo(X)},u.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},u.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},u.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},u.prototype.parseADTSAACPayload=function(s,a){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var g=new Uint8Array(s.byteLength+this.aac_last_incomplete_data_.byteLength);g.set(this.aac_last_incomplete_data_,0),g.set(s,this.aac_last_incomplete_data_.byteLength),s=g}var D,p;if(a!=null&&(p=a/this.timescale_),this.audio_metadata_.codec==="aac"){if(a==null&&this.audio_last_sample_pts_!=null)D=1024/this.audio_metadata_.sampling_frequency*1e3,p=this.audio_last_sample_pts_+D;else if(a==null)return void b.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){D=1024/this.audio_metadata_.sampling_frequency*1e3;var M=this.audio_last_sample_pts_+D;Math.abs(M-p)>1&&(b.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(M,"ms, PES pts: ").concat(p,"ms")),p=M)}}for(var V,O=new ae(s),K=null,X=p;(K=O.readNextAACFrame())!=null;){D=1024/K.sampling_frequency*1e3;var J={codec:"aac",data:K};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:K.audio_object_type,sampling_freq_index:K.sampling_freq_index,sampling_frequency:K.sampling_frequency,channel_config:K.channel_config},this.dispatchAudioInitSegment(J)):this.detectAudioMetadataChange(J)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(J)),V=X;var $=Math.floor(X),de={unit:K.data,length:K.data.byteLength,pts:$,dts:$};this.audio_track_.samples.push(de),this.audio_track_.length+=K.data.byteLength,X+=D}O.hasIncompleteData()&&(this.aac_last_incomplete_data_=O.getIncompleteData()),V&&(this.audio_last_sample_pts_=V)}},u.prototype.parseLOASAACPayload=function(s,a){var g;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var D=new Uint8Array(s.byteLength+this.aac_last_incomplete_data_.byteLength);D.set(this.aac_last_incomplete_data_,0),D.set(s,this.aac_last_incomplete_data_.byteLength),s=D}var p,M;if(a!=null&&(M=a/this.timescale_),this.audio_metadata_.codec==="aac"){if(a==null&&this.audio_last_sample_pts_!=null)p=1024/this.audio_metadata_.sampling_frequency*1e3,M=this.audio_last_sample_pts_+p;else if(a==null)return void b.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){p=1024/this.audio_metadata_.sampling_frequency*1e3;var V=this.audio_last_sample_pts_+p;Math.abs(V-M)>1&&(b.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(V,"ms, PES pts: ").concat(M,"ms")),M=V)}}for(var O,K=new Y(s),X=null,J=M;(X=K.readNextAACFrame((g=this.loas_previous_frame)!==null&&g!==void 0?g:void 0))!=null;){this.loas_previous_frame=X,p=1024/X.sampling_frequency*1e3;var $={codec:"aac",data:X};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:X.audio_object_type,sampling_freq_index:X.sampling_freq_index,sampling_frequency:X.sampling_frequency,channel_config:X.channel_config},this.dispatchAudioInitSegment($)):this.detectAudioMetadataChange($)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment($)),O=J;var de=Math.floor(J),he={unit:X.data,length:X.data.byteLength,pts:de,dts:de};this.audio_track_.samples.push(he),this.audio_track_.length+=X.data.byteLength,J+=p}K.hasIncompleteData()&&(this.aac_last_incomplete_data_=K.getIncompleteData()),O&&(this.audio_last_sample_pts_=O)}},u.prototype.parseAC3Payload=function(s,a){if(!this.has_video_||this.video_init_segment_dispatched_){var g,D;if(a!=null&&(D=a/this.timescale_),this.audio_metadata_.codec==="ac-3"){if(a==null&&this.audio_last_sample_pts_!=null)g=1536/this.audio_metadata_.sampling_frequency*1e3,D=this.audio_last_sample_pts_+g;else if(a==null)return void b.a.w(this.TAG,"AC3: Unknown pts")}for(var p,M=new _e(s),V=null,O=D;(V=M.readNextAC3Frame())!=null;){g=1536/V.sampling_frequency*1e3;var K={codec:"ac-3",data:V};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ac-3",sampling_frequency:V.sampling_frequency,bit_stream_identification:V.bit_stream_identification,bit_stream_mode:V.bit_stream_mode,low_frequency_effects_channel_on:V.low_frequency_effects_channel_on,channel_mode:V.channel_mode},this.dispatchAudioInitSegment(K)):this.detectAudioMetadataChange(K)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(K)),p=O;var X=Math.floor(O),J={unit:V.data,length:V.data.byteLength,pts:X,dts:X};this.audio_track_.samples.push(J),this.audio_track_.length+=V.data.byteLength,O+=g}p&&(this.audio_last_sample_pts_=p)}},u.prototype.parseEAC3Payload=function(s,a){if(!this.has_video_||this.video_init_segment_dispatched_){var g,D;if(a!=null&&(D=a/this.timescale_),this.audio_metadata_.codec==="ec-3"){if(a==null&&this.audio_last_sample_pts_!=null)g=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,D=this.audio_last_sample_pts_+g;else if(a==null)return void b.a.w(this.TAG,"EAC3: Unknown pts")}for(var p,M=new we(s),V=null,O=D;(V=M.readNextEAC3Frame())!=null;){g=1536/V.sampling_frequency*1e3;var K={codec:"ec-3",data:V};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ec-3",sampling_frequency:V.sampling_frequency,bit_stream_identification:V.bit_stream_identification,low_frequency_effects_channel_on:V.low_frequency_effects_channel_on,num_blks:V.num_blks,channel_mode:V.channel_mode},this.dispatchAudioInitSegment(K)):this.detectAudioMetadataChange(K)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(K)),p=O;var X=Math.floor(O),J={unit:V.data,length:V.data.byteLength,pts:X,dts:X};this.audio_track_.samples.push(J),this.audio_track_.length+=V.data.byteLength,O+=g}p&&(this.audio_last_sample_pts_=p)}},u.prototype.parseOpusPayload=function(s,a){if(!this.has_video_||this.video_init_segment_dispatched_){var g,D;if(a!=null&&(D=a/this.timescale_),this.audio_metadata_.codec==="opus"){if(a==null&&this.audio_last_sample_pts_!=null)g=20,D=this.audio_last_sample_pts_+g;else if(a==null)return void b.a.w(this.TAG,"Opus: Unknown pts")}for(var p,M=D,V=0;V<s.length;){g=20;for(var O=(16&s[V+1])!=0,K=(8&s[V+1])!=0,X=V+2,J=0;s[X]===255;)J+=255,X+=1;J+=s[X],X+=1,X+=O?2:0,X+=K?2:0,p=M;var $=Math.floor(M),de=s.slice(X,X+J),he={unit:de,length:de.byteLength,pts:$,dts:$};this.audio_track_.samples.push(he),this.audio_track_.length+=de.byteLength,M+=g,V=X+J}p&&(this.audio_last_sample_pts_=p)}},u.prototype.parseMP3Payload=function(s,a){if(!this.has_video_||this.video_init_segment_dispatched_){var g=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],D=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],p=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],M=s[1]>>>3&3,V=(6&s[1])>>1,O=(240&s[2])>>>4,K=(12&s[2])>>>2,X=(s[3]>>>6&3)!==3?2:1,J=0,$=34;switch(M){case 0:J=[11025,12e3,8e3,0][K];break;case 2:J=[22050,24e3,16e3,0][K];break;case 3:J=[44100,48e3,32e3,0][K]}switch(V){case 1:$=34,O<p.length&&p[O];break;case 2:$=33,O<D.length&&D[O];break;case 3:$=32,O<g.length&&g[O]}var de=new ce;de.object_type=$,de.sample_rate=J,de.channel_count=X,de.data=s;var he={codec:"mp3",data:de};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"mp3",object_type:$,sample_rate:J,channel_count:X},this.dispatchAudioInitSegment(he)):this.detectAudioMetadataChange(he)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(he));var Te={unit:s,length:s.byteLength,pts:a/this.timescale_,dts:a/this.timescale_};this.audio_track_.samples.push(Te),this.audio_track_.length+=s.byteLength}},u.prototype.detectAudioMetadataChange=function(s){if(s.codec!==this.audio_metadata_.codec)return b.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(s.codec)),!0;if(s.codec==="aac"&&this.audio_metadata_.codec==="aac"){if((a=s.data).audio_object_type!==this.audio_metadata_.audio_object_type)return b.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(a.audio_object_type)),!0;if(a.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return b.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(a.sampling_freq_index)),!0;if(a.channel_config!==this.audio_metadata_.channel_config)return b.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(a.channel_config)),!0}else if(s.codec==="ac-3"&&this.audio_metadata_.codec==="ac-3"){var a;if((a=s.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return b.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat(a.sampling_frequency)),!0;if(a.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return b.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat(a.bit_stream_identification)),!0;if(a.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return b.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat(a.bit_stream_mode)),!0;if(a.channel_mode!==this.audio_metadata_.channel_mode)return b.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat(a.channel_mode)),!0;if(a.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return b.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat(a.low_frequency_effects_channel_on)),!0}else if(s.codec==="opus"&&this.audio_metadata_.codec==="opus"){if((g=s.meta).sample_rate!==this.audio_metadata_.sample_rate)return b.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(g.sample_rate)),!0;if(g.channel_count!==this.audio_metadata_.channel_count)return b.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(g.channel_count)),!0}else if(s.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var g;if((g=s.data).object_type!==this.audio_metadata_.object_type)return b.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(g.object_type)),!0;if(g.sample_rate!==this.audio_metadata_.sample_rate)return b.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(g.sample_rate)),!0;if(g.channel_count!==this.audio_metadata_.channel_count)return b.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(g.channel_count)),!0}return!1},u.prototype.dispatchAudioInitSegment=function(s){var a={type:"audio"};if(a.id=this.audio_track_.id,a.timescale=1e3,a.duration=this.duration_,this.audio_metadata_.codec==="aac"){var g=s.codec==="aac"?s.data:null,D=new q(g);a.audioSampleRate=D.sampling_rate,a.channelCount=D.channel_count,a.codec=D.codec_mimetype,a.originalCodec=D.original_codec_mimetype,a.config=D.config,a.refSampleDuration=1024/a.audioSampleRate*a.timescale}else if(this.audio_metadata_.codec==="ac-3"){var p=s.codec==="ac-3"?s.data:null,M=new ye(p);a.audioSampleRate=M.sampling_rate,a.channelCount=M.channel_count,a.codec=M.codec_mimetype,a.originalCodec=M.original_codec_mimetype,a.config=M.config,a.refSampleDuration=1536/a.audioSampleRate*a.timescale}else if(this.audio_metadata_.codec==="ec-3"){var V=s.codec==="ec-3"?s.data:null,O=new Oe(V);a.audioSampleRate=O.sampling_rate,a.channelCount=O.channel_count,a.codec=O.codec_mimetype,a.originalCodec=O.original_codec_mimetype,a.config=O.config,a.refSampleDuration=256*O.num_blks/a.audioSampleRate*a.timescale}else this.audio_metadata_.codec==="opus"?(a.audioSampleRate=this.audio_metadata_.sample_rate,a.channelCount=this.audio_metadata_.channel_count,a.channelConfigCode=this.audio_metadata_.channel_config_code,a.codec="opus",a.originalCodec="opus",a.config=void 0,a.refSampleDuration=20):this.audio_metadata_.codec==="mp3"&&(a.audioSampleRate=this.audio_metadata_.sample_rate,a.channelCount=this.audio_metadata_.channel_count,a.codec="mp3",a.originalCodec="mp3",a.config=void 0);this.audio_init_segment_dispatched_==0&&b.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(a.codec)),this.onTrackMetadata("audio",a),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var K=this.media_info_;K.hasAudio=!0,K.audioCodec=a.originalCodec,K.audioSampleRate=a.audioSampleRate,K.audioChannelCount=a.channelCount,K.hasVideo&&K.videoCodec?K.mimeType='video/mp2t; codecs="'.concat(K.videoCodec,",").concat(K.audioCodec,'"'):K.mimeType='video/mp2t; codecs="'.concat(K.audioCodec,'"'),K.isComplete()&&this.onMediaInfo(K)},u.prototype.dispatchPESPrivateDataDescriptor=function(s,a,g){var D=new re;D.pid=s,D.stream_type=a,D.descriptor=g,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(D)},u.prototype.parsePESPrivateDataPayload=function(s,a,g,D,p){var M=new le;if(M.pid=D,M.stream_id=p,M.len=s.byteLength,M.data=s,a!=null){var V=Math.floor(a/this.timescale_);M.pts=V}else M.nearest_pts=this.getNearestTimestampMilliseconds();if(g!=null){var O=Math.floor(g/this.timescale_);M.dts=O}this.onPESPrivateData&&this.onPESPrivateData(M)},u.prototype.parseTimedID3MetadataPayload=function(s,a,g,D,p){var M=new le;if(M.pid=D,M.stream_id=p,M.len=s.byteLength,M.data=s,a!=null){var V=Math.floor(a/this.timescale_);M.pts=V}if(g!=null){var O=Math.floor(g/this.timescale_);M.dts=O}this.onTimedID3Metadata&&this.onTimedID3Metadata(M)},u.prototype.parseSynchronousKLVMetadataPayload=function(s,a,g,D,p){var M=new De;if(M.pid=D,M.stream_id=p,M.len=s.byteLength,M.data=s,a!=null){var V=Math.floor(a/this.timescale_);M.pts=V}if(g!=null){var O=Math.floor(g/this.timescale_);M.dts=O}M.access_units=function(K){for(var X=[],J=0;J+5<K.byteLength;){var $=K[J+0],de=K[J+1],he=K[J+2],Te=K[J+3]<<8|K[J+4]<<0,Le=K.slice(J+5,J+5+Te);X.push({service_id:$,sequence_number:de,flags:he,data:Le}),J+=5+Te}return X}(s),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(M)},u.prototype.parseAsynchronousKLVMetadataPayload=function(s,a,g){var D=new le;D.pid=a,D.stream_id=g,D.len=s.byteLength,D.data=s,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(D)},u.prototype.parseSMPTE2038MetadataPayload=function(s,a,g,D,p){var M=new pe;if(M.pid=D,M.stream_id=p,M.len=s.byteLength,M.data=s,a!=null){var V=Math.floor(a/this.timescale_);M.pts=V}if(M.nearest_pts=this.getNearestTimestampMilliseconds(),g!=null){var O=Math.floor(g/this.timescale_);M.dts=O}M.ancillaries=function(K){for(var X=new x.a(K),J=0,$=[];J+=6,X.readBits(6)===0;){var de=X.readBool();J+=1;var he=X.readBits(11);J+=11;var Te=X.readBits(12);J+=12;var Le=255&X.readBits(10);J+=10;var be=255&X.readBits(10);J+=10;var Se=255&X.readBits(10);J+=10;for(var Ie=new Uint8Array(Se),xe=0;xe<Se;xe++){var Ce=255&X.readBits(10);J+=10,Ie[xe]=Ce}X.readBits(10),J+=10;var Be="User Defined";Le===65?be===7&&(Be="SCTE-104"):Le===95?be===220?Be="ARIB STD-B37 (1SEG)":be===221?Be="ARIB STD-B37 (ANALOG)":be===222?Be="ARIB STD-B37 (SD)":be===223&&(Be="ARIB STD-B37 (HD)"):Le===97&&(be===1?Be="EIA-708":be===2&&(Be="EIA-608")),$.push({yc_indicator:de,line_number:he,horizontal_offset:Te,did:Le,sdid:be,user_data:Ie,description:Be,information:{}}),X.readBits(8-(J-Math.floor(J/8))%8),J+=(8-(J-Math.floor(J/8)))%8}return X.destroy(),X=null,$}(s),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(M)},u.prototype.getNearestTimestampMilliseconds=function(){return this.audio_last_sample_pts_!=null?Math.floor(this.audio_last_sample_pts_):this.last_pcr_!=null?Math.floor(this.last_pcr_/300/this.timescale_):void 0},u}(R);oe.a=Re},function(me,oe,B){var N=B(10),b=function(){function A(){}return A._ebsp2rbsp=function(l){for(var R=l,n=R.byteLength,m=new Uint8Array(n),E=0,k=0;k<n;k++)k>=2&&R[k]===3&&R[k-1]===0&&R[k-2]===0||(m[E]=R[k],E++);return new Uint8Array(m.buffer,0,E)},A.parseVPS=function(l){var R=A._ebsp2rbsp(l),n=new N.a(R);return n.readByte(),n.readByte(),n.readBits(4),n.readBits(2),n.readBits(6),{num_temporal_layers:n.readBits(3)+1,temporal_id_nested:n.readBool()}},A.parseSPS=function(l){var R=A._ebsp2rbsp(l),n=new N.a(R);n.readByte(),n.readByte();for(var m=0,E=0,k=0,T=0,I=(n.readBits(4),n.readBits(3)),Z=(n.readBool(),n.readBits(2)),U=n.readBool(),z=n.readBits(5),j=n.readByte(),L=n.readByte(),Q=n.readByte(),ne=n.readByte(),x=n.readByte(),h=n.readByte(),_=n.readByte(),c=n.readByte(),f=n.readByte(),H=n.readByte(),ee=n.readByte(),ae=[],Y=[],q=0;q<I;q++)ae.push(n.readBool()),Y.push(n.readBool());if(I>0)for(q=I;q<8;q++)n.readBits(2);for(q=0;q<I;q++)ae[q]&&(n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte()),Y[q]&&n.readByte();n.readUEG();var le=n.readUEG();le==3&&n.readBits(1);var re=n.readUEG(),v=n.readUEG();n.readBool()&&(m+=n.readUEG(),E+=n.readUEG(),k+=n.readUEG(),T+=n.readUEG());var e=n.readUEG(),t=n.readUEG(),i=n.readUEG();for(q=n.readBool()?0:I;q<=I;q++)n.readUEG(),n.readUEG(),n.readUEG();if(n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readBool()&&n.readBool())for(var r=0;r<4;r++)for(var o=0;o<(r===3?2:6);o++)if(n.readBool()){var S=Math.min(64,1<<4+(r<<1));for(r>1&&n.readSEG(),q=0;q<S;q++)n.readSEG()}else n.readUEG();n.readBool(),n.readBool(),n.readBool()&&(n.readByte(),n.readUEG(),n.readUEG(),n.readBool());var C=n.readUEG(),y=0;for(q=0;q<C;q++){var w=!1;if(q!==0&&(w=n.readBool()),w){q===C&&n.readUEG(),n.readBool(),n.readUEG();for(var G=0,P=0;P<=y;P++){var F=n.readBool(),W=!1;F||(W=n.readBool()),(F||W)&&G++}y=G}else{var te=n.readUEG(),se=n.readUEG();for(y=te+se,P=0;P<te;P++)n.readUEG(),n.readBool();for(P=0;P<se;P++)n.readUEG(),n.readBool()}}if(n.readBool()){var fe=n.readUEG();for(q=0;q<fe;q++){for(P=0;P<i+4;P++)n.readBits(1);n.readBits(1)}}var ie=0,ue=1,pe=1,ce=!1,ge=1,Ee=1;if(n.readBool(),n.readBool(),n.readBool()){if(n.readBool()){var _e=n.readByte();_e>0&&_e<=16?(ue=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][_e-1],pe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][_e-1]):_e===255&&(ue=n.readBits(16),pe=n.readBits(16))}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(3),n.readBool(),n.readBool()&&(n.readByte(),n.readByte(),n.readByte())),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool(),n.readBool(),n.readBool(),n.readBool()&&(n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG()),n.readBool()&&(ge=n.readBits(32),Ee=n.readBits(32),n.readBool()&&n.readUEG(),n.readBool())){var ye=!1,ve=!1,we=!1;for(ye=n.readBool(),ve=n.readBool(),(ye||ve)&&((we=n.readBool())&&(n.readByte(),n.readBits(5),n.readBool(),n.readBits(5)),n.readBits(4),n.readBits(4),we&&n.readBits(4),n.readBits(5),n.readBits(5),n.readBits(5)),q=0;q<=I;q++){var Oe=n.readBool();ce=Oe;var De=!0,Pe=1;Oe||(De=n.readBool());var Me=!1;if(De?n.readUEG():Me=n.readBool(),Me||(Pe=n.readUEG()+1),ye){for(P=0;P<Pe;P++)n.readUEG(),n.readUEG(),we&&(n.readUEG(),n.readUEG());n.readBool()}if(ve){for(P=0;P<Pe;P++)n.readUEG(),n.readUEG(),we&&(n.readUEG(),n.readUEG());n.readBool()}}}n.readBool()&&(n.readBool(),n.readBool(),n.readBool(),ie=n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG())}n.readBool();var Re="hvc1.".concat(z,".1.L").concat(ee,".B0"),d=re-(m+E)*(le===1||le===2?2:1),u=v-(k+T)*(le===1?2:1),s=1;return ue!==1&&pe!==1&&(s=ue/pe),n.destroy(),n=null,{codec_mimetype:Re,profile_string:A.getProfileString(z),level_string:A.getLevelString(ee),profile_idc:z,bit_depth:e+8,ref_frames:1,chroma_format:le,chroma_format_string:A.getChromaFormatString(le),general_level_idc:ee,general_profile_space:Z,general_tier_flag:U,general_profile_idc:z,general_profile_compatibility_flags_1:j,general_profile_compatibility_flags_2:L,general_profile_compatibility_flags_3:Q,general_profile_compatibility_flags_4:ne,general_constraint_indicator_flags_1:x,general_constraint_indicator_flags_2:h,general_constraint_indicator_flags_3:_,general_constraint_indicator_flags_4:c,general_constraint_indicator_flags_5:f,general_constraint_indicator_flags_6:H,min_spatial_segmentation_idc:ie,constant_frame_rate:0,chroma_format_idc:le,bit_depth_luma_minus8:e,bit_depth_chroma_minus8:t,frame_rate:{fixed:ce,fps:Ee/ge,fps_den:ge,fps_num:Ee},sar_ratio:{width:ue,height:pe},codec_size:{width:d,height:u},present_size:{width:d*s,height:u}}},A.parsePPS=function(l){var R=A._ebsp2rbsp(l),n=new N.a(R);n.readByte(),n.readByte(),n.readUEG(),n.readUEG(),n.readBool(),n.readBool(),n.readBits(3),n.readBool(),n.readBool(),n.readUEG(),n.readUEG(),n.readSEG(),n.readBool(),n.readBool(),n.readBool()&&n.readUEG(),n.readSEG(),n.readSEG(),n.readBool(),n.readBool(),n.readBool(),n.readBool();var m=n.readBool(),E=n.readBool(),k=1;return E&&m?k=0:E?k=3:m&&(k=2),{parallelismType:k}},A.getChromaFormatString=function(l){switch(l){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},A.getProfileString=function(l){switch(l){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},A.getLevelString=function(l){return(l/30).toFixed(1)},A}();oe.a=b},function(me,oe,B){var N,b=B(0),A=function(){function x(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return x.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},x.prototype.addBytes=function(h){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=h,this._totalBytes+=h):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=h,this._totalBytes+=h):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=h,this._totalBytes+=h,this._lastCheckpoint=this._now())},Object.defineProperty(x.prototype,"currentKBps",{get:function(){this.addBytes(0);var h=(this._now()-this._lastCheckpoint)/1e3;return h==0&&(h=1),this._intervalBytes/h/1024},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"averageKBps",{get:function(){var h=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/h/1024},enumerable:!1,configurable:!0}),x}(),l=B(2),R=B(5),n=B(3),m=(N=function(x,h){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,c){_.__proto__=c}||function(_,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(_[f]=c[f])})(x,h)},function(x,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");function _(){this.constructor=x}N(x,h),x.prototype=h===null?Object.create(h):(_.prototype=h.prototype,new _)}),E=function(x){function h(_,c){var f=x.call(this,"fetch-stream-loader")||this;return f.TAG="FetchStreamLoader",f._seekHandler=_,f._config=c,f._needStash=!0,f._requestAbort=!1,f._abortController=null,f._contentLength=null,f._receivedLength=0,f}return m(h,x),h.isSupported=function(){try{var _=R.a.msedge&&R.a.version.minor>=15048,c=!R.a.msedge||_;return self.fetch&&self.ReadableStream&&c}catch{return!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),x.prototype.destroy.call(this)},h.prototype.open=function(_,c){var f=this;this._dataSource=_,this._range=c;var H=_.url;this._config.reuseRedirectedURL&&_.redirectedURL!=null&&(H=_.redirectedURL);var ee=this._seekHandler.getConfig(H,c),ae=new self.Headers;if(typeof ee.headers=="object"){var Y=ee.headers;for(var q in Y)Y.hasOwnProperty(q)&&ae.append(q,Y[q])}var le={method:"GET",headers:ae,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var q in this._config.headers)ae.append(q,this._config.headers[q]);_.cors===!1&&(le.mode="same-origin"),_.withCredentials&&(le.credentials="include"),_.referrerPolicy&&(le.referrerPolicy=_.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,le.signal=this._abortController.signal),this._status=l.c.kConnecting,self.fetch(ee.url,le).then(function(re){if(f._requestAbort)return f._status=l.c.kIdle,void re.body.cancel();if(re.ok&&re.status>=200&&re.status<=299){if(re.url!==ee.url&&f._onURLRedirect){var v=f._seekHandler.removeURLParameters(re.url);f._onURLRedirect(v)}var e=re.headers.get("Content-Length");return e!=null&&(f._contentLength=parseInt(e),f._contentLength!==0&&f._onContentLengthKnown&&f._onContentLengthKnown(f._contentLength)),f._pump.call(f,re.body.getReader())}if(f._status=l.c.kError,!f._onError)throw new n.d("FetchStreamLoader: Http code invalid, "+re.status+" "+re.statusText);f._onError(l.b.HTTP_STATUS_CODE_INVALID,{code:re.status,msg:re.statusText})}).catch(function(re){if(!f._abortController||!f._abortController.signal.aborted){if(f._status=l.c.kError,!f._onError)throw re;f._onError(l.b.EXCEPTION,{code:-1,msg:re.message})}})},h.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==l.c.kBuffering||!R.a.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},h.prototype._pump=function(_){var c=this;return _.read().then(function(f){if(f.done)if(c._contentLength!==null&&c._receivedLength<c._contentLength){c._status=l.c.kError;var H=l.b.EARLY_EOF,ee={code:-1,msg:"Fetch stream meet Early-EOF"};if(!c._onError)throw new n.d(ee.msg);c._onError(H,ee)}else c._status=l.c.kComplete,c._onComplete&&c._onComplete(c._range.from,c._range.from+c._receivedLength-1);else{if(c._abortController&&c._abortController.signal.aborted)return void(c._status=l.c.kComplete);if(c._requestAbort===!0)return c._status=l.c.kComplete,_.cancel();c._status=l.c.kBuffering;var ae=f.value.buffer,Y=c._range.from+c._receivedLength;c._receivedLength+=ae.byteLength,c._onDataArrival&&c._onDataArrival(ae,Y,c._receivedLength),c._pump(_)}}).catch(function(f){if(c._abortController&&c._abortController.signal.aborted)c._status=l.c.kComplete;else if(f.code!==11||!R.a.msedge){c._status=l.c.kError;var H=0,ee=null;if(f.code!==19&&f.message!=="network error"||!(c._contentLength===null||c._contentLength!==null&&c._receivedLength<c._contentLength)?(H=l.b.EXCEPTION,ee={code:f.code,msg:f.message}):(H=l.b.EARLY_EOF,ee={code:f.code,msg:"Fetch stream meet Early-EOF"}),!c._onError)throw new n.d(ee.msg);c._onError(H,ee)}})},h}(l.a),k=function(){var x=function(h,_){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var H in f)Object.prototype.hasOwnProperty.call(f,H)&&(c[H]=f[H])})(h,_)};return function(h,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function c(){this.constructor=h}x(h,_),h.prototype=_===null?Object.create(_):(c.prototype=_.prototype,new c)}}(),T=function(x){function h(_,c){var f=x.call(this,"xhr-moz-chunked-loader")||this;return f.TAG="MozChunkedLoader",f._seekHandler=_,f._config=c,f._needStash=!0,f._xhr=null,f._requestAbort=!1,f._contentLength=null,f._receivedLength=0,f}return k(h,x),h.isSupported=function(){try{var _=new XMLHttpRequest;return _.open("GET","https://example.com",!0),_.responseType="moz-chunked-arraybuffer",_.responseType==="moz-chunked-arraybuffer"}catch(c){return b.a.w("MozChunkedLoader",c.message),!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),x.prototype.destroy.call(this)},h.prototype.open=function(_,c){this._dataSource=_,this._range=c;var f=_.url;this._config.reuseRedirectedURL&&_.redirectedURL!=null&&(f=_.redirectedURL);var H=this._seekHandler.getConfig(f,c);this._requestURL=H.url;var ee=this._xhr=new XMLHttpRequest;if(ee.open("GET",H.url,!0),ee.responseType="moz-chunked-arraybuffer",ee.onreadystatechange=this._onReadyStateChange.bind(this),ee.onprogress=this._onProgress.bind(this),ee.onloadend=this._onLoadEnd.bind(this),ee.onerror=this._onXhrError.bind(this),_.withCredentials&&(ee.withCredentials=!0),typeof H.headers=="object"){var ae=H.headers;for(var Y in ae)ae.hasOwnProperty(Y)&&ee.setRequestHeader(Y,ae[Y])}if(typeof this._config.headers=="object"){ae=this._config.headers;for(var Y in ae)ae.hasOwnProperty(Y)&&ee.setRequestHeader(Y,ae[Y])}this._status=l.c.kConnecting,ee.send()},h.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=l.c.kComplete},h.prototype._onReadyStateChange=function(_){var c=_.target;if(c.readyState===2){if(c.responseURL!=null&&c.responseURL!==this._requestURL&&this._onURLRedirect){var f=this._seekHandler.removeURLParameters(c.responseURL);this._onURLRedirect(f)}if(c.status!==0&&(c.status<200||c.status>299)){if(this._status=l.c.kError,!this._onError)throw new n.d("MozChunkedLoader: Http code invalid, "+c.status+" "+c.statusText);this._onError(l.b.HTTP_STATUS_CODE_INVALID,{code:c.status,msg:c.statusText})}else this._status=l.c.kBuffering}},h.prototype._onProgress=function(_){if(this._status!==l.c.kError){this._contentLength===null&&_.total!==null&&_.total!==0&&(this._contentLength=_.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var c=_.target.response,f=this._range.from+this._receivedLength;this._receivedLength+=c.byteLength,this._onDataArrival&&this._onDataArrival(c,f,this._receivedLength)}},h.prototype._onLoadEnd=function(_){this._requestAbort!==!0?this._status!==l.c.kError&&(this._status=l.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},h.prototype._onXhrError=function(_){this._status=l.c.kError;var c=0,f=null;if(this._contentLength&&_.loaded<this._contentLength?(c=l.b.EARLY_EOF,f={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(c=l.b.EXCEPTION,f={code:-1,msg:_.constructor.name+" "+_.type}),!this._onError)throw new n.d(f.msg);this._onError(c,f)},h}(l.a),I=function(){var x=function(h,_){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var H in f)Object.prototype.hasOwnProperty.call(f,H)&&(c[H]=f[H])})(h,_)};return function(h,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function c(){this.constructor=h}x(h,_),h.prototype=_===null?Object.create(_):(c.prototype=_.prototype,new c)}}(),Z=(function(x){function h(_,c){var f=x.call(this,"xhr-msstream-loader")||this;return f.TAG="MSStreamLoader",f._seekHandler=_,f._config=c,f._needStash=!0,f._xhr=null,f._reader=null,f._totalRange=null,f._currentRange=null,f._currentRequestURL=null,f._currentRedirectedURL=null,f._contentLength=null,f._receivedLength=0,f._bufferLimit=16777216,f._lastTimeBufferSize=0,f._isReconnecting=!1,f}I(h,x),h.isSupported=function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var _=new XMLHttpRequest;return _.open("GET","https://example.com",!0),_.responseType="ms-stream",_.responseType==="ms-stream"}catch(c){return b.a.w("MSStreamLoader",c.message),!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),x.prototype.destroy.call(this)},h.prototype.open=function(_,c){this._internalOpen(_,c,!1)},h.prototype._internalOpen=function(_,c,f){this._dataSource=_,f?this._currentRange=c:this._totalRange=c;var H=_.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?H=this._currentRedirectedURL:_.redirectedURL!=null&&(H=_.redirectedURL));var ee=this._seekHandler.getConfig(H,c);this._currentRequestURL=ee.url;var ae=this._reader=new self.MSStreamReader;ae.onprogress=this._msrOnProgress.bind(this),ae.onload=this._msrOnLoad.bind(this),ae.onerror=this._msrOnError.bind(this);var Y=this._xhr=new XMLHttpRequest;if(Y.open("GET",ee.url,!0),Y.responseType="ms-stream",Y.onreadystatechange=this._xhrOnReadyStateChange.bind(this),Y.onerror=this._xhrOnError.bind(this),_.withCredentials&&(Y.withCredentials=!0),typeof ee.headers=="object"){var q=ee.headers;for(var le in q)q.hasOwnProperty(le)&&Y.setRequestHeader(le,q[le])}if(typeof this._config.headers=="object"){q=this._config.headers;for(var le in q)q.hasOwnProperty(le)&&Y.setRequestHeader(le,q[le])}this._isReconnecting?this._isReconnecting=!1:this._status=l.c.kConnecting,Y.send()},h.prototype.abort=function(){this._internalAbort(),this._status=l.c.kComplete},h.prototype._internalAbort=function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},h.prototype._xhrOnReadyStateChange=function(_){var c=_.target;if(c.readyState===2)if(c.status>=200&&c.status<=299){if(this._status=l.c.kBuffering,c.responseURL!=null){var f=this._seekHandler.removeURLParameters(c.responseURL);c.responseURL!==this._currentRequestURL&&f!==this._currentRedirectedURL&&(this._currentRedirectedURL=f,this._onURLRedirect&&this._onURLRedirect(f))}var H=c.getResponseHeader("Content-Length");if(H!=null&&this._contentLength==null){var ee=parseInt(H);ee>0&&(this._contentLength=ee,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=l.c.kError,!this._onError)throw new n.d("MSStreamLoader: Http code invalid, "+c.status+" "+c.statusText);this._onError(l.b.HTTP_STATUS_CODE_INVALID,{code:c.status,msg:c.statusText})}else if(c.readyState===3&&c.status>=200&&c.status<=299){this._status=l.c.kBuffering;var ae=c.response;this._reader.readAsArrayBuffer(ae)}},h.prototype._xhrOnError=function(_){this._status=l.c.kError;var c=l.b.EXCEPTION,f={code:-1,msg:_.constructor.name+" "+_.type};if(!this._onError)throw new n.d(f.msg);this._onError(c,f)},h.prototype._msrOnProgress=function(_){var c=_.target.result;if(c!=null){var f=c.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=c.byteLength;var H=this._totalRange.from+this._receivedLength;this._receivedLength+=f.byteLength,this._onDataArrival&&this._onDataArrival(f,H,this._receivedLength),c.byteLength>=this._bufferLimit&&(b.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(H+f.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},h.prototype._doReconnectIfNeeded=function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var _={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,_,!0)}},h.prototype._msrOnLoad=function(_){this._status=l.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},h.prototype._msrOnError=function(_){this._status=l.c.kError;var c=0,f=null;if(this._contentLength&&this._receivedLength<this._contentLength?(c=l.b.EARLY_EOF,f={code:-1,msg:"MSStream meet Early-Eof"}):(c=l.b.EARLY_EOF,f={code:-1,msg:_.constructor.name+" "+_.type}),!this._onError)throw new n.d(f.msg);this._onError(c,f)}}(l.a),function(){var x=function(h,_){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var H in f)Object.prototype.hasOwnProperty.call(f,H)&&(c[H]=f[H])})(h,_)};return function(h,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function c(){this.constructor=h}x(h,_),h.prototype=_===null?Object.create(_):(c.prototype=_.prototype,new c)}}()),U=function(x){function h(_,c){var f=x.call(this,"xhr-range-loader")||this;return f.TAG="RangeLoader",f._seekHandler=_,f._config=c,f._needStash=!1,f._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],f._currentChunkSizeKB=384,f._currentSpeedNormalized=0,f._zeroSpeedChunkCount=0,f._xhr=null,f._speedSampler=new A,f._requestAbort=!1,f._waitForTotalLength=!1,f._totalLengthReceived=!1,f._currentRequestURL=null,f._currentRedirectedURL=null,f._currentRequestRange=null,f._totalLength=null,f._contentLength=null,f._receivedLength=0,f._lastTimeLoaded=0,f}return Z(h,x),h.isSupported=function(){try{var _=new XMLHttpRequest;return _.open("GET","https://example.com",!0),_.responseType="arraybuffer",_.responseType==="arraybuffer"}catch(c){return b.a.w("RangeLoader",c.message),!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),x.prototype.destroy.call(this)},Object.defineProperty(h.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),h.prototype.open=function(_,c){this._dataSource=_,this._range=c,this._status=l.c.kConnecting;var f=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(f=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||f?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},h.prototype._openSubRange=function(){var _=1024*this._currentChunkSizeKB,c=this._range.from+this._receivedLength,f=c+_;this._contentLength!=null&&f-this._range.from>=this._contentLength&&(f=this._range.from+this._contentLength-1),this._currentRequestRange={from:c,to:f},this._internalOpen(this._dataSource,this._currentRequestRange)},h.prototype._internalOpen=function(_,c){this._lastTimeLoaded=0;var f=_.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?f=this._currentRedirectedURL:_.redirectedURL!=null&&(f=_.redirectedURL));var H=this._seekHandler.getConfig(f,c);this._currentRequestURL=H.url;var ee=this._xhr=new XMLHttpRequest;if(ee.open("GET",H.url,!0),ee.responseType="arraybuffer",ee.onreadystatechange=this._onReadyStateChange.bind(this),ee.onprogress=this._onProgress.bind(this),ee.onload=this._onLoad.bind(this),ee.onerror=this._onXhrError.bind(this),_.withCredentials&&(ee.withCredentials=!0),typeof H.headers=="object"){var ae=H.headers;for(var Y in ae)ae.hasOwnProperty(Y)&&ee.setRequestHeader(Y,ae[Y])}if(typeof this._config.headers=="object"){ae=this._config.headers;for(var Y in ae)ae.hasOwnProperty(Y)&&ee.setRequestHeader(Y,ae[Y])}ee.send()},h.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=l.c.kComplete},h.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},h.prototype._onReadyStateChange=function(_){var c=_.target;if(c.readyState===2){if(c.responseURL!=null){var f=this._seekHandler.removeURLParameters(c.responseURL);c.responseURL!==this._currentRequestURL&&f!==this._currentRedirectedURL&&(this._currentRedirectedURL=f,this._onURLRedirect&&this._onURLRedirect(f))}if(c.status>=200&&c.status<=299){if(this._waitForTotalLength)return;this._status=l.c.kBuffering}else{if(this._status=l.c.kError,!this._onError)throw new n.d("RangeLoader: Http code invalid, "+c.status+" "+c.statusText);this._onError(l.b.HTTP_STATUS_CODE_INVALID,{code:c.status,msg:c.statusText})}}},h.prototype._onProgress=function(_){if(this._status!==l.c.kError){if(this._contentLength===null){var c=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,c=!0;var f=_.total;this._internalAbort(),f!=null&f!==0&&(this._totalLength=f)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,c)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var H=_.loaded-this._lastTimeLoaded;this._lastTimeLoaded=_.loaded,this._speedSampler.addBytes(H)}},h.prototype._normalizeSpeed=function(_){var c=this._chunkSizeKBList,f=c.length-1,H=0,ee=0,ae=f;if(_<c[0])return c[0];for(;ee<=ae;){if((H=ee+Math.floor((ae-ee)/2))===f||_>=c[H]&&_<c[H+1])return c[H];c[H]<_?ee=H+1:ae=H-1}},h.prototype._onLoad=function(_){if(this._status!==l.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var c=this._speedSampler.lastSecondKBps;if(c===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(c=this._speedSampler.currentKBps)),c!==0){var f=this._normalizeSpeed(c);this._currentSpeedNormalized!==f&&(this._currentSpeedNormalized=f,this._currentChunkSizeKB=f)}var H=_.target.response,ee=this._range.from+this._receivedLength;this._receivedLength+=H.byteLength;var ae=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():ae=!0,this._onDataArrival&&this._onDataArrival(H,ee,this._receivedLength),ae&&(this._status=l.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},h.prototype._onXhrError=function(_){this._status=l.c.kError;var c=0,f=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(c=l.b.EARLY_EOF,f={code:-1,msg:"RangeLoader meet Early-Eof"}):(c=l.b.EXCEPTION,f={code:-1,msg:_.constructor.name+" "+_.type}),!this._onError)throw new n.d(f.msg);this._onError(c,f)},h}(l.a),z=function(){var x=function(h,_){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var H in f)Object.prototype.hasOwnProperty.call(f,H)&&(c[H]=f[H])})(h,_)};return function(h,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function c(){this.constructor=h}x(h,_),h.prototype=_===null?Object.create(_):(c.prototype=_.prototype,new c)}}(),j=function(x){function h(){var _=x.call(this,"websocket-loader")||this;return _.TAG="WebSocketLoader",_._needStash=!0,_._ws=null,_._requestAbort=!1,_._receivedLength=0,_}return z(h,x),h.isSupported=function(){try{return self.WebSocket!==void 0}catch{return!1}},h.prototype.destroy=function(){this._ws&&this.abort(),x.prototype.destroy.call(this)},h.prototype.open=function(_){try{var c=this._ws=new self.WebSocket(_.url);c.binaryType="arraybuffer",c.onopen=this._onWebSocketOpen.bind(this),c.onclose=this._onWebSocketClose.bind(this),c.onmessage=this._onWebSocketMessage.bind(this),c.onerror=this._onWebSocketError.bind(this),this._status=l.c.kConnecting}catch(H){this._status=l.c.kError;var f={code:H.code,msg:H.message};if(!this._onError)throw new n.d(f.msg);this._onError(l.b.EXCEPTION,f)}},h.prototype.abort=function(){var _=this._ws;!_||_.readyState!==0&&_.readyState!==1||(this._requestAbort=!0,_.close()),this._ws=null,this._status=l.c.kComplete},h.prototype._onWebSocketOpen=function(_){this._status=l.c.kBuffering},h.prototype._onWebSocketClose=function(_){this._requestAbort!==!0?(this._status=l.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},h.prototype._onWebSocketMessage=function(_){var c=this;if(_.data instanceof ArrayBuffer)this._dispatchArrayBuffer(_.data);else if(_.data instanceof Blob){var f=new FileReader;f.onload=function(){c._dispatchArrayBuffer(f.result)},f.readAsArrayBuffer(_.data)}else{this._status=l.c.kError;var H={code:-1,msg:"Unsupported WebSocket message type: "+_.data.constructor.name};if(!this._onError)throw new n.d(H.msg);this._onError(l.b.EXCEPTION,H)}},h.prototype._dispatchArrayBuffer=function(_){var c=_,f=this._receivedLength;this._receivedLength+=c.byteLength,this._onDataArrival&&this._onDataArrival(c,f,this._receivedLength)},h.prototype._onWebSocketError=function(_){this._status=l.c.kError;var c={code:_.code,msg:_.message};if(!this._onError)throw new n.d(c.msg);this._onError(l.b.EXCEPTION,c)},h}(l.a),L=function(){function x(h){this._zeroStart=h||!1}return x.prototype.getConfig=function(h,_){var c={};if(_.from!==0||_.to!==-1){var f=void 0;f=_.to!==-1?"bytes=".concat(_.from.toString(),"-").concat(_.to.toString()):"bytes=".concat(_.from.toString(),"-"),c.Range=f}else this._zeroStart&&(c.Range="bytes=0-");return{url:h,headers:c}},x.prototype.removeURLParameters=function(h){return h},x}(),Q=function(){function x(h,_){this._startName=h,this._endName=_}return x.prototype.getConfig=function(h,_){var c=h;if(_.from!==0||_.to!==-1){var f=!0;c.indexOf("?")===-1&&(c+="?",f=!1),f&&(c+="&"),c+="".concat(this._startName,"=").concat(_.from.toString()),_.to!==-1&&(c+="&".concat(this._endName,"=").concat(_.to.toString()))}return{url:c,headers:{}}},x.prototype.removeURLParameters=function(h){var _=h.split("?")[0],c=void 0,f=h.indexOf("?");f!==-1&&(c=h.substring(f+1));var H="";if(c!=null&&c.length>0)for(var ee=c.split("&"),ae=0;ae<ee.length;ae++){var Y=ee[ae].split("="),q=ae>0;Y[0]!==this._startName&&Y[0]!==this._endName&&(q&&(H+="&"),H+=ee[ae])}return H.length===0?_:_+"?"+H},x}(),ne=function(){function x(h,_,c){this.TAG="IOController",this._config=_,this._extraData=c,this._stashInitialSize=65536,_.stashInitialSize!=null&&_.stashInitialSize>0&&(this._stashInitialSize=_.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,_.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=h,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(h.url),this._refTotalLength=h.filesize?h.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new A,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return x.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},x.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},x.prototype.isPaused=function(){return this._paused},Object.defineProperty(x.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"extraData",{get:function(){return this._extraData},set:function(h){this._extraData=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(h){this._onDataArrival=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(h){this._onSeeked=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onError",{get:function(){return this._onError},set:function(h){this._onError=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onComplete",{get:function(){return this._onComplete},set:function(h){this._onComplete=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(h){this._onRedirect=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(h){this._onRecoveredEarlyEof=h},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentSpeed",{get:function(){return this._loaderClass===U?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),x.prototype._selectSeekHandler=function(){var h=this._config;if(h.seekType==="range")this._seekHandler=new L(this._config.rangeLoadZeroStart);else if(h.seekType==="param"){var _=h.seekParamStart||"bstart",c=h.seekParamEnd||"bend";this._seekHandler=new Q(_,c)}else{if(h.seekType!=="custom")throw new n.b("Invalid seekType in config: ".concat(h.seekType));if(typeof h.customSeekHandler!="function")throw new n.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new h.customSeekHandler}},x.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=j;else if(E.isSupported())this._loaderClass=E;else if(T.isSupported())this._loaderClass=T;else{if(!U.isSupported())throw new n.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=U}},x.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},x.prototype.open=function(h){this._currentRange={from:0,to:-1},h&&(this._currentRange.from=h),this._speedSampler.reset(),h||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},x.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},x.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},x.prototype.resume=function(){if(this._paused){this._paused=!1;var h=this._resumeFrom;this._resumeFrom=0,this._internalSeek(h,!0)}},x.prototype.seek=function(h){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(h,!0)},x.prototype._internalSeek=function(h,_){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(_),this._loader.destroy(),this._loader=null;var c={from:h,to:-1};this._currentRange={from:c.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,c),this._onSeeked&&this._onSeeked()},x.prototype.updateUrl=function(h){if(!h||typeof h!="string"||h.length===0)throw new n.b("Url must be a non-empty string!");this._dataSource.url=h},x.prototype._expandBuffer=function(h){for(var _=this._stashSize;_+1048576<h;)_*=2;if((_+=1048576)!==this._bufferSize){var c=new ArrayBuffer(_);if(this._stashUsed>0){var f=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(c,0,_).set(f,0)}this._stashBuffer=c,this._bufferSize=_}},x.prototype._normalizeSpeed=function(h){var _=this._speedNormalizeList,c=_.length-1,f=0,H=0,ee=c;if(h<_[0])return _[0];for(;H<=ee;){if((f=H+Math.floor((ee-H)/2))===c||h>=_[f]&&h<_[f+1])return _[f];_[f]<h?H=f+1:ee=f-1}},x.prototype._adjustStashSize=function(h){var _=0;(_=this._config.isLive?h/8:h<512?h:h>=512&&h<=1024?Math.floor(1.5*h):2*h)>8192&&(_=8192);var c=1024*_+1048576;this._bufferSize<c&&this._expandBuffer(c),this._stashSize=1024*_},x.prototype._dispatchChunks=function(h,_){return this._currentRange.to=_+h.byteLength-1,this._onDataArrival(h,_)},x.prototype._onURLRedirect=function(h){this._redirectedURL=h,this._onRedirect&&this._onRedirect(h)},x.prototype._onContentLengthKnown=function(h){h&&this._fullRequestFlag&&(this._totalLength=h,this._fullRequestFlag=!1)},x.prototype._onLoaderChunkArrival=function(h,_,c){if(!this._onDataArrival)throw new n.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(h.byteLength);var f=this._speedSampler.lastSecondKBps;if(f!==0){var H=this._normalizeSpeed(f);this._speedNormalized!==H&&(this._speedNormalized=H,this._adjustStashSize(H))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=_),this._stashUsed+h.byteLength<=this._stashSize)(Y=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(h),this._stashUsed),this._stashUsed+=h.byteLength;else if(Y=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var ee=this._stashBuffer.slice(0,this._stashUsed);(q=this._dispatchChunks(ee,this._stashByteStart))<ee.byteLength?q>0&&(le=new Uint8Array(ee,q),Y.set(le,0),this._stashUsed=le.byteLength,this._stashByteStart+=q):(this._stashUsed=0,this._stashByteStart+=q),this._stashUsed+h.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+h.byteLength),Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),Y.set(new Uint8Array(h),this._stashUsed),this._stashUsed+=h.byteLength}else(q=this._dispatchChunks(h,_))<h.byteLength&&((ae=h.byteLength-q)>this._bufferSize&&(this._expandBuffer(ae),Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),Y.set(new Uint8Array(h,q),0),this._stashUsed+=ae,this._stashByteStart=_+q);else if(this._stashUsed===0){var ae;(q=this._dispatchChunks(h,_))<h.byteLength&&((ae=h.byteLength-q)>this._bufferSize&&this._expandBuffer(ae),(Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(h,q),0),this._stashUsed+=ae,this._stashByteStart=_+q)}else{var Y,q;if(this._stashUsed+h.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+h.byteLength),(Y=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(h),this._stashUsed),this._stashUsed+=h.byteLength,(q=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&q>0){var le=new Uint8Array(this._stashBuffer,q);Y.set(le,0)}this._stashUsed-=q,this._stashByteStart+=q}}},x.prototype._flushStashBuffer=function(h){if(this._stashUsed>0){var _=this._stashBuffer.slice(0,this._stashUsed),c=this._dispatchChunks(_,this._stashByteStart),f=_.byteLength-c;if(c<_.byteLength){if(!h){if(c>0){var H=new Uint8Array(this._stashBuffer,0,this._bufferSize),ee=new Uint8Array(_,c);H.set(ee,0),this._stashUsed=ee.byteLength,this._stashByteStart+=c}return 0}b.a.w(this.TAG,"".concat(f," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,f}return 0},x.prototype._onLoaderComplete=function(h,_){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},x.prototype._onLoaderError=function(h,_){switch(b.a.e(this.TAG,"Loader error, code = ".concat(_.code,", msg = ").concat(_.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,h=l.b.UNRECOVERABLE_EARLY_EOF),h){case l.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var c=this._currentRange.to+1;return void(c<this._totalLength&&(b.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(c,!1)))}h=l.b.UNRECOVERABLE_EARLY_EOF;break;case l.b.UNRECOVERABLE_EARLY_EOF:case l.b.CONNECTING_TIMEOUT:case l.b.HTTP_STATUS_CODE_INVALID:case l.b.EXCEPTION:}if(!this._onError)throw new n.d("IOException: "+_.msg);this._onError(h,_)},x}();oe.a=ne},function(me,oe,B){var N=B(9),b=B.n(N),A=B(0),l=B(5),R=B(13);function n(e,t,i){var r=e;if(t+i<r.length){for(;i--;)if((192&r[++t])!=128)return!1;return!0}return!1}var m,E=function(e){for(var t=[],i=e,r=0,o=e.length;r<o;)if(i[r]<128)t.push(String.fromCharCode(i[r])),++r;else{if(!(i[r]<192)){if(i[r]<224){if(n(i,r,1)&&(S=(31&i[r])<<6|63&i[r+1])>=128){t.push(String.fromCharCode(65535&S)),r+=2;continue}}else if(i[r]<240){if(n(i,r,2)&&(S=(15&i[r])<<12|(63&i[r+1])<<6|63&i[r+2])>=2048&&(63488&S)!=55296){t.push(String.fromCharCode(65535&S)),r+=3;continue}}else if(i[r]<248){var S;if(n(i,r,3)&&(S=(7&i[r])<<18|(63&i[r+1])<<12|(63&i[r+2])<<6|63&i[r+3])>65536&&S<1114112){S-=65536,t.push(String.fromCharCode(S>>>10|55296)),t.push(String.fromCharCode(1023&S|56320)),r+=4;continue}}}t.push(""),++r}return t.join("")},k=B(3),T=(m=new ArrayBuffer(2),new DataView(m).setInt16(0,256,!0),new Int16Array(m)[0]===256),I=function(){function e(){}return e.parseScriptData=function(t,i,r){var o={};try{var S=e.parseValue(t,i,r),C=e.parseValue(t,i+S.size,r-S.size);o[S.data]=C.data}catch(y){A.a.e("AMF",y.toString())}return o},e.parseObject=function(t,i,r){if(r<3)throw new k.a("Data not enough when parse ScriptDataObject");var o=e.parseString(t,i,r),S=e.parseValue(t,i+o.size,r-o.size),C=S.objectEnd;return{data:{name:o.data,value:S.data},size:o.size+S.size,objectEnd:C}},e.parseVariable=function(t,i,r){return e.parseObject(t,i,r)},e.parseString=function(t,i,r){if(r<2)throw new k.a("Data not enough when parse String");var o=new DataView(t,i,r).getUint16(0,!T);return{data:o>0?E(new Uint8Array(t,i+2,o)):"",size:2+o}},e.parseLongString=function(t,i,r){if(r<4)throw new k.a("Data not enough when parse LongString");var o=new DataView(t,i,r).getUint32(0,!T);return{data:o>0?E(new Uint8Array(t,i+4,o)):"",size:4+o}},e.parseDate=function(t,i,r){if(r<10)throw new k.a("Data size invalid when parse Date");var o=new DataView(t,i,r),S=o.getFloat64(0,!T),C=o.getInt16(8,!T);return{data:new Date(S+=60*C*1e3),size:10}},e.parseValue=function(t,i,r){if(r<1)throw new k.a("Data not enough when parse Value");var o,S=new DataView(t,i,r),C=1,y=S.getUint8(0),w=!1;try{switch(y){case 0:o=S.getFloat64(1,!T),C+=8;break;case 1:o=!!S.getUint8(1),C+=1;break;case 2:var G=e.parseString(t,i+1,r-1);o=G.data,C+=G.size;break;case 3:o={};var P=0;for((16777215&S.getUint32(r-4,!T))==9&&(P=3);C<r-4;){var F=e.parseObject(t,i+C,r-C-P);if(F.objectEnd)break;o[F.data.name]=F.data.value,C+=F.size}C<=r-3&&(16777215&S.getUint32(C-1,!T))===9&&(C+=3);break;case 8:for(o={},C+=4,P=0,(16777215&S.getUint32(r-4,!T))==9&&(P=3);C<r-8;){var W=e.parseVariable(t,i+C,r-C-P);if(W.objectEnd)break;o[W.data.name]=W.data.value,C+=W.size}C<=r-3&&(16777215&S.getUint32(C-1,!T))===9&&(C+=3);break;case 9:o=void 0,C=1,w=!0;break;case 10:o=[];var te=S.getUint32(1,!T);C+=4;for(var se=0;se<te;se++){var fe=e.parseValue(t,i+C,r-C);o.push(fe.data),C+=fe.size}break;case 11:var ie=e.parseDate(t,i+1,r-1);o=ie.data,C+=ie.size;break;case 12:var ue=e.parseString(t,i+1,r-1);o=ue.data,C+=ue.size;break;default:C=r,A.a.w("AMF","Unsupported AMF value type "+y)}}catch(pe){A.a.e("AMF",pe.toString())}return{data:o,size:C,objectEnd:w}},e}(),Z=B(22),U=B(6),z=B(15);function j(e){return e.byteOffset%2==0&&e.byteLength%2==0}function L(e){return e.byteOffset%4==0&&e.byteLength%4==0}function Q(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}var ne=function(e,t){return e.byteLength===t.byteLength&&(L(e)&&L(t)?function(i,r){return Q(new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4),new Uint32Array(r.buffer,r.byteOffset,r.byteLength/4))}(e,t):j(e)&&j(t)?function(i,r){return Q(new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2))}(e,t):function(i,r){return Q(i,r)}(e,t))},x=B(10),h=function(){function e(){}return e.parseOBUs=function(t){for(var i=null,r=0;r<t.byteLength;){t[r];var o=(120&t[r])>>3,S=(4&t[r])!=0,C=(2&t[r])!=0;t[r],r+=1,S&&(r+=1);var y=Number.POSITIVE_INFINITY;if(C){y=0;for(var w=0;y|=(127&t[r])<<7*w,(128&t[r+=1])!=0;w++);}o===1&&(i=e.parseSeuqneceHeader(t.subarray(r,r+y))),r+=y}return i},e.parseSeuqneceHeader=function(t){var i=new x.a(t),r=i.readBits(3),o=(i.readBool(),i.readBool()),S=!0,C=0,y=0,w=[];if(o)w.push({operating_point_idc:0,level:i.readBits(5),tier:0});else{if(i.readBool()){var G=i.readBits(32),P=i.readBits(32),F=i.readBool();if(F){for(var W=0;i.readBits(1)===0;)W+=1;W>=32||(1<<W)-1+i.readBits(W)}(C=P)/(y=G),S=F,i.readBool()&&(i.readBits(5),i.readBits(32),i.readBits(5),i.readBits(5))}for(var te=i.readBool(),se=i.readBits(5),fe=0;fe<=se;fe++){var ie=i.readBits(12),ue=i.readBits(5),pe=ue>7?i.readBits(1):0;w.push({operating_point_idc:ie,level:ue,tier:pe}),te&&i.readBool()&&i.readBits(4)}}var ce=w[0],ge=ce.level,Ee=ce.tier,_e=i.readBits(4),ye=i.readBits(4),ve=i.readBits(_e+1)+1,we=i.readBits(ye+1)+1,Oe=!1;o||(Oe=i.readBool()),Oe&&(i.readBits(4),i.readBits(4)),i.readBool(),i.readBool(),i.readBool();var De=!1;o||(i.readBool(),i.readBool(),i.readBool(),i.readBool(),(De=i.readBool())&&(i.readBool(),i.readBool()),(i.readBool()||i.readBits(1))&&(i.readBool()||i.readBits(1)),De&&i.readBits(3)+1),i.readBool(),i.readBool(),i.readBool();var Pe=i.readBool(),Me=8;r===2&&Pe?Me=i.readBool()?12:10:Me=Pe?10:8;var Re=!1;r!==1&&(Re=i.readBool()),i.readBool()&&(i.readBits(8),i.readBits(8),i.readBits(8));var d=1,u=1;return Re?(i.readBits(1),d=1,u=1):(i.readBits(1),r==0?(d=1,u=1):r==1?(d=0,u=0):Me==12?i.readBits(1)&&i.readBits(1):(d=1,u=0),d&&u&&i.readBits(2),i.readBits(1)),i.readBool(),i.destroy(),i=null,{codec_mimetype:"av01.".concat(r,".").concat(e.getLevelString(ge,Ee),".").concat(Me.toString(10).padStart(2,"0")),level:ge,tier:Ee,level_string:e.getLevelString(ge,Ee),profile_idc:r,profile_string:"".concat(r),bit_depth:Me,ref_frames:1,chroma_format:e.getChromaFormat(Re,d,u),chroma_format_string:e.getChromaFormatString(Re,d,u),frame_rate:{fixed:S,fps:C/y,fps_den:y,fps_num:C},sar_ratio:{width:1,height:1},codec_size:{width:ve,height:we},present_size:{width:1*ve,height:we}}},e.getLevelString=function(t,i){return"".concat(t.toString(10).padStart(2,"0")).concat(i===0?"M":"H")},e.getChromaFormat=function(t,i,r){return t?0:i===0&&r===0?3:i===1&&r===0?2:i===1&&r===1?1:Number.NaN},e.getChromaFormatString=function(t,i,r){return t?"4:0:0":i===0&&r===0?"4:4:4":i===1&&r===0?"4:2:2":i===1&&r===1?"4:2:0":"Unknown"},e}(),_=function(){function e(t,i){this.TAG="FLVDemuxer",this._config=i,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=t.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=t.hasAudioTrack,this._hasVideo=t.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new R.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(t){var i=new Uint8Array(t);if(i.byteLength<9)return{needMoreData:!0};var r={match:!1};if(i[0]!==70||i[1]!==76||i[2]!==86||i[3]!==1)return r;var o,S,C=(4&i[4])>>>2!=0,y=(1&i[4])!=0,w=(o=i)[S=5]<<24|o[S+1]<<16|o[S+2]<<8|o[S+3];return w<9?r:{match:!0,consumed:w,dataOffset:w,hasAudioTrack:C,hasVideoTrack:y}},e.prototype.bindDataSource=function(t){return t.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(t){this._onTrackMetadata=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(t){this._onMediaInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(t){this._onMetaDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(t){this._onScriptDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(t){this._onDataAvailable=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(t){this._timestampBase=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(t){this._durationOverrided=!0,this._duration=t,this._mediaInfo.duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(t){this._hasAudioFlagOverrided=!0,this._hasAudio=t,this._mediaInfo.hasAudio=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(t){this._hasVideoFlagOverrided=!0,this._hasVideo=t,this._mediaInfo.hasVideo=t},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new R.a},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,i){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new k.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var r=0,o=this._littleEndian;if(i===0){if(!(t.byteLength>13))return 0;r=e.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,i+r!==this._dataOffset&&A.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(S=new DataView(t,r)).getUint32(0,!o)!==0&&A.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),r+=4);r<t.byteLength;){this._dispatch=!0;var S=new DataView(t,r);if(r+11+4>t.byteLength)break;var C=S.getUint8(0),y=16777215&S.getUint32(0,!o);if(r+11+y+4>t.byteLength)break;if(C===8||C===9||C===18){var w=S.getUint8(4),G=S.getUint8(5),P=S.getUint8(6)|G<<8|w<<16|S.getUint8(7)<<24;16777215&S.getUint32(7,!o)&&A.a.w(this.TAG,"Meet tag which has StreamID != 0!");var F=r+11;switch(C){case 8:this._parseAudioData(t,F,y,P);break;case 9:this._parseVideoData(t,F,y,P,i+r);break;case 18:this._parseScriptData(t,F,y)}var W=S.getUint32(11+y,!o);W!==11+y&&A.a.w(this.TAG,"Invalid PrevTagSize ".concat(W)),r+=11+y+4}else A.a.w(this.TAG,"Unsupported tag type ".concat(C,", skipped")),r+=11+y+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),r},e.prototype._parseScriptData=function(t,i,r){var o=I.parseScriptData(t,i,r);if(o.hasOwnProperty("onMetaData")){if(o.onMetaData==null||typeof o.onMetaData!="object")return void A.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&A.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=o;var S=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},S)),typeof S.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=S.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof S.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=S.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof S.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=S.audiodatarate),typeof S.videodatarate=="number"&&(this._mediaInfo.videoDataRate=S.videodatarate),typeof S.width=="number"&&(this._mediaInfo.width=S.width),typeof S.height=="number"&&(this._mediaInfo.height=S.height),typeof S.duration=="number"){if(!this._durationOverrided){var C=Math.floor(S.duration*this._timescale);this._duration=C,this._mediaInfo.duration=C}}else this._mediaInfo.duration=0;if(typeof S.framerate=="number"){var y=Math.floor(1e3*S.framerate);if(y>0){var w=y/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=w,this._referenceFrameRate.fps_num=y,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=w}}if(typeof S.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var G=S.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(G),S.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=S,A.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(o).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},o))},e.prototype._parseKeyframesIndex=function(t){for(var i=[],r=[],o=1;o<t.times.length;o++){var S=this._timestampBase+Math.floor(1e3*t.times[o]);i.push(S),r.push(t.filepositions[o])}return{times:i,filepositions:r}},e.prototype._parseAudioData=function(t,i,r,o){if(r<=1)A.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var S=new DataView(t,i,r).getUint8(0),C=S>>>4;if(C===2||C===10){var y=0,w=(12&S)>>>2;if(w>=0&&w<=4){y=this._flvSoundRateTable[w];var G=1&S,P=this._audioMetadata,F=this._audioTrack;if(P||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(P=this._audioMetadata={}).type="audio",P.id=F.id,P.timescale=this._timescale,P.duration=this._duration,P.audioSampleRate=y,P.channelCount=G===0?1:2),C===10){var W=this._parseAACAudioData(t,i+1,r-1);if(W==null)return;if(W.packetType===0){if(P.config){if(ne(W.data.config,P.config))return;A.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var te=W.data;P.audioSampleRate=te.samplingRate,P.channelCount=te.channelCount,P.codec=te.codec,P.originalCodec=te.originalCodec,P.config=te.config,P.refSampleDuration=1024/P.audioSampleRate*P.timescale,A.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",P),(ie=this._mediaInfo).audioCodec=P.originalCodec,ie.audioSampleRate=P.audioSampleRate,ie.audioChannelCount=P.channelCount,ie.hasVideo?ie.videoCodec!=null&&(ie.mimeType='video/x-flv; codecs="'+ie.videoCodec+","+ie.audioCodec+'"'):ie.mimeType='video/x-flv; codecs="'+ie.audioCodec+'"',ie.isComplete()&&this._onMediaInfo(ie)}else if(W.packetType===1){var se=this._timestampBase+o,fe={unit:W.data,length:W.data.byteLength,dts:se,pts:se};F.samples.push(fe),F.length+=W.data.length}else A.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(W.packetType))}else if(C===2){if(!P.codec){var ie;if((te=this._parseMP3AudioData(t,i+1,r-1,!0))==null)return;P.audioSampleRate=te.samplingRate,P.channelCount=te.channelCount,P.codec=te.codec,P.originalCodec=te.originalCodec,P.refSampleDuration=1152/P.audioSampleRate*P.timescale,A.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",P),(ie=this._mediaInfo).audioCodec=P.codec,ie.audioSampleRate=P.audioSampleRate,ie.audioChannelCount=P.channelCount,ie.audioDataRate=te.bitRate,ie.hasVideo?ie.videoCodec!=null&&(ie.mimeType='video/x-flv; codecs="'+ie.videoCodec+","+ie.audioCodec+'"'):ie.mimeType='video/x-flv; codecs="'+ie.audioCodec+'"',ie.isComplete()&&this._onMediaInfo(ie)}var ue=this._parseMP3AudioData(t,i+1,r-1,!1);if(ue==null)return;se=this._timestampBase+o;var pe={unit:ue,length:ue.byteLength,dts:se,pts:se};F.samples.push(pe),F.length+=ue.length}}else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+w)}else this._onError(U.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+C)}},e.prototype._parseAACAudioData=function(t,i,r){if(!(r<=1)){var o={},S=new Uint8Array(t,i,r);return o.packetType=S[0],S[0]===0?o.data=this._parseAACAudioSpecificConfig(t,i+1,r-1):o.data=S.subarray(1),o}A.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(t,i,r){var o,S,C=new Uint8Array(t,i,r),y=null,w=0,G=null;if(w=o=C[0]>>>3,(S=(7&C[0])<<1|C[1]>>>7)<0||S>=this._mpegSamplingRates.length)this._onError(U.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var P=this._mpegSamplingRates[S],F=(120&C[1])>>>3;if(!(F<0||F>=8)){w===5&&(G=(7&C[1])<<1|C[2]>>>7,(124&C[2])>>>2);var W=self.navigator.userAgent.toLowerCase();return W.indexOf("firefox")!==-1?S>=6?(w=5,y=new Array(4),G=S-3):(w=2,y=new Array(2),G=S):W.indexOf("android")!==-1?(w=2,y=new Array(2),G=S):(w=5,G=S,y=new Array(4),S>=6?G=S-3:F===1&&(w=2,y=new Array(2),G=S)),y[0]=w<<3,y[0]|=(15&S)>>>1,y[1]=(15&S)<<7,y[1]|=(15&F)<<3,w===5&&(y[1]|=(15&G)>>>1,y[2]=(1&G)<<7,y[2]|=8,y[3]=0),{config:y,samplingRate:P,channelCount:F,codec:"mp4a.40."+w,originalCodec:"mp4a.40."+o}}this._onError(U.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(t,i,r,o){if(!(r<4)){this._littleEndian;var S=new Uint8Array(t,i,r),C=null;if(o){if(S[0]!==255)return;var y=S[1]>>>3&3,w=(6&S[1])>>1,G=(240&S[2])>>>4,P=(12&S[2])>>>2,F=(S[3]>>>6&3)!==3?2:1,W=0,te=0;switch(y){case 0:W=this._mpegAudioV25SampleRateTable[P];break;case 2:W=this._mpegAudioV20SampleRateTable[P];break;case 3:W=this._mpegAudioV10SampleRateTable[P]}switch(w){case 1:G<this._mpegAudioL3BitRateTable.length&&(te=this._mpegAudioL3BitRateTable[G]);break;case 2:G<this._mpegAudioL2BitRateTable.length&&(te=this._mpegAudioL2BitRateTable[G]);break;case 3:G<this._mpegAudioL1BitRateTable.length&&(te=this._mpegAudioL1BitRateTable[G])}C={bitRate:te,samplingRate:W,channelCount:F,codec:"mp3",originalCodec:"mp3"}}else C=S;return C}A.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseVideoData=function(t,i,r,o,S){if(r<=1)A.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var C=new Uint8Array(t,i,r)[0],y=(112&C)>>>4;if(128&C){var w=15&C,G=String.fromCharCode.apply(String,new Uint8Array(t,i,r).slice(1,5));if(G==="hvc1")this._parseEnhancedHEVCVideoPacket(t,i+5,r-5,o,S,y,w);else{if(G!=="av01")return void this._onError(U.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(G));this._parseEnhancedAV1VideoPacket(t,i+5,r-5,o,S,y,w)}}else{var P=15&C;if(P===7)this._parseAVCVideoPacket(t,i+1,r-1,o,S,y);else{if(P!==12)return void this._onError(U.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(P));this._parseHEVCVideoPacket(t,i+1,r-1,o,S,y)}}}},e.prototype._parseAVCVideoPacket=function(t,i,r,o,S,C){if(r<4)A.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var y=this._littleEndian,w=new DataView(t,i,r),G=w.getUint8(0),P=(16777215&w.getUint32(0,!y))<<8>>8;if(G===0)this._parseAVCDecoderConfigurationRecord(t,i+4,r-4);else if(G===1)this._parseAVCVideoData(t,i+4,r-4,o,S,C,P);else if(G!==2)return void this._onError(U.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(G))}},e.prototype._parseHEVCVideoPacket=function(t,i,r,o,S,C){if(r<4)A.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var y=this._littleEndian,w=new DataView(t,i,r),G=w.getUint8(0),P=(16777215&w.getUint32(0,!y))<<8>>8;if(G===0)this._parseHEVCDecoderConfigurationRecord(t,i+4,r-4);else if(G===1)this._parseHEVCVideoData(t,i+4,r-4,o,S,C,P);else if(G!==2)return void this._onError(U.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(G))}},e.prototype._parseEnhancedHEVCVideoPacket=function(t,i,r,o,S,C,y){var w=this._littleEndian,G=new DataView(t,i,r);if(y===0)this._parseHEVCDecoderConfigurationRecord(t,i,r);else if(y===1){var P=(4294967040&G.getUint32(0,!w))>>8;this._parseHEVCVideoData(t,i+3,r-3,o,S,C,P)}else if(y===3)this._parseHEVCVideoData(t,i,r,o,S,C,0);else if(y!==2)return void this._onError(U.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(y))},e.prototype._parseEnhancedAV1VideoPacket=function(t,i,r,o,S,C,y){if(this._littleEndian,y===0)this._parseAV1CodecConfigurationRecord(t,i,r);else if(y===1)this._parseAV1VideoData(t,i,r,o,S,C,0);else{if(y===5)return void this._onError(U.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(y));if(y!==2)return void this._onError(U.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(y))}},e.prototype._parseAVCDecoderConfigurationRecord=function(t,i,r){if(r<7)A.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var o=this._videoMetadata,S=this._videoTrack,C=this._littleEndian,y=new DataView(t,i,r);if(o){if(o.avcc!==void 0){var w=new Uint8Array(t,i,r);if(ne(w,o.avcc))return;A.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(o=this._videoMetadata={}).type="video",o.id=S.id,o.timescale=this._timescale,o.duration=this._duration;var G=y.getUint8(0),P=y.getUint8(1);if(y.getUint8(2),y.getUint8(3),G===1&&P!==0)if(this._naluLengthSize=1+(3&y.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var F=31&y.getUint8(5);if(F!==0){F>1&&A.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(F));for(var W=6,te=0;te<F;te++){var se=y.getUint16(W,!C);if(W+=2,se!==0){var fe=new Uint8Array(t,i+W,se);W+=se;var ie=Z.a.parseSPS(fe);if(te===0){o.codecWidth=ie.codec_size.width,o.codecHeight=ie.codec_size.height,o.presentWidth=ie.present_size.width,o.presentHeight=ie.present_size.height,o.profile=ie.profile_string,o.level=ie.level_string,o.bitDepth=ie.bit_depth,o.chromaFormat=ie.chroma_format,o.sarRatio=ie.sar_ratio,o.frameRate=ie.frame_rate,ie.frame_rate.fixed!==!1&&ie.frame_rate.fps_num!==0&&ie.frame_rate.fps_den!==0||(o.frameRate=this._referenceFrameRate);var ue=o.frameRate.fps_den,pe=o.frameRate.fps_num;o.refSampleDuration=o.timescale*(ue/pe);for(var ce=fe.subarray(1,4),ge="avc1.",Ee=0;Ee<3;Ee++){var _e=ce[Ee].toString(16);_e.length<2&&(_e="0"+_e),ge+=_e}o.codec=ge;var ye=this._mediaInfo;ye.width=o.codecWidth,ye.height=o.codecHeight,ye.fps=o.frameRate.fps,ye.profile=o.profile,ye.level=o.level,ye.refFrames=ie.ref_frames,ye.chromaFormat=ie.chroma_format_string,ye.sarNum=o.sarRatio.width,ye.sarDen=o.sarRatio.height,ye.videoCodec=ge,ye.hasAudio?ye.audioCodec!=null&&(ye.mimeType='video/x-flv; codecs="'+ye.videoCodec+","+ye.audioCodec+'"'):ye.mimeType='video/x-flv; codecs="'+ye.videoCodec+'"',ye.isComplete()&&this._onMediaInfo(ye)}}}var ve=y.getUint8(W);if(ve!==0){for(ve>1&&A.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(ve)),W++,te=0;te<ve;te++)se=y.getUint16(W,!C),W+=2,se!==0&&(W+=se);o.avcc=new Uint8Array(r),o.avcc.set(new Uint8Array(t,i,r),0),A.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",o)}else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(U.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseHEVCDecoderConfigurationRecord=function(t,i,r){if(r<22)A.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var o=this._videoMetadata,S=this._videoTrack,C=this._littleEndian,y=new DataView(t,i,r);if(o){if(o.hvcc!==void 0){var w=new Uint8Array(t,i,r);if(ne(w,o.hvcc))return;A.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(o=this._videoMetadata={}).type="video",o.id=S.id,o.timescale=this._timescale,o.duration=this._duration;var G=y.getUint8(0),P=31&y.getUint8(1);if(G===1&&P!==0)if(this._naluLengthSize=1+(3&y.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var F=y.getUint8(22),W=0,te=23;W<F;W++){var se=63&y.getUint8(te+0),fe=y.getUint16(te+1,!C);te+=3;for(var ie=0;ie<fe;ie++){var ue=y.getUint16(te+0,!C);if(ie===0)if(se===33){te+=2;var pe=new Uint8Array(t,i+te,ue),ce=z.a.parseSPS(pe);o.codecWidth=ce.codec_size.width,o.codecHeight=ce.codec_size.height,o.presentWidth=ce.present_size.width,o.presentHeight=ce.present_size.height,o.profile=ce.profile_string,o.level=ce.level_string,o.bitDepth=ce.bit_depth,o.chromaFormat=ce.chroma_format,o.sarRatio=ce.sar_ratio,o.frameRate=ce.frame_rate,ce.frame_rate.fixed!==!1&&ce.frame_rate.fps_num!==0&&ce.frame_rate.fps_den!==0||(o.frameRate=this._referenceFrameRate);var ge=o.frameRate.fps_den,Ee=o.frameRate.fps_num;o.refSampleDuration=o.timescale*(ge/Ee),o.codec=ce.codec_mimetype;var _e=this._mediaInfo;_e.width=o.codecWidth,_e.height=o.codecHeight,_e.fps=o.frameRate.fps,_e.profile=o.profile,_e.level=o.level,_e.refFrames=ce.ref_frames,_e.chromaFormat=ce.chroma_format_string,_e.sarNum=o.sarRatio.width,_e.sarDen=o.sarRatio.height,_e.videoCodec=ce.codec_mimetype,_e.hasAudio?_e.audioCodec!=null&&(_e.mimeType='video/x-flv; codecs="'+_e.videoCodec+","+_e.audioCodec+'"'):_e.mimeType='video/x-flv; codecs="'+_e.videoCodec+'"',_e.isComplete()&&this._onMediaInfo(_e),te+=ue}else te+=2+ue;else te+=2+ue}}o.hvcc=new Uint8Array(r),o.hvcc.set(new Uint8Array(t,i,r),0),A.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",o)}else this._onError(U.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord")}},e.prototype._parseAV1CodecConfigurationRecord=function(t,i,r){if(r<4)A.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var o=this._videoMetadata,S=this._videoTrack,C=(this._littleEndian,new DataView(t,i,r));o?o.av1c!==void 0&&A.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(o=this._videoMetadata={}).type="video",o.id=S.id,o.timescale=this._timescale,o.duration=this._duration);var y=127&C.getUint8(0);if(C.getUint8(1),C.getUint8(1),C.getUint8(2),y===1){var w=h.parseOBUs(new Uint8Array(t,i+4,r-4));if(w!=null){o.codecWidth=w.codec_size.width,o.codecHeight=w.codec_size.height,o.presentWidth=w.present_size.width,o.presentHeight=w.present_size.height,o.profile=w.profile_string,o.level=w.level_string,o.bitDepth=w.bit_depth,o.chromaFormat=w.chroma_format,o.sarRatio=w.sar_ratio,o.frameRate=w.frame_rate,w.frame_rate.fixed!==!1&&w.frame_rate.fps_num!==0&&w.frame_rate.fps_den!==0||(o.frameRate=this._referenceFrameRate);var G=o.frameRate.fps_den,P=o.frameRate.fps_num;o.refSampleDuration=o.timescale*(G/P),o.codec=w.codec_mimetype;var F=this._mediaInfo;F.width=o.codecWidth,F.height=o.codecHeight,F.fps=o.frameRate.fps,F.profile=o.profile,F.level=o.level,F.refFrames=w.ref_frames,F.chromaFormat=w.chroma_format_string,F.sarNum=o.sarRatio.width,F.sarDen=o.sarRatio.height,F.videoCodec=w.codec_mimetype,F.hasAudio?F.audioCodec!=null&&(F.mimeType='video/x-flv; codecs="'+F.videoCodec+","+F.audioCodec+'"'):F.mimeType='video/x-flv; codecs="'+F.videoCodec+'"',F.isComplete()&&this._onMediaInfo(F),o.av1c=new Uint8Array(r),o.av1c.set(new Uint8Array(t,i,r),0),A.a.v(this.TAG,"Parsed AV1CodecConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",o)}else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(U.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},e.prototype._parseAVCVideoData=function(t,i,r,o,S,C,y){for(var w=this._littleEndian,G=new DataView(t,i,r),P=[],F=0,W=0,te=this._naluLengthSize,se=this._timestampBase+o,fe=C===1;W<r;){if(W+4>=r){A.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(se,", offset = ").concat(W,", dataSize = ").concat(r));break}var ie=G.getUint32(W,!w);if(te===3&&(ie>>>=8),ie>r-te)return void A.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(se,", NaluSize > DataSize!"));var ue=31&G.getUint8(W+te);ue===5&&(fe=!0);var pe=new Uint8Array(t,i+W,te+ie),ce={type:ue,data:pe};P.push(ce),F+=pe.byteLength,W+=te+ie}if(P.length){var ge=this._videoTrack,Ee={units:P,length:F,isKeyframe:fe,dts:se,cts:y,pts:se+y};fe&&(Ee.fileposition=S),ge.samples.push(Ee),ge.length+=F}},e.prototype._parseHEVCVideoData=function(t,i,r,o,S,C,y){for(var w=this._littleEndian,G=new DataView(t,i,r),P=[],F=0,W=0,te=this._naluLengthSize,se=this._timestampBase+o,fe=C===1;W<r;){if(W+4>=r){A.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(se,", offset = ").concat(W,", dataSize = ").concat(r));break}var ie=G.getUint32(W,!w);if(te===3&&(ie>>>=8),ie>r-te)return void A.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(se,", NaluSize > DataSize!"));var ue=31&G.getUint8(W+te);ue!==19&&ue!==20||(fe=!0);var pe=new Uint8Array(t,i+W,te+ie),ce={type:ue,data:pe};P.push(ce),F+=pe.byteLength,W+=te+ie}if(P.length){var ge=this._videoTrack,Ee={units:P,length:F,isKeyframe:fe,dts:se,cts:y,pts:se+y};fe&&(Ee.fileposition=S),ge.samples.push(Ee),ge.length+=F}},e.prototype._parseAV1VideoData=function(t,i,r,o,S,C,y){this._littleEndian;var w,G=[],P=this._timestampBase+o,F=C===1;if(w=r,G.push({unitType:0,data:new Uint8Array(t,i+0,r)}),G.length){var W=this._videoTrack,te={units:G,length:w,isKeyframe:F,dts:P,cts:y,pts:P+y};F&&(te.fileposition=S),W.samples.push(te),W.length+=w}},e}(),c=B(14),f=function(e,t,i){for(var r,o=0,S=t.length;o<S;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},H=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=e.constants={};i.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),i.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),i.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),i.STSC=i.STCO=i.STTS,i.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),i.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),i.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),i.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(t){for(var i=8,r=null,o=Array.prototype.slice.call(arguments,1),S=o.length,C=0;C<S;C++)i+=o[C].byteLength;(r=new Uint8Array(i))[0]=i>>>24&255,r[1]=i>>>16&255,r[2]=i>>>8&255,r[3]=255&i,r.set(t,4);var y=8;for(C=0;C<S;C++)r.set(o[C],y),y+=o[C].byteLength;return r},e.generateInitSegment=function(t){var i=e.box(e.types.ftyp,e.constants.FTYP),r=e.moov(t),o=new Uint8Array(i.byteLength+r.byteLength);return o.set(i,0),o.set(r,i.byteLength),o},e.moov=function(t){var i=e.mvhd(t.timescale,t.duration),r=e.trak(t),o=e.mvex(t);return e.box(e.types.moov,i,r,o)},e.mvhd=function(t,i){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var i=t.id,r=t.duration,o=t.presentWidth,S=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>>8&255,255&o,0,0,S>>>8&255,255&S,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var i=t.timescale,r=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,r>>>24&255,r>>>16&255,r>>>8&255,255&r,85,196,0,0]))},e.hdlr=function(t){var i=null;return i=t.type==="audio"?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,i)},e.minf=function(t){var i=null;return i=t.type==="audio"?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,i,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return t.type==="audio"?t.codec==="mp3"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):t.codec==="ac-3"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ac3(t)):t.codec==="ec-3"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ec3(t)):t.codec==="opus"?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.Opus(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):t.type==="video"&&t.codec.startsWith("hvc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hvc1(t)):t.type==="video"&&t.codec.startsWith("av01")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.av01(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var i=t.channelCount,r=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return e.box(e.types[".mp3"],o)},e.mp4a=function(t){var i=t.channelCount,r=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return e.box(e.types.mp4a,o,e.esds(t))},e.ac3=function(t){var i=t.channelCount,r=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return e.box(e.types["ac-3"],o,e.box(e.types.dac3,new Uint8Array(t.config)))},e.ec3=function(t){var i=t.channelCount,r=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return e.box(e.types["ec-3"],o,e.box(e.types.dec3,new Uint8Array(t.config)))},e.esds=function(t){var i=t.config||[],r=i.length,o=new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(i).concat([6,1,2]));return e.box(e.types.esds,o)},e.Opus=function(t){var i=t.channelCount,r=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return e.box(e.types.Opus,o,e.dOps(t))},e.dOps=function(t){var i=t.channelCount,r=t.channelConfigCode,o=t.audioSampleRate;if(t.config)return e.box(e.types.dOps,C);var S=[];switch(r){case 1:case 2:S=[0];break;case 0:S=[255,1,1,0,1];break;case 128:S=[255,2,0,0,1];break;case 3:S=[1,2,1,0,2,1];break;case 4:S=[1,2,2,0,1,2,3];break;case 5:S=[1,3,2,0,4,1,2,3];break;case 6:S=[1,4,2,0,4,1,2,3,5];break;case 7:S=[1,4,2,0,4,1,2,3,5,6];break;case 8:S=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:S=[1,1,2,0,1];break;case 131:S=[1,1,3,0,1,2];break;case 132:S=[1,1,4,0,1,2,3];break;case 133:S=[1,1,5,0,1,2,3,4];break;case 134:S=[1,1,6,0,1,2,3,4,5];break;case 135:S=[1,1,7,0,1,2,3,4,5,6];break;case 136:S=[1,1,8,0,1,2,3,4,5,6,7]}var C=new Uint8Array(f([0,i,0,0,o>>>24&255,o>>>17&255,o>>>8&255,o>>>0&255,0,0],S));return e.box(e.types.dOps,C)},e.avc1=function(t){var i=t.avcc,r=t.codecWidth,o=t.codecHeight,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>>8&255,255&r,o>>>8&255,255&o,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,S,e.box(e.types.avcC,i))},e.hvc1=function(t){var i=t.hvcc,r=t.codecWidth,o=t.codecHeight,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>>8&255,255&r,o>>>8&255,255&o,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hvc1,S,e.box(e.types.hvcC,i))},e.av01=function(t){var i=t.av1c,r=t.codecWidth||192,o=t.codecHeight||108,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>>8&255,255&r,o>>>8&255,255&o,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.av01,S,e.box(e.types.av1C,i))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var i=t.id,r=new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,r)},e.moof=function(t,i){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,i))},e.mfhd=function(t){var i=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,i)},e.traf=function(t,i){var r=t.id,o=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r])),S=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),C=e.sdtp(t),y=e.trun(t,C.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,o,S,y,C)},e.sdtp=function(t){for(var i=t.samples||[],r=i.length,o=new Uint8Array(4+r),S=0;S<r;S++){var C=i[S].flags;o[S+4]=C.isLeading<<6|C.dependsOn<<4|C.isDependedOn<<2|C.hasRedundancy}return e.box(e.types.sdtp,o)},e.trun=function(t,i){var r=t.samples||[],o=r.length,S=12+16*o,C=new Uint8Array(S);i+=8+S,C.set([0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,255&o,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0);for(var y=0;y<o;y++){var w=r[y].duration,G=r[y].size,P=r[y].flags,F=r[y].cts;C.set([w>>>24&255,w>>>16&255,w>>>8&255,255&w,G>>>24&255,G>>>16&255,G>>>8&255,255&G,P.isLeading<<2|P.dependsOn,P.isDependedOn<<6|P.hasRedundancy<<4|P.isNonSync,0,0,F>>>24&255,F>>>16&255,F>>>8&255,255&F],12+16*y)}return e.box(e.types.trun,C)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();H.init();var ee=H,ae=function(){function e(){}return e.getSilentFrame=function(t,i){if(t==="mp4a.40.2"){if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),Y=B(12),q=function(){function e(t){this.TAG="MP4Remuxer",this._config=t,this._isLive=t.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Y.c("audio"),this._videoSegmentInfoList=new Y.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!l.a.chrome||!(l.a.version.major<50||l.a.version.major===50&&l.a.version.build<2661)),this._fillSilentAfterSeek=l.a.msedge||l.a.msie,this._mp3UseMpegAudio=!l.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},e.prototype.bindDataSource=function(t){return t.onDataAvailable=this.remux.bind(this),t.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(t){this._onInitSegment=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(t){this._onMediaSegment=t},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(t){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(t,i){if(!this._onMediaSegment)throw new k.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(t,i),i&&this._remuxVideo(i),t&&this._remuxAudio(t)},e.prototype._onTrackMetadataReceived=function(t,i){var r=null,o="mp4",S=i.codec;if(t==="audio")this._audioMeta=i,i.codec==="mp3"&&this._mp3UseMpegAudio?(o="mpeg",S="",r=new Uint8Array):r=ee.generateInitSegment(i);else{if(t!=="video")return;this._videoMeta=i,r=ee.generateInitSegment(i)}if(!this._onInitSegment)throw new k.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(t,{type:t,data:r.buffer,codec:S,container:"".concat(t,"/").concat(o),mediaDuration:i.duration})},e.prototype._calculateDtsBase=function(t,i){this._dtsBaseInited||(t&&t.samples&&t.samples.length&&(this._audioDtsBase=t.samples[0].dts),i&&i.samples&&i.samples.length&&(this._videoDtsBase=i.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},e.prototype.flushStashedSamples=function(){var t=this._videoStashedLastSample,i=this._audioStashedLastSample,r={type:"video",id:1,sequenceNumber:0,samples:[],length:0};t!=null&&(r.samples.push(t),r.length=t.length);var o={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};i!=null&&(o.samples.push(i),o.length=i.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(r,!0),this._remuxAudio(o,!0)},e.prototype._remuxAudio=function(t,i){if(this._audioMeta!=null){var r,o=t,S=o.samples,C=void 0,y=-1,w=this._audioMeta.refSampleDuration,G=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,P=this._dtsBaseInited&&this._audioNextDts===void 0,F=!1;if(S&&S.length!==0&&(S.length!==1||i)){var W=0,te=null,se=0;G?(W=0,se=o.length):(W=8,se=8+o.length);var fe=null;if(S.length>1&&(se-=(fe=S.pop()).length),this._audioStashedLastSample!=null){var ie=this._audioStashedLastSample;this._audioStashedLastSample=null,S.unshift(ie),se+=ie.length}fe!=null&&(this._audioStashedLastSample=fe);var ue=S[0].dts-this._dtsBase;if(this._audioNextDts)C=ue-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())C=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(F=!0);else{var pe=this._audioSegmentInfoList.getLastSampleBefore(ue);if(pe!=null){var ce=ue-(pe.originalDts+pe.duration);ce<=3&&(ce=0),C=ue-(pe.dts+pe.duration+ce)}else C=0}if(F){var ge=ue-C,Ee=this._videoSegmentInfoList.getLastSegmentBefore(ue);if(Ee!=null&&Ee.beginDts<ge){if(u=ae.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var _e=Ee.beginDts,ye=ge-Ee.beginDts;A.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(_e,", duration: ").concat(ye)),S.unshift({unit:u,dts:_e,pts:_e}),se+=u.byteLength}}else F=!1}for(var ve=[],we=0;we<S.length;we++){var Oe=(ie=S[we]).unit,De=ie.dts-this._dtsBase,Pe=(_e=De,!1),Me=null,Re=0;if(!(De<-.001)){if(this._audioMeta.codec!=="mp3"){var d=De;if(this._audioNextDts&&(d=this._audioNextDts),(C=De-d)<=-3*w){A.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(De," ms ,curRefDts: ").concat(d," ms)  due to dtsCorrection: ").concat(C," ms overlap."));continue}if(C>=3*w&&this._fillAudioTimestampGap&&!l.a.safari){Pe=!0;var u,s=Math.floor(C/w);A.a.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+"originalDts: ".concat(De," ms, curRefDts: ").concat(d," ms, ")+"dtsCorrection: ".concat(Math.round(C)," ms, generate: ").concat(s," frames")),_e=Math.floor(d),Re=Math.floor(d+w)-_e,(u=ae.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(A.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),u=Oe),Me=[];for(var a=0;a<s;a++){d+=w;var g=Math.floor(d),D=Math.floor(d+w)-g,p={dts:g,pts:g,cts:0,unit:u,size:u.byteLength,duration:D,originalDts:De,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Me.push(p),se+=p.size}this._audioNextDts=d+w}else _e=Math.floor(d),Re=Math.floor(d+w)-_e,this._audioNextDts=d+w}else _e=De-C,we!==S.length-1?Re=S[we+1].dts-this._dtsBase-C-_e:fe!=null?Re=fe.dts-this._dtsBase-C-_e:Re=ve.length>=1?ve[ve.length-1].duration:Math.floor(w),this._audioNextDts=_e+Re;y===-1&&(y=_e),ve.push({dts:_e,pts:_e,cts:0,unit:ie.unit,size:ie.unit.byteLength,duration:Re,originalDts:De,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Pe&&ve.push.apply(ve,Me)}}if(ve.length===0)return o.samples=[],void(o.length=0);for(G?te=new Uint8Array(se):((te=new Uint8Array(se))[0]=se>>>24&255,te[1]=se>>>16&255,te[2]=se>>>8&255,te[3]=255&se,te.set(ee.types.mdat,4)),we=0;we<ve.length;we++)Oe=ve[we].unit,te.set(Oe,W),W+=Oe.byteLength;var M=ve[ve.length-1];r=M.dts+M.duration;var V=new Y.b;V.beginDts=y,V.endDts=r,V.beginPts=y,V.endPts=r,V.originalBeginDts=ve[0].originalDts,V.originalEndDts=M.originalDts+M.duration,V.firstSample=new Y.d(ve[0].dts,ve[0].pts,ve[0].duration,ve[0].originalDts,!1),V.lastSample=new Y.d(M.dts,M.pts,M.duration,M.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(V),o.samples=ve,o.sequenceNumber++;var O=null;O=G?new Uint8Array:ee.moof(o,y),o.samples=[],o.length=0;var K={type:"audio",data:this._mergeBoxes(O,te).buffer,sampleCount:ve.length,info:V};G&&P&&(K.timestampOffset=y),this._onMediaSegment("audio",K)}}},e.prototype._remuxVideo=function(t,i){if(this._videoMeta!=null){var r,o,S=t,C=S.samples,y=void 0,w=-1,G=-1;if(C&&C.length!==0&&(C.length!==1||i)){var P=8,F=null,W=8+t.length,te=null;if(C.length>1&&(W-=(te=C.pop()).length),this._videoStashedLastSample!=null){var se=this._videoStashedLastSample;this._videoStashedLastSample=null,C.unshift(se),W+=se.length}te!=null&&(this._videoStashedLastSample=te);var fe=C[0].dts-this._dtsBase;if(this._videoNextDts)y=fe-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())y=0;else{var ie=this._videoSegmentInfoList.getLastSampleBefore(fe);if(ie!=null){var ue=fe-(ie.originalDts+ie.duration);ue<=3&&(ue=0),y=fe-(ie.dts+ie.duration+ue)}else y=0}for(var pe=new Y.b,ce=[],ge=0;ge<C.length;ge++){var Ee=(se=C[ge]).dts-this._dtsBase,_e=se.isKeyframe,ye=Ee-y,ve=se.cts,we=ye+ve;w===-1&&(w=ye,G=we);var Oe=0;if(ge!==C.length-1?Oe=C[ge+1].dts-this._dtsBase-y-ye:te!=null?Oe=te.dts-this._dtsBase-y-ye:Oe=ce.length>=1?ce[ce.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),_e){var De=new Y.d(ye,we,Oe,se.dts,!0);De.fileposition=se.fileposition,pe.appendSyncPoint(De)}ce.push({dts:ye,pts:we,cts:ve,units:se.units,size:se.length,isKeyframe:_e,duration:Oe,originalDts:Ee,flags:{isLeading:0,dependsOn:_e?2:1,isDependedOn:_e?1:0,hasRedundancy:0,isNonSync:_e?0:1}})}for((F=new Uint8Array(W))[0]=W>>>24&255,F[1]=W>>>16&255,F[2]=W>>>8&255,F[3]=255&W,F.set(ee.types.mdat,4),ge=0;ge<ce.length;ge++)for(var Pe=ce[ge].units;Pe.length;){var Me=Pe.shift().data;F.set(Me,P),P+=Me.byteLength}var Re=ce[ce.length-1];if(r=Re.dts+Re.duration,o=Re.pts+Re.duration,this._videoNextDts=r,pe.beginDts=w,pe.endDts=r,pe.beginPts=G,pe.endPts=o,pe.originalBeginDts=ce[0].originalDts,pe.originalEndDts=Re.originalDts+Re.duration,pe.firstSample=new Y.d(ce[0].dts,ce[0].pts,ce[0].duration,ce[0].originalDts,ce[0].isKeyframe),pe.lastSample=new Y.d(Re.dts,Re.pts,Re.duration,Re.originalDts,Re.isKeyframe),this._isLive||this._videoSegmentInfoList.append(pe),S.samples=ce,S.sequenceNumber++,this._forceFirstIDR){var d=ce[0].flags;d.dependsOn=2,d.isNonSync=0}var u=ee.moof(S,w);S.samples=[],S.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(u,F).buffer,sampleCount:ce.length,info:pe})}}},e.prototype._mergeBoxes=function(t,i){var r=new Uint8Array(t.byteLength+i.byteLength);return r.set(t,0),r.set(i,t.byteLength),r},e}(),le=B(16),re=B(1),v=(B(2),function(){function e(t,i){this.TAG="TransmuxingController",this._emitter=new b.a,this._config=i,t.segments||(t.segments=[{duration:t.duration,filesize:t.filesize,url:t.url}]),typeof t.cors!="boolean"&&(t.cors=!0),typeof t.withCredentials!="boolean"&&(t.withCredentials=!1),this._mediaDataSource=t,this._currentSegmentIndex=0;var r=0;this._mediaDataSource.segments.forEach(function(o){o.timestampBase=r,r+=o.duration,o.cors=t.cors,o.withCredentials=t.withCredentials,i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy)}),isNaN(r)||this._mediaDataSource.duration===r||(this._mediaDataSource.duration=r),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(t,i){this._emitter.addListener(t,i)},e.prototype.off=function(t,i){this._emitter.removeListener(t,i)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(t,i){this._currentSegmentIndex=t;var r=this._mediaDataSource.segments[t],o=this._ioctl=new le.a(r,this._config,t);o.onError=this._onIOException.bind(this),o.onSeeked=this._onIOSeeked.bind(this),o.onComplete=this._onIOComplete.bind(this),o.onRedirect=this._onIORedirect.bind(this),o.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),i?this._demuxer.bindDataSource(this._ioctl):o.onDataArrival=this._onInitChunkArrival.bind(this),o.open(i)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(t){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var i=this._searchSegmentIndexContains(t);if(i===this._currentSegmentIndex){var r=this._mediaInfo.segments[i];if(r==null)this._pendingSeekTime=t;else{var o=r.getNearestKeyframe(t);this._remuxer.seek(o.milliseconds),this._ioctl.seek(o.fileposition),this._pendingResolveSeekPoint=o.milliseconds}}else{var S=this._mediaInfo.segments[i];S==null?(this._pendingSeekTime=t,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(i)):(o=S.getNearestKeyframe(t),this._internalAbort(),this._remuxer.seek(t),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[i].timestampBase,this._loadSegment(i,o.fileposition),this._pendingResolveSeekPoint=o.milliseconds,this._reportSegmentMediaInfo(i))}this._enableStatisticsReporter()}},e.prototype._searchSegmentIndexContains=function(t){for(var i=this._mediaDataSource.segments,r=i.length-1,o=0;o<i.length;o++)if(t<i[o].timestampBase){r=o-1;break}return r},e.prototype._onInitChunkArrival=function(t,i){var r=this,o=0;if(i>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,o=this._demuxer.parseChunks(t,i);else{var S=null;(S=_.probe(t)).match&&(this._setupFLVDemuxerRemuxer(S),o=this._demuxer.parseChunks(t,i)),S.match||S.needMoreData||(S=c.a.probe(t)).match&&(this._setupTSDemuxerRemuxer(S),o=this._demuxer.parseChunks(t,i)),S.match||S.needMoreData||(S=null,A.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(function(){r._internalAbort()}),this._emitter.emit(re.a.DEMUX_ERROR,U.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return o},e.prototype._setupFLVDemuxerRemuxer=function(t){this._demuxer=new _(t,this._config),this._remuxer||(this._remuxer=new q(this._config));var i=this._mediaDataSource;i.duration==null||isNaN(i.duration)||(this._demuxer.overridedDuration=i.duration),typeof i.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=i.hasAudio),typeof i.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=i.hasVideo),this._demuxer.timestampBase=i.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupTSDemuxerRemuxer=function(t){var i=this._demuxer=new c.a(t,this._config);this._remuxer||(this._remuxer=new q(this._config)),i.onError=this._onDemuxException.bind(this),i.onMediaInfo=this._onMediaInfo.bind(this),i.onMetaDataArrived=this._onMetaDataArrived.bind(this),i.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),i.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),i.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),i.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),i.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),i.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),i.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._onMediaInfo=function(t){var i=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},t),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,R.a.prototype));var r=Object.assign({},t);Object.setPrototypeOf(r,R.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=r,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var o=i._pendingSeekTime;i._pendingSeekTime=null,i.seek(o)})},e.prototype._onMetaDataArrived=function(t){this._emitter.emit(re.a.METADATA_ARRIVED,t)},e.prototype._onScriptDataArrived=function(t){this._emitter.emit(re.a.SCRIPTDATA_ARRIVED,t)},e.prototype._onTimedID3Metadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.dts!=null&&(t.dts-=i),this._emitter.emit(re.a.TIMED_ID3_METADATA_ARRIVED,t))},e.prototype._onSynchronousKLVMetadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.dts!=null&&(t.dts-=i),this._emitter.emit(re.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,t))},e.prototype._onAsynchronousKLVMetadata=function(t){this._emitter.emit(re.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)},e.prototype._onSMPTE2038Metadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.dts!=null&&(t.dts-=i),t.nearest_pts!=null&&(t.nearest_pts-=i),this._emitter.emit(re.a.SMPTE2038_METADATA_ARRIVED,t))},e.prototype._onSCTE35Metadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.nearest_pts!=null&&(t.nearest_pts-=i),this._emitter.emit(re.a.SCTE35_METADATA_ARRIVED,t))},e.prototype._onPESPrivateDataDescriptor=function(t){this._emitter.emit(re.a.PES_PRIVATE_DATA_DESCRIPTOR,t)},e.prototype._onPESPrivateData=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.nearest_pts!=null&&(t.nearest_pts-=i),t.dts!=null&&(t.dts-=i),this._emitter.emit(re.a.PES_PRIVATE_DATA_ARRIVED,t))},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(t){var i=t+1;i<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(i)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(re.a.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(t){var i=this._ioctl.extraData;this._mediaDataSource.segments[i].redirectedURL=t},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(re.a.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(t,i){A.a.e(this.TAG,"IOException: type = ".concat(t,", code = ").concat(i.code,", msg = ").concat(i.msg)),this._emitter.emit(re.a.IO_ERROR,t,i),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(t,i){A.a.e(this.TAG,"DemuxException: type = ".concat(t,", info = ").concat(i)),this._emitter.emit(re.a.DEMUX_ERROR,t,i)},e.prototype._onRemuxerInitSegmentArrival=function(t,i){this._emitter.emit(re.a.INIT_SEGMENT,t,i)},e.prototype._onRemuxerMediaSegmentArrival=function(t,i){if(this._pendingSeekTime==null&&(this._emitter.emit(re.a.MEDIA_SEGMENT,t,i),this._pendingResolveSeekPoint!=null&&t==="video")){var r=i.info.syncPoints,o=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,l.a.safari&&r.length>0&&r[0].originalDts===o&&(o=r[0].pts),this._emitter.emit(re.a.RECOMMEND_SEEKPOINT,o)}},e.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(t){var i=this._mediaInfo.segments[t],r=Object.assign({},i);r.duration=this._mediaInfo.duration,r.segmentCount=this._mediaInfo.segmentCount,delete r.segments,delete r.keyframesIndex,this._emitter.emit(re.a.MEDIA_INFO,r)},e.prototype._reportStatisticsInfo=function(){var t={};t.url=this._ioctl.currentURL,t.hasRedirect=this._ioctl.hasRedirect,t.hasRedirect&&(t.redirectedURL=this._ioctl.currentRedirectedURL),t.speed=this._ioctl.currentSpeed,t.loaderType=this._ioctl.loaderType,t.currentSegmentIndex=this._currentSegmentIndex,t.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(re.a.STATISTICS_INFO,t)},e}());oe.a=v},function(me,oe,B){var N=function(){function b(){}return b.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(A,l){return A.__proto__=l,A},Object.assign=Object.assign||function(A){if(A==null)throw new TypeError("Cannot convert undefined or null to object");for(var l=Object(A),R=1;R<arguments.length;R++){var n=arguments[R];if(n!=null)for(var m in n)n.hasOwnProperty(m)&&(l[m]=n[m])}return l},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(A,l){var R=l>0?0|l:0;return this.substring(R,R+A.length)===A}}),typeof self.Promise!="function"&&B(25).polyfill()},b}();N.install(),oe.a=N},function(me,oe,B){var N=B(9),b=B.n(N),A=B(0),l=B(5),R=B(7),n=B(3),m=function(){function E(k){this.TAG="MSEController",this._config=k,this._emitter=new b.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return E.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},E.prototype.on=function(k,T){this._emitter.addListener(k,T)},E.prototype.off=function(k,T){this._emitter.removeListener(k,T)},E.prototype.initialize=function(k){if(this._mediaSource)throw new n.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&A.a.v(this.TAG,"Using ManagedMediaSource");var T=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;T.addEventListener("sourceopen",this.e.onSourceOpen),T.addEventListener("sourceended",this.e.onSourceEnded),T.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(T.addEventListener("startstreaming",this.e.onStartStreaming),T.addEventListener("endstreaming",this.e.onEndStreaming),T.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=k},E.prototype.shutdown=function(){if(this._mediaSource){var k=this._mediaSource;for(var T in this._sourceBuffers){var I=this._pendingSegments[T];I.splice(0,I.length),this._pendingSegments[T]=null,this._pendingRemoveRanges[T]=null,this._lastInitSegments[T]=null;var Z=this._sourceBuffers[T];if(Z){if(k.readyState!=="closed"){try{k.removeSourceBuffer(Z)}catch(U){A.a.e(this.TAG,U.message)}Z.removeEventListener("error",this.e.onSourceBufferError),Z.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[T]=null,this._sourceBuffers[T]=null}}if(k.readyState==="open")try{k.endOfStream()}catch(U){A.a.e(this.TAG,U.message)}this._mediaElementProxy=null,k.removeEventListener("sourceopen",this.e.onSourceOpen),k.removeEventListener("sourceended",this.e.onSourceEnded),k.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(k.removeEventListener("startstraming",this.e.onStartStreaming),k.removeEventListener("endstreaming",this.e.onEndStreaming),k.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},E.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},E.prototype.getObject=function(){if(!this._mediaSource)throw new n.a("MediaSource has not been initialized yet!");return this._mediaSource},E.prototype.getHandle=function(){if(!this._mediaSource)throw new n.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},E.prototype.getObjectURL=function(){if(!this._mediaSource)throw new n.a("MediaSource has not been initialized yet!");return this._mediaSourceObjectURL==null&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},E.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},E.prototype.appendInitSegment=function(k,T){if(T===void 0&&(T=void 0),!this._mediaSource||this._mediaSource.readyState!=="open"||this._mediaSource.streaming===!1)return this._pendingSourceBufferInit.push(k),void this._pendingSegments[k.type].push(k);var I=k,Z="".concat(I.container);I.codec&&I.codec.length>0&&(Z+=";codecs=".concat(I.codec));var U=!1;if(A.a.v(this.TAG,"Received Initialization Segment, mimeType: "+Z),this._lastInitSegments[I.type]=I,Z!==this._mimeTypes[I.type]){if(this._mimeTypes[I.type])A.a.v(this.TAG,"Notice: ".concat(I.type," mimeType changed, origin: ").concat(this._mimeTypes[I.type],", target: ").concat(Z));else{U=!0;try{var z=this._sourceBuffers[I.type]=this._mediaSource.addSourceBuffer(Z);z.addEventListener("error",this.e.onSourceBufferError),z.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(j){return A.a.e(this.TAG,j.message),void this._emitter.emit(R.a.ERROR,{code:j.code,msg:j.message})}}this._mimeTypes[I.type]=Z}T||this._pendingSegments[I.type].push(I),U||this._sourceBuffers[I.type]&&!this._sourceBuffers[I.type].updating&&this._doAppendSegments(),l.a.safari&&I.container==="audio/mpeg"&&I.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=I.mediaDuration/1e3,this._updateMediaSourceDuration())},E.prototype.appendMediaSegment=function(k){var T=k;this._pendingSegments[T.type].push(T),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var I=this._sourceBuffers[T.type];!I||I.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},E.prototype.flush=function(){for(var k in this._sourceBuffers)if(this._sourceBuffers[k]){var T=this._sourceBuffers[k];if(this._mediaSource.readyState==="open")try{T.abort()}catch(L){A.a.e(this.TAG,L.message)}var I=this._pendingSegments[k];if(I.splice(0,I.length),this._mediaSource.readyState!=="closed"){for(var Z=0;Z<T.buffered.length;Z++){var U=T.buffered.start(Z),z=T.buffered.end(Z);this._pendingRemoveRanges[k].push({start:U,end:z})}if(T.updating||this._doRemoveRanges(),l.a.safari){var j=this._lastInitSegments[k];j&&(this._pendingSegments[k].push(j),T.updating||this._doAppendSegments())}}}},E.prototype.endOfStream=function(){var k=this._mediaSource,T=this._sourceBuffers;k&&k.readyState==="open"?T.video&&T.video.updating||T.audio&&T.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,k.endOfStream()):k&&k.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},E.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var k=this._mediaElementProxy.getCurrentTime();for(var T in this._sourceBuffers){var I=this._sourceBuffers[T];if(I){var Z=I.buffered;if(Z.length>=1&&k-Z.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},E.prototype._doCleanupSourceBuffer=function(){var k=this._mediaElementProxy.getCurrentTime();for(var T in this._sourceBuffers){var I=this._sourceBuffers[T];if(I){for(var Z=I.buffered,U=!1,z=0;z<Z.length;z++){var j=Z.start(z),L=Z.end(z);if(j<=k&&k<L+3){if(k-j>=this._config.autoCleanupMaxBackwardDuration){U=!0;var Q=k-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[T].push({start:j,end:Q})}}else L<k&&(U=!0,this._pendingRemoveRanges[T].push({start:j,end:L}))}U&&!I.updating&&this._doRemoveRanges()}}},E.prototype._updateMediaSourceDuration=function(){var k=this._sourceBuffers;if(this._mediaElementProxy.getReadyState()!==0&&this._mediaSource.readyState==="open"&&!(k.video&&k.video.updating||k.audio&&k.audio.updating)){var T=this._mediaSource.duration,I=this._pendingMediaDuration;I>0&&(isNaN(T)||I>T)&&(A.a.v(this.TAG,"Update MediaSource duration from ".concat(T," to ").concat(I)),this._mediaSource.duration=I),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},E.prototype._doRemoveRanges=function(){for(var k in this._pendingRemoveRanges)if(this._sourceBuffers[k]&&!this._sourceBuffers[k].updating)for(var T=this._sourceBuffers[k],I=this._pendingRemoveRanges[k];I.length&&!T.updating;){var Z=I.shift();T.remove(Z.start,Z.end)}},E.prototype._doAppendSegments=function(){var k=this._pendingSegments;for(var T in k)if(this._sourceBuffers[T]&&!this._sourceBuffers[T].updating&&this._mediaSource.streaming!==!1&&k[T].length>0){var I=k[T].shift();if(I.timestampOffset){var Z=this._sourceBuffers[T].timestampOffset,U=I.timestampOffset/1e3;Math.abs(Z-U)>.1&&(A.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(Z," to ").concat(U)),this._sourceBuffers[T].timestampOffset=U),delete I.timestampOffset}if(!I.data||I.data.byteLength===0)continue;try{this._sourceBuffers[T].appendBuffer(I.data),this._isBufferFull=!1}catch(z){this._pendingSegments[T].unshift(I),z.code===22?(this._isBufferFull||this._emitter.emit(R.a.BUFFER_FULL),this._isBufferFull=!0):(A.a.e(this.TAG,z.message),this._emitter.emit(R.a.ERROR,{code:z.code,msg:z.message}))}}},E.prototype._onSourceOpen=function(){if(A.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var k=this._pendingSourceBufferInit;k.length;){var T=k.shift();this.appendInitSegment(T,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(R.a.SOURCE_OPEN)},E.prototype._onStartStreaming=function(){A.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(R.a.START_STREAMING)},E.prototype._onEndStreaming=function(){A.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(R.a.END_STREAMING)},E.prototype._onQualityChange=function(){A.a.v(this.TAG,"ManagedMediaSource onQualityChange")},E.prototype._onSourceEnded=function(){A.a.v(this.TAG,"MediaSource onSourceEnded")},E.prototype._onSourceClose=function(){A.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstraming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},E.prototype._hasPendingSegments=function(){var k=this._pendingSegments;return k.video.length>0||k.audio.length>0},E.prototype._hasPendingRemoveRanges=function(){var k=this._pendingRemoveRanges;return k.video.length>0||k.audio.length>0},E.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(R.a.UPDATE_END)},E.prototype._onSourceBufferError=function(k){A.a.e(this.TAG,"SourceBuffer Error: ".concat(k))},E}();oe.a=m},function(me,oe,B){var N=B(9),b=B.n(N),A=B(21),l=B.n(A),R=B(0),n=B(8),m=B(17),E=B(1),k=(B(23),B(13)),T=B(14),I=function(){function Z(U,z){if(this.TAG="Transmuxer",this._emitter=new b.a,z.enableWorker&&typeof Worker<"u")try{this._worker=l()(23),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[U,z]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},n.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:n.a.getConfig()})}catch{R.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new m.a(U,z)}else this._controller=new m.a(U,z);if(this._controller){var j=this._controller;j.on(E.a.IO_ERROR,this._onIOError.bind(this)),j.on(E.a.DEMUX_ERROR,this._onDemuxError.bind(this)),j.on(E.a.INIT_SEGMENT,this._onInitSegment.bind(this)),j.on(E.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),j.on(E.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),j.on(E.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),j.on(E.a.MEDIA_INFO,this._onMediaInfo.bind(this)),j.on(E.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),j.on(E.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),j.on(E.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),j.on(E.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),j.on(E.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),j.on(E.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),j.on(E.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),j.on(E.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),j.on(E.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),j.on(E.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),j.on(E.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return Z.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),n.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},Z.prototype.on=function(U,z){this._emitter.addListener(U,z)},Z.prototype.off=function(U,z){this._emitter.removeListener(U,z)},Z.prototype.hasWorker=function(){return this._worker!=null},Z.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},Z.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},Z.prototype.seek=function(U){this._worker?this._worker.postMessage({cmd:"seek",param:U}):this._controller.seek(U)},Z.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},Z.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},Z.prototype.switchPrimaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"primary"}):this._controller._demuxer instanceof T.a&&(this._controller._demuxer.preferred_secondary_audio=!1)},Z.prototype.switchSecondaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"secondary"}):this._controller._demuxer instanceof T.a&&(this._controller._demuxer.preferred_secondary_audio=!0)},Z.prototype._onInitSegment=function(U,z){var j=this;Promise.resolve().then(function(){j._emitter.emit(E.a.INIT_SEGMENT,U,z)})},Z.prototype._onMediaSegment=function(U,z){var j=this;Promise.resolve().then(function(){j._emitter.emit(E.a.MEDIA_SEGMENT,U,z)})},Z.prototype._onLoadingComplete=function(){var U=this;Promise.resolve().then(function(){U._emitter.emit(E.a.LOADING_COMPLETE)})},Z.prototype._onRecoveredEarlyEof=function(){var U=this;Promise.resolve().then(function(){U._emitter.emit(E.a.RECOVERED_EARLY_EOF)})},Z.prototype._onMediaInfo=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.MEDIA_INFO,U)})},Z.prototype._onMetaDataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.METADATA_ARRIVED,U)})},Z.prototype._onScriptDataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.SCRIPTDATA_ARRIVED,U)})},Z.prototype._onTimedID3MetadataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.TIMED_ID3_METADATA_ARRIVED,U)})},Z.prototype._onSynchronousKLVMetadataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,U)})},Z.prototype._onAsynchronousKLVMetadataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,U)})},Z.prototype._onSMPTE2038MetadataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.SMPTE2038_METADATA_ARRIVED,U)})},Z.prototype._onSCTE35MetadataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.SCTE35_METADATA_ARRIVED,U)})},Z.prototype._onPESPrivateDataDescriptor=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.PES_PRIVATE_DATA_DESCRIPTOR,U)})},Z.prototype._onPESPrivateDataArrived=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.PES_PRIVATE_DATA_ARRIVED,U)})},Z.prototype._onStatisticsInfo=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.STATISTICS_INFO,U)})},Z.prototype._onIOError=function(U,z){var j=this;Promise.resolve().then(function(){j._emitter.emit(E.a.IO_ERROR,U,z)})},Z.prototype._onDemuxError=function(U,z){var j=this;Promise.resolve().then(function(){j._emitter.emit(E.a.DEMUX_ERROR,U,z)})},Z.prototype._onRecommendSeekpoint=function(U){var z=this;Promise.resolve().then(function(){z._emitter.emit(E.a.RECOMMEND_SEEKPOINT,U)})},Z.prototype._onLoggingConfigChanged=function(U){this._worker&&this._worker.postMessage({cmd:"logging_config",param:U})},Z.prototype._onWorkerMessage=function(U){var z=U.data,j=z.data;if(z.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(z.msg){case E.a.INIT_SEGMENT:case E.a.MEDIA_SEGMENT:this._emitter.emit(z.msg,j.type,j.data);break;case E.a.LOADING_COMPLETE:case E.a.RECOVERED_EARLY_EOF:this._emitter.emit(z.msg);break;case E.a.MEDIA_INFO:Object.setPrototypeOf(j,k.a.prototype),this._emitter.emit(z.msg,j);break;case E.a.METADATA_ARRIVED:case E.a.SCRIPTDATA_ARRIVED:case E.a.TIMED_ID3_METADATA_ARRIVED:case E.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case E.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case E.a.SMPTE2038_METADATA_ARRIVED:case E.a.SCTE35_METADATA_ARRIVED:case E.a.PES_PRIVATE_DATA_DESCRIPTOR:case E.a.PES_PRIVATE_DATA_ARRIVED:case E.a.STATISTICS_INFO:this._emitter.emit(z.msg,j);break;case E.a.IO_ERROR:case E.a.DEMUX_ERROR:this._emitter.emit(z.msg,j.type,j.info);break;case E.a.RECOMMEND_SEEKPOINT:this._emitter.emit(z.msg,j);break;case"logcat_callback":R.a.emitter.emit("log",j.type,j.logcat)}},Z}();oe.a=I},function(me,oe,B){function N(R){var n={};function m(k){if(n[k])return n[k].exports;var T=n[k]={i:k,l:!1,exports:{}};return R[k].call(T.exports,T,T.exports,m),T.l=!0,T.exports}m.m=R,m.c=n,m.i=function(k){return k},m.d=function(k,T,I){m.o(k,T)||Object.defineProperty(k,T,{configurable:!1,enumerable:!0,get:I})},m.r=function(k){Object.defineProperty(k,"__esModule",{value:!0})},m.n=function(k){var T=k&&k.__esModule?function(){return k.default}:function(){return k};return m.d(T,"a",T),T},m.o=function(k,T){return Object.prototype.hasOwnProperty.call(k,T)},m.p="/",m.oe=function(k){throw console.error(k),k};var E=m(m.s=ENTRY_MODULE);return E.default||E}function b(R){return(R+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function A(R,n,m){var E={};E[m]=[];var k=n.toString(),T=k.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!T)return E;for(var I,Z=T[1],U=new RegExp("(\\\\n|\\W)"+b(Z)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");I=U.exec(k);)I[3]!=="dll-reference"&&E[m].push(I[3]);for(U=new RegExp("\\("+b(Z)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");I=U.exec(k);)R[I[2]]||(E[m].push(I[1]),R[I[2]]=B(I[1]).m),E[I[2]]=E[I[2]]||[],E[I[2]].push(I[4]);for(var z,j=Object.keys(E),L=0;L<j.length;L++)for(var Q=0;Q<E[j[L]].length;Q++)z=E[j[L]][Q],isNaN(1*z)||(E[j[L]][Q]=1*E[j[L]][Q]);return E}function l(R){return Object.keys(R).reduce(function(n,m){return n||R[m].length>0},!1)}me.exports=function(R,n){n=n||{};var m={main:B.m},E=n.all?{main:Object.keys(m.main)}:function(U,z){for(var j={main:[z]},L={main:[]},Q={main:{}};l(j);)for(var ne=Object.keys(j),x=0;x<ne.length;x++){var h=ne[x],_=j[h].pop();if(Q[h]=Q[h]||{},!Q[h][_]&&U[h][_]){Q[h][_]=!0,L[h]=L[h]||[],L[h].push(_);for(var c=A(U,U[h][_],h),f=Object.keys(c),H=0;H<f.length;H++)j[f[H]]=j[f[H]]||[],j[f[H]]=j[f[H]].concat(c[f[H]])}}return L}(m,R),k="";Object.keys(E).filter(function(U){return U!=="main"}).forEach(function(U){for(var z=0;E[U][z];)z++;E[U].push(z),m[U][z]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",k=k+"var "+U+" = ("+N.toString().replace("ENTRY_MODULE",JSON.stringify(z))+")({"+E[U].map(function(j){return JSON.stringify(j)+": "+m[U][j].toString()}).join(",")+`});
`}),k=k+"new (("+N.toString().replace("ENTRY_MODULE",JSON.stringify(R))+")({"+E.main.map(function(U){return JSON.stringify(U)+": "+m.main[U].toString()}).join(",")+"}))(self);";var T=new self.Blob([k],{type:"text/javascript"});if(n.bare)return T;var I=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(T),Z=new self.Worker(I);return Z.objectURL=I,Z}},function(me,oe,B){var N=B(10),b=function(){function A(){}return A._ebsp2rbsp=function(l){for(var R=l,n=R.byteLength,m=new Uint8Array(n),E=0,k=0;k<n;k++)k>=2&&R[k]===3&&R[k-1]===0&&R[k-2]===0||(m[E]=R[k],E++);return new Uint8Array(m.buffer,0,E)},A.parseSPS=function(l){for(var R=l.subarray(1,4),n="avc1.",m=0;m<3;m++){var E=R[m].toString(16);E.length<2&&(E="0"+E),n+=E}var k=A._ebsp2rbsp(l),T=new N.a(k);T.readByte();var I=T.readByte();T.readByte();var Z=T.readByte();T.readUEG();var U=A.getProfileString(I),z=A.getLevelString(Z),j=1,L=420,Q=8,ne=8;if((I===100||I===110||I===122||I===244||I===44||I===83||I===86||I===118||I===128||I===138||I===144)&&((j=T.readUEG())===3&&T.readBits(1),j<=3&&(L=[0,420,422,444][j]),Q=T.readUEG()+8,ne=T.readUEG()+8,T.readBits(1),T.readBool()))for(var x=j!==3?8:12,h=0;h<x;h++)T.readBool()&&(h<6?A._skipScalingList(T,16):A._skipScalingList(T,64));T.readUEG();var _=T.readUEG();if(_===0)T.readUEG();else if(_===1){T.readBits(1),T.readSEG(),T.readSEG();var c=T.readUEG();for(h=0;h<c;h++)T.readSEG()}var f=T.readUEG();T.readBits(1);var H=T.readUEG(),ee=T.readUEG(),ae=T.readBits(1);ae===0&&T.readBits(1),T.readBits(1);var Y=0,q=0,le=0,re=0;T.readBool()&&(Y=T.readUEG(),q=T.readUEG(),le=T.readUEG(),re=T.readUEG());var v=1,e=1,t=0,i=!0,r=0,o=0;if(T.readBool()){if(T.readBool()){var S=T.readByte();S>0&&S<16?(v=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][S-1],e=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][S-1]):S===255&&(v=T.readByte()<<8|T.readByte(),e=T.readByte()<<8|T.readByte())}if(T.readBool()&&T.readBool(),T.readBool()&&(T.readBits(4),T.readBool()&&T.readBits(24)),T.readBool()&&(T.readUEG(),T.readUEG()),T.readBool()){var C=T.readBits(32),y=T.readBits(32);i=T.readBool(),t=(r=y)/(o=2*C)}}var w=1;v===1&&e===1||(w=v/e);var G=0,P=0;j===0?(G=1,P=2-ae):(G=j===3?1:2,P=(j===1?2:1)*(2-ae));var F=16*(H+1),W=16*(ee+1)*(2-ae);F-=(Y+q)*G,W-=(le+re)*P;var te=Math.ceil(F*w);return T.destroy(),T=null,{codec_mimetype:n,profile_idc:I,level_idc:Z,profile_string:U,level_string:z,chroma_format_idc:j,bit_depth:Q,bit_depth_luma:Q,bit_depth_chroma:ne,ref_frames:f,chroma_format:L,chroma_format_string:A.getChromaFormatString(L),frame_rate:{fixed:i,fps:t,fps_den:o,fps_num:r},sar_ratio:{width:v,height:e},codec_size:{width:F,height:W},present_size:{width:te,height:W}}},A._skipScalingList=function(l,R){for(var n=8,m=8,E=0;E<R;E++)m!==0&&(m=(n+l.readSEG()+256)%256),n=m===0?n:m},A.getProfileString=function(l){switch(l){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},A.getLevelString=function(l){return(l/10).toFixed(1)},A.getChromaFormatString=function(l){switch(l){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},A}();oe.a=b},function(me,oe,B){B.r(oe),B(0);var N=B(8),b=B(18),A=B(17),l=B(1),R=B(14);oe.default=function(n){var m=null,E=(function(Y,q){n.postMessage({msg:"logcat_callback",data:{type:Y,logcat:q}})}).bind(this);function k(Y,q){var le={msg:l.a.INIT_SEGMENT,data:{type:Y,data:q}};n.postMessage(le,[q.data])}function T(Y,q){var le={msg:l.a.MEDIA_SEGMENT,data:{type:Y,data:q}};n.postMessage(le,[q.data])}function I(){var Y={msg:l.a.LOADING_COMPLETE};n.postMessage(Y)}function Z(){var Y={msg:l.a.RECOVERED_EARLY_EOF};n.postMessage(Y)}function U(Y){var q={msg:l.a.MEDIA_INFO,data:Y};n.postMessage(q)}function z(Y){var q={msg:l.a.METADATA_ARRIVED,data:Y};n.postMessage(q)}function j(Y){var q={msg:l.a.SCRIPTDATA_ARRIVED,data:Y};n.postMessage(q)}function L(Y){var q={msg:l.a.TIMED_ID3_METADATA_ARRIVED,data:Y};n.postMessage(q)}function Q(Y){var q={msg:l.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:Y};n.postMessage(q)}function ne(Y){var q={msg:l.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:Y};n.postMessage(q)}function x(Y){var q={msg:l.a.SMPTE2038_METADATA_ARRIVED,data:Y};n.postMessage(q)}function h(Y){var q={msg:l.a.SCTE35_METADATA_ARRIVED,data:Y};n.postMessage(q)}function _(Y){var q={msg:l.a.PES_PRIVATE_DATA_DESCRIPTOR,data:Y};n.postMessage(q)}function c(Y){var q={msg:l.a.PES_PRIVATE_DATA_ARRIVED,data:Y};n.postMessage(q)}function f(Y){var q={msg:l.a.STATISTICS_INFO,data:Y};n.postMessage(q)}function H(Y,q){n.postMessage({msg:l.a.IO_ERROR,data:{type:Y,info:q}})}function ee(Y,q){n.postMessage({msg:l.a.DEMUX_ERROR,data:{type:Y,info:q}})}function ae(Y){n.postMessage({msg:l.a.RECOMMEND_SEEKPOINT,data:Y})}b.a.install(),n.addEventListener("message",function(Y){switch(Y.data.cmd){case"init":(m=new A.a(Y.data.param[0],Y.data.param[1])).on(l.a.IO_ERROR,H.bind(this)),m.on(l.a.DEMUX_ERROR,ee.bind(this)),m.on(l.a.INIT_SEGMENT,k.bind(this)),m.on(l.a.MEDIA_SEGMENT,T.bind(this)),m.on(l.a.LOADING_COMPLETE,I.bind(this)),m.on(l.a.RECOVERED_EARLY_EOF,Z.bind(this)),m.on(l.a.MEDIA_INFO,U.bind(this)),m.on(l.a.METADATA_ARRIVED,z.bind(this)),m.on(l.a.SCRIPTDATA_ARRIVED,j.bind(this)),m.on(l.a.TIMED_ID3_METADATA_ARRIVED,L.bind(this)),m.on(l.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,Q.bind(this)),m.on(l.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,ne.bind(this)),m.on(l.a.SMPTE2038_METADATA_ARRIVED,x.bind(this)),m.on(l.a.SCTE35_METADATA_ARRIVED,h.bind(this)),m.on(l.a.PES_PRIVATE_DATA_DESCRIPTOR,_.bind(this)),m.on(l.a.PES_PRIVATE_DATA_ARRIVED,c.bind(this)),m.on(l.a.STATISTICS_INFO,f.bind(this)),m.on(l.a.RECOMMEND_SEEKPOINT,ae.bind(this));break;case"destroy":m&&(m.destroy(),m=null),n.postMessage({msg:"destroyed"});break;case"start":m.start();break;case"stop":m.stop();break;case"seek":m.seek(Y.data.param);break;case"pause":m.pause();break;case"resume":m.resume();break;case"logging_config":var q=Y.data.param;N.a.applyConfig(q),q.enableCallback===!0?N.a.addLogListener(E):N.a.removeLogListener(E);break;case"switch_audio":m._demuxer instanceof R.a&&(Y.data.param==="primary"?m._demuxer.preferred_secondary_audio=!1:Y.data.param==="secondary"&&(m._demuxer.preferred_secondary_audio=!0))}})}},function(me,oe,B){me.exports=B(29).default},function(me,oe,B){(function(N,b){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var A;A=function(){function l(y){return typeof y=="function"}var R=Array.isArray?Array.isArray:function(y){return Object.prototype.toString.call(y)==="[object Array]"},n=0,m=void 0,E=void 0,k=function(y,w){L[n]=y,L[n+1]=w,(n+=2)===2&&(E?E(Q):c())},T=typeof window<"u"?window:void 0,I=T||{},Z=I.MutationObserver||I.WebKitMutationObserver,U=typeof self>"u"&&N!==void 0&&{}.toString.call(N)==="[object process]",z=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function j(){var y=setTimeout;return function(){return y(Q,1)}}var L=new Array(1e3);function Q(){for(var y=0;y<n;y+=2)(0,L[y])(L[y+1]),L[y]=void 0,L[y+1]=void 0;n=0}var ne,x,h,_,c=void 0;function f(y,w){var G=this,P=new this.constructor(ae);P[ee]===void 0&&o(P);var F=G._state;if(F){var W=arguments[F-1];k(function(){return i(F,P,W,G._result)})}else e(G,P,y,w);return P}function H(y){if(y&&typeof y=="object"&&y.constructor===this)return y;var w=new this(ae);return q(w,y),w}U?c=function(){return N.nextTick(Q)}:Z?(x=0,h=new Z(Q),_=document.createTextNode(""),h.observe(_,{characterData:!0}),c=function(){_.data=x=++x%2}):z?((ne=new MessageChannel).port1.onmessage=Q,c=function(){return ne.port2.postMessage(0)}):c=T===void 0?function(){try{var y=Function("return this")().require("vertx");return(m=y.runOnLoop||y.runOnContext)!==void 0?function(){m(Q)}:j()}catch{return j()}}():j();var ee=Math.random().toString(36).substring(2);function ae(){}function Y(y,w,G){w.constructor===y.constructor&&G===f&&w.constructor.resolve===H?function(P,F){F._state===1?re(P,F._result):F._state===2?v(P,F._result):e(F,void 0,function(W){return q(P,W)},function(W){return v(P,W)})}(y,w):G===void 0?re(y,w):l(G)?function(P,F,W){k(function(te){var se=!1,fe=function(ie,ue,pe,ce){try{ie.call(ue,pe,ce)}catch(ge){return ge}}(W,F,function(ie){se||(se=!0,F!==ie?q(te,ie):re(te,ie))},function(ie){se||(se=!0,v(te,ie))},te._label);!se&&fe&&(se=!0,v(te,fe))},P)}(y,w,G):re(y,w)}function q(y,w){if(y===w)v(y,new TypeError("You cannot resolve a promise with itself"));else if(F=typeof(P=w),P===null||F!=="object"&&F!=="function")re(y,w);else{var G=void 0;try{G=w.then}catch(W){return void v(y,W)}Y(y,w,G)}var P,F}function le(y){y._onerror&&y._onerror(y._result),t(y)}function re(y,w){y._state===void 0&&(y._result=w,y._state=1,y._subscribers.length!==0&&k(t,y))}function v(y,w){y._state===void 0&&(y._state=2,y._result=w,k(le,y))}function e(y,w,G,P){var F=y._subscribers,W=F.length;y._onerror=null,F[W]=w,F[W+1]=G,F[W+2]=P,W===0&&y._state&&k(t,y)}function t(y){var w=y._subscribers,G=y._state;if(w.length!==0){for(var P=void 0,F=void 0,W=y._result,te=0;te<w.length;te+=3)P=w[te],F=w[te+G],P?i(G,P,F,W):F(W);y._subscribers.length=0}}function i(y,w,G,P){var F=l(G),W=void 0,te=void 0,se=!0;if(F){try{W=G(P)}catch(fe){se=!1,te=fe}if(w===W)return void v(w,new TypeError("A promises callback cannot return that same promise."))}else W=P;w._state!==void 0||(F&&se?q(w,W):se===!1?v(w,te):y===1?re(w,W):y===2&&v(w,W))}var r=0;function o(y){y[ee]=r++,y._state=void 0,y._result=void 0,y._subscribers=[]}var S=function(){function y(w,G){this._instanceConstructor=w,this.promise=new w(ae),this.promise[ee]||o(this.promise),R(G)?(this.length=G.length,this._remaining=G.length,this._result=new Array(this.length),this.length===0?re(this.promise,this._result):(this.length=this.length||0,this._enumerate(G),this._remaining===0&&re(this.promise,this._result))):v(this.promise,new Error("Array Methods must be provided an Array"))}return y.prototype._enumerate=function(w){for(var G=0;this._state===void 0&&G<w.length;G++)this._eachEntry(w[G],G)},y.prototype._eachEntry=function(w,G){var P=this._instanceConstructor,F=P.resolve;if(F===H){var W=void 0,te=void 0,se=!1;try{W=w.then}catch(ie){se=!0,te=ie}if(W===f&&w._state!==void 0)this._settledAt(w._state,G,w._result);else if(typeof W!="function")this._remaining--,this._result[G]=w;else if(P===C){var fe=new P(ae);se?v(fe,te):Y(fe,w,W),this._willSettleAt(fe,G)}else this._willSettleAt(new P(function(ie){return ie(w)}),G)}else this._willSettleAt(F(w),G)},y.prototype._settledAt=function(w,G,P){var F=this.promise;F._state===void 0&&(this._remaining--,w===2?v(F,P):this._result[G]=P),this._remaining===0&&re(F,this._result)},y.prototype._willSettleAt=function(w,G){var P=this;e(w,void 0,function(F){return P._settledAt(1,G,F)},function(F){return P._settledAt(2,G,F)})},y}(),C=function(){function y(w){this[ee]=r++,this._result=this._state=void 0,this._subscribers=[],ae!==w&&(typeof w!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof y?function(G,P){try{P(function(F){q(G,F)},function(F){v(G,F)})}catch(F){v(G,F)}}(this,w):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return y.prototype.catch=function(w){return this.then(null,w)},y.prototype.finally=function(w){var G=this.constructor;return l(w)?this.then(function(P){return G.resolve(w()).then(function(){return P})},function(P){return G.resolve(w()).then(function(){throw P})}):this.then(w,w)},y}();return C.prototype.then=f,C.all=function(y){return new S(this,y).promise},C.race=function(y){var w=this;return R(y)?new w(function(G,P){for(var F=y.length,W=0;W<F;W++)w.resolve(y[W]).then(G,P)}):new w(function(G,P){return P(new TypeError("You must pass an array to race."))})},C.resolve=H,C.reject=function(y){var w=new this(ae);return v(w,y),w},C._setScheduler=function(y){E=y},C._setAsap=function(y){k=y},C._asap=k,C.polyfill=function(){var y=void 0;if(b!==void 0)y=b;else if(typeof self<"u")y=self;else try{y=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var w=y.Promise;if(w){var G=null;try{G=Object.prototype.toString.call(w.resolve())}catch{}if(G==="[object Promise]"&&!w.cast)return}y.Promise=C},C.Promise=C,C},me.exports=A()}).call(this,B(26),B(27))},function(me,oe){var B,N,b=me.exports={};function A(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function R(z){if(B===setTimeout)return setTimeout(z,0);if((B===A||!B)&&setTimeout)return B=setTimeout,setTimeout(z,0);try{return B(z,0)}catch{try{return B.call(null,z,0)}catch{return B.call(this,z,0)}}}(function(){try{B=typeof setTimeout=="function"?setTimeout:A}catch{B=A}try{N=typeof clearTimeout=="function"?clearTimeout:l}catch{N=l}})();var n,m=[],E=!1,k=-1;function T(){E&&n&&(E=!1,n.length?m=n.concat(m):k=-1,m.length&&I())}function I(){if(!E){var z=R(T);E=!0;for(var j=m.length;j;){for(n=m,m=[];++k<j;)n&&n[k].run();k=-1,j=m.length}n=null,E=!1,function(L){if(N===clearTimeout)return clearTimeout(L);if((N===l||!N)&&clearTimeout)return N=clearTimeout,clearTimeout(L);try{N(L)}catch{try{return N.call(null,L)}catch{return N.call(this,L)}}}(z)}}function Z(z,j){this.fun=z,this.array=j}function U(){}b.nextTick=function(z){var j=new Array(arguments.length-1);if(arguments.length>1)for(var L=1;L<arguments.length;L++)j[L-1]=arguments[L];m.push(new Z(z,j)),m.length!==1||E||R(I)},Z.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=U,b.addListener=U,b.once=U,b.off=U,b.removeListener=U,b.removeAllListeners=U,b.emit=U,b.prependListener=U,b.prependOnceListener=U,b.listeners=function(z){return[]},b.binding=function(z){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(z){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},function(me,oe){var B;B=function(){return this}();try{B=B||new Function("return this")()}catch{typeof window=="object"&&(B=window)}me.exports=B},function(me,oe,B){B.r(oe);var N=B(0),b=B(8),A=B(3),l=B(7),R=B(19),n=B(20),m=B(1),E=B(4),k=B(11);oe.default=function(T){var I="PlayerEngineWorker",Z=(function(v,e){T.postMessage({msg:"logcat_callback",type:v,logcat:e})}).bind(void 0),U=null,z=null,j=null,L=null,Q=!1,ne=!1,x=0,h=0,_=!1;function c(){j&&(j.shutdown(),j.destroy(),j=null)}function f(){if(U==null||z==null)throw new A.a("Worker not initialized");if(L)throw new A.a("Transmuxer has been initialized");ne||(!z.deferLoadAfterSourceOpen||Q?((L=new n.a(U,z)).on(m.a.INIT_SEGMENT,function(v,e){j.appendInitSegment(e)}),L.on(m.a.MEDIA_SEGMENT,function(v,e){j.appendMediaSegment(e),T.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:e.info.endDts})}),L.on(m.a.LOADING_COMPLETE,function(){j.endOfStream(),T.postMessage({msg:"player_event",event:E.a.LOADING_COMPLETE})}),L.on(m.a.RECOVERED_EARLY_EOF,function(){T.postMessage({msg:"player_event",event:E.a.RECOVERED_EARLY_EOF})}),L.on(m.a.IO_ERROR,function(v,e){T.postMessage({msg:"player_event",event:E.a.ERROR,error_type:k.b.NETWORK_ERROR,error_detail:v,info:e})}),L.on(m.a.DEMUX_ERROR,function(v,e){T.postMessage({msg:"player_event",event:E.a.ERROR,error_type:k.b.MEDIA_ERROR,error_detail:v,info:e})}),L.on(m.a.MEDIA_INFO,function(v){le(m.a.MEDIA_INFO,v)}),L.on(m.a.STATISTICS_INFO,function(v){le(m.a.STATISTICS_INFO,v)}),L.on(m.a.RECOMMEND_SEEKPOINT,function(v){(function(e){T.postMessage({msg:"transmuxing_event",event:m.a.RECOMMEND_SEEKPOINT,milliseconds:e})})(v)}),L.on(m.a.METADATA_ARRIVED,function(v){re(E.a.METADATA_ARRIVED,v)}),L.on(m.a.SCRIPTDATA_ARRIVED,function(v){re(E.a.SCRIPTDATA_ARRIVED,v)}),L.on(m.a.TIMED_ID3_METADATA_ARRIVED,function(v){re(E.a.TIMED_ID3_METADATA_ARRIVED,v)}),L.on(m.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(v){re(E.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,v)}),L.on(m.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(v){re(E.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,v)}),L.on(m.a.SMPTE2038_METADATA_ARRIVED,function(v){re(E.a.SMPTE2038_METADATA_ARRIVED,v)}),L.on(m.a.SCTE35_METADATA_ARRIVED,function(v){re(E.a.SCTE35_METADATA_ARRIVED,v)}),L.on(m.a.PES_PRIVATE_DATA_DESCRIPTOR,function(v){re(E.a.PES_PRIVATE_DATA_DESCRIPTOR,v)}),L.on(m.a.PES_PRIVATE_DATA_ARRIVED,function(v){re(E.a.PES_PRIVATE_DATA_ARRIVED,v)}),L.open()):ne=!0)}function H(){j&&j.flush(),L&&(L.close(),L.destroy(),L=null)}function ee(){Q=!0,ne&&(ne=!1,f())}function ae(){T.postMessage({msg:"mse_event",event:l.a.UPDATE_END})}function Y(){N.a.v(I,"MSE SourceBuffer is full, report to main thread"),T.postMessage({msg:"mse_event",event:l.a.BUFFER_FULL})}function q(v){T.postMessage({msg:"player_event",event:E.a.ERROR,error_type:k.b.MEDIA_ERROR,error_detail:k.b.MEDIA_MSE_ERROR,info:v})}function le(v,e){T.postMessage({msg:"transmuxing_event",event:v,info:e})}function re(v,e){T.postMessage({msg:"player_event",event:v,extraData:e})}T.addEventListener("message",function(v){if(!_){var e=v.data;switch(e.cmd){case"logging_config":var t=e;b.a.applyConfig(t.logging_config),t.logging_config.enableCallback===!0?b.a.addLogListener(Z):b.a.removeLogListener(Z);break;case"init":U=(t=e).media_data_source,z=t.config;break;case"destroy":(function(){L&&H(),j&&c(),_=!0,T.postMessage({msg:"destroyed"})})();break;case"initialize_mse":(function(){N.a.v(I,"Initializing MediaSource in DedicatedWorker"),(j=new R.a(z)).on(l.a.SOURCE_OPEN,ee.bind(this)),j.on(l.a.UPDATE_END,ae.bind(this)),j.on(l.a.BUFFER_FULL,Y.bind(this)),j.on(l.a.ERROR,q.bind(this)),j.initialize({getCurrentTime:function(){return x},getReadyState:function(){return h}});var i=j.getHandle();T.postMessage({msg:"mse_init",handle:i},[i])})();break;case"shutdown_mse":c();break;case"load":f();break;case"unload":H();break;case"unbuffered_seek":t=e,j.flush(),L.seek(t.milliseconds);break;case"timeupdate":x=(t=e).current_time;break;case"readystatechange":h=(t=e).ready_state;break;case"pause_transmuxer":L.pause();break;case"resume_transmuxer":L.resume();break;case"switch_audio":(t=e).audio_track==="primary"?L.switchPrimaryAudio():t.audio_track==="secondary"&&L.switchSecondaryAudio()}}})}},function(me,oe,B){B.r(oe);var N=B(18),b=B(16),A={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function l(){return Object.assign({},A)}var R=function(){function v(){}return v.supportMSEH264Playback=function(){var e=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return e||t},v.supportMSEH265Playback=function(){var e=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),t=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return e||t},v.supportNetworkStreamIO=function(){var e=new b.a({},l()),t=e.loaderType;return e.destroy(),t=="fetch-stream-loader"||t=="xhr-moz-chunked-loader"},v.getNetworkLoaderTypeName=function(){var e=new b.a({},l()),t=e.loaderType;return e.destroy(),t},v.supportNativeMediaPlayback=function(e){v.videoElement==null&&(v.videoElement=window.document.createElement("video"));var t=v.videoElement.canPlayType(e);return t==="probably"||t=="maybe"},v.getFeatureList=function(){var e={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return e.msePlayback=v.supportMSEH264Playback(),e.networkStreamIO=v.supportNetworkStreamIO(),e.networkLoaderName=v.getNetworkLoaderTypeName(),e.mseLivePlayback=e.msePlayback&&e.networkStreamIO,e.mseH265Playback=v.supportMSEH265Playback(),e.nativeMP4H264Playback=v.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),e.nativeMP4H265Playback=v.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),e.nativeWebmVP8Playback=v.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),e.nativeWebmVP9Playback=v.supportNativeMediaPlayback('video/webm; codecs="vp9"'),e},v}(),n=B(2),m=B(0),E=B(9),k=B.n(E),T=B(19),I=B(4),Z=B(20),U=B(7),z=B(11),j=B(3),L=B(1),Q=B(5),ne=B(12),x=function(){function v(e,t,i){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new ne.a,this.e=null,this._config=e,this._media_element=t,this._on_unbuffered_seek=i,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var r=Q.a.chrome&&(Q.a.version.major<50||Q.a.version.major===50&&Q.a.version.build<2661);this._always_seek_keyframe=!!(r||Q.a.msedge||Q.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return v.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},v.prototype.seek=function(e){var t=this._isPositionBuffered(e),i=!1;if(e<1&&this._media_element.buffered.length>0){var r=this._media_element.buffered.start(0);(r<1&&e<r||Q.a.safari)&&(i=!0,e=Q.a.safari?.1:r)}if(i)this.directSeek(e);else if(t)if(this._always_seek_keyframe){var o=this._getNearestKeyframe(Math.floor(1e3*e));o!=null&&(e=o.dts/1e3),this.directSeek(e)}else this.directSeek(e);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*e)),this._config.accurateSeek&&this.directSeek(e)},v.prototype.directSeek=function(e){this._request_set_current_time=!0,this._media_element.currentTime=e},v.prototype.appendSyncPoints=function(e){this._idr_sample_list.appendArray(e)},v.prototype._onMediaSeeking=function(e){if(this._request_set_current_time)this._request_set_current_time=!1;else{var t=this._media_element.currentTime,i=this._media_element.buffered;if(t<1&&i.length>0){var r=i.start(0);if(r<1&&t<r||Q.a.safari){var o=Q.a.safari?.1:r;return void this.directSeek(o)}}if(this._isPositionBuffered(t)){if(this._always_seek_keyframe){var S=this._getNearestKeyframe(Math.floor(1e3*t));S!=null&&(t=S.dts/1e3,this.directSeek(t))}}else this._seek_request_record_clocktime=v._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},v.prototype._pollAndApplyUnbufferedSeek=function(){if(this._seek_request_record_clocktime!=null)if(this._seek_request_record_clocktime<=v._getClockTime()-100){var e=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(e)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*e)),this._config.accurateSeek&&this.directSeek(e))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},v.prototype._isPositionBuffered=function(e){for(var t=this._media_element.buffered,i=0;i<t.length;i++){var r=t.start(i),o=t.end(i);if(e>=r&&e<o)return!0}return!1},v.prototype._getNearestKeyframe=function(e){return this._idr_sample_list.getLastSyncPointBeforeDts(e)},v._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},v}(),h=function(){function v(e,t,i,r){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=e,this._media_element=t,this._on_pause_transmuxer=i,this._on_resume_transmuxer=r,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return v.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},v.prototype.notifyBufferedPositionChanged=function(e){!this._config.isLive&&this._config.lazyLoad&&(e==null?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(e))},v.prototype._onMediaTimeUpdate=function(e){this._paused&&this._resumeTransmuxerIfNeeded()},v.prototype._suspendTransmuxerIfNeeded=function(){for(var e=this._media_element.buffered,t=this._media_element.currentTime,i=0,r=0;r<e.length;r++){var o=e.start(r),S=e.end(r);if(o<=t&&t<S){i=S;break}}i>0&&this._suspendTransmuxerIfBufferedPositionExceeded(i)},v.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(e){e>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(m.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},v.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},v.prototype._resumeTransmuxerIfNeeded=function(){for(var e=this._media_element.buffered,t=this._media_element.currentTime,i=this._config.lazyLoadRecoverDuration,r=!1,o=0;o<e.length;o++){var S=e.start(o),C=e.end(o);if(t>=S&&t<C){t>=C-i&&(r=!0);break}}r&&(m.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},v.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},v}(),_=function(){function v(e,t){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=e,this._on_direct_seek=t,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return v.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},v.prototype._onMediaCanPlay=function(e){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},v.prototype._onMediaStalled=function(e){this._detectAndFixStuckPlayback(!0)},v.prototype._onMediaProgress=function(e){this._detectAndFixStuckPlayback()},v.prototype._detectAndFixStuckPlayback=function(e){var t=this._media_element,i=t.buffered;e||!this._canplay_received||t.readyState<2?i.length>0&&t.currentTime<i.start(0)&&(m.a.w(this.TAG,"Playback seems stuck at ".concat(t.currentTime,", seek to ").concat(i.start(0))),this._on_direct_seek(i.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},v}(),c=function(){function v(e,t,i){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=e,this._media_element=t,this._on_direct_seek=i}return v.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},v.prototype.notifyBufferedRangeUpdate=function(){this._chaseLiveLatency()},v.prototype._chaseLiveLatency=function(){var e=this._media_element.buffered,t=this._media_element.currentTime,i=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&e.length!=0&&(this._config.liveBufferLatencyChasingOnPaused||!i)){var r=e.end(e.length-1);if(r>this._config.liveBufferLatencyMaxLatency&&r-t>this._config.liveBufferLatencyMaxLatency){var o=r-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(o)}}},v}(),f=function(){function v(e,t){this._config=null,this._media_element=null,this.e=null,this._config=e,this._media_element=t,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return v.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},v.prototype._onMediaTimeUpdate=function(e){if(this._config.isLive&&this._config.liveSync){var t=this._getCurrentLatency();if(t>this._config.liveSyncMaxLatency){var i=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate=i}else t>this._config.liveSyncTargetLatency||this._media_element.playbackRate!==1&&this._media_element.playbackRate!==0&&(this._media_element.playbackRate=1)}},v.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var e=this._media_element.buffered,t=this._media_element.currentTime;return e.length==0?0:e.end(e.length-1)-t},v}(),H=function(){function v(e,t){this.TAG="PlayerEngineMainThread",this._emitter=new E,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=e,this._config=l(),typeof t=="object"&&Object.assign(this._config,t),e.isLive===!0&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return v.prototype.destroy=function(){this._emitter.emit(I.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(e,t){var i=this;this._emitter.addListener(e,t),e===I.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return i._emitter.emit(I.a.MEDIA_INFO,i.mediaInfo)}):e==I.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return i._emitter.emit(I.a.STATISTICS_INFO,i.statisticsInfo)})},v.prototype.off=function(e,t){this._emitter.removeListener(e,t)},v.prototype.attachMediaElement=function(e){var t=this;this._media_element=e,e.src="",e.removeAttribute("src"),e.srcObject=null,e.load(),e.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new T.a(this._config),this._mse_controller.on(U.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(U.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(U.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(U.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(U.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(U.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return t._media_element.currentTime},getReadyState:function(){return t._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(e.disableRemotePlayback=!0,e.srcObject=this._mse_controller.getObject()):e.src=this._mse_controller.getObjectURL()},v.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},v.prototype.load=function(){var e=this;if(!this._media_element)throw new j.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new j.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new Z.a(this._media_data_source,this._config),this._transmuxer.on(L.a.INIT_SEGMENT,function(t,i){e._mse_controller.appendInitSegment(i)}),this._transmuxer.on(L.a.MEDIA_SEGMENT,function(t,i){e._mse_controller.appendMediaSegment(i),!e._config.isLive&&t==="video"&&i.data&&i.data.byteLength>0&&"info"in i&&e._seeking_handler.appendSyncPoints(i.info.syncPoints),e._loading_controller.notifyBufferedPositionChanged(i.info.endDts/1e3)}),this._transmuxer.on(L.a.LOADING_COMPLETE,function(){e._mse_controller.endOfStream(),e._emitter.emit(I.a.LOADING_COMPLETE)}),this._transmuxer.on(L.a.RECOVERED_EARLY_EOF,function(){e._emitter.emit(I.a.RECOVERED_EARLY_EOF)}),this._transmuxer.on(L.a.IO_ERROR,function(t,i){e._emitter.emit(I.a.ERROR,z.b.NETWORK_ERROR,t,i)}),this._transmuxer.on(L.a.DEMUX_ERROR,function(t,i){e._emitter.emit(I.a.ERROR,z.b.MEDIA_ERROR,t,i)}),this._transmuxer.on(L.a.MEDIA_INFO,function(t){e._media_info=t,e._emitter.emit(I.a.MEDIA_INFO,Object.assign({},t))}),this._transmuxer.on(L.a.STATISTICS_INFO,function(t){e._statistics_info=e._fillStatisticsInfo(t),e._emitter.emit(I.a.STATISTICS_INFO,Object.assign({},t))}),this._transmuxer.on(L.a.RECOMMEND_SEEKPOINT,function(t){e._media_element&&!e._config.accurateSeek&&e._seeking_handler.directSeek(t/1e3)}),this._transmuxer.on(L.a.METADATA_ARRIVED,function(t){e._emitter.emit(I.a.METADATA_ARRIVED,t)}),this._transmuxer.on(L.a.SCRIPTDATA_ARRIVED,function(t){e._emitter.emit(I.a.SCRIPTDATA_ARRIVED,t)}),this._transmuxer.on(L.a.TIMED_ID3_METADATA_ARRIVED,function(t){e._emitter.emit(I.a.TIMED_ID3_METADATA_ARRIVED,t)}),this._transmuxer.on(L.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(t){e._emitter.emit(I.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,t)}),this._transmuxer.on(L.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(t){e._emitter.emit(I.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)}),this._transmuxer.on(L.a.SMPTE2038_METADATA_ARRIVED,function(t){e._emitter.emit(I.a.SMPTE2038_METADATA_ARRIVED,t)}),this._transmuxer.on(L.a.SCTE35_METADATA_ARRIVED,function(t){e._emitter.emit(I.a.SCTE35_METADATA_ARRIVED,t)}),this._transmuxer.on(L.a.PES_PRIVATE_DATA_DESCRIPTOR,function(t){e._emitter.emit(I.a.PES_PRIVATE_DATA_DESCRIPTOR,t)}),this._transmuxer.on(L.a.PES_PRIVATE_DATA_ARRIVED,function(t){e._emitter.emit(I.a.PES_PRIVATE_DATA_ARRIVED,t)}),this._seeking_handler=new x(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new h(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new _(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new c(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new f(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},v.prototype.unload=function(){var e,t,i,r,o,S,C,y,w;(e=this._media_element)===null||e===void 0||e.pause(),(t=this._live_latency_synchronizer)===null||t===void 0||t.destroy(),this._live_latency_synchronizer=null,(i=this._live_latency_chaser)===null||i===void 0||i.destroy(),this._live_latency_chaser=null,(r=this._startup_stall_jumper)===null||r===void 0||r.destroy(),this._startup_stall_jumper=null,(o=this._loading_controller)===null||o===void 0||o.destroy(),this._loading_controller=null,(S=this._seeking_handler)===null||S===void 0||S.destroy(),this._seeking_handler=null,(C=this._mse_controller)===null||C===void 0||C.flush(),(y=this._transmuxer)===null||y===void 0||y.close(),(w=this._transmuxer)===null||w===void 0||w.destroy(),this._transmuxer=null},v.prototype.play=function(){return this._media_element.play()},v.prototype.pause=function(){this._media_element.pause()},v.prototype.seek=function(e){this._media_element&&this._seeking_handler?this._seeking_handler.seek(e):this._pending_seek_time=e},v.prototype.switchPrimaryAudio=function(){this._transmuxer.switchPrimaryAudio()},v.prototype.switchSecondaryAudio=function(){this._transmuxer.switchSecondaryAudio()},Object.defineProperty(v.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),v.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},v.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},v.prototype._onMSEBufferFull=function(){m.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},v.prototype._onMSEError=function(e){this._emitter.emit(I.a.ERROR,z.b.MEDIA_ERROR,z.a.MEDIA_MSE_ERROR,e)},v.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(m.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},v.prototype._onMSEEndStreaming=function(){this._config.isLive||(m.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},v.prototype._onMediaLoadedMetadata=function(e){this._loaded_metadata_received=!0,this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},v.prototype._onRequestDirectSeek=function(e){this._seeking_handler.directSeek(e)},v.prototype._onRequiredUnbufferedSeek=function(e){this._mse_controller.flush(),this._transmuxer.seek(e)},v.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},v.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},v.prototype._fillStatisticsInfo=function(e){if(e.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return e;var t=!0,i=0,r=0;if(this._media_element.getVideoPlaybackQuality){var o=this._media_element.getVideoPlaybackQuality();i=o.totalVideoFrames,r=o.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(i=this._media_element.webkitDecodedFrameCount,r=this._media_element.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=r),e},v}(),ee=B(21),ae=B(8),Y=function(){function v(e,t){this.TAG="PlayerEngineDedicatedThread",this._emitter=new E,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=e,this._config=l(),typeof t=="object"&&Object.assign(this._config,t),e.isLive===!0&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},ae.a.registerListener(this.e.onLoggingConfigChanged),this._worker=ee(28,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:ae.a.getConfig()})}return v.isSupported=function(){return!!(self.Worker&&self.MediaSource&&"canConstructInDedicatedWorker"in self.MediaSource&&self.MediaSource.canConstructInDedicatedWorker===!0)},v.prototype.destroy=function(){this._emitter.emit(I.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),ae.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(e,t){var i=this;this._emitter.addListener(e,t),e===I.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return i._emitter.emit(I.a.MEDIA_INFO,i.mediaInfo)}):e==I.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return i._emitter.emit(I.a.STATISTICS_INFO,i.statisticsInfo)})},v.prototype.off=function(e,t){this._emitter.removeListener(e,t)},v.prototype.attachMediaElement=function(e){this._media_element=e,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},v.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},v.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new x(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new h(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new _(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new c(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new f(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},v.prototype.unload=function(){var e,t,i,r,o,S;(e=this._media_element)===null||e===void 0||e.pause(),this._worker.postMessage({cmd:"unload"}),(t=this._live_latency_synchronizer)===null||t===void 0||t.destroy(),this._live_latency_synchronizer=null,(i=this._live_latency_chaser)===null||i===void 0||i.destroy(),this._live_latency_chaser=null,(r=this._startup_stall_jumper)===null||r===void 0||r.destroy(),this._startup_stall_jumper=null,(o=this._loading_controller)===null||o===void 0||o.destroy(),this._loading_controller=null,(S=this._seeking_handler)===null||S===void 0||S.destroy(),this._seeking_handler=null},v.prototype.play=function(){return this._media_element.play()},v.prototype.pause=function(){this._media_element.pause()},v.prototype.seek=function(e){this._media_element&&this._seeking_handler?this._seeking_handler.seek(e):this._pending_seek_time=e},v.prototype.switchPrimaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"primary"})},v.prototype.switchSecondaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"secondary"})},Object.defineProperty(v.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),v.prototype._onLoggingConfigChanged=function(e){var t;(t=this._worker)===null||t===void 0||t.postMessage({cmd:"logging_config",logging_config:e})},v.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},v.prototype._onMSEBufferFull=function(){m.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},v.prototype._onMediaLoadedMetadata=function(e){this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},v.prototype._onRequestDirectSeek=function(e){this._seeking_handler.directSeek(e)},v.prototype._onRequiredUnbufferedSeek=function(e){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:e})},v.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},v.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},v.prototype._onMediaTimeUpdate=function(e){this._worker.postMessage({cmd:"timeupdate",current_time:e.target.currentTime})},v.prototype._onMediaReadyStateChange=function(e){this._worker.postMessage({cmd:"readystatechange",ready_state:e.target.readyState})},v.prototype._onWorkerMessage=function(e){var t,i=e.data,r=i.msg;if(r=="destroyed"||this._worker_destroying)return this._worker_destroying=!1,(t=this._worker)===null||t===void 0||t.terminate(),void(this._worker=null);switch(r){case"mse_init":var o=i;this._media_element.srcObject=o.handle;break;case"mse_event":(o=i).event==U.a.UPDATE_END?this._onMSEUpdateEnd():o.event==U.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((o=i).event==L.a.MEDIA_INFO){var S=i;this._media_info=S.info,this._emitter.emit(I.a.MEDIA_INFO,Object.assign({},S.info))}else if(o.event==L.a.STATISTICS_INFO){var C=i;this._statistics_info=this._fillStatisticsInfo(C.info),this._emitter.emit(I.a.STATISTICS_INFO,Object.assign({},C.info))}else if(o.event==L.a.RECOMMEND_SEEKPOINT){var y=i;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(y.milliseconds/1e3)}break;case"player_event":if((o=i).event==I.a.ERROR){var w=i;this._emitter.emit(I.a.ERROR,w.error_type,w.error_detail,w.info)}else if("extraData"in o){var G=i;this._emitter.emit(G.event,G.extraData)}break;case"logcat_callback":o=i,m.a.emitter.emit("log",o.type,o.logcat);break;case"buffered_position_changed":o=i,this._loading_controller.notifyBufferedPositionChanged(o.buffered_position_milliseconds/1e3)}},v.prototype._fillStatisticsInfo=function(e){if(e.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return e;var t=!0,i=0,r=0;if(this._media_element.getVideoPlaybackQuality){var o=this._media_element.getVideoPlaybackQuality();i=o.totalVideoFrames,r=o.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(i=this._media_element.webkitDecodedFrameCount,r=this._media_element.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=r),e},v}(),q=function(){function v(e,t){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var i=e.type.toLowerCase();if(i!=="mse"&&i!=="mpegts"&&i!=="m2ts"&&i!=="flv")throw new j.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");if(t&&t.enableWorkerForMSE&&Y.isSupported())try{this._player_engine=new Y(e,t)}catch{m.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new H(e,t)}else this._player_engine=new H(e,t)}return v.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},v.prototype.on=function(e,t){this._player_engine.on(e,t)},v.prototype.off=function(e,t){this._player_engine.off(e,t)},v.prototype.attachMediaElement=function(e){this._media_element=e,this._player_engine.attachMediaElement(e)},v.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},v.prototype.load=function(){this._player_engine.load()},v.prototype.unload=function(){this._player_engine.unload()},v.prototype.play=function(){return this._player_engine.play()},v.prototype.pause=function(){this._player_engine.pause()},v.prototype.switchPrimaryAudio=function(){this._player_engine.switchPrimaryAudio()},v.prototype.switchSecondaryAudio=function(){this._player_engine.switchSecondaryAudio()},Object.defineProperty(v.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"volume",{get:function(){return this._media_element.volume},set:function(e){this._media_element.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"muted",{get:function(){return this._media_element.muted},set:function(e){this._media_element.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(e){this._player_engine.seek(e)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),v}(),le=function(){function v(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new k.a,this._config=l(),typeof t=="object"&&Object.assign(this._config,t);var i=e.type.toLowerCase();if(i==="mse"||i==="mpegts"||i==="m2ts"||i==="flv")throw new j.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new j.b("NativePlayer(".concat(e.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return v.prototype.destroy=function(){this._emitter.emit(I.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(e,t){var i=this;e===I.a.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){i._emitter.emit(I.a.MEDIA_INFO,i.mediaInfo)}):e===I.a.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){i._emitter.emit(I.a.STATISTICS_INFO,i.statisticsInfo)}),this._emitter.addListener(e,t)},v.prototype.off=function(e,t){this._emitter.removeListener(e,t)},v.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},v.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype.load=function(){if(!this._mediaElement)throw new j.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},v.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype.play=function(){return this._mediaElement.play()},v.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(v.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,i=0,r=0;if(this._mediaElement.getVideoPlaybackQuality){var o=this._mediaElement.getVideoPlaybackQuality();i=o.totalVideoFrames,r=o.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(i=this._mediaElement.webkitDecodedFrameCount,r=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=r),e},enumerable:!1,configurable:!0}),v.prototype._onvLoadedMetadata=function(e){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(I.a.MEDIA_INFO,this.mediaInfo)},v.prototype._reportStatisticsInfo=function(){this._emitter.emit(I.a.STATISTICS_INFO,this.statisticsInfo)},v}();N.a.install();var re={createPlayer:function(v,e){var t=v;if(t==null||typeof t!="object")throw new j.b("MediaDataSource must be an javascript object!");if(!t.hasOwnProperty("type"))throw new j.b("MediaDataSource must has type field to indicate video file type!");switch(t.type){case"mse":case"mpegts":case"m2ts":case"flv":return new q(t,e);default:return new le(t,e)}},isSupported:function(){return R.supportMSEH264Playback()},getFeatureList:function(){return R.getFeatureList()}};re.BaseLoader=n.a,re.LoaderStatus=n.c,re.LoaderErrors=n.b,re.Events=I.a,re.ErrorTypes=z.b,re.ErrorDetails=z.a,re.MSEPlayer=q,re.NativePlayer=le,re.LoggingControl=ae.a,Object.defineProperty(re,"version",{enumerable:!0,get:function(){return"1.7.3"}}),oe.default=re}])})})(ze);var Ke=ze.exports;const Xe=qe(Ke);export{Xe as m};
