import{I as d,aO as u,aN as r,aF as i,a5 as c,ay as s,p as t,a8 as o,az as m,a2 as p,$ as f}from"./SnackbarsStore-IhryqwJK.js";import{V as h,u as v,_,w as V,a as y}from"./top-DYZnYhxm.js";import{_ as g}from"./logo-BdrpTKlZ.js";import{V as w,a as b}from"./VCard-BrfSgegv.js";import{V as $,a as S}from"./VTextField-1kdWTn8s.js";import{V as x}from"./VForm-BVRNpF3d.js";import"./VAvatar-DMZxG9rh.js";const C=d({name:"Connect",data(){return{is_form_dense:i.isSmartphoneHorizontal(),is_validating:!1,host:"",rules:[e=>e?!0:"ホストが空です。",e=>/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$/.test(e)?!0:"IPv4のホストを入力してください。",async e=>(i.saveApiHost(e),await h.fetchServerVersion(!0)!==null?!0:(i.deleteApiHost(),"接続先ホストはKonomiTVサーバーではありません。"))]}},computed:{...u(v)},mounted(){if(this.$route.query.failed_host){this.host=this.$route.query.failed_host,r.error("KonomiTVサーバーへの接続に失敗しました。ホスト設定を確認してください。");return}},methods:{async connect(){this.is_validating=!0;try{const e=await this.$refs.connect.validate();if(!e.valid){r.error(e.errors[0].errorMessages[0]);return}await this.versionStore.fetchServerVersion(!0),this.versionStore.is_version_mismatch&&r.warning("このKonomiTVクライアントとKonomiTVサーバーのバージョンが異なるため、正常な動作が保証されません。"),await this.$router.replace({path:"/tv/",query:{}})}finally{this.is_validating=!1}}}}),T={class:"route-container"},I={class:"connect-container-wrapper d-flex align-center w-100 mb-13"};function B(e,a,K,N,k,q){const n=p("Icon");return f(),c("div",T,[s("main",null,[s("div",I,[t(b,{class:"connect-container px-10 pt-8 pb-11 mx-auto",elevation:"10",width:"100%","max-width":"450"},{default:o(()=>[t(w,{class:"connect__logo py-4 d-flex flex-column justify-center align-center"},{default:o(()=>[...a[1]||(a[1]=[s("img",{class:"d-block",src:g,style:{"max-width":"250px"}},null,-1),s("h4",{class:"mt-10"},"接続",-1)])]),_:1}),t($),t(x,{ref:"connect",onSubmit:V(e.connect,["prevent"])},{default:o(()=>[t(S,{class:"mt-12",name:"ipv4-host",color:"primary",variant:"outlined",type:"url",placeholder:"ホスト",autofocus:"","validate-on":"submit",pattern:"^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$",hint:"IPv4のホストを入力してください。","persistent-hint":"",rules:e.rules,density:e.is_form_dense?"compact":"default",modelValue:e.host,"onUpdate:modelValue":a[0]||(a[0]=l=>e.host=l)},null,8,["rules","density","modelValue"]),t(y,{type:"submit",class:"connect-button mt-5",color:"secondary",variant:"flat",width:"100%",height:"56",loading:e.is_validating,disabled:e.is_validating},{default:o(()=>[t(n,{icon:"fa:sign-in",class:"mr-2"}),a[2]||(a[2]=m("接続 ",-1))]),_:1},8,["loading","disabled"])]),_:1},8,["onSubmit"])]),_:1})])])])}const j=_(C,[["render",B],["__scopeId","data-v-4bec0af7"]]);export{j as default};
