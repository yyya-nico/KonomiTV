import{x as m,az as r,aI as p,aH as c,Y as f,T as h,$ as _,at as a,k as t,a2 as s,au as v,Q as V,R as w}from"./SnackbarsStore-CzVJc6Ad.js";import{V as S,u as y}from"./VersionStore-CjDG_WKL.js";import{_ as $,w as b,V as x}from"./top-Y8zMy7Hh.js";import{_ as g}from"./logo-Dzh0hwrk.js";import{V as B,a as C}from"./VCard-B5zkVNRM.js";import{V as I,a as A}from"./VTextField-DfrYGvb_.js";import{V as T}from"./VForm-CjkFBbFW.js";import"./VAvatar-C_Khr9xd.js";const k=m({name:"Connect",data(){return{is_form_dense:r.isSmartphoneHorizontal(),host:"",rules:[e=>e?!0:"ホストが空です。",e=>/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$/.test(e)?!0:"IPv4のホストを入力してください。",async e=>{const[o,n]=e.split(":"),i=`${o.replaceAll(".","-")}.local.konomi.tv:${n??7e3}`;return r.saveApiHost(i),await S.fetchServerVersion(!0)!==null?!0:(r.deleteApiHost(),"接続先ホストはKonomiTVサーバーではありません。")}]}},computed:{...p(y)},methods:{async connect(){const e=await this.$refs.connect.validate();if(!e.valid){c.error(e.errors[0].errorMessages[0]);return}await this.versionStore.fetchServerVersion(!0),this.versionStore.is_version_mismatch&&c.warning("このKonomiTVクライアントとKonomiTVサーバーのバージョンが異なるため、正常な動作が保証されません。"),await this.$router.replace({path:"/tv/"})}}}),u=e=>(V("data-v-db27dd20"),e=e(),w(),e),D={class:"route-container"},H={class:"connect-container-wrapper d-flex align-center w-100 mb-13"},F=u(()=>a("img",{class:"d-block",src:g,style:{"max-width":"250px"}},null,-1)),K=u(()=>a("h4",{class:"mt-10"},"接続",-1));function M(e,o,n,i,N,z){const l=f("Icon");return h(),_("div",D,[a("main",null,[a("div",H,[t(B,{class:"connect-container px-10 pt-8 pb-11 mx-auto",elevation:"10",width:"100%","max-width":"450"},{default:s(()=>[t(C,{class:"connect__logo py-4 d-flex flex-column justify-center align-center"},{default:s(()=>[F,K]),_:1}),t(I),t(T,{ref:"connect",onSubmit:b(e.connect,["prevent"])},{default:s(()=>[t(A,{class:"mt-12",color:"primary",variant:"outlined",type:"url",placeholder:"ホスト",autofocus:"","validate-on":"submit",pattern:"^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?$",hint:"IPv4のホストを入力してください。","persistent-hint":"",rules:e.rules,density:e.is_form_dense?"compact":"default",modelValue:e.host,"onUpdate:modelValue":o[0]||(o[0]=d=>e.host=d)},null,8,["rules","density","modelValue"]),t(x,{type:"submit",class:"connect-button mt-5",color:"secondary",variant:"flat",width:"100%",height:"56"},{default:s(()=>[t(l,{icon:"fa:sign-in",class:"mr-2"}),v("接続 ")]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])])}const G=$(k,[["render",M],["__scopeId","data-v-db27dd20"]]);export{G as default};
