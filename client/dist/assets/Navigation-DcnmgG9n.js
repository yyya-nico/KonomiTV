import{u as H,a as U,v as F,b as G,V as S,R as g,_ as V,p as M,af as K,m as Y,$ as J,a5 as Q,a4 as X,b4 as Z,d as j,aT as O,S as tt,g as et,b5 as at,ak as nt,a1 as st,a0 as it,a8 as ot,aa as rt,h as lt,b6 as ct,X as ut,a2 as vt,e as _t,b7 as dt,M as ht}from"./top-T8_bFoR3.js";import{_ as pt}from"./logo-DYlZj9PS.js";import{V as q,u as ft}from"./ssrBoot-wpHw1Y-I.js";import{x as z,P as A,d as gt,am as mt,ac as w,Y as C,T as h,$ as I,_ as f,U as m,a2 as _,k as i,at as c,a1 as kt,au as yt,ai as bt,Q as W,R as D,an as $,a8 as p,aR as R,bY as wt,az as E,aJ as St,Z as Ct,av as $t}from"./SnackbarsStore-Duvz5vzr.js";function Bt(t,o,e,u){function s(a){return a instanceof e?a:new e(function(r){r(a)})}return new(e||(e=Promise))(function(a,r){function v(d){try{n(u.next(d))}catch(l){r(l)}}function k(d){try{n(u.throw(d))}catch(l){r(l)}}function n(d){d.done?a(d.value):s(d.value).then(v,k)}n((u=u.apply(t,[])).next())})}function It(t,o){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},u,s,a,r;return r={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function v(n){return function(d){return k([n,d])}}function k(n){if(u)throw new TypeError("Generator is already executing.");for(;r&&(r=0,n[0]&&(e=0)),e;)try{if(u=1,s&&(a=n[0]&2?s.return:n[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,n[1])).done)return a;switch(s=0,a&&(n=[n[0]&2,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,s=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!a||n[1]>a[0]&&n[1]<a[3])){e.label=n[1];break}if(n[0]===6&&e.label<a[1]){e.label=a[1],a=n;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(n);break}a[2]&&e.ops.pop(),e.trys.pop();continue}n=o.call(t,e)}catch(d){n=[6,d],s=0}finally{u=a=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}var xt=function(){function t(){var o=this;this.event=null,this.callbacks=[],this.install=function(){return Bt(o,void 0,void 0,function(){var e=this;return It(this,function(u){switch(u.label){case 0:return this.event?(this.event.prompt(),[4,this.event.userChoice.then(function(s){var a=s.outcome;return e.updateEvent(null),a==="accepted"||!0})]):[3,2];case 1:return[2,u.sent()];case 2:throw new Error("Not allowed to prompt.")}})})},!(typeof window>"u")&&(window.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),o.updateEvent(e)}),window.addEventListener("appinstalled",function(){o.updateEvent(null)}))}return t.prototype.getEvent=function(){return this.event},t.prototype.canInstall=function(){return this.event!==null},t.prototype.updateEvent=function(o){var e=this;o!==this.event&&(this.event=o,this.callbacks.forEach(function(u){return u(e.canInstall())}))},t.prototype.addListener=function(o){o(this.canInstall()),this.callbacks.push(o)},t.prototype.removeListener=function(o){this.callbacks=this.callbacks.filter(function(e){return o!==e})},t}(),T=new xt;const L=t=>(W("data-v-89736472"),t=t(),D(),t),Et={class:"header"},Vt=L(()=>c("img",{class:"konomitv-logo__image",src:pt,height:"21"},null,-1)),Wt={key:0,class:"search-box"},Dt=["placeholder"],Nt=L(()=>c("div",{class:"mr-3 mr-md-6"},null,-1)),Pt=z({__name:"HeaderBar",setup(t){const o=A(!1),e=A(""),u=H(),s=U(),a=()=>{s.path.endsWith("/search")&&s.query.query&&(e.value=decodeURIComponent(s.query.query))};gt(()=>{T.addListener(l=>{o.value=l}),a()}),mt(()=>s.fullPath,a);const r=w(()=>s.path.startsWith("/videos")||s.path.startsWith("/mylist")||s.path.startsWith("/viewing-history")?"録画番組を検索...":"放送予定の番組を検索..."),v=()=>s.path.startsWith("/videos")||s.path.startsWith("/mylist")||s.path.startsWith("/viewing-history")?"/videos/search":"/tv/search",k=l=>{l.key==="Enter"&&!l.isComposing&&n()},n=()=>{if(e.value.trim()){const l=v();u.push(`${l}?query=${encodeURIComponent(e.value.trim())}`)}},d=w(()=>{const l=s.path;return!l.startsWith("/captures")&&!l.startsWith("/settings")&&!l.startsWith("/login")&&!l.startsWith("/register")});return(l,y)=>{const x=C("router-link"),N=C("Icon");return h(),I("header",Et,[f((h(),m(x,{class:"konomitv-logo ml-3 ml-md-6",to:"/tv/"},{default:_(()=>[Vt]),_:1})),[[g]]),i(q),d.value?(h(),I("div",Wt,[f(c("input",{class:"search-input",type:"text",placeholder:r.value,"onUpdate:modelValue":y[0]||(y[0]=P=>e.value=P),onKeydown:k},null,40,Dt),[[F,e.value]]),i(N,{class:"search-input__icon",icon:"fluent:search-20-filled",height:"24px",onClick:n})])):kt("",!0),f(i(S,{variant:"flat",class:"pwa-install-button",onClick:y[1]||(y[1]=P=>bt(T).install())},{default:_(()=>[i(N,{icon:"material-symbols:install-desktop-rounded",height:"20px",class:"mr-1"}),yt(" アプリとしてインストール ")]),_:1},512),[[G,o.value]]),Nt])}}}),_e=V(Pt,[["__scopeId","data-v-89736472"]]),At=M({baseColor:String,bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:t=>!t||["horizontal","shift"].includes(t)},height:{type:[Number,String],default:56},active:{type:Boolean,default:!0},...K(),...Y(),...J(),...Q(),...X(),...Z({name:"bottom-navigation"}),...j({tag:"header"}),...O({selectedClass:"v-btn--selected"}),...tt()},"VBottomNavigation"),Rt=et()({name:"VBottomNavigation",props:At(),emits:{"update:active":t=>!0,"update:modelValue":t=>!0},setup(t,o){let{slots:e}=o;const{themeClasses:u}=at(),{borderClasses:s}=nt(t),{backgroundColorClasses:a,backgroundColorStyles:r}=st($(t,"bgColor")),{densityClasses:v}=it(t),{elevationClasses:k}=ot(t),{roundedClasses:n}=rt(t),{ssrBootStyles:d}=ft(),l=w(()=>Number(t.height)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0)),y=lt(t,"active",t.active),{layoutItemStyles:x}=ct({id:t.name,order:w(()=>parseInt(t.order,10)),position:w(()=>"bottom"),layoutSize:w(()=>y.value?l.value:0),elementSize:l,active:y,absolute:$(t,"absolute")});return ut(t,dt),vt({VBtn:{baseColor:$(t,"baseColor"),color:$(t,"color"),density:$(t,"density"),stacked:w(()=>t.mode!=="horizontal"),variant:"text"}},{scoped:!0}),_t(()=>i(t.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":y.value,"v-bottom-navigation--grow":t.grow,"v-bottom-navigation--shift":t.mode==="shift"},u.value,a.value,s.value,v.value,k.value,n.value,t.class],style:[r.value,x.value,{height:ht(l.value)},d.value,t.style]},{default:()=>[e.default&&i("div",{class:"v-bottom-navigation__content"},[e.default()])]})),{}}}),Tt={},B=t=>(W("data-v-8139492e"),t=t(),D(),t),qt=B(()=>c("span",{class:"mt-1"},"テレビをみる",-1)),zt=B(()=>c("span",{class:"mt-1"},"ビデオをみる",-1)),Lt=B(()=>c("span",{class:"mt-1"},"録画予約",-1)),Ht=B(()=>c("span",{class:"mt-1"},"キャプチャ",-1)),Ut=B(()=>c("span",{class:"mt-1"},"マイページ",-1));function Ft(t,o){const e=C("Icon");return h(),m(Rt,{class:"bottom-navigation-container elevation-12",color:"primary",grow:"",active:""},{default:_(()=>[i(S,{class:p(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/tv")}]),to:"/tv/"},{default:_(()=>[i(e,{icon:"fluent:tv-20-regular",width:"30px"}),qt]),_:1},8,["class"]),i(S,{class:p(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/videos")}]),to:"/videos/"},{default:_(()=>[i(e,{icon:"fluent:movies-and-tv-20-regular",width:"30px"}),zt]),_:1},8,["class"]),i(S,{class:p(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/reserves")}]),to:"/reserves/"},{default:_(()=>[i(e,{icon:"fluent:timer-16-regular",width:"30px"}),Lt]),_:1},8,["class"]),i(S,{class:p(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/captures")}]),to:"/captures/"},{default:_(()=>[i(e,{icon:"fluent:image-multiple-24-regular",width:"30px"}),Ht]),_:1},8,["class"]),i(S,{class:p(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/mypage")}]),to:"/mypage/"},{default:_(()=>[i(e,{icon:"fluent:person-20-regular",width:"30px"}),Ut]),_:1},8,["class"])]),_:1})}const Gt=V(Tt,[["render",Ft],["__scopeId","data-v-8139492e"]]);class Mt{static async fetchServerVersion(o=!1){const e=await R.get("/version");return e.type==="error"?(o===!1&&R.showGenericError(e,"バージョン情報を取得できませんでした。"),null):e.data}}const Kt=wt("version",{state:()=>({server_version_info:null,last_updated_at:0}),getters:{client_version(){return E.version},server_version(){var t;return((t=this.server_version_info)==null?void 0:t.version)??null},latest_version(){var t;return((t=this.server_version_info)==null?void 0:t.latest_version)??null},is_client_develop_version(){return this.client_version.includes("-dev")},is_server_develop_version(){var t;return((t=this.server_version)==null?void 0:t.includes("-dev"))??!1},is_update_available(){return this.server_version===null||this.latest_version===null?!1:this.is_server_develop_version===!1&&this.server_version!==this.latest_version||this.is_server_develop_version===!0&&this.server_version.replace("-dev","")===this.latest_version},is_version_mismatch(){return this.server_version===null?!1:this.client_version!==this.server_version}},actions:{async fetchServerVersion(t=!1){if(this.server_version_info!==null&&t===!1)return E.time()-this.last_updated_at>60&&this.fetchServerVersion(!0),this.server_version_info;const o=await Mt.fetchServerVersion();return o===null?null:(this.server_version_info=o,this.last_updated_at=E.time(),this.server_version_info)}}}),Yt=Kt,Jt=z({name:"Navigation",components:{BottomNavigation:Gt},computed:{...St(Yt)},async created(){await this.versionStore.fetchServerVersion()}}),b=t=>(W("data-v-2b176113"),t=t(),D(),t),Qt={class:"navigation-container elevation-8"},Xt={class:"navigation"},Zt={class:"navigation-scroll"},jt=b(()=>c("span",{class:"navigation__link-text"},"テレビをみる",-1)),Ot=b(()=>c("span",{class:"navigation__link-text"},"ビデオをみる",-1)),te=b(()=>c("span",{class:"navigation__link-text"},"番組表",-1)),ee=b(()=>c("span",{class:"navigation__link-text"},"録画予約",-1)),ae=b(()=>c("span",{class:"navigation__link-text"},"キャプチャ",-1)),ne=b(()=>c("span",{class:"navigation__link-text"},"マイリスト",-1)),se=b(()=>c("span",{class:"navigation__link-text"},"視聴履歴",-1)),ie=b(()=>c("span",{class:"navigation__link-text"},"設定",-1)),oe={class:"navigation__link-text"};function re(t,o,e,u,s,a){const r=C("Icon"),v=C("router-link"),k=C("BottomNavigation"),n=Ct("ftooltip");return h(),I("div",null,[c("div",Qt,[c("nav",Xt,[c("div",Zt,[f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/tv")}]),"active-class":"navigation__link--active",to:"/tv/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:tv-20-regular",width:"26px"}),jt]),_:1},8,["class"])),[[g]]),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/videos")}]),"active-class":"navigation__link--active",to:"/videos/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:movies-and-tv-20-regular",width:"26px"}),Ot]),_:1},8,["class"])),[[g]]),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/timetable")}]),"active-class":"navigation__link--active",to:"/timetable/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:calendar-ltr-20-regular",width:"26px"}),te]),_:1},8,["class"])),[[g]]),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/reserves")}]),"active-class":"navigation__link--active",to:"/reserves/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:timer-16-regular",width:"26px",style:{padding:"0.5px"}}),ee]),_:1},8,["class"])),[[g]]),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/captures")}]),"active-class":"navigation__link--active",to:"/captures/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:image-multiple-24-regular",width:"26px"}),ae]),_:1},8,["class"])),[[g]]),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/mylist")}]),"active-class":"navigation__link--active",to:"/mylist/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"ic:round-playlist-play",width:"26px"}),ne]),_:1},8,["class"])),[[g]]),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/viewing-history")}]),"active-class":"navigation__link--active",to:"/viewing-history/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:history-20-regular",width:"26px"}),se]),_:1},8,["class"])),[[g]]),i(q),f((h(),m(v,{class:p(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/settings")}]),"active-class":"navigation__link--active",to:"/settings/"},{default:_(()=>[i(r,{class:"navigation__link-icon",icon:"fluent:settings-20-regular",width:"26px"}),ie]),_:1},8,["class"])),[[g]]),f((h(),I("a",{class:p(["navigation__link",{"navigation__link--develop-version":t.versionStore.is_client_develop_version,"navigation__link--highlight":t.versionStore.is_update_available}]),"active-class":"navigation__link--active",href:"https://github.com/yyya-nico/KonomiTV",target:"_blank"},[i(r,{class:"navigation__link-icon",icon:"fluent:info-16-regular",width:"26px"}),c("span",oe,"version "+$t(t.versionStore.client_version),1)],2)),[[g],[n,t.versionStore.is_update_available?`アップデートがあります (version ${t.versionStore.latest_version})`:"",void 0,{top:!0}]])])])]),i(k)])}const de=V(Jt,[["render",re],["__scopeId","data-v-2b176113"]]);export{_e as H,de as N,Mt as V,Yt as u};
