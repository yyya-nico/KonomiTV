import{u as P,b as A,v as R,V as w,a as T,R as f,_ as E,g as q,p as L,b6 as z,am as H,aa as F,ag as G,a7 as M,a9 as U,h as K,b7 as Z,ad as j,s as J,e as O,a4 as Q,z as X,aW as Y,m as tt,b8 as at,B as et,C as nt,D as st,c as it,E as ot,b9 as rt}from"./top-DHEXiwp1.js";import{_ as lt}from"./logo-DywwsDaY.js";import{V as D,u as ut}from"./ssrBoot-qapM9KZq.js";import{I as N,V as I,M as ct,N as vt,ah as b,a4 as B,a3 as g,p as o,a5 as dt,aw as u,Z as k,a7 as d,a1 as C,G as ht,ax as _t,_ as p,aq as S,ac as m,aL as pt,a2 as mt,ay as gt}from"./SnackbarsStore-Buj_rJWA.js";import{u as ft}from"./VersionStore-fcAF5g0F.js";function kt(t,a,e,c){function i(n){return n instanceof e?n:new e(function(r){r(n)})}return new(e||(e=Promise))(function(n,r){function v(h){try{s(c.next(h))}catch(l){r(l)}}function y(h){try{s(c.throw(h))}catch(l){r(l)}}function s(h){h.done?n(h.value):i(h.value).then(v,y)}s((c=c.apply(t,[])).next())})}function yt(t,a){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},c,i,n,r;return r={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function v(s){return function(h){return y([s,h])}}function y(s){if(c)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(e=0)),e;)try{if(c=1,i&&(n=s[0]&2?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(s[0]===6&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=a.call(t,e)}catch(h){s=[6,h],i=0}finally{c=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}var bt=function(){function t(){var a=this;this.event=null,this.callbacks=[],this.install=function(){return kt(a,void 0,void 0,function(){var e=this;return yt(this,function(c){switch(c.label){case 0:return this.event?(this.event.prompt(),[4,this.event.userChoice.then(function(i){var n=i.outcome;return e.updateEvent(null),n==="accepted"})]):[3,2];case 1:return[2,c.sent()];case 2:throw new Error("Not allowed to prompt.")}})})},!(typeof window>"u")&&(window.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),a.updateEvent(e)}),window.addEventListener("appinstalled",function(){a.updateEvent(null)}))}return t.prototype.getEvent=function(){return this.event},t.prototype.canInstall=function(){return this.event!==null},t.prototype.updateEvent=function(a){var e=this;a!==this.event&&(this.event=a,this.callbacks.forEach(function(c){return c(e.canInstall())}))},t.prototype.addListener=function(a){a(this.canInstall()),this.callbacks.push(a)},t.prototype.removeListener=function(a){this.callbacks=this.callbacks.filter(function(e){return a!==e})},t}(),V=new bt;const wt={class:"header"},Ct={key:0,class:"search-box"},St=["placeholder"],Bt=N({__name:"HeaderBar",setup(t){const a=I(!1),e=I(""),c=T(),i=P(),n=()=>{i.path.endsWith("/search")&&i.query.query&&(e.value=decodeURIComponent(i.query.query))};ct(()=>{V.addListener(l=>{a.value=l}),n()}),vt(()=>i.fullPath,n);const r=b(()=>i.path.startsWith("/videos")||i.path.startsWith("/mylist")||i.path.startsWith("/watched-history")?"録画番組を検索...":"放送予定の番組を検索..."),v=()=>i.path.startsWith("/videos")||i.path.startsWith("/mylist")||i.path.startsWith("/watched-history")?"/videos/search":"/tv/search",y=l=>{l.key==="Enter"&&!l.isComposing&&s()},s=()=>{if(e.value.trim()){const l=v();c.push(`${l}?query=${encodeURIComponent(e.value.trim())}`)}},h=b(()=>{const l=i.path;return!l.startsWith("/captures")&&!l.startsWith("/settings")&&!l.startsWith("/login")&&!l.startsWith("/register")});return(l,_)=>{const $=C("router-link"),x=C("Icon");return p(),B("header",wt,[g((p(),k($,{class:"konomitv-logo ml-3 ml-md-6",to:"/tv/"},{default:d(()=>_[2]||(_[2]=[u("img",{class:"konomitv-logo__image",src:lt,height:"21"},null,-1)])),_:1})),[[f]]),o(D),h.value?(p(),B("div",Ct,[g(u("input",{class:"search-input",type:"search",enterkeyhint:"search",placeholder:r.value,"onUpdate:modelValue":_[0]||(_[0]=W=>e.value=W),onKeydown:y},null,40,St),[[A,e.value]]),o(x,{class:"search-input__icon",icon:"fluent:search-20-filled",height:"24px",onClick:s})])):dt("",!0),g(o(w,{variant:"flat",class:"pwa-install-button",onClick:_[1]||(_[1]=W=>ht(V).install())},{default:d(()=>[o(x,{icon:"material-symbols:install-desktop-rounded",height:"20px",class:"mr-1"}),_[3]||(_[3]=_t(" アプリとしてインストール "))]),_:1},512),[[R,a.value]]),_[4]||(_[4]=u("div",{class:"mr-3 mr-md-6"},null,-1))])}}}),Ft=E(Bt,[["__scopeId","data-v-fd8ec2e9"]]),$t=L({baseColor:String,bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:t=>!t||["horizontal","shift"].includes(t)},height:{type:[Number,String],default:56},active:{type:Boolean,default:!0},...ot(),...it(),...st(),...nt(),...et(),...at({name:"bottom-navigation"}),...tt({tag:"header"}),...Y({selectedClass:"v-btn--selected"}),...X()},"VBottomNavigation"),Et=q()({name:"VBottomNavigation",props:$t(),emits:{"update:active":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{slots:e}=a;const{themeClasses:c}=z(),{borderClasses:i}=H(t),{backgroundColorClasses:n,backgroundColorStyles:r}=F(S(t,"bgColor")),{densityClasses:v}=G(t),{elevationClasses:y}=M(t),{roundedClasses:s}=U(t),{ssrBootStyles:h}=ut(),l=b(()=>Number(t.height)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0)),_=K(t,"active",t.active),{layoutItemStyles:$}=Z({id:t.name,order:b(()=>parseInt(t.order,10)),position:b(()=>"bottom"),layoutSize:b(()=>_.value?l.value:0),elementSize:l,active:_,absolute:S(t,"absolute")});return j(t,rt),J({VBtn:{baseColor:S(t,"baseColor"),color:S(t,"color"),density:S(t,"density"),stacked:b(()=>t.mode!=="horizontal"),variant:"text"}},{scoped:!0}),O(()=>o(t.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":_.value,"v-bottom-navigation--grow":t.grow,"v-bottom-navigation--shift":t.mode==="shift"},c.value,n.value,i.value,v.value,y.value,s.value,t.class],style:[r.value,$.value,{height:Q(l.value)},h.value,t.style]},{default:()=>[e.default&&o("div",{class:"v-bottom-navigation__content"},[e.default()])]})),{}}}),xt={};function Wt(t,a){const e=C("Icon");return p(),k(Et,{class:"bottom-navigation-container elevation-12",color:"primary",grow:"",active:""},{default:d(()=>[o(w,{class:m(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/tv")}]),to:"/tv/"},{default:d(()=>[o(e,{icon:"fluent:tv-20-regular",width:"30px"}),a[0]||(a[0]=u("span",{class:"mt-1"},"テレビをみる",-1))]),_:1},8,["class"]),o(w,{class:m(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/videos")}]),to:"/videos/"},{default:d(()=>[o(e,{icon:"fluent:movies-and-tv-20-regular",width:"30px"}),a[1]||(a[1]=u("span",{class:"mt-1"},"ビデオをみる",-1))]),_:1},8,["class"]),o(w,{class:m(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/reserves")}]),to:"/reserves/"},{default:d(()=>[o(e,{icon:"fluent:timer-16-regular",width:"30px"}),a[2]||(a[2]=u("span",{class:"mt-1"},"録画予約",-1))]),_:1},8,["class"]),o(w,{class:m(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/captures")}]),to:"/captures/"},{default:d(()=>[o(e,{icon:"fluent:image-multiple-24-regular",width:"30px"}),a[3]||(a[3]=u("span",{class:"mt-1"},"キャプチャ",-1))]),_:1},8,["class"]),o(w,{class:m(["bottom-navigation-button",{"v-btn--active":t.$route.path.startsWith("/mypage")}]),to:"/mypage/"},{default:d(()=>[o(e,{icon:"fluent:person-20-regular",width:"30px"}),a[4]||(a[4]=u("span",{class:"mt-1"},"マイページ",-1))]),_:1},8,["class"])]),_:1})}const It=E(xt,[["render",Wt],["__scopeId","data-v-8139492e"]]),Vt=N({name:"Navigation",components:{BottomNavigation:It},computed:{...pt(ft)},async created(){await this.versionStore.fetchServerVersion()}}),Dt={class:"navigation-container elevation-8"},Nt={class:"navigation"},Pt={class:"navigation-scroll"},At={class:"navigation__link-text"};function Rt(t,a,e,c,i,n){const r=C("Icon"),v=C("router-link"),y=C("BottomNavigation"),s=mt("ftooltip");return p(),B("div",null,[u("div",Dt,[u("nav",Nt,[u("div",Pt,[g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/tv")}]),"active-class":"navigation__link--active",to:"/tv/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:tv-20-regular",width:"26px"}),a[0]||(a[0]=u("span",{class:"navigation__link-text"},"テレビをみる",-1))]),_:1},8,["class"])),[[f]]),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/videos")}]),"active-class":"navigation__link--active",to:"/videos/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:movies-and-tv-20-regular",width:"26px"}),a[1]||(a[1]=u("span",{class:"navigation__link-text"},"ビデオをみる",-1))]),_:1},8,["class"])),[[f]]),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/timetable")}]),"active-class":"navigation__link--active",to:"/timetable/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:calendar-ltr-20-regular",width:"26px"}),a[2]||(a[2]=u("span",{class:"navigation__link-text"},"番組表",-1))]),_:1},8,["class"])),[[f]]),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/reserves")}]),"active-class":"navigation__link--active",to:"/reserves/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:timer-16-regular",width:"26px",style:{padding:"0.5px"}}),a[3]||(a[3]=u("span",{class:"navigation__link-text"},"録画予約",-1))]),_:1},8,["class"])),[[f]]),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/captures")}]),"active-class":"navigation__link--active",to:"/captures/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:image-multiple-24-regular",width:"26px"}),a[4]||(a[4]=u("span",{class:"navigation__link-text"},"キャプチャ",-1))]),_:1},8,["class"])),[[f]]),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/mylist")}]),"active-class":"navigation__link--active",to:"/mylist/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"ic:round-playlist-play",width:"26px"}),a[5]||(a[5]=u("span",{class:"navigation__link-text"},"マイリスト",-1))]),_:1},8,["class"])),[[f]]),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/watched-history")}]),"active-class":"navigation__link--active",to:"/watched-history/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:history-20-regular",width:"26px"}),a[6]||(a[6]=u("span",{class:"navigation__link-text"},"視聴履歴",-1))]),_:1},8,["class"])),[[f]]),o(D),g((p(),k(v,{class:m(["navigation__link",{"navigation__link--active":t.$route.path.startsWith("/settings")}]),"active-class":"navigation__link--active",to:"/settings/"},{default:d(()=>[o(r,{class:"navigation__link-icon",icon:"fluent:settings-20-regular",width:"26px"}),a[7]||(a[7]=u("span",{class:"navigation__link-text"},"設定",-1))]),_:1},8,["class"])),[[f]]),g((p(),B("a",{class:m(["navigation__link",{"navigation__link--develop-version":t.versionStore.is_client_develop_version,"navigation__link--highlight":t.versionStore.is_update_available}]),"active-class":"navigation__link--active",href:"https://github.com/yyya-nico/KonomiTV",target:"_blank"},[o(r,{class:"navigation__link-icon",icon:"fluent:info-16-regular",width:"26px"}),u("span",At,"version "+gt(t.versionStore.client_version),1)],2)),[[f],[s,t.versionStore.is_update_available?`アップデートがあります (version ${t.versionStore.latest_version})`:"",void 0,{top:!0}]])])])]),o(y)])}const Gt=E(Vt,[["render",Rt],["__scopeId","data-v-c07c4024"]]);export{Ft as H,Gt as N};
